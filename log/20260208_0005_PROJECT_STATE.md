# Project State: metricsAI (2026-02-08 17:00)

## Overview

metricsAI is a Python/Jupyter econometrics textbook with 18 chapters (CH00 Preface + CH01-CH17).
All teaching chapters have been standardized, proofread, and PDFs regenerated.
All 189 Key Concepts have been numbered and titled (X.N format with short descriptive titles).
12 chapters include dual case studies: Mendez Convergence Clubs + DS4Bolivia satellite data.
The complete book has been compiled into a single PDF with professional formatting and a copyright page.

## Current Quality Metrics

### Standardization Scores (chapter-standard skill)

| Chapter | Title | Score |
|---------|-------|-------|
| CH00 | Preface | 39/100 (excluded - not a teaching chapter) |
| CH01 | Analysis of Economics Data | 95/100 |
| CH02 | Univariate Data Summary | 91/100 |
| CH03 | The Sample Mean | 93/100 |
| CH04 | Statistical Inference for the Mean | 96/100 |
| CH05 | Bivariate Data Summary | 95/100 |
| CH06 | The Least Squares Estimator | 96/100 |
| CH07 | Statistical Inference for Bivariate Regression | 93/100 |
| CH08 | Case Studies for Bivariate Regression | 93/100 |
| CH09 | Models with Natural Logarithms | 96/100 |
| CH10 | Data Summary for Multiple Regression | 100/100 |
| CH11 | Statistical Inference for Multiple Regression | 95/100 |
| CH12 | Further Topics in Multiple Regression | 98/100 |
| CH13 | Case Studies for Multiple Regression | 93/100 |
| CH14 | Regression with Indicator Variables | 100/100 |
| CH15 | Regression with Transformed Variables | 98/100 |
| CH16 | Checking the Model and Data | 98/100 |
| CH17 | Panel Data, Time Series Data, Causation | 100/100 |

**Average (CH01-CH17): 95.5/100. All at 90+.**

### Proofreading Scores (proofread skill)

| Chapter | Critical | Minor | Suggestions | Score |
|---------|----------|-------|-------------|-------|
| ch00 | 0 | 2 | 1 | 95/100 |
| ch01 | 0 | 2 | 1 | 95/100 |
| ch02 | 0 | 1 | 3 | 95/100 |
| ch03 | 0 | 1 | 0 | 98/100 |
| ch04 | 0 | 2 | 0 | 96/100 |
| ch05 | 0 | 5 | 0 | 90/100 |
| ch06 | 0 | 0 | 1 | 99/100 |
| ch07 | 0 | 3 | 0 | 94/100 |
| ch08 | 0 | 1 | 0 | 98/100 |
| ch09 | 0 | 0 | 0 | 100/100 |
| ch10 | 0 | 0 | 0 | 100/100 |
| ch11 | 0 | 4 | 0 | 92/100 |
| ch12 | 0 | 1 | 0 | 98/100 |
| ch13 | 0 | 0 | 0 | 100/100 |
| ch14 | 0 | 0 | 0 | 100/100 |
| ch15 | 0 | 5 | 0 | 90/100 |
| ch16 | 0 | 4 | 0 | 92/100 |
| ch17 | 0 | 1 | 0 | 98/100 |

**Zero critical issues across all chapters. All at 90+.**

## Key Concepts

**189 Key Concepts** across CH01-CH17, all numbered and titled in format: `> **Key Concept X.N: Short Title**`

| Chapter | Key Concepts |
|---------|-------------|
| CH01 | 10 (1.1-1.10) |
| CH02 | 11 (2.1-2.11) |
| CH03 | 11 (3.1-3.11) |
| CH04 | 13 (4.1-4.13) |
| CH05 | 12 (5.1-5.12) |
| CH06 | 10 (6.1-6.10) |
| CH07 | 13 (7.1-7.13) |
| CH08 | 8 (8.1-8.8) |
| CH09 | 9 (9.1-9.9) |
| CH10 | 13 (10.1-10.13) |
| CH11 | 13 (11.1-11.13) |
| CH12 | 12 (12.1-12.12) |
| CH13 | 9 (13.1-13.9) |
| CH14 | 10 (14.1-14.10) |
| CH15 | 12 (15.1-15.12) |
| CH16 | 12 (16.1-16.12) |
| CH17 | 11 (17.1-17.11) |

**Numbering script**: `scripts/number_key_concepts.py` (with 52 pre-defined titles for previously untitled concepts)

## Case Studies

### Mendez Convergence Clubs Dataset (Case Study 1)

- **URL**: `https://raw.githubusercontent.com/quarcs-lab/mendez2020-convergence-clubs-code-data/master/assets/dat.csv`
- **Scope**: 108 countries, 1990-2014 (cross-country economic convergence)
- **Used in**: CH01, CH02, CH04, CH07, CH08, CH09, CH10, CH11, CH12, CH14, CH15, CH16, CH17

### DS4Bolivia Dataset (Case Study 2)

- **URL**: `https://raw.githubusercontent.com/quarcs-lab/ds4bolivia/master/ds4bolivia_v20250523.csv`
- **Scope**: 339 Bolivian municipalities, satellite data (NTL + 64-dim embeddings), SDG indices
- **Theme**: "Can Satellites See Development? Using Remote Sensing to Predict Local Economic Development in Bolivia"
- **Used in**: CH01, CH02, CH04, CH05, CH07, CH10, CH11, CH12, CH14, CH15, CH16, CH17
- **Structure**: 6 tasks per case study (Guided, Semi-guided, Independent) + 2 Key Concepts each
- **Scripts**: `scripts/add_ds4bolivia_chXX.py` (12 scripts)

## Compiled Book PDF

**File**: `notebooks_colab/metricsAI_complete_book.pdf`
**Size**: 62.3 MB
**Pages**: 900
**Clickable TOC links**: 753 (Brief Contents + Detailed Contents + Key Concepts)

### Book Structure

| Component | Pages |
|-----------|-------|
| Cover page | 1 (unnumbered) |
| Copyright page | 1 (unnumbered) |
| Brief Contents | 1 (unnumbered) |
| Detailed Contents | 4 (unnumbered) |
| Key Concepts | 5 (unnumbered) |
| Content (CH00-CH17) | 888 (numbered 1-888) |
| **Total** | **900** |

### PDF Bookmarks

132 hierarchical bookmark entries:

- Preface (4 sub-sections)
- Part I: Foundations > Chapters 1-4 (29 sections)
- Part II: Bivariate Regression > Chapters 5-9 (25 sections)
- Part III: Multiple Regression > Chapters 10-13 (34 sections)
- Part IV: Advanced Topics > Chapters 14-17 (18 sections)

### Individual Chapter PDFs

| Chapter | Size | Pages |
|---------|------|-------|
| ch00 | 0.90 MB | 15 |
| ch01 | 1.40 MB | 37 |
| ch02 | 2.00 MB | 62 |
| ch03 | 1.50 MB | 41 |
| ch04 | 1.80 MB | 58 |
| ch05 | 1.80 MB | 64 |
| ch06 | 1.40 MB | 39 |
| ch07 | 1.70 MB | 72 |
| ch08 | 1.70 MB | 41 |
| ch09 | 1.50 MB | 37 |
| ch10 | 1.70 MB | 40 |
| ch11 | 1.60 MB | 54 |
| ch12 | 1.50 MB | 48 |
| ch13 | 1.80 MB | 63 |
| ch14 | 1.40 MB | 45 |
| ch15 | 1.70 MB | 54 |
| ch16 | 2.00 MB | 59 |
| ch17 | 1.80 MB | 59 |

## Claude Code Skills

### 1. chapter-standard

- **Location**: `.claude/skills/chapter-standard/`
- **Purpose**: Verify and standardize chapter notebooks against template
- **Usage**: `/chapter-standard ch08`, `/chapter-standard --all`

### 2. proofread

- **Location**: `.claude/skills/proofread/`
- **Purpose**: Detect and fix text quality issues in notebooks
- **Usage**: `/proofread ch08`, `/proofread ch08 --fix`, `/proofread --all`

### 3. compile-book

- **Location**: `.claude/skills/compile-book/`
- **Purpose**: Compile all chapter PDFs into single book PDF
- **Usage**: `/compile-book`, `/compile-book ch05`, `/compile-book --compile-only`, `/compile-book --check`
- **Features**: Auto-detects modified chapters, regenerates PDFs, compiles book with cover, copyright page, three TOCs with clickable hyperlinks (753 links), page numbers, and section-level PDF bookmarks

## Key Infrastructure

### PDF Generation Pipeline

1. `jupyter nbconvert --to html` (notebook -> HTML)
2. `inject_print_css.py` (inject `notebook_pdf_styles.css` -> printable HTML)
3. `generate_pdf_playwright.py` (Chromium-based PDF with precise formatting)

### Book Compilation Pipeline

- **Script**: `scripts/compile_book.py`
- **Steps**: Cover -> Copyright -> Section + Key Concept extraction -> Brief Contents -> Detailed Contents -> Key Concepts TOC -> Merge -> Page numbers -> PDF bookmarks -> Clickable TOC links
- **Dependencies**: playwright, pypdf

### Key Concept Numbering

- **Script**: `scripts/number_key_concepts.py`
- **Purpose**: Numbers and titles all Key Concepts across CH01-CH17
- **Usage**: `python3 scripts/number_key_concepts.py` (all) or `python3 scripts/number_key_concepts.py ch01 ch05` (specific)
- **52 pre-defined titles** for previously untitled concepts (mostly in CH01-CH08)

### Recommended Workflow

```text
1. /chapter-standard chXX          # Verify structure (target: 90+)
2. /proofread chXX --fix            # Fix text quality issues
3. /compile-book chXX               # Regenerate PDF and recompile book
```

## Work Completed

### DS4Bolivia Case Studies (2026-02-08)

1. Added Case Study 2 (DS4Bolivia satellite data) to 12 chapters
2. 24 new Key Concepts added (165 -> 189 total)
3. 12 implementation scripts in `scripts/add_ds4bolivia_chXX.py`
4. CH01 provides comprehensive DS4Bolivia introduction; other chapters reference it

### Copyright Page (2026-02-08)

1. Added `generate_copyright_html()` to `scripts/compile_book.py`
2. Copyright page inserted between cover and Brief Contents
3. Content: Title, copyright (Carlos Mendez, 2026), affiliation (Nagoya University), companion website

### Key Concept Numbering and TOC (2026-02-08)

1. Created `scripts/number_key_concepts.py` to number and title all Key Concepts
2. Processed all 189 Key Concepts across 17 chapters (52 untitled concepts received new titles)
3. Added Key Concepts TOC to `scripts/compile_book.py` (5 pages, clickable links)
4. Regenerated all 18 chapter PDFs with numbered Key Concepts
5. Recompiled book: 900 pages, 753 clickable TOC links

### Book Compilation (2026-02-08)

1. Created `scripts/compile_book.py` (book compilation script)
2. Added cover page, copyright page, Brief Contents, Detailed Contents with clickable hyperlinks
3. Added section-level PDF bookmarks (110 sections)
4. Added Key Concepts TOC (189 concepts with clickable links)

### Compile-Book Skill

- Created `.claude/skills/compile-book/SKILL.md`
- Created `.claude/skills/compile-book/references/COMPILATION_GUIDE.md`

## Next Steps

- Commit all changes (DS4Bolivia case studies, copyright page, Key Concept numbering, updated PDFs, book)
- The textbook is publication-ready: standardized (95.5 avg), proofread (0 critical issues), dual case studies, compiled (900 pages with copyright, 3 clickable TOCs, bookmarks, and page numbers)
