<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Chapter 4: Statistical Inference for the Mean – Econometrics Powered by AI</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../book/site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../book/site_libs/quarto-nav/headroom.min.js"></script>
<script src="../book/site_libs/clipboard/clipboard.min.js"></script>
<script src="../book/site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../book/site_libs/quarto-search/fuse.min.js"></script>
<script src="../book/site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../book/">
<link href="../book/../notebooks_colab/ch05_Bivariate_Data_Summary.html" rel="next">
<link href="../book/../notebooks_colab/ch03_The_Sample_Mean.html" rel="prev">
<script src="../book/site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../book/site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../book/site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../book/site_libs/quarto-html/popper.min.js"></script>
<script src="../book/site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../book/site_libs/quarto-html/anchor.min.js"></script>
<link href="../book/site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../book/site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../book/site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../book/site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../book/site_libs/bootstrap/bootstrap-27c261d06b905028a18691de25d09dde.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../book/custom.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../book/../notebooks_colab/ch01_Analysis_of_Economics_Data.html">Statistical Foundations</a></li><li class="breadcrumb-item"><a href="../book/../notebooks_colab/ch04_Statistical_Inference_for_the_Mean.html"><span class="chapter-title">Chapter 4: Statistical Inference for the Mean</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../book/">Econometrics Powered by AI</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/../notebooks_colab/ch00_Preface.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Preface: Econometrics Powered by AI</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Statistical Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/../notebooks_colab/ch01_Analysis_of_Economics_Data.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 1: Analysis of Economics Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/../notebooks_colab/ch02_Univariate_Data_Summary.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 2: Univariate Data Summary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/../notebooks_colab/ch03_The_Sample_Mean.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 3: The Sample Mean</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/../notebooks_colab/ch04_Statistical_Inference_for_the_Mean.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Chapter 4: Statistical Inference for the Mean</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Bivariate Regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/../notebooks_colab/ch05_Bivariate_Data_Summary.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 5: Bivariate Data Summary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/../notebooks_colab/ch06_The_Least_Squares_Estimator.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 6: The Least Squares Estimator</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/../notebooks_colab/ch07_Statistical_Inference_for_Bivariate_Regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 7: Statistical Inference for Bivariate Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/../notebooks_colab/ch08_Case_Studies_for_Bivariate_Regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 8: Case Studies for Bivariate Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/../notebooks_colab/ch09_Models_with_Natural_Logarithms.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 9: Models with Natural Logarithms</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Multiple Regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/../notebooks_colab/ch10_Data_Summary_for_Multiple_Regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 10: Data Summary for Multiple Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/../notebooks_colab/ch11_Statistical_Inference_for_Multiple_Regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 11: Statistical Inference for Multiple Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/../notebooks_colab/ch12_Further_Topics_in_Multiple_Regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 12: Further Topics in Multiple Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/../notebooks_colab/ch13_Case_Studies_for_Multiple_Regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 13: Case Studies for Multiple Regression</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Advanced Topics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/../notebooks_colab/ch14_Regression_with_Indicator_Variables.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 14: Regression with Indicator Variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/../notebooks_colab/ch15_Regression_with_Transformed_Variables.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 15: Regression with Transformed Variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/../notebooks_colab/ch16_Checking_the_Model_and_Data.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 16: Checking the Model and Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/../notebooks_colab/ch17_Panel_Data_Time_Series_Data_Causation.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 17: Panel Data, Time Series Data, Causation</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#chapter-overview" id="toc-chapter-overview" class="nav-link active" data-scroll-target="#chapter-overview">Chapter Overview</a></li>
  <li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#example-mean-annual-earnings" id="toc-example-mean-annual-earnings" class="nav-link" data-scroll-target="#example-mean-annual-earnings">4.1 Example: Mean Annual Earnings</a></li>
  <li><a href="#t-statistic-and-t-distribution" id="toc-t-statistic-and-t-distribution" class="nav-link" data-scroll-target="#t-statistic-and-t-distribution">4.2 t Statistic and t Distribution</a></li>
  <li><a href="#confidence-intervals" id="toc-confidence-intervals" class="nav-link" data-scroll-target="#confidence-intervals">4.3 Confidence Intervals</a>
  <ul class="collapse">
  <li><a href="#confidence-precision-trade-off" id="toc-confidence-precision-trade-off" class="nav-link" data-scroll-target="#confidence-precision-trade-off">Confidence-Precision Trade-off</a></li>
  </ul></li>
  <li><a href="#two-sided-hypothesis-tests" id="toc-two-sided-hypothesis-tests" class="nav-link" data-scroll-target="#two-sided-hypothesis-tests">4.4 Two-Sided Hypothesis Tests</a>
  <ul class="collapse">
  <li><a href="#visualizing-the-two-sided-hypothesis-test" id="toc-visualizing-the-two-sided-hypothesis-test" class="nav-link" data-scroll-target="#visualizing-the-two-sided-hypothesis-test">Visualizing the two-sided hypothesis test</a></li>
  <li><a href="#type-i-error-type-ii-error-and-statistical-power" id="toc-type-i-error-type-ii-error-and-statistical-power" class="nav-link" data-scroll-target="#type-i-error-type-ii-error-and-statistical-power">Type I Error, Type II Error, and Statistical Power</a></li>
  </ul></li>
  <li><a href="#hypothesis-test-examples" id="toc-hypothesis-test-examples" class="nav-link" data-scroll-target="#hypothesis-test-examples">4.5 Hypothesis Test Examples</a>
  <ul class="collapse">
  <li><a href="#example-1-gasoline-prices" id="toc-example-1-gasoline-prices" class="nav-link" data-scroll-target="#example-1-gasoline-prices">Example 1: Gasoline Prices</a></li>
  <li><a href="#example-2-male-earnings" id="toc-example-2-male-earnings" class="nav-link" data-scroll-target="#example-2-male-earnings">Example 2: Male Earnings</a></li>
  <li><a href="#example-3-gdp-growth" id="toc-example-3-gdp-growth" class="nav-link" data-scroll-target="#example-3-gdp-growth">Example 3: GDP Growth</a></li>
  </ul></li>
  <li><a href="#one-sided-directional-hypothesis-tests" id="toc-one-sided-directional-hypothesis-tests" class="nav-link" data-scroll-target="#one-sided-directional-hypothesis-tests">4.6 One-Sided Directional Hypothesis Tests</a>
  <ul class="collapse">
  <li><a href="#visualizing-one-sided-test" id="toc-visualizing-one-sided-test" class="nav-link" data-scroll-target="#visualizing-one-sided-test">Visualizing One-Sided Test</a></li>
  </ul></li>
  <li><a href="#proportions-data" id="toc-proportions-data" class="nav-link" data-scroll-target="#proportions-data">4.7 Proportions Data</a></li>
  <li><a href="#key-takeaways" id="toc-key-takeaways" class="nav-link" data-scroll-target="#key-takeaways">Key Takeaways</a>
  <ul class="collapse">
  <li><a href="#core-concepts" id="toc-core-concepts" class="nav-link" data-scroll-target="#core-concepts">Core Concepts</a></li>
  <li><a href="#what-you-learned" id="toc-what-you-learned" class="nav-link" data-scroll-target="#what-you-learned">What You Learned</a></li>
  <li><a href="#next-steps" id="toc-next-steps" class="nav-link" data-scroll-target="#next-steps">Next Steps</a></li>
  <li><a href="#congratulations" id="toc-congratulations" class="nav-link" data-scroll-target="#congratulations">Congratulations!</a></li>
  </ul></li>
  <li><a href="#practice-exercises" id="toc-practice-exercises" class="nav-link" data-scroll-target="#practice-exercises">Practice Exercises</a>
  <ul class="collapse">
  <li><a href="#exercise-1-confidence-interval-interpretation" id="toc-exercise-1-confidence-interval-interpretation" class="nav-link" data-scroll-target="#exercise-1-confidence-interval-interpretation">Exercise 1: Confidence Interval Interpretation</a></li>
  <li><a href="#exercise-2-standard-error-calculation" id="toc-exercise-2-standard-error-calculation" class="nav-link" data-scroll-target="#exercise-2-standard-error-calculation">Exercise 2: Standard Error Calculation</a></li>
  <li><a href="#exercise-3-t-vs-z-distribution" id="toc-exercise-3-t-vs-z-distribution" class="nav-link" data-scroll-target="#exercise-3-t-vs-z-distribution">Exercise 3: t vs z Distribution</a></li>
  <li><a href="#exercise-4-hypothesis-test-mechanics" id="toc-exercise-4-hypothesis-test-mechanics" class="nav-link" data-scroll-target="#exercise-4-hypothesis-test-mechanics">Exercise 4: Hypothesis Test Mechanics</a></li>
  <li><a href="#exercise-5-one-sided-vs-two-sided-tests" id="toc-exercise-5-one-sided-vs-two-sided-tests" class="nav-link" data-scroll-target="#exercise-5-one-sided-vs-two-sided-tests">Exercise 5: One-Sided vs Two-Sided Tests</a></li>
  <li><a href="#exercise-6-type-i-and-type-ii-errors" id="toc-exercise-6-type-i-and-type-ii-errors" class="nav-link" data-scroll-target="#exercise-6-type-i-and-type-ii-errors">Exercise 6: Type I and Type II Errors</a></li>
  <li><a href="#exercise-7-proportions-inference" id="toc-exercise-7-proportions-inference" class="nav-link" data-scroll-target="#exercise-7-proportions-inference">Exercise 7: Proportions Inference</a></li>
  <li><a href="#exercise-8-python-practice" id="toc-exercise-8-python-practice" class="nav-link" data-scroll-target="#exercise-8-python-practice">Exercise 8: Python Practice</a></li>
  </ul></li>
  <li><a href="#case-study-1-statistical-inference-for-labor-productivity" id="toc-case-study-1-statistical-inference-for-labor-productivity" class="nav-link" data-scroll-target="#case-study-1-statistical-inference-for-labor-productivity">Case Study 1: Statistical Inference for Labor Productivity</a>
  <ul class="collapse">
  <li><a href="#economic-context-testing-convergence-hypotheses" id="toc-economic-context-testing-convergence-hypotheses" class="nav-link" data-scroll-target="#economic-context-testing-convergence-hypotheses">Economic Context: Testing Convergence Hypotheses</a></li>
  <li><a href="#how-to-use-these-tasks" id="toc-how-to-use-these-tasks" class="nav-link" data-scroll-target="#how-to-use-these-tasks">How to Use These Tasks</a></li>
  <li><a href="#task-1-confidence-intervals-for-mean-productivity-guided" id="toc-task-1-confidence-intervals-for-mean-productivity-guided" class="nav-link" data-scroll-target="#task-1-confidence-intervals-for-mean-productivity-guided">Task 1: Confidence Intervals for Mean Productivity (GUIDED)</a></li>
  <li><a href="#task-2-testing-productivity-change-over-time-semi-guided" id="toc-task-2-testing-productivity-change-over-time-semi-guided" class="nav-link" data-scroll-target="#task-2-testing-productivity-change-over-time-semi-guided">Task 2: Testing Productivity Change Over Time (SEMI-GUIDED)</a></li>
  <li><a href="#task-3-comparing-regional-productivity-levels-semi-guided" id="toc-task-3-comparing-regional-productivity-levels-semi-guided" class="nav-link" data-scroll-target="#task-3-comparing-regional-productivity-levels-semi-guided">Task 3: Comparing Regional Productivity Levels (SEMI-GUIDED)</a></li>
  <li><a href="#task-4-one-sided-test-for-growth-more-independent" id="toc-task-4-one-sided-test-for-growth-more-independent" class="nav-link" data-scroll-target="#task-4-one-sided-test-for-growth-more-independent">Task 4: One-Sided Test for Growth (MORE INDEPENDENT)</a></li>
  <li><a href="#task-5-proportions-analysis---growth-winners-independent" id="toc-task-5-proportions-analysis---growth-winners-independent" class="nav-link" data-scroll-target="#task-5-proportions-analysis---growth-winners-independent">Task 5: Proportions Analysis - Growth Winners (INDEPENDENT)</a></li>
  <li><a href="#task-6-multi-regional-hypothesis-testing-independent" id="toc-task-6-multi-regional-hypothesis-testing-independent" class="nav-link" data-scroll-target="#task-6-multi-regional-hypothesis-testing-independent">Task 6: Multi-Regional Hypothesis Testing (INDEPENDENT)</a></li>
  <li><a href="#what-youve-learned" id="toc-what-youve-learned" class="nav-link" data-scroll-target="#what-youve-learned">What You’ve Learned</a></li>
  <li><a href="#case-study-2-is-bolivias-development-equal-testing-differences-across-departments" id="toc-case-study-2-is-bolivias-development-equal-testing-differences-across-departments" class="nav-link" data-scroll-target="#case-study-2-is-bolivias-development-equal-testing-differences-across-departments">Case Study 2: Is Bolivia’s Development Equal? Testing Differences Across Departments</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">
<div id="google_translate_element" style="padding: 8px 0;"></div>
<script type="text/javascript">
function googleTranslateElementInit() {
  new google.translate.TranslateElement({
    pageLanguage: 'en',
    layout: google.translate.TranslateElement.InlineLayout.HORIZONTAL
  }, 'google_translate_element');
}
</script>
<script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../book/../notebooks_colab/ch01_Analysis_of_Economics_Data.html">Statistical Foundations</a></li><li class="breadcrumb-item"><a href="../book/../notebooks_colab/ch04_Statistical_Inference_for_the_Mean.html"><span class="chapter-title">Chapter 4: Statistical Inference for the Mean</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-title">Chapter 4: Statistical Inference for the Mean</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><strong>metricsAI: An Introduction to Econometrics with Python and AI in the Cloud</strong></p>
<p><em><a href="https://carlos-mendez.org">Carlos Mendez</a></em></p>
<p><img src="https://raw.githubusercontent.com/quarcs-lab/metricsai/main/images/ch04_visual_summary.jpg" alt="Chapter 04 Visual Summary" width="65%"></p>
<p>This notebook provides an interactive introduction to statistical inference, teaching you how to extrapolate from sample statistics to population parameters using confidence intervals and hypothesis tests.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://colab.research.google.com/github/quarcs-lab/metricsai/blob/main/notebooks_colab/ch04_Statistical_Inference_for_the_Mean.ipynb"><img src="https://colab.research.google.com/assets/colab-badge.svg" class="img-fluid figure-img"></a></p>
<figcaption>Open In Colab</figcaption>
</figure>
</div>
<section id="chapter-overview" class="level2">
<h2 class="anchored" data-anchor-id="chapter-overview">Chapter Overview</h2>
<p>This chapter introduces <strong>statistical inference for the mean</strong>—the foundational methods for extrapolating from sample statistics to population parameters with quantified uncertainty.</p>
<p><strong>What you’ll learn:</strong></p>
<ul>
<li>Construct and interpret <strong>confidence intervals</strong> for population means</li>
<li>Understand the <strong>t-distribution</strong> and when to use it (vs.&nbsp;normal distribution)</li>
<li>Conduct <strong>hypothesis tests</strong> to evaluate claims about population parameters</li>
<li>Calculate and interpret <strong>p-values</strong> and understand statistical significance</li>
<li>Distinguish between <strong>one-sided and two-sided tests</strong></li>
<li>Apply inference methods to <strong>proportions data</strong> and binary outcomes</li>
</ul>
<p><strong>Datasets used:</strong></p>
<ul>
<li><strong>AED_EARNINGS.DTA</strong>: Sample of 171 30-year-old female full-time workers in 2010 (earnings in dollars)</li>
<li><strong>AED_GASPRICE.DTA</strong>: Weekly gasoline prices in the U.S. (testing price level hypotheses)</li>
<li><strong>AED_EARNINGSMALE.DTA</strong>: Male earnings data for hypothesis testing examples</li>
<li><strong>AED_REALGDPPC.DTA</strong>: Real GDP per capita growth rates (testing economic growth hypotheses)</li>
</ul>
<p><strong>Chapter outline:</strong></p>
<ul>
<li><strong>4.1 Example: Mean Annual Earnings</strong></li>
<li><strong>4.2 t Statistic and t Distribution</strong></li>
<li><strong>4.3 Confidence Intervals</strong></li>
<li><strong>4.4 Two-Sided Hypothesis Tests</strong></li>
<li><strong>4.5 Hypothesis Test Examples</strong></li>
<li><strong>4.6 One-Sided Directional Hypothesis Tests</strong></li>
<li><strong>4.7 Proportions Data</strong></li>
</ul>
</section>
<section id="setup" class="level2">
<h2 class="anchored" data-anchor-id="setup">Setup</h2>
<p>Run this cell first to import all required packages and configure the environment.</p>
<div id="cell-3" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import required libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Set random seeds for reproducibility</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>RANDOM_SEED <span class="op">=</span> <span class="dv">42</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>random.seed(RANDOM_SEED)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>np.random.seed(RANDOM_SEED)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>os.environ[<span class="st">'PYTHONHASHSEED'</span>] <span class="op">=</span> <span class="bu">str</span>(RANDOM_SEED)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># GitHub data URL (data streams directly from here)</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>GITHUB_DATA_URL <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/quarcs-lab/data-open/master/AED/"</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Optional: Create directories for saving outputs locally</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>IMAGES_DIR <span class="op">=</span> <span class="st">'images'</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>TABLES_DIR <span class="op">=</span> <span class="st">'tables'</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>os.makedirs(IMAGES_DIR, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>os.makedirs(TABLES_DIR, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Set plotting style</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>sns.set_style(<span class="st">"whitegrid"</span>)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'figure.figsize'</span>] <span class="op">=</span> (<span class="dv">10</span>, <span class="dv">6</span>)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"✓ Setup complete! All packages imported successfully."</span>)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"✓ Random seed set to </span><span class="sc">{</span>RANDOM_SEED<span class="sc">}</span><span class="ss"> for reproducibility."</span>)</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"✓ Data will stream from: </span><span class="sc">{</span>GITHUB_DATA_URL<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>✓ Setup complete! All packages imported successfully.
✓ Random seed set to 42 for reproducibility.
✓ Data will stream from: https://raw.githubusercontent.com/quarcs-lab/data-open/master/AED/</code></pre>
</div>
</div>
</section>
<section id="example-mean-annual-earnings" class="level2">
<h2 class="anchored" data-anchor-id="example-mean-annual-earnings">4.1 Example: Mean Annual Earnings</h2>
<p>We’ll use a motivating example throughout this chapter: estimating the <strong>population mean annual earnings</strong> for 30-year-old female full-time workers in the U.S. in 2010.</p>
<p><strong>The Problem:</strong></p>
<ul>
<li>We have a <strong>sample</strong> of 171 women</li>
<li>We want to make inferences about the <strong>population</strong> of all such women</li>
</ul>
<p><strong>Key Statistics:</strong></p>
<ul>
<li><strong>Sample mean</strong> <span class="math inline">\(\bar{x}\)</span>: Our point estimate of population mean μ</li>
<li><strong>Standard deviation</strong> s: Measures variability in the sample</li>
<li><strong>Standard error</strong> se(<span class="math inline">\(\bar{x}\)</span>) = s/√n: Measures precision of <span class="math inline">\(\bar{x}\)</span> as an estimate of μ</li>
</ul>
<p>The <strong>standard error</strong> is crucial—it quantifies our uncertainty about μ. Smaller standard errors mean more precise estimates.</p>
<div id="cell-5" class="cell" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load earnings data</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>data_earnings <span class="op">=</span> pd.read_stata(GITHUB_DATA_URL <span class="op">+</span> <span class="st">'AED_EARNINGS.DTA'</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>earnings <span class="op">=</span> data_earnings[<span class="st">'earnings'</span>]</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate key statistics</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="bu">len</span>(earnings)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>mean_earnings <span class="op">=</span> earnings.mean()</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>std_earnings <span class="op">=</span> earnings.std(ddof<span class="op">=</span><span class="dv">1</span>)  <span class="co"># ddof=1 for sample std dev</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>se_earnings <span class="op">=</span> std_earnings <span class="op">/</span> np.sqrt(n)  <span class="co"># Standard error</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"SAMPLE STATISTICS FOR ANNUAL EARNINGS"</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sample size (n):        </span><span class="sc">{</span>n<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mean:                   $</span><span class="sc">{</span>mean_earnings<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Standard deviation:     $</span><span class="sc">{</span>std_earnings<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Standard error:         $</span><span class="sc">{</span>se_earnings<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Interpretation: Our best estimate of population mean earnings is $</span><span class="sc">{</span>mean_earnings<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The standard error of $</span><span class="sc">{</span>se_earnings<span class="sc">:,.2f}</span><span class="ss"> measures the precision of this estimate."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
SAMPLE STATISTICS FOR ANNUAL EARNINGS
======================================================================
Sample size (n):        171
Mean:                   $41,412.69
Standard deviation:     $25,527.05
Standard error:         $1,952.10

Interpretation: Our best estimate of population mean earnings is $41,412.69
The standard error of $1,952.10 measures the precision of this estimate.</code></pre>
</div>
</div>
<p><strong>Key Statistics from our Sample (n = 171 women):</strong></p>
<ul>
<li>Sample mean: $41,412.69</li>
<li>Standard deviation: $25,527.05</li>
<li>Standard error: $1,952.10</li>
</ul>
<p><strong>What is the standard error telling us?</strong></p>
<p>The standard error of $1,952.10 measures the <strong>precision</strong> of our sample mean as an estimate of the true population mean. Think of it as quantifying our uncertainty.</p>
<p><strong>Statistical interpretation:</strong></p>
<ul>
<li>If we repeatedly drew samples of 171 women, the sample means would vary</li>
<li>The standard error tells us the typical amount by which sample means differ from the true population mean</li>
<li>Formula: SE = s/√n = $25,527.05/√171 = $1,952.10</li>
</ul>
<p><strong>Why is the SE much smaller than the standard deviation?</strong></p>
<ul>
<li>Standard deviation ($25,527) measures variability among individual women’s earnings</li>
<li>Standard error ($1,952) measures variability of the sample mean across different samples</li>
<li>The larger the sample size, the smaller the SE → more precise estimates</li>
</ul>
<p><strong>Practical insight:</strong></p>
<ul>
<li>A standard error of $1,952 is relatively small compared to the mean ($41,413)</li>
<li>This suggests our estimate is reasonably precise</li>
<li>If we had only 43 women (n=43), SE would double to $3,904 (less precise)</li>
<li>With 684 women (n=684), SE would halve to $976 (more precise)</li>
</ul>
<blockquote class="blockquote">
<p><strong>Key Concept 4.1: Standard Error and Precision</strong></p>
<p>The standard error se(<span class="math inline">\(\bar{x}\)</span>) = s/√n measures the precision of the sample mean as an estimate of the population mean μ. It quantifies sampling uncertainty—smaller standard errors mean more precise estimates. The SE decreases with sample size at rate 1/√n, so quadrupling the sample size halves the standard error.</p>
</blockquote>
</section>
<section id="t-statistic-and-t-distribution" class="level2">
<h2 class="anchored" data-anchor-id="t-statistic-and-t-distribution">4.2 t Statistic and t Distribution</h2>
<p>For inference on the population mean μ, we use the <strong>t-statistic</strong>:</p>
<p><span class="math display">\[t = \frac{\bar{x} - \mu}{\text{se}(\bar{x})} = \frac{\bar{x} - \mu}{s / \sqrt{n}}\]</span></p>
<p>Under certain assumptions, this statistic follows a <strong>t-distribution</strong> with (n - 1) degrees of freedom:</p>
<p><span class="math display">\[t \sim T(n-1)\]</span></p>
<p><strong>Why t-distribution instead of normal?</strong></p>
<ul>
<li>We don’t know the population standard deviation σ, so we estimate it with sample std dev s</li>
<li>This adds uncertainty, making the distribution have <strong>fatter tails</strong> than the normal</li>
<li>As sample size increases (n → ∞), the t-distribution approaches the standard normal distribution</li>
</ul>
<p><strong>Key properties:</strong></p>
<ul>
<li>Symmetric around zero (like the normal)</li>
<li>Fatter tails than normal (more probability in extremes)</li>
<li>Converges to N(0,1) as degrees of freedom increase</li>
</ul>
<div id="cell-9" class="cell" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize t-distribution vs standard normal</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">16</span>, <span class="dv">6</span>))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">200</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel A: t(4) vs standard normal</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].plot(x, stats.norm.pdf(x), <span class="st">'b--'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">'Standard Normal'</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].plot(x, stats.t.pdf(x, df<span class="op">=</span><span class="dv">4</span>), <span class="st">'r-'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">'t(4)'</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">'x value'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'Density'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">'Panel A: t(4) and Standard Normal'</span>, fontsize<span class="op">=</span><span class="dv">13</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].legend()</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].text(<span class="dv">0</span>, <span class="fl">0.35</span>, <span class="st">'Notice: t(4) has fatter tails</span><span class="ch">\n</span><span class="st">(more extreme values likely)'</span>, </span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>             ha<span class="op">=</span><span class="st">'center'</span>, bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'round'</span>, facecolor<span class="op">=</span><span class="st">'wheat'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>))</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel B: t(30) vs standard normal</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(x, stats.norm.pdf(x), <span class="st">'b--'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">'Standard Normal'</span>)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(x, stats.t.pdf(x, df<span class="op">=</span><span class="dv">30</span>), <span class="st">'r-'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">'t(30)'</span>)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">'x value'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">'Density'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">'Panel B: t(30) and Standard Normal'</span>, fontsize<span class="op">=</span><span class="dv">13</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].legend()</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].text(<span class="dv">0</span>, <span class="fl">0.35</span>, <span class="st">'As df increases, t approaches</span><span class="ch">\n</span><span class="st">the standard normal'</span>, </span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>             ha<span class="op">=</span><span class="st">'center'</span>, bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'round'</span>, facecolor<span class="op">=</span><span class="st">'wheat'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>))</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">'Figure 4.1: t Distribution vs Standard Normal'</span>,</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, y<span class="op">=</span><span class="fl">1.0</span>)</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">📊 Key Observation:"</span>)</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   With more degrees of freedom (larger n), the t-distribution looks more like the normal."</span>)</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   For n &gt; 30, they're nearly identical."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="ch04_Statistical_Inference_for_the_Mean_files/figure-html/cell-4-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
📊 Key Observation:
   With more degrees of freedom (larger n), the t-distribution looks more like the normal.
   For n &gt; 30, they're nearly identical.</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p><strong>Key Concept 4.2: The t-Distribution</strong></p>
<p>The t-distribution is used when the population standard deviation <span class="math inline">\(\sigma\)</span> is unknown and must be estimated from the sample. It is similar to the standard normal N(0,1) but with fatter tails that reflect the additional uncertainty from estimating <span class="math inline">\(\sigma\)</span>. As the sample size <span class="math inline">\(n\)</span> grows, the t-distribution approaches the normal distribution, making the normal a good approximation for large samples.</p>
</blockquote>
</section>
<section id="confidence-intervals" class="level2">
<h2 class="anchored" data-anchor-id="confidence-intervals">4.3 Confidence Intervals</h2>
<p>A <strong>confidence interval</strong> provides a range of plausible values for the population parameter μ.</p>
<p><strong>General formula:</strong> <span class="math display">\[\text{estimate} \pm \text{critical value} \times \text{standard error}\]</span></p>
<p>For the population mean, a <strong>100(1 - α)% confidence interval</strong> is: <span class="math display">\[\bar{x} \pm t_{n-1, \alpha/2} \times \text{se}(\bar{x})\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\bar{x}\)</span> = sample mean (our estimate)</li>
<li><span class="math inline">\(t_{n-1, \alpha/2}\)</span> = critical value from t-distribution with (n-1) degrees of freedom</li>
<li>se(<span class="math inline">\(\bar{x}\)</span>) = s/√n = standard error</li>
<li>α = significance level (e.g., 0.05 for 95% confidence)</li>
</ul>
<p><strong>Interpretation:</strong> If we repeatedly drew samples and constructed 95% CIs, about 95% of those intervals would contain the true population mean μ.</p>
<p><strong>Practical interpretation:</strong> We are “95% confident” that μ lies within this interval.</p>
<p><strong>Rule of thumb:</strong> For n &gt; 30, <span class="math inline">\(t_{n-1, 0.025} \approx 2\)</span>, so a 95% CI is approximately: <span class="math display">\[\bar{x} \pm 2 \times \text{se}(\bar{x})\]</span></p>
<blockquote class="blockquote">
<p><strong>Key Concept 4.3: Confidence Intervals</strong></p>
<p>A confidence interval provides a range of plausible values for the population parameter <span class="math inline">\(\mu\)</span>. A 95% confidence interval means: if we repeated the sampling procedure many times, approximately 95% of the resulting intervals would contain the true <span class="math inline">\(\mu\)</span>. The interval is constructed as <span class="math inline">\(\bar{x} \pm t_{\alpha/2} \times se(\bar{x})\)</span>, where wider intervals indicate less precision.</p>
</blockquote>
<div id="cell-13" class="cell" data-execution_count="4">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate 95% confidence interval for mean earnings</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>conf_level <span class="op">=</span> <span class="fl">0.95</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> conf_level</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>t_crit <span class="op">=</span> stats.t.ppf(<span class="dv">1</span> <span class="op">-</span> alpha<span class="op">/</span><span class="dv">2</span>, n <span class="op">-</span> <span class="dv">1</span>)  <span class="co"># Critical value</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>margin_of_error <span class="op">=</span> t_crit <span class="op">*</span> se_earnings</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>ci_lower <span class="op">=</span> mean_earnings <span class="op">-</span> margin_of_error</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>ci_upper <span class="op">=</span> mean_earnings <span class="op">+</span> margin_of_error</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"95% CONFIDENCE INTERVAL FOR POPULATION MEAN EARNINGS"</span>)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sample mean:            $</span><span class="sc">{</span>mean_earnings<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Standard error:         $</span><span class="sc">{</span>se_earnings<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Critical value t₁₇₀:     </span><span class="sc">{</span>t_crit<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Margin of error:        $</span><span class="sc">{</span>margin_of_error<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">95% Confidence Interval: [$</span><span class="sc">{</span>ci_lower<span class="sc">:,.2f}</span><span class="ss">, $</span><span class="sc">{</span>ci_upper<span class="sc">:,.2f}</span><span class="ss">]"</span>)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Interpretation: We are 95% confident that the true population mean"</span>)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"earnings lies between $</span><span class="sc">{</span>ci_lower<span class="sc">:,.2f}</span><span class="ss"> and $</span><span class="sc">{</span>ci_upper<span class="sc">:,.2f}</span><span class="ss">."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
95% CONFIDENCE INTERVAL FOR POPULATION MEAN EARNINGS
======================================================================
Sample mean:            $41,412.69
Standard error:         $1,952.10
Critical value t₁₇₀:     1.9740
Margin of error:        $3,853.48

95% Confidence Interval: [$37,559.21, $45,266.17]

Interpretation: We are 95% confident that the true population mean
earnings lies between $37,559.21 and $45,266.17.</code></pre>
</div>
</div>
<p><strong>95% Confidence Interval for Mean Earnings: [$37,559.21, $45,266.17]</strong></p>
<p><strong>What this interval means:</strong></p>
<p>The correct interpretation: If we repeatedly drew samples of 171 women and calculated 95% CIs for each sample, approximately 95% of those intervals would contain the true population mean μ.</p>
<p><strong>Common misconceptions (WRONG interpretations):</strong> - “There is a 95% probability that μ is in this interval” - “95% of individual women earn between $37,559 and $45,266” - “The interval captures 95% of the data”</p>
<p><strong>Correct interpretation:</strong> - We are 95% confident that the true population mean earnings lie between $37,559 and $45,266 - The interval accounts for sampling uncertainty through the standard error - The population mean μ is fixed (but unknown); our interval is random</p>
<p><strong>Breaking down the calculation:</strong> - Sample mean: $41,412.69 - Critical value (t₁₇₀, 0.025): 1.9740 - Margin of error: 1.9740 × $1,952.10 = $3,853.48 - Interval: $41,412.69 ± $3,853.48</p>
<p><strong>Practical insights:</strong> - The interval does NOT include $36,000 or $46,000, suggesting these are implausible values for μ - The interval is fairly narrow (width = $7,707), indicating good precision - The critical value (1.974) is close to 2, confirming the “rule of thumb”: CI ≈ mean ± 2×SE</p>
<p><strong>Why use 95% confidence?</strong> - Convention in most scientific fields (α = 0.05) - Balances precision (narrow interval) with confidence (high probability of capturing μ) - Could use 90% (narrower, less confident) or 99% (wider, more confident)</p>
<p><strong>Transition:</strong> Now that we understand how the t-distribution differs from the normal distribution, we can use it to construct confidence intervals that account for the uncertainty in estimating σ from our sample.</p>
<section id="confidence-precision-trade-off" class="level3">
<h3 class="anchored" data-anchor-id="confidence-precision-trade-off">Confidence-Precision Trade-off</h3>
<p><strong>Comparing Confidence Intervals at Different Levels:</strong></p>
<ul>
<li>90% CI: [$38,184.17, $44,641.21] — Width: $6,457.03</li>
<li>95% CI: [$37,559.21, $45,266.17] — Width: $7,706.97</li>
<li>99% CI: [$36,327.35, $46,498.03] — Width: $10,170.68</li>
</ul>
<p><strong>The fundamental trade-off:</strong></p>
<p>Higher confidence requires wider intervals. You cannot have both maximum precision (narrow interval) AND maximum confidence (high probability of capturing μ) simultaneously.</p>
<p><strong>Why does this happen?</strong></p>
<ul>
<li>To be more confident we’ve captured μ, we must cast a wider net</li>
<li>The critical value increases with confidence level:
<ul>
<li>90% CI: t-critical ≈ 1.66 → smaller multiplier</li>
<li>95% CI: t-critical ≈ 1.97 → moderate multiplier<br>
</li>
<li>99% CI: t-critical ≈ 2.61 → larger multiplier</li>
</ul></li>
</ul>
<p><strong>Practical implications:</strong></p>
<ol type="1">
<li><strong>90% CI ($6,457 width):</strong>
<ul>
<li>Narrower, more precise</li>
<li>BUT: 10% chance the interval misses μ</li>
<li>Use when: precision is critical and you can tolerate more risk</li>
</ul></li>
<li><strong>95% CI ($7,707 width):</strong>
<ul>
<li>Standard choice in economics and most sciences</li>
<li>Good balance between precision and confidence</li>
<li>Use when: following standard practice (almost always)</li>
</ul></li>
<li><strong>99% CI ($10,171 width):</strong>
<ul>
<li>Wider, less precise</li>
<li>BUT: Only 1% chance the interval misses μ</li>
<li>Use when: being wrong is very costly (medical, safety applications)</li>
</ul></li>
</ol>
<p><strong>How to improve BOTH confidence AND precision?</strong></p>
<ul>
<li>Increase sample size (n)! Larger n → smaller SE → narrower intervals at any confidence level</li>
<li>With n = 684 (4× larger), the 95% CI would be approximately half as wide</li>
</ul>
<p><strong>Trade-off:</strong> Higher confidence → wider intervals</p>
<ul>
<li>90% CI: Narrower, but less confident</li>
<li>95% CI: Standard choice (most common)</li>
<li>99% CI: Wider, but more confident</li>
</ul>
<p>Let’s compare:</p>
<div id="cell-18" class="cell" data-execution_count="5">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare confidence intervals at different levels</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>conf_levels <span class="op">=</span> [<span class="fl">0.90</span>, <span class="fl">0.95</span>, <span class="fl">0.99</span>]</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"CONFIDENCE INTERVALS AT DIFFERENT LEVELS"</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'Level'</span><span class="sc">:&lt;10}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'Lower Bound'</span><span class="sc">:&gt;15}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'Upper Bound'</span><span class="sc">:&gt;15}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'Width'</span><span class="sc">:&gt;15}</span><span class="ss">"</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> conf <span class="kw">in</span> conf_levels:</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    alpha <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> conf</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    t_crit <span class="op">=</span> stats.t.ppf(<span class="dv">1</span> <span class="op">-</span> alpha<span class="op">/</span><span class="dv">2</span>, n <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    ci_lower <span class="op">=</span> mean_earnings <span class="op">-</span> t_crit <span class="op">*</span> se_earnings</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    ci_upper <span class="op">=</span> mean_earnings <span class="op">+</span> t_crit <span class="op">*</span> se_earnings</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    width <span class="op">=</span> ci_upper <span class="op">-</span> ci_lower</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>conf<span class="op">*</span><span class="dv">100</span><span class="sc">:.0f}</span><span class="ss">%</span><span class="sc">{</span>ci_lower<span class="sc">:&gt;18,.2f}{</span>ci_upper<span class="sc">:&gt;18,.2f}{</span>width<span class="sc">:&gt;18,.2f}</span><span class="ss">"</span>)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">📊 Notice: Higher confidence → wider interval → less precision"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
CONFIDENCE INTERVALS AT DIFFERENT LEVELS
======================================================================
Level          Lower Bound     Upper Bound           Width
----------------------------------------------------------------------
90%         38,184.17         44,641.21          6,457.03
95%         37,559.21         45,266.17          7,706.97
99%         36,327.35         46,498.03         10,170.68

📊 Notice: Higher confidence → wider interval → less precision</code></pre>
</div>
</div>
<p><em>Now that we understand confidence intervals, let’s formalize the process of testing specific hypotheses about the population mean.</em></p>
</section>
</section>
<section id="two-sided-hypothesis-tests" class="level2">
<h2 class="anchored" data-anchor-id="two-sided-hypothesis-tests">4.4 Two-Sided Hypothesis Tests</h2>
<p>A <strong>hypothesis test</strong> evaluates whether a specific claim about μ is plausible given our sample data.</p>
<p><strong>Structure of a hypothesis test:</strong></p>
<ul>
<li><strong>Null hypothesis</strong> H₀: The claim we’re testing (e.g., μ = $40,000)</li>
<li><strong>Alternative hypothesis</strong> Hₐ: What we conclude if we reject H₀ (e.g., μ ≠ $40,000)</li>
<li><strong>Significance level</strong> α: Maximum probability of Type I error we’ll tolerate (typically 0.05)</li>
</ul>
<p><strong>Test statistic:</strong> <span class="math display">\[t = \frac{\bar{x} - \mu_0}{\text{se}(\bar{x})}\]</span></p>
<p>Where μ₀ is the hypothesized value.</p>
<p><strong>Two ways to make a decision:</strong></p>
<ol type="1">
<li><strong>p-value approach:</strong>
<ul>
<li>p-value = probability of observing a t-statistic at least as extreme as ours, assuming H₀ is true</li>
<li>Reject H₀ if p-value &lt; α</li>
</ul></li>
<li><strong>Critical value approach:</strong>
<ul>
<li>Critical value c = <span class="math inline">\(t_{n-1, \alpha/2}\)</span></li>
<li>Reject H₀ if |t| &gt; c</li>
</ul></li>
</ol>
<p>Both methods always give the same conclusion.</p>
<p><strong>Example:</strong> Test whether population mean earnings equal $40,000.</p>
<blockquote class="blockquote">
<p><strong>Key Concept 4.4: Hypothesis Testing Framework</strong></p>
<p>A hypothesis test evaluates whether data provide sufficient evidence to reject a specific claim (H₀) about a parameter. The t-statistic measures how many standard errors the estimate is from the hypothesized value. The p-value is the probability of observing a result at least as extreme as ours, assuming H₀ is true. Small p-values (&lt; α, typically 0.05) provide evidence against H₀, leading us to reject it.</p>
</blockquote>
<div id="cell-22" class="cell" data-execution_count="6">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Two-sided hypothesis test: H0: μ = $40,000 vs Ha: μ ≠ $40,000</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>mu0 <span class="op">=</span> <span class="dv">40000</span>  <span class="co"># Hypothesized value</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>t_stat <span class="op">=</span> (mean_earnings <span class="op">-</span> mu0) <span class="op">/</span> se_earnings</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>p_value <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> stats.t.cdf(<span class="bu">abs</span>(t_stat), n <span class="op">-</span> <span class="dv">1</span>))  <span class="co"># Two-sided p-value</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>t_crit_95 <span class="op">=</span> stats.t.ppf(<span class="fl">0.975</span>, n <span class="op">-</span> <span class="dv">1</span>)  <span class="co"># Critical value for α = 0.05</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"TWO-SIDED HYPOTHESIS TEST"</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"H₀: μ = $</span><span class="sc">{</span>mu0<span class="sc">:,}</span><span class="ss">"</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Hₐ: μ ≠ $</span><span class="sc">{</span>mu0<span class="sc">:,}</span><span class="ss">"</span>)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Significance level α = 0.05"</span>)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Sample Statistics:"</span>)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Sample mean:      $</span><span class="sc">{</span>mean_earnings<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Standard error:   $</span><span class="sc">{</span>se_earnings<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Test Results:"</span>)</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  t-statistic:       </span><span class="sc">{</span>t_stat<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  p-value:           </span><span class="sc">{</span>p_value<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Critical value:    ±</span><span class="sc">{</span>t_crit_95<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Decision:"</span>)</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  p-value approach:  </span><span class="sc">{</span>p_value<span class="sc">:.4f}</span><span class="ss"> &gt; 0.05 → Do not reject H₀"</span>)</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Critical approach: |</span><span class="sc">{</span>t_stat<span class="sc">:.4f}</span><span class="ss">| &lt; </span><span class="sc">{</span>t_crit_95<span class="sc">:.4f}</span><span class="ss"> → Do not reject H₀"</span>)</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Conclusion: We do not have sufficient evidence to reject the claim"</span>)</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"that population mean earnings equal $</span><span class="sc">{</span>mu0<span class="sc">:,}</span><span class="ss">."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
TWO-SIDED HYPOTHESIS TEST
======================================================================
H₀: μ = $40,000
Hₐ: μ ≠ $40,000
Significance level α = 0.05

Sample Statistics:
  Sample mean:      $41,412.69
  Standard error:   $1,952.10

Test Results:
  t-statistic:       0.7237
  p-value:           0.4703
  Critical value:    ±1.9740

Decision:
  p-value approach:  0.4703 &gt; 0.05 → Do not reject H₀
  Critical approach: |0.7237| &lt; 1.9740 → Do not reject H₀

Conclusion: We do not have sufficient evidence to reject the claim
that population mean earnings equal $40,000.</code></pre>
</div>
</div>
<p><strong>Test Results: H₀: μ = $40,000 vs Hₐ: μ ≠ $40,000</strong></p>
<ul>
<li>t-statistic: 0.7237</li>
<li>p-value: 0.4703</li>
<li>Critical value: ±1.9740</li>
<li>Decision: Do NOT reject H₀</li>
</ul>
<p><strong>What does this mean?</strong></p>
<p>We tested whether the population mean earnings equal $40,000. Based on our sample data (mean = $41,413), we do NOT have sufficient evidence to reject this claim.</p>
<p><strong>Understanding the p-value (0.4703):</strong></p>
<p>The p-value answers: “If the true population mean really is $40,000, what’s the probability of observing a sample mean at least as far from $40,000 as ours ($41,413)?”</p>
<ul>
<li>p-value = 0.4703 = 47.03%</li>
<li>This is quite HIGH → the data are consistent with H₀</li>
<li>Interpretation: If μ truly equals $40,000, we’d see a sample mean this extreme about 47% of the time just due to random sampling</li>
</ul>
<p><strong>Two equivalent decision rules:</strong></p>
<ol type="1">
<li><strong>p-value approach:</strong>
<ul>
<li>p-value (0.4703) &gt; α (0.05) → Do not reject H₀</li>
<li>The evidence against H₀ is weak</li>
</ul></li>
<li><strong>Critical value approach:</strong>
<ul>
<li>|t-statistic| = |0.7237| &lt; 1.9740 → Do not reject H₀</li>
<li>Our t-statistic falls in the “non-rejection region”</li>
</ul></li>
</ol>
<p><strong>Why did we fail to reject?</strong></p>
<ul>
<li>Our sample mean ($41,413) is only $1,413 above the hypothesized value ($40,000)</li>
<li>Given the standard error ($1,952), this difference is less than 1 SE away</li>
<li>This is well within the range of normal sampling variation</li>
<li>The difference is NOT statistically significant at α = 0.05</li>
</ul>
<p><strong>Does this prove μ = $40,000?</strong></p>
<p>NO! We never “prove” or “accept” the null hypothesis. We simply say:</p>
<ul>
<li>The data are consistent with μ = $40,000</li>
<li>We lack sufficient evidence to conclude otherwise</li>
<li>Other values (e.g., $41,000, $42,000) are also consistent with our data</li>
</ul>
<p><strong>Connection to confidence interval:</strong></p>
<p>Notice that $40,000 IS inside our 95% CI [$37,559, $45,266]. This is no coincidence:</p>
<ul>
<li>Any value inside the 95% CI will NOT be rejected at α = 0.05 (two-sided test)</li>
<li>Any value outside the 95% CI WILL be rejected at α = 0.05</li>
</ul>
<section id="visualizing-the-two-sided-hypothesis-test" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-the-two-sided-hypothesis-test">Visualizing the two-sided hypothesis test</h3>
<div id="cell-25" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize two-sided hypothesis test</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">500</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> stats.t.pdf(x, n <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the t-distribution</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>ax.plot(x, y, <span class="st">'b-'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="ss">f't(</span><span class="sc">{</span>n<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">) distribution'</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Mark the observed t-statistic</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>ax.axvline(x<span class="op">=</span>t_stat, color<span class="op">=</span><span class="st">'red'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, linestyle<span class="op">=</span><span class="st">'--'</span>,</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>           label<span class="op">=</span><span class="ss">f'Observed t = </span><span class="sc">{</span>t_stat<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Mark critical values</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>ax.axvline(x<span class="op">=</span>t_crit_95, color<span class="op">=</span><span class="st">'green'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>, linestyle<span class="op">=</span><span class="st">':'</span>,</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>           label<span class="op">=</span><span class="ss">f'Critical values = ±</span><span class="sc">{</span>t_crit_95<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>ax.axvline(x<span class="op">=-</span>t_crit_95, color<span class="op">=</span><span class="st">'green'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>, linestyle<span class="op">=</span><span class="st">':'</span>)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Shade rejection regions (both tails)</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>x_reject_lower <span class="op">=</span> x[x <span class="op">&lt;</span> <span class="op">-</span>t_crit_95]</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>x_reject_upper <span class="op">=</span> x[x <span class="op">&gt;</span> t_crit_95]</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>ax.fill_between(x_reject_lower, <span class="dv">0</span>, stats.t.pdf(x_reject_lower, n<span class="op">-</span><span class="dv">1</span>),</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>                alpha<span class="op">=</span><span class="fl">0.3</span>, color<span class="op">=</span><span class="st">'red'</span>, label<span class="op">=</span><span class="st">'Rejection region (α/2 = 0.025 each tail)'</span>)</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>ax.fill_between(x_reject_upper, <span class="dv">0</span>, stats.t.pdf(x_reject_upper, n<span class="op">-</span><span class="dv">1</span>),</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>                alpha<span class="op">=</span><span class="fl">0.3</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'t-statistic'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Density'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Two-Sided Hypothesis Test Visualization'</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>ax.legend(fontsize<span class="op">=</span><span class="dv">9</span>, loc<span class="op">=</span><span class="st">'upper right'</span>)</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">📊 Interpretation:"</span>)</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   Our t-statistic (</span><span class="sc">{</span>t_stat<span class="sc">:.2f}</span><span class="ss">) falls INSIDE the critical region,"</span>)</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   so we do NOT reject H₀. The data are consistent with μ = $</span><span class="sc">{</span>mu0<span class="sc">:,}</span><span class="ss">."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="type-i-error-type-ii-error-and-statistical-power" class="level3">
<h3 class="anchored" data-anchor-id="type-i-error-type-ii-error-and-statistical-power">Type I Error, Type II Error, and Statistical Power</h3>
<p><strong>The Four Possible Outcomes of a Hypothesis Test:</strong></p>
<p>When we conduct a hypothesis test, there are four possible scenarios:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 30%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>H₀ is TRUE</strong> (in reality)</th>
<th><strong>H₀ is FALSE</strong> (in reality)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Reject H₀</strong> (decision)</td>
<td>Type I Error (α)</td>
<td>Correct Decision (Power)</td>
</tr>
<tr class="even">
<td><strong>Do not reject H₀</strong></td>
<td>Correct Decision (1-α)</td>
<td>Type II Error (β)</td>
</tr>
</tbody>
</table>
<p><strong>Type I Error (False Positive):</strong> - Definition: Rejecting H₀ when it’s actually true - Probability: α (significance level) - In our earnings example: Concluding μ ≠ $40,000 when it actually equals $40,000 - We control this: By setting α = 0.05, we accept a 5% chance of Type I error - Consequence: “Crying wolf” — claiming an effect that doesn’t exist</p>
<p><strong>Type II Error (False Negative):</strong> - Definition: Failing to reject H₀ when it’s actually false - Probability: β (depends on sample size, effect size, and α) - In our earnings example: Concluding μ = $40,000 when it actually differs - Harder to control directly - Consequence: Missing a real effect</p>
<p><strong>Statistical Power:</strong> - Definition: Power = 1 - β = Probability of correctly rejecting false H₀ - Interpretation: Probability of detecting a real effect when it exists - Typical target: 80% power (β = 0.20) - Higher power → lower chance of Type II error</p>
<p><strong>The Trade-off Between Type I and Type II Errors:</strong></p>
<p>You cannot minimize both simultaneously: - <strong>Decrease α</strong> (e.g., from 0.05 to 0.01): - Lower chance of Type I error (false positive) - Higher chance of Type II error (false negative) - Lower statistical power</p>
<ul>
<li><strong>Increase α</strong> (e.g., from 0.05 to 0.10):</li>
<li>Higher statistical power</li>
<li>Lower chance of Type II error</li>
<li>Higher chance of Type I error</li>
</ul>
<p><strong>How to improve power WITHOUT increasing Type I error:</strong></p>
<ol type="1">
<li><strong>Increase sample size:</strong></li>
</ol>
<ul>
<li>Larger n → smaller SE → easier to detect real effects</li>
<li>Our earnings data: n = 171, SE = $1,952</li>
<li>If n = 684 (4× larger): SE = $976 (half as large)</li>
<li>Same effect size would yield t-statistic twice as large</li>
</ul>
<ol start="2" type="1">
<li><strong>Study larger effects:</strong></li>
</ol>
<ul>
<li>Easier to detect large differences than small ones</li>
<li>Testing μ = $30,000 vs μ = $41,413 would have higher power</li>
<li>Testing μ = $40,000 vs μ = $41,413 has lower power</li>
</ul>
<ol start="3" type="1">
<li><strong>Use one-sided tests (when appropriate):</strong></li>
</ol>
<ul>
<li>Concentrates α in one tail → higher power in that direction</li>
<li>But: Cannot detect effects in the opposite direction</li>
</ul>
<p><strong>In our examples:</strong></p>
<ol type="1">
<li><strong>Earnings test (non-significant):</strong></li>
</ol>
<ul>
<li>Could be: μ truly equals $40,000 (correct decision)</li>
<li>Or could be: Type II error (μ differs but we didn’t detect it)</li>
<li>With more data, we might detect the difference</li>
</ul>
<ol start="2" type="1">
<li><strong>Gas price test (significant):</strong></li>
</ol>
<ul>
<li>High power due to small SE ($0.0267) and reasonable sample size (n=32)</li>
<li>Successfully detected a real difference</li>
<li>Low probability this is a Type I error (p &lt; 0.0001)</li>
</ul>
<p><strong>Practical advice:</strong></p>
<ul>
<li><strong>Planning stage:</strong> Calculate required sample size for desired power</li>
<li><strong>Design stage:</strong> Set α based on consequences of Type I vs Type II errors</li>
<li>Medical trials: Type I error very costly → use α = 0.01</li>
<li>Exploratory research: Type II error costly → use α = 0.10</li>
<li><strong>Interpretation stage:</strong> Non-significant results don’t prove H₀ is true (could be Type II error)</li>
</ul>
</section>
</section>
<section id="hypothesis-test-examples" class="level2">
<h2 class="anchored" data-anchor-id="hypothesis-test-examples">4.5 Hypothesis Test Examples</h2>
<p>Let’s apply hypothesis testing to three real-world economic questions.</p>
<section id="example-1-gasoline-prices" class="level3">
<h3 class="anchored" data-anchor-id="example-1-gasoline-prices">Example 1: Gasoline Prices</h3>
<p><strong>Question:</strong> Are gasoline prices in Yolo County different from the California state average?</p>
<ul>
<li>California average: $3.81/gallon</li>
<li>Sample: 32 gas stations in Yolo County</li>
<li>Test: H₀: μ = 3.81 vs Hₐ: μ ≠ 3.81</li>
</ul>
<div id="cell-29" class="cell" data-execution_count="8">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load and test gasoline price data</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>data_gasprice <span class="op">=</span> pd.read_stata(GITHUB_DATA_URL <span class="op">+</span> <span class="st">'AED_GASPRICE.DTA'</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>price <span class="op">=</span> data_gasprice[<span class="st">'price'</span>]</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>mean_price <span class="op">=</span> price.mean()</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>std_price <span class="op">=</span> price.std(ddof<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>n_price <span class="op">=</span> <span class="bu">len</span>(price)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>se_price <span class="op">=</span> std_price <span class="op">/</span> np.sqrt(n_price)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>mu0_price <span class="op">=</span> <span class="fl">3.81</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>t_stat_price <span class="op">=</span> (mean_price <span class="op">-</span> mu0_price) <span class="op">/</span> se_price</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>p_value_price <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> stats.t.cdf(<span class="bu">abs</span>(t_stat_price), n_price <span class="op">-</span> <span class="dv">1</span>))</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"EXAMPLE 1: GASOLINE PRICES"</span>)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"H₀: μ = $</span><span class="sc">{</span>mu0_price<span class="sc">:.2f}</span><span class="ss"> (CA state average)"</span>)</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Hₐ: μ ≠ $</span><span class="sc">{</span>mu0_price<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Sample size:       </span><span class="sc">{</span>n_price<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sample mean:      $</span><span class="sc">{</span>mean_price<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Std error:        $</span><span class="sc">{</span>se_price<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"t-statistic:       </span><span class="sc">{</span>t_stat_price<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"p-value:           </span><span class="sc">{</span>p_value_price<span class="sc">:.6f}</span><span class="ss">"</span>)</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Decision: p-value &lt; 0.05 → </span><span class="sc">{</span><span class="st">'REJECT H₀'</span> <span class="cf">if</span> p_value_price <span class="op">&lt;</span> <span class="fl">0.05</span> <span class="cf">else</span> <span class="st">'Do not reject H₀'</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Conclusion: Yolo County gas prices ARE </span><span class="sc">{</span><span class="st">'significantly '</span> <span class="cf">if</span> p_value_price <span class="op">&lt;</span> <span class="fl">0.05</span> <span class="cf">else</span> <span class="st">'NOT significantly '</span><span class="sc">}</span><span class="ss">different from CA average."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
EXAMPLE 1: GASOLINE PRICES
======================================================================
H₀: μ = $3.81 (CA state average)
Hₐ: μ ≠ $3.81

Sample size:       32
Sample mean:      $3.6697
Std error:        $0.0267
t-statistic:       -5.2577
p-value:           0.000010

Decision: p-value &lt; 0.05 → REJECT H₀

Conclusion: Yolo County gas prices ARE significantly different from CA average.</code></pre>
</div>
</div>
<p><strong>Test Results: H₀: μ = $3.81 vs Hₐ: μ ≠ $3.81</strong></p>
<ul>
<li>Sample mean: $3.6697</li>
<li>t-statistic: -5.2577</li>
<li>p-value: 0.0000 (actually &lt; 0.0001)</li>
<li>Decision: REJECT H₀ at α = 0.05</li>
</ul>
<p><strong>This is a STATISTICALLY SIGNIFICANT result!</strong></p>
<p>Unlike our earnings example, here we have strong evidence that Yolo County gas prices differ from the California state average of $3.81.</p>
<p><strong>Understanding the strong evidence:</strong></p>
<ol type="1">
<li><strong>Large t-statistic (-5.26):</strong>
<ul>
<li>The sample mean ($3.67) is 5.26 standard errors below the hypothesized value ($3.81)</li>
<li>This is far beyond the critical value (±2.04)</li>
<li>Such extreme values rarely occur by chance alone</li>
</ul></li>
<li><strong>Tiny p-value (&lt; 0.0001):</strong>
<ul>
<li>If μ truly equaled $3.81, the probability of observing a sample mean this extreme is less than 0.01%</li>
<li>This is MUCH smaller than α = 0.05 (5%)</li>
<li>Strong evidence against H₀</li>
</ul></li>
<li><strong>Direction matters:</strong>
<ul>
<li>The negative t-statistic tells us Yolo County prices are LOWER than the state average</li>
<li>Difference: $3.81 - $3.67 = $0.14 per gallon cheaper</li>
</ul></li>
</ol>
<p><strong>Statistical vs Practical Significance:</strong></p>
<ul>
<li><strong>Statistical significance:</strong> Yes, we can confidently say Yolo County prices differ from $3.81 (p &lt; 0.0001)</li>
<li><strong>Practical significance:</strong> Is 14 cents per gallon meaningful?
<ul>
<li>For a 15-gallon tank: $2.10 savings</li>
<li>Over a year (52 fill-ups): $109 savings</li>
<li>This IS economically meaningful for consumers!</li>
</ul></li>
</ul>
<p><strong>Why is this result so strong compared to the earnings test?</strong></p>
<ul>
<li>The standard error is very small ($0.0267) relative to the difference we’re testing</li>
<li>This gives us high <strong>statistical power</strong> to detect the difference</li>
<li>Even though the dollar difference is small ($0.14), it’s precisely estimated</li>
</ul>
<p><strong>Type I vs Type II Errors in this context:</strong></p>
<ul>
<li><strong>Type I Error:</strong> Concluding Yolo County prices differ when they actually don’t
<ul>
<li>Probability = α = 0.05 (5% chance if we reject)</li>
<li>But our p-value is &lt; 0.0001, so we’re very confident we’re not making this error</li>
</ul></li>
<li><strong>Type II Error:</strong> Concluding prices don’t differ when they actually do
<ul>
<li>Not relevant here since we rejected H₀</li>
<li>This test had high power to detect real differences</li>
</ul></li>
</ul>
<blockquote class="blockquote">
<p><strong>Key Concept 4.5: Statistical Significance vs.&nbsp;Sample Size</strong></p>
<p>Even small practical differences can be statistically significant with large samples (n=53 gas stations). The gasoline price difference of $0.14 might seem trivial, but: - The <strong>standard error is small</strong> ($0.0267), giving precise estimates - The <strong>t-statistic is large</strong> (-5.26), indicating the difference is many standard errors from zero - This demonstrates <strong>high statistical power</strong>—the ability to detect even small real effects</p>
<p>Statistical significance answers “Is there a difference?” while practical significance asks “Does the difference matter?” Both questions are important in econometrics.</p>
</blockquote>
</section>
<section id="example-2-male-earnings" class="level3">
<h3 class="anchored" data-anchor-id="example-2-male-earnings">Example 2: Male Earnings</h3>
<p><strong>Question:</strong> Do 30-year-old men earn more than $50,000 on average?</p>
<ul>
<li>Claim: μ &gt; $50,000 (set as alternative hypothesis)</li>
<li>Sample: 191 men</li>
<li>Test: H₀: μ ≤ 50,000 vs Hₐ: μ &gt; 50,000 (one-sided, covered in section 4.6)</li>
</ul>
<div id="cell-33" class="cell" data-execution_count="9">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load and test male earnings data</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>data_male <span class="op">=</span> pd.read_stata(GITHUB_DATA_URL <span class="op">+</span> <span class="st">'AED_EARNINGSMALE.DTA'</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>earnings_male <span class="op">=</span> data_male[<span class="st">'earnings'</span>]</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>mean_male <span class="op">=</span> earnings_male.mean()</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>std_male <span class="op">=</span> earnings_male.std(ddof<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>n_male <span class="op">=</span> <span class="bu">len</span>(earnings_male)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>se_male <span class="op">=</span> std_male <span class="op">/</span> np.sqrt(n_male)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>mu0_male <span class="op">=</span> <span class="dv">50000</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>t_stat_male <span class="op">=</span> (mean_male <span class="op">-</span> mu0_male) <span class="op">/</span> se_male</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>p_value_male <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> stats.t.cdf(<span class="bu">abs</span>(t_stat_male), n_male <span class="op">-</span> <span class="dv">1</span>))  <span class="co"># Two-sided for now</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"EXAMPLE 2: MALE EARNINGS (Two-sided test shown)"</span>)</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"H₀: μ = $</span><span class="sc">{</span>mu0_male<span class="sc">:,}</span><span class="ss">"</span>)</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Hₐ: μ ≠ $</span><span class="sc">{</span>mu0_male<span class="sc">:,}</span><span class="ss">"</span>)</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Sample size:       </span><span class="sc">{</span>n_male<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sample mean:      $</span><span class="sc">{</span>mean_male<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Std error:        $</span><span class="sc">{</span>se_male<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"t-statistic:       </span><span class="sc">{</span>t_stat_male<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"p-value:           </span><span class="sc">{</span>p_value_male<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Decision: p-value &gt; 0.05 → Do not reject H₀"</span>)</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Note: A one-sided test is more appropriate here (see section 4.6)"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
EXAMPLE 2: MALE EARNINGS (Two-sided test shown)
======================================================================
H₀: μ = $50,000
Hₐ: μ ≠ $50,000

Sample size:       191
Sample mean:      $52,353.93
Std error:        $4,705.75
t-statistic:       0.5002
p-value:           0.6175

Decision: p-value &gt; 0.05 → Do not reject H₀

Note: A one-sided test is more appropriate here (see section 4.6)</code></pre>
</div>
</div>
<p><strong>Test Results: H₀: μ = $50,000 vs Hₐ: μ ≠ $50,000</strong> - Sample mean: (actual value from code output) - t-statistic: (actual value from code output) - p-value: &gt; 0.05 (not statistically significant) - Decision: DO NOT REJECT H₀ at α = 0.05</p>
<p><strong>This is NOT a statistically significant result.</strong></p>
<p>We do not have sufficient evidence to conclude that 30-year-old men earn differently than $50,000 on average. This does NOT mean they earn exactly $50,000—it means our data are consistent with that value.</p>
<p><strong>Understanding the lack of significance:</strong></p>
<ol type="1">
<li><strong>Moderate t-statistic:</strong>
<ul>
<li>The sample mean is not far enough from $50,000 (in standard error units) to confidently reject H₀</li>
<li>The observed difference could plausibly arise from random sampling variation alone</li>
</ul></li>
<li><strong>Large p-value (&gt; 0.05):</strong>
<ul>
<li>If μ truly equaled $50,000, observing a sample mean like ours is quite probable</li>
<li>We don’t have strong evidence against H₀</li>
<li>p &gt; α, so we fail to reject</li>
</ul></li>
<li><strong>What “fail to reject” means:</strong>
<ul>
<li>We’re NOT proving μ = $50,000</li>
<li>We’re saying the data don’t provide convincing evidence that μ ≠ $50,000</li>
<li>Absence of evidence is not evidence of absence</li>
</ul></li>
</ol>
<p><strong>Statistical vs Practical Significance:</strong></p>
<ul>
<li><strong>Statistical significance:</strong> No, we cannot confidently say mean earnings differ from $50,000 (p &gt; 0.05)</li>
<li><strong>Practical considerations:</strong>
<ul>
<li>The sample mean might be close to $50,000 anyway</li>
<li>Or the sample size (n=191) might not provide enough precision to detect a modest difference</li>
<li>Or there’s genuine variability in the population making the effect hard to pin down</li>
</ul></li>
</ul>
<p><strong>Why might we fail to reject H₀?</strong></p>
<p>Three possible explanations:</p>
<ol type="1">
<li><strong>H₀ is actually true:</strong> Mean earnings truly are around $50,000</li>
<li><strong>Insufficient power:</strong> Real difference exists, but our sample size is too small to detect it</li>
<li><strong>High variability:</strong> Earnings have large standard deviation, making precise inference difficult</li>
</ol>
<p><strong>Note on directional hypothesis:</strong></p>
<p>The question asks “Do men earn MORE than $50,000?” which suggests a <strong>one-sided test</strong> (H₀: μ ≤ 50,000 vs Hₐ: μ &gt; 50,000). The code note mentions this will be covered in section 4.6. One-sided tests have more power to detect effects in a specific direction.</p>
<blockquote class="blockquote">
<p><strong>Key Concept 4.6: “Fail to Reject” Does Not Mean “Accept”</strong></p>
<p>When p &gt; α, we <strong>fail to reject H₀</strong>, but this does NOT mean we “accept H₀” or prove it’s true. Three key reasons:</p>
<ol type="1">
<li><strong>Limited evidence:</strong> Our sample might simply lack the power to detect a real difference</li>
<li><strong>Type II error risk:</strong> We might be making a Type II error (failing to reject a false H₀)</li>
<li><strong>Confidence intervals are more informative:</strong> A 95% CI tells us the plausible range for μ, not just “different or not different”</li>
</ol>
<p>In econometrics, “fail to reject” means “the data are consistent with H₀, but we can’t rule out alternatives.” Always interpret non-significant results with appropriate caution.</p>
</blockquote>
</section>
<section id="example-3-gdp-growth" class="level3">
<h3 class="anchored" data-anchor-id="example-3-gdp-growth">Example 3: GDP Growth</h3>
<p><strong>Question:</strong> Did real GDP per capita grow at 2.0% per year on average from 1960-2020?</p>
<ul>
<li>Historical claim: 2.0% annual growth</li>
<li>Sample: 241 year-to-year growth rates</li>
<li>Test: H₀: μ = 2.0 vs Hₐ: μ ≠ 2.0</li>
</ul>
<div id="cell-37" class="cell" data-execution_count="10">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load and test GDP growth data</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>data_gdp <span class="op">=</span> pd.read_stata(GITHUB_DATA_URL <span class="op">+</span> <span class="st">'AED_REALGDPPC.DTA'</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>growth <span class="op">=</span> data_gdp[<span class="st">'growth'</span>]</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>mean_growth <span class="op">=</span> growth.mean()</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>std_growth <span class="op">=</span> growth.std(ddof<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>n_growth <span class="op">=</span> <span class="bu">len</span>(growth)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>se_growth <span class="op">=</span> std_growth <span class="op">/</span> np.sqrt(n_growth)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>mu0_growth <span class="op">=</span> <span class="fl">2.0</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>t_stat_growth <span class="op">=</span> (mean_growth <span class="op">-</span> mu0_growth) <span class="op">/</span> se_growth</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>p_value_growth <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> stats.t.cdf(<span class="bu">abs</span>(t_stat_growth), n_growth <span class="op">-</span> <span class="dv">1</span>))</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"EXAMPLE 3: REAL GDP PER CAPITA GROWTH"</span>)</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"H₀: μ = </span><span class="sc">{</span>mu0_growth<span class="sc">:.1f}</span><span class="ss">%"</span>)</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Hₐ: μ ≠ </span><span class="sc">{</span>mu0_growth<span class="sc">:.1f}</span><span class="ss">%"</span>)</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Sample size:       </span><span class="sc">{</span>n_growth<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sample mean:       </span><span class="sc">{</span>mean_growth<span class="sc">:.4f}</span><span class="ss">%"</span>)</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Std error:         </span><span class="sc">{</span>se_growth<span class="sc">:.4f}</span><span class="ss">%"</span>)</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"t-statistic:       </span><span class="sc">{</span>t_stat_growth<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"p-value:           </span><span class="sc">{</span>p_value_growth<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Decision: p-value &gt; 0.05 → Do not reject H₀"</span>)</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Conclusion: The data are consistent with 2.0% average annual growth."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
EXAMPLE 3: REAL GDP PER CAPITA GROWTH
======================================================================
H₀: μ = 2.0%
Hₐ: μ ≠ 2.0%

Sample size:       245
Sample mean:       1.9905%
Std error:         0.1392%
t-statistic:       -0.0686
p-value:           0.9454

Decision: p-value &gt; 0.05 → Do not reject H₀

Conclusion: The data are consistent with 2.0% average annual growth.</code></pre>
</div>
</div>
<p><strong>Test Results: H₀: μ = 2.0% vs Hₐ: μ ≠ 2.0%</strong> - Sample mean: (actual value from code output) - t-statistic: (actual value from code output) - p-value: &gt; 0.05 (not statistically significant) - Decision: DO NOT REJECT H₀ at α = 0.05</p>
<p><strong>The data are consistent with 2.0% average annual growth.</strong></p>
<p>We cannot reject the hypothesis that real GDP per capita grew at 2.0% per year on average from 1960-2020. This historical benchmark appears supported by the data.</p>
<p><strong>Understanding the result:</strong></p>
<ol type="1">
<li><strong>What does “consistent with 2.0%” mean?</strong>
<ul>
<li>The sample mean growth rate is close enough to 2.0% that random variation could explain the difference</li>
<li>We don’t have strong evidence that the true mean differs from 2.0%</li>
<li>The p-value &gt; 0.05 indicates this result is plausible under H₀</li>
</ul></li>
<li><strong>Large sample size (n=241 years):</strong>
<ul>
<li>With 241 year-to-year growth rates, we have substantial data</li>
<li>Large samples typically have smaller standard errors and more statistical power</li>
<li>Yet we still fail to reject H₀—this suggests the true mean is genuinely close to 2.0%</li>
</ul></li>
<li><strong>Economic interpretation:</strong>
<ul>
<li>The 2.0% benchmark is a common reference point in growth economics</li>
<li>Our data support this conventional wisdom</li>
<li>Long-run economic growth appears remarkably stable around this rate</li>
</ul></li>
</ol>
<p><strong>Statistical vs Practical Significance:</strong></p>
<ul>
<li><strong>Statistical significance:</strong> No, we cannot confidently say mean growth differs from 2.0% (p &gt; 0.05)</li>
<li><strong>Economic significance:</strong>
<ul>
<li>Even small deviations from 2.0% compound dramatically over 60 years</li>
<li>But our data suggest the historical average is indeed close to 2.0%</li>
<li>This consistency validates the use of 2.0% as a benchmark for policy discussions</li>
</ul></li>
</ul>
<p><strong>Why is this result interesting despite being “non-significant”?</strong></p>
<ol type="1">
<li><strong>Validates a benchmark:</strong> Economic theory often assumes ~2% long-run growth; our data support this</li>
<li><strong>Large sample confidence:</strong> With 241 observations, we can be confident the mean is near 2.0%</li>
<li><strong>Demonstrates stability:</strong> Despite recessions and booms, average growth centers around 2.0%</li>
</ol>
<p><strong>Time series considerations:</strong></p>
<p>GDP growth data are <strong>time series</strong>—observations ordered chronologically with potential autocorrelation. Our standard t-test assumes independent observations, which might not fully hold for year-to-year growth rates. Advanced time series methods (Chapter 17) address these dependencies.</p>
<blockquote class="blockquote">
<p><strong>Key Concept 4.7: Context and Consistency in Hypothesis Testing</strong></p>
<p>Statistical results gain meaning only through economic context – a statistically significant coefficient matters because of what it implies for policy, behavior, or theory. The hypothesis testing pattern (set up hypotheses, compute test statistic, compare to critical value or p-value) is consistent across diverse applications, from wage analysis to macroeconomic growth.</p>
</blockquote>
<p><em>Having mastered two-sided hypothesis tests, let’s now consider situations where we have a directional prediction.</em></p>
</section>
</section>
<section id="one-sided-directional-hypothesis-tests" class="level2">
<h2 class="anchored" data-anchor-id="one-sided-directional-hypothesis-tests">4.6 One-Sided Directional Hypothesis Tests</h2>
<p>Sometimes we want to test a <strong>directional</strong> claim:</p>
<ul>
<li>“Does μ <strong>exceed</strong> a certain value?” (upper-tailed test)</li>
<li>“Is μ <strong>less than</strong> a certain value?” (lower-tailed test)</li>
</ul>
<p><strong>Structure:</strong></p>
<ul>
<li><strong>Upper-tailed test:</strong> H₀: μ ≤ μ* vs Hₐ: μ &gt; μ*</li>
<li><strong>Lower-tailed test:</strong> H₀: μ ≥ μ* vs Hₐ: μ &lt; μ*</li>
</ul>
<p><strong>Key difference from two-sided tests:</strong></p>
<ul>
<li>Rejection region is only in <strong>one tail</strong> of the distribution</li>
<li>p-value calculation uses one tail instead of two</li>
<li>For upper-tailed: p-value = Pr[T ≥ t]</li>
<li>For lower-tailed: p-value = Pr[T ≤ t]</li>
</ul>
<p><strong>Example:</strong> Test whether mean earnings <strong>exceed</strong> $40,000.</p>
<ul>
<li>Claim to be tested: μ &gt; 40,000 (set as Hₐ)</li>
<li>Test: H₀: μ ≤ 40,000 vs Hₐ: μ &gt; 40,000</li>
</ul>
<blockquote class="blockquote">
<p><strong>Key Concept 4.8: One-Sided Tests</strong></p>
<p>One-sided tests concentrate the rejection region in ONE tail of the distribution, making them more powerful for detecting effects in the specified direction. Use when theory predicts a specific direction. The p-value for a one-sided test is exactly half the two-sided p-value (when the effect is in the predicted direction). Critical values are smaller for one-sided tests (e.g., 1.65 vs ±1.96 for α=0.05).</p>
</blockquote>
<div id="cell-43" class="cell" data-execution_count="11">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># One-sided (upper-tailed) test: H0: μ ≤ $40,000 vs Ha: μ &gt; $40,000</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>mu0 <span class="op">=</span> <span class="dv">40000</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>t_stat <span class="op">=</span> (mean_earnings <span class="op">-</span> mu0) <span class="op">/</span> se_earnings</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>p_value_upper <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> stats.t.cdf(t_stat, n <span class="op">-</span> <span class="dv">1</span>)  <span class="co"># Upper tail only</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>t_crit_upper <span class="op">=</span> stats.t.ppf(<span class="fl">0.95</span>, n <span class="op">-</span> <span class="dv">1</span>)  <span class="co"># One-sided critical value</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"ONE-SIDED HYPOTHESIS TEST (Upper-tailed)"</span>)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"H₀: μ ≤ $</span><span class="sc">{</span>mu0<span class="sc">:,}</span><span class="ss">"</span>)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Hₐ: μ &gt; $</span><span class="sc">{</span>mu0<span class="sc">:,}</span><span class="ss"> (the claim we're testing)"</span>)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Significance level α = 0.05"</span>)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Test Results:"</span>)</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  t-statistic:       </span><span class="sc">{</span>t_stat<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  p-value (upper):   </span><span class="sc">{</span>p_value_upper<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Critical value:    </span><span class="sc">{</span>t_crit_upper<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Decision:"</span>)</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  p-value approach:  </span><span class="sc">{</span>p_value_upper<span class="sc">:.4f}</span><span class="ss"> &gt; 0.05 → Do not reject H₀"</span>)</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Critical approach: </span><span class="sc">{</span>t_stat<span class="sc">:.4f}</span><span class="ss"> &lt; </span><span class="sc">{</span>t_crit_upper<span class="sc">:.4f}</span><span class="ss"> → Do not reject H₀"</span>)</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Conclusion: We do not have sufficient evidence to support the claim"</span>)</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"that mean earnings exceed $</span><span class="sc">{</span>mu0<span class="sc">:,}</span><span class="ss">."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
ONE-SIDED HYPOTHESIS TEST (Upper-tailed)
======================================================================
H₀: μ ≤ $40,000
Hₐ: μ &gt; $40,000 (the claim we're testing)
Significance level α = 0.05

Test Results:
  t-statistic:       0.7237
  p-value (upper):   0.2351
  Critical value:    1.6539

Decision:
  p-value approach:  0.2351 &gt; 0.05 → Do not reject H₀
  Critical approach: 0.7237 &lt; 1.6539 → Do not reject H₀

Conclusion: We do not have sufficient evidence to support the claim
that mean earnings exceed $40,000.</code></pre>
</div>
</div>
<section id="visualizing-one-sided-test" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-one-sided-test">Visualizing One-Sided Test</h3>
<div id="cell-45" class="cell" data-execution_count="12">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize one-sided hypothesis test</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">500</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> stats.t.pdf(x, n <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the t-distribution</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>ax.plot(x, y, <span class="st">'b-'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="ss">f't(</span><span class="sc">{</span>n<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">) distribution'</span>)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Mark the observed t-statistic</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>ax.axvline(x<span class="op">=</span>t_stat, color<span class="op">=</span><span class="st">'red'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, linestyle<span class="op">=</span><span class="st">'--'</span>,</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>           label<span class="op">=</span><span class="ss">f'Observed t = </span><span class="sc">{</span>t_stat<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Mark critical value (upper tail only)</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>ax.axvline(x<span class="op">=</span>t_crit_upper, color<span class="op">=</span><span class="st">'green'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>, linestyle<span class="op">=</span><span class="st">':'</span>,</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>           label<span class="op">=</span><span class="ss">f'Critical value = </span><span class="sc">{</span>t_crit_upper<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Shade rejection region (upper tail only)</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>x_reject <span class="op">=</span> x[x <span class="op">&gt;</span> t_crit_upper]</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>ax.fill_between(x_reject, <span class="dv">0</span>, stats.t.pdf(x_reject, n<span class="op">-</span><span class="dv">1</span>),</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>                alpha<span class="op">=</span><span class="fl">0.3</span>, color<span class="op">=</span><span class="st">'red'</span>, label<span class="op">=</span><span class="st">'Rejection region (α = 0.05)'</span>)</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'t-statistic'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Density'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'One-Sided Hypothesis Test (Upper-tailed) Visualization'</span>,</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>ax.legend(fontsize<span class="op">=</span><span class="dv">9</span>, loc<span class="op">=</span><span class="st">'upper left'</span>)</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">📊 Interpretation:"</span>)</span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   For an upper-tailed test, we only reject H₀ if t is large and POSITIVE."</span>)</span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   Our t-statistic (</span><span class="sc">{</span>t_stat<span class="sc">:.2f}</span><span class="ss">) is below the critical value, so we do not reject."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="ch04_Statistical_Inference_for_the_Mean_files/figure-html/cell-13-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
📊 Interpretation:
   For an upper-tailed test, we only reject H₀ if t is large and POSITIVE.
   Our t-statistic (0.72) is below the critical value, so we do not reject.</code></pre>
</div>
</div>
<p><strong>One-Sided Test Results: H₀: μ ≤ $40,000 vs Hₐ: μ &gt; $40,000</strong></p>
<ul>
<li>t-statistic: 0.7237 (same as two-sided test)</li>
<li>p-value (one-sided): 0.2351</li>
<li>p-value (two-sided): 0.4703</li>
<li>Critical value (one-sided, α=0.05): 1.6539</li>
<li>Decision: Do NOT reject H₀</li>
</ul>
<p><strong>Key differences from two-sided test:</strong></p>
<ol type="1">
<li><strong>p-value is exactly half:</strong>
<ul>
<li>Two-sided p-value: 0.4703</li>
<li>One-sided p-value: 0.2351 = 0.4703/2</li>
<li>Why? We only count probability in ONE tail (upper tail)</li>
</ul></li>
<li><strong>Critical value is smaller:</strong>
<ul>
<li>Two-sided critical value: ±1.9740 (5% split across two tails)</li>
<li>One-sided critical value: 1.6539 (5% all in one tail)</li>
<li>One-sided tests reject H₀ more easily in the specified direction</li>
</ul></li>
<li><strong>Directional claim:</strong>
<ul>
<li>Two-sided: “μ is different from $40,000” (could be higher OR lower)</li>
<li>One-sided: “μ exceeds $40,000” (specifically higher)</li>
</ul></li>
</ol>
<p><strong>When to use one-sided tests?</strong></p>
<p>Use one-sided tests when:</p>
<ul>
<li>Theory or prior research specifies a direction</li>
<li>Example: Testing if a new drug is better (not just different) than placebo</li>
<li>Example: Testing if a policy increases (not just changes) income</li>
</ul>
<p><strong>When NOT to use one-sided tests:</strong></p>
<p>Avoid one-sided tests when:</p>
<ul>
<li>You’re genuinely interested in detecting differences in either direction</li>
<li>You might want to detect unexpected effects</li>
<li>The field convention is two-sided (economics typically uses two-sided)</li>
</ul>
<p><strong>Warning about one-sided test abuse:</strong></p>
<p>Researchers sometimes use one-sided tests to get “significant” results when two-sided tests fail. This is questionable practice:</p>
<ul>
<li>If p (two-sided) = 0.08 → not significant at α = 0.05</li>
<li>If p (one-sided) = 0.04 → significant at α = 0.05</li>
<li>Switching to one-sided AFTER seeing the data is “p-hacking”</li>
<li>The choice between one-sided and two-sided should be made BEFORE collecting data</li>
</ul>
<p><strong>In our example:</strong></p>
<ul>
<li>Sample mean ($41,413) is above $40,000, consistent with Hₐ: μ &gt; $40,000</li>
<li>But p-value (0.2351) &gt; 0.05, so still not significant</li>
<li>The effect is too small relative to sampling variability</li>
<li>We cannot conclude that mean earnings exceed $40,000</li>
</ul>
<p><strong>Power consideration:</strong></p>
<p>One advantage of one-sided tests: greater statistical power in the specified direction</p>
<ul>
<li>If you’re only interested in detecting μ &gt; $40,000, the one-sided test is more powerful</li>
<li>Trade-off: Cannot detect effects in the opposite direction</li>
</ul>
</section>
</section>
<section id="proportions-data" class="level2">
<h2 class="anchored" data-anchor-id="proportions-data">4.7 Proportions Data</h2>
<p>The methods extend naturally to <strong>proportions</strong> (binary data).</p>
<p><strong>Example:</strong> Survey data where respondents answer yes (1) or no (0).- Sample proportion: <span class="math inline">\(\hat{p} = \bar{x}\)</span> = fraction of “yes” responses- Standard error: se(<span class="math inline">\(\hat{p}\)</span>) = √[<span class="math inline">\(\hat{p}\)</span>(1 - <span class="math inline">\(\hat{p}\)</span>)/n]</p>
<p><strong>Confidence interval for population proportion p:</strong><span class="math display">\[\hat{p} \pm z_{\alpha/2} \times \sqrt{\frac{\hat{p}(1-\hat{p})}{n}}\]</span><strong>Note:</strong> For proportions with large n, we use the <strong>normal distribution</strong> (z) instead of t. <strong>Example:</strong> In a sample of 921 voters, 480 intend to vote Democrat. Is this different from 50%?</p>
<div id="cell-48" class="cell" data-execution_count="13">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportions example</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>n_total <span class="op">=</span> <span class="dv">921</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>n_success <span class="op">=</span> <span class="dv">480</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>p_hat <span class="op">=</span> n_success <span class="op">/</span> n_total</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>se_prop <span class="op">=</span> np.sqrt(p_hat <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> p_hat) <span class="op">/</span> n_total)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 95% Confidence interval</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>z_crit <span class="op">=</span> <span class="fl">1.96</span>  <span class="co"># For 95% CI (normal approximation)</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>ci_lower_prop <span class="op">=</span> p_hat <span class="op">-</span> z_crit <span class="op">*</span> se_prop</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>ci_upper_prop <span class="op">=</span> p_hat <span class="op">+</span> z_crit <span class="op">*</span> se_prop</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"INFERENCE FOR PROPORTIONS"</span>)</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sample size:           </span><span class="sc">{</span>n_total<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Number voting Democrat: </span><span class="sc">{</span>n_success<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sample proportion:     </span><span class="sc">{</span>p_hat<span class="sc">:.4f}</span><span class="ss"> (</span><span class="sc">{</span>p_hat<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%)"</span>)</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Standard error:        </span><span class="sc">{</span>se_prop<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"95% CI:                [</span><span class="sc">{</span>ci_lower_prop<span class="sc">:.4f}</span><span class="ss">, </span><span class="sc">{</span>ci_upper_prop<span class="sc">:.4f}</span><span class="ss">]"</span>)</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"                        [</span><span class="sc">{</span>ci_lower_prop<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%, </span><span class="sc">{</span>ci_upper_prop<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%]"</span>)</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Hypothesis test: H0: p = 0.50</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>p0 <span class="op">=</span> <span class="fl">0.50</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>se_under_h0 <span class="op">=</span> np.sqrt(p0 <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> p0) <span class="op">/</span> n_total)</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>z_stat <span class="op">=</span> (p_hat <span class="op">-</span> p0) <span class="op">/</span> se_under_h0</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>p_value_prop <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> stats.norm.cdf(<span class="bu">abs</span>(z_stat)))</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Hypothesis Test: H₀: p = </span><span class="sc">{</span>p0<span class="sc">:.2f}</span><span class="ss"> (50-50 split)"</span>)</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  z-statistic:       </span><span class="sc">{</span>z_stat<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  p-value:           </span><span class="sc">{</span>p_value_prop<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Decision:          </span><span class="sc">{</span><span class="st">'Reject H₀'</span> <span class="cf">if</span> <span class="bu">abs</span>(z_stat) <span class="op">&gt;</span> <span class="fl">1.96</span> <span class="cf">else</span> <span class="st">'Do not reject H₀'</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Conclusion: The proportion is </span><span class="sc">{</span><span class="st">'significantly'</span> <span class="cf">if</span> <span class="bu">abs</span>(z_stat) <span class="op">&gt;</span> <span class="fl">1.96</span> <span class="cf">else</span> <span class="st">'NOT significantly'</span><span class="sc">}</span><span class="ss"> different from 50%."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
INFERENCE FOR PROPORTIONS
======================================================================
Sample size:           921
Number voting Democrat: 480
Sample proportion:     0.5212 (52.12%)
Standard error:        0.0165
95% CI:                [0.4889, 0.5534]
                        [48.89%, 55.34%]

Hypothesis Test: H₀: p = 0.50 (50-50 split)
  z-statistic:       1.2851
  p-value:           0.1988
  Decision:          Do not reject H₀

Conclusion: The proportion is NOT significantly different from 50%.</code></pre>
</div>
</div>
<p><strong>Proportion Results: 480 out of 921 voters intend to vote Democrat</strong> - Sample proportion: p̂ = 0.5212 (52.12%) - Standard error: 0.0165 - 95% CI: [0.4889, 0.5534] or [48.89%, 55.34%] - z-statistic (testing H₀: p = 0.50): 1.2851 - p-value: 0.1988 - Decision: Do NOT reject H₀</p>
<p><strong>What this tells us:</strong></p>
<p>We have a sample where 52.12% intend to vote Democrat. The question is: does this provide evidence that the population proportion differs from 50% (a tied race)?</p>
<p><strong>Understanding the confidence interval:</strong></p>
<p>The 95% CI [48.89%, 55.34%] suggests: - We’re 95% confident the true population proportion is in this range - The interval INCLUDES 50%, indicating 50-50 is plausible - The interval is fairly wide (6.45 percentage points), indicating some uncertainty</p>
<p><strong>Understanding the hypothesis test:</strong></p>
<p>Testing H₀: p = 0.50 (tied race) vs Hₐ: p ≠ 0.50 (one candidate ahead) - z-statistic: 1.29 (only 1.29 standard errors above 50%) - p-value: 0.1988 (about 20% chance of seeing this result if truly 50-50) - Conclusion: We cannot reject the null hypothesis of a tied race</p>
<p><strong>Why use z-statistic (normal) instead of t-statistic?</strong></p>
<p>For proportions with large samples (n = 921): - The sampling distribution of p̂ is approximately normal - We know the exact standard error formula: √[p̂(1-p̂)/n] - No need to estimate anything with t-distribution - Rule of thumb: Use normal approximation when np ≥ 10 and n(1-p) ≥ 10 - Here: 921(0.52) = 479 and 921(0.48) = 442, both &gt;&gt; 10</p>
<p><strong>Practical interpretation for election forecasting:</strong></p>
<p>This sample shows 52% support for Democrats, but: - This is NOT statistically significant evidence of a Democratic lead (p = 0.20) - The confidence interval includes 50%, so the race could be tied - Margin of error: ±3.2 percentage points (1.96 × 0.0165 = 0.032) - To call the race, we’d want the CI to exclude 50% entirely</p>
<p><strong>How would a larger sample change things?</strong></p>
<p>If we had the same proportion (52%) but with 2,500 voters instead of 921: - Standard error would shrink: √[0.52(0.48)/2500] = 0.010 - 95% CI would be narrower: [50.0%, 54.0%] - z-statistic would be larger: (0.52 - 0.50)/0.010 = 2.00 - p-value would be smaller: 0.045 &lt; 0.05 → significant! - Conclusion: Same proportion, but with more data, we could detect the difference</p>
<p><strong>Key insight about proportions:</strong></p>
<p>Proportions are just means of binary (0/1) data: - Each voter is coded as 1 (Democrat) or 0 (not Democrat) - Sample proportion = sample mean of these 0/1 values - All inference principles (SE, CI, hypothesis tests) apply identically</p>
<blockquote class="blockquote">
<p><strong>Key Concept 4.9: Inference for Proportions</strong></p>
<p>Proportions data (like employment rates, approval ratings, or market shares) are binary variables coded as 0 or 1. All inference methods for means—confidence intervals, hypothesis tests, standard errors—extend naturally to proportions. The sample proportion <span class="math inline">\(\bar{p}\)</span> is simply the sample mean of binary data, and the standard error formula <span class="math inline">\(se(\bar{p}) = \sqrt{\bar{p}(1-\bar{p})/n}\)</span> follows from the variance formula for binary variables.</p>
</blockquote>
</section>
<section id="key-takeaways" class="level2">
<h2 class="anchored" data-anchor-id="key-takeaways">Key Takeaways</h2>
<section id="core-concepts" class="level3">
<h3 class="anchored" data-anchor-id="core-concepts">Core Concepts</h3>
<ol type="1">
<li><p><strong>Statistical inference</strong> lets us extrapolate from sample statistics to population parameters with quantified uncertainty.</p></li>
<li><p><strong>Standard error</strong> <span class="math inline">\(\text{se}(\bar{x}) = \frac{s}{\sqrt{n}}\)</span> measures the precision of the sample mean as an estimate of the population mean.</p></li>
<li><p><strong>t-distribution</strong> is used (instead of normal) when we estimate the population standard deviation from the sample</p></li>
</ol>
<ul>
<li>Fatter tails than normal (accounts for extra uncertainty)</li>
<li>Converges to normal as <span class="math inline">\(n\)</span> increases</li>
</ul>
<ol start="4" type="1">
<li><strong>Confidence intervals</strong> provide a range of plausible values</li>
</ol>
<ul>
<li>Formula: estimate <span class="math inline">\(\pm\)</span> critical value <span class="math inline">\(\times\)</span> standard error</li>
<li>95% CI: <span class="math inline">\(\bar{x} \pm t_{n-1, 0.025} \times \text{se}(\bar{x}) \approx \bar{x} \pm 2 \times \text{se}(\bar{x})\)</span></li>
<li>Interpretation: “We are 95% confident <span class="math inline">\(\mu\)</span> lies in this interval”</li>
</ul>
<ol start="5" type="1">
<li><strong>Hypothesis tests</strong> evaluate specific claims about parameters</li>
</ol>
<ul>
<li>Set up <span class="math inline">\(H_0\)</span> (null) and <span class="math inline">\(H_a\)</span> (alternative)</li>
<li>Calculate <span class="math inline">\(t\text{-statistic} = \frac{\text{estimate} - \text{hypothesized value}}{\text{standard error}}\)</span></li>
<li>Make decision using p-value or critical value approach</li>
</ul>
<ol start="6" type="1">
<li><strong>Two-sided tests</strong> (<span class="math inline">\(H_0: \mu = \mu^*\)</span> vs <span class="math inline">\(H_a: \mu \neq \mu^*\)</span>)</li>
</ol>
<ul>
<li>Rejection region in both tails</li>
<li><span class="math inline">\(\text{p-value} = 2 \times \Pr[T \geq |t|]\)</span></li>
</ul>
<ol start="7" type="1">
<li><strong>One-sided tests</strong> (<span class="math inline">\(H_0: \mu \leq \mu^*\)</span> vs <span class="math inline">\(H_a: \mu &gt; \mu^*\)</span>, or vice versa)</li>
</ol>
<ul>
<li>Rejection region in one tail only</li>
<li>Use when testing a directional claim</li>
</ul>
<ol start="8" type="1">
<li><strong>p-value interpretation</strong></li>
</ol>
<ul>
<li>Probability of observing data at least as extreme as ours, assuming <span class="math inline">\(H_0\)</span> is true</li>
<li>Small p-value (<span class="math inline">\(&lt; \alpha\)</span>) → reject <span class="math inline">\(H_0\)</span></li>
<li>Common significance level: <span class="math inline">\(\alpha = 0.05\)</span></li>
</ul>
<ol start="9" type="1">
<li><strong>Methods generalize</strong> to other parameters (regression coefficients, differences in means, etc.) and proportions data</li>
</ol>
</section>
<section id="what-you-learned" class="level3">
<h3 class="anchored" data-anchor-id="what-you-learned">What You Learned</h3>
<p><strong>Statistical Concepts Covered:</strong> - Standard error and sampling distribution - t-distribution vs normal distribution - Confidence intervals (90%, 95%, 99%) - Hypothesis testing (two-sided and one-sided) - p-values and critical values - Type I error and significance level - Inference for proportions</p>
<p><strong>Python Tools Used:</strong> - <code>scipy.stats.t</code>: t-distribution (pdf, cdf, ppf) - <code>scipy.stats.norm</code>: Normal distribution (for proportions) - <code>pandas</code>: Data manipulation - <code>matplotlib</code>: Visualization of hypothesis tests</p>
</section>
<section id="next-steps" class="level3">
<h3 class="anchored" data-anchor-id="next-steps">Next Steps</h3>
<ul>
<li><strong>Chapter 5:</strong> Bivariate data summary (relationships between two variables)</li>
<li><strong>Chapter 6:</strong> Least squares estimator (regression foundation)</li>
<li><strong>Chapter 7:</strong> Inference for regression coefficients</li>
</ul>
</section>
<section id="congratulations" class="level3">
<h3 class="anchored" data-anchor-id="congratulations">Congratulations!</h3>
<p>You now understand the foundations of statistical inference:</p>
<ul>
<li>How to quantify uncertainty using confidence intervals</li>
<li>How to test claims about population parameters</li>
<li>The difference between statistical and practical significance</li>
<li>When to use one-sided vs two-sided tests</li>
</ul>
<p>These tools are fundamental to all empirical research in economics and beyond!</p>
</section>
</section>
<section id="practice-exercises" class="level2">
<h2 class="anchored" data-anchor-id="practice-exercises">Practice Exercises</h2>
<p>Test your understanding of statistical inference:</p>
<section id="exercise-1-confidence-interval-interpretation" class="level3">
<h3 class="anchored" data-anchor-id="exercise-1-confidence-interval-interpretation">Exercise 1: Confidence Interval Interpretation</h3>
<p>A 95% CI for mean household income is [$48,000, $56,000]</p>
<ol type="a">
<li><p>What is the point estimate (sample mean)?</p></li>
<li><p>What is the margin of error?</p></li>
<li><p>TRUE or FALSE: “There is a 95% probability that the true mean is in this interval”</p></li>
<li><p>TRUE or FALSE: “If we repeated sampling, 95% of CIs would contain the true mean”</p></li>
</ol>
</section>
<section id="exercise-2-standard-error-calculation" class="level3">
<h3 class="anchored" data-anchor-id="exercise-2-standard-error-calculation">Exercise 2: Standard Error Calculation</h3>
<p>Sample of <span class="math inline">\(n=64\)</span> observations with mean <span class="math inline">\(\$45,000\)</span> and standard deviation <span class="math inline">\(s=\$16,000\)</span></p>
<ol type="a">
<li><p>Calculate the standard error</p></li>
<li><p>What sample size would halve the standard error?</p></li>
<li><p>Construct an approximate 95% CI using the “mean <span class="math inline">\(\pm\)</span> 2SE” rule</p></li>
</ol>
</section>
<section id="exercise-3-t-vs-z-distribution" class="level3">
<h3 class="anchored" data-anchor-id="exercise-3-t-vs-z-distribution">Exercise 3: t vs z Distribution</h3>
<ol type="a">
<li><p>Why do we use the t-distribution instead of the normal distribution?</p></li>
<li><p>For <span class="math inline">\(n=10\)</span>, find the critical value for a 95% CI</p></li>
<li><p>For <span class="math inline">\(n=100\)</span>, find the critical value for a 95% CI</p></li>
<li><p>Compare these to <span class="math inline">\(z=1.96\)</span>. What do you notice?</p></li>
</ol>
</section>
<section id="exercise-4-hypothesis-test-mechanics" class="level3">
<h3 class="anchored" data-anchor-id="exercise-4-hypothesis-test-mechanics">Exercise 4: Hypothesis Test Mechanics</h3>
<p>Test <span class="math inline">\(H_0: \mu = 100\)</span> vs <span class="math inline">\(H_a: \mu \neq 100\)</span> with sample mean <span class="math inline">\(= 105\)</span>, SE <span class="math inline">\(= 3\)</span>, <span class="math inline">\(n = 49\)</span></p>
<ol type="a">
<li><p>Calculate the t-statistic</p></li>
<li><p>Find the p-value (use t-table or Python)</p></li>
<li><p>Make a decision at <span class="math inline">\(\alpha=0.05\)</span></p></li>
<li><p>Would your decision change if <span class="math inline">\(\alpha=0.01\)</span>?</p></li>
</ol>
</section>
<section id="exercise-5-one-sided-vs-two-sided-tests" class="level3">
<h3 class="anchored" data-anchor-id="exercise-5-one-sided-vs-two-sided-tests">Exercise 5: One-Sided vs Two-Sided Tests</h3>
<p>Sample: <span class="math inline">\(n=36\)</span>, mean <span class="math inline">\(=72\)</span>, <span class="math inline">\(s=18\)</span></p>
<ol type="a">
<li><p>Test <span class="math inline">\(H_0: \mu = 75\)</span> vs <span class="math inline">\(H_a: \mu \neq 75\)</span> (two-sided, <span class="math inline">\(\alpha=0.05\)</span>)</p></li>
<li><p>Test <span class="math inline">\(H_0: \mu \geq 75\)</span> vs <span class="math inline">\(H_a: \mu &lt; 75\)</span> (one-sided, <span class="math inline">\(\alpha=0.05\)</span>)</p></li>
<li><p>Compare the p-values. What is the relationship?</p></li>
<li><p>In which case is the evidence against <span class="math inline">\(H_0\)</span> stronger?</p></li>
</ol>
</section>
<section id="exercise-6-type-i-and-type-ii-errors" class="level3">
<h3 class="anchored" data-anchor-id="exercise-6-type-i-and-type-ii-errors">Exercise 6: Type I and Type II Errors</h3>
<ol type="a">
<li><p>Define Type I error and give an example in the earnings context</p></li>
<li><p>Define Type II error and give an example</p></li>
<li><p>If we decrease <span class="math inline">\(\alpha\)</span> from 0.05 to 0.01, what happens to the probability of Type II error?</p></li>
<li><p>How can we reduce both types of error simultaneously?</p></li>
</ol>
</section>
<section id="exercise-7-proportions-inference" class="level3">
<h3 class="anchored" data-anchor-id="exercise-7-proportions-inference">Exercise 7: Proportions Inference</h3>
<p>Survey of 500 people: 275 support a policy</p>
<ol type="a">
<li><p>Calculate the sample proportion and standard error</p></li>
<li><p>Construct a 95% CI for the population proportion</p></li>
<li><p>Test <span class="math inline">\(H_0: p = 0.50\)</span> vs <span class="math inline">\(H_a: p \neq 0.50\)</span></p></li>
<li><p>Is the result statistically significant?</p></li>
</ol>
</section>
<section id="exercise-8-python-practice" class="level3">
<h3 class="anchored" data-anchor-id="exercise-8-python-practice">Exercise 8: Python Practice</h3>
<p>Generate a random sample of 100 observations from <span class="math inline">\(N(50, 100)\)</span></p>
<ol type="a">
<li><p>Calculate the 95% CI for the mean</p></li>
<li><p>Does the CI contain the true mean (50)?</p></li>
<li><p>Repeat 1000 times. What fraction of CIs contain 50?</p></li>
<li><p>Test <span class="math inline">\(H_0: \mu = 55\)</span>. What proportion of tests reject (should be <span class="math inline">\(\approx 0.05\)</span>)?</p></li>
</ol>
<hr>
</section>
</section>
<section id="case-study-1-statistical-inference-for-labor-productivity" class="level2">
<h2 class="anchored" data-anchor-id="case-study-1-statistical-inference-for-labor-productivity">Case Study 1: Statistical Inference for Labor Productivity</h2>
<p><strong>Research Question:</strong> “Has global labor productivity changed significantly over time, and do productivity levels differ significantly across regions?”</p>
<p>This case study applies all the statistical inference methods from Chapter 4 to analyze real economic data on labor productivity across 108 countries over 25 years (1990-2014). You’ll practice:</p>
<ul>
<li>Constructing and interpreting <strong>confidence intervals</strong> for population means</li>
<li>Conducting <strong>two-sided hypothesis tests</strong> to compare time periods</li>
<li>Performing <strong>one-sided directional tests</strong> for benchmark comparisons</li>
<li>Applying <strong>proportions inference</strong> to binary economic outcomes</li>
<li>Comparing productivity levels across <strong>regional subgroups</strong></li>
<li>Interpreting results in economic context (development economics, convergence theory)</li>
</ul>
<p>The Mendez convergence clubs dataset provides panel data on labor productivity, GDP, capital, human capital, and total factor productivity for 108 countries from 1990 to 2014.</p>
<section id="economic-context-testing-convergence-hypotheses" class="level3">
<h3 class="anchored" data-anchor-id="economic-context-testing-convergence-hypotheses">Economic Context: Testing Convergence Hypotheses</h3>
<p>In development economics, the <strong>convergence hypothesis</strong> suggests that poorer countries should grow faster than richer ones, leading to a narrowing of productivity gaps over time. Statistical inference allows us to test whether observed changes in productivity are:</p>
<ul>
<li><strong>Statistically significant</strong> (unlikely due to random sampling variation)</li>
<li><strong>Economically meaningful</strong> (large enough to matter for policy)</li>
</ul>
<p>By applying Chapter 4’s methods to this dataset, you’ll answer questions like:</p>
<ol type="1">
<li>Has mean global productivity increased significantly from 1990 to 2014?</li>
<li>Are regional productivity gaps (e.g., Africa vs.&nbsp;Europe) statistically significant?</li>
<li>What proportion of countries experienced positive productivity growth?</li>
<li>Can we reject specific hypotheses about productivity benchmarks?</li>
</ol>
<p>These are real questions that economists and policymakers care about when designing development strategies.</p>
<blockquote class="blockquote">
<p><strong>Key Concept 4.10: Why Statistical Inference Matters in Economics</strong></p>
<p>When analyzing economic data, we rarely observe entire populations. Instead, we work with <strong>samples</strong> (like 108 countries from all countries in the world, or 25 years from a longer historical period). Statistical inference lets us:</p>
<ol type="1">
<li><strong>Quantify uncertainty</strong> - Confidence intervals tell us the range of plausible values for population parameters</li>
<li><strong>Test theories</strong> - Hypothesis tests evaluate whether data support or contradict economic theories</li>
<li><strong>Compare groups</strong> - We can determine if differences between regions/periods are real or just noise</li>
<li><strong>Inform policy</strong> - Statistical significance helps separate meaningful patterns from random fluctuations</li>
</ol>
<p>Without inference methods, we couldn’t distinguish between: - A real productivity increase vs.&nbsp;random year-to-year variation - Genuine regional gaps vs.&nbsp;sampling artifacts - Policy-relevant changes vs.&nbsp;statistical noise</p>
</blockquote>
<div id="cell-56" class="cell" data-execution_count="14">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load convergence clubs dataset</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/quarcs-lab/mendez2020-convergence-clubs-code-data/master/assets/dat.csv"</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(url)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Set multi-index (country, year)</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.set_index([<span class="st">'country'</span>, <span class="st">'year'</span>])</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Display dataset information</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Dataset Overview:"</span>)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Total observations: </span><span class="sc">{</span><span class="bu">len</span>(df)<span class="sc">:,}</span><span class="ss">"</span>)</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Countries: </span><span class="sc">{</span>df<span class="sc">.</span>index<span class="sc">.</span>get_level_values(<span class="st">'country'</span>)<span class="sc">.</span>nunique()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Years: </span><span class="sc">{</span>df<span class="sc">.</span>index<span class="sc">.</span>get_level_values(<span class="st">'year'</span>)<span class="sc">.</span><span class="bu">min</span>()<span class="sc">}</span><span class="ss">-</span><span class="sc">{</span>df<span class="sc">.</span>index<span class="sc">.</span>get_level_values(<span class="st">'year'</span>)<span class="sc">.</span><span class="bu">max</span>()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Variables: </span><span class="sc">{</span><span class="bu">list</span>(df.columns)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract labor productivity for key years</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>lp_1990 <span class="op">=</span> df.loc[df.index.get_level_values(<span class="st">'year'</span>) <span class="op">==</span> <span class="dv">1990</span>, <span class="st">'lp'</span>]</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>lp_2014 <span class="op">=</span> df.loc[df.index.get_level_values(<span class="st">'year'</span>) <span class="op">==</span> <span class="dv">2014</span>, <span class="st">'lp'</span>]</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Labor productivity samples:"</span>)</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"1990: n=</span><span class="sc">{</span><span class="bu">len</span>(lp_1990)<span class="sc">}</span><span class="ss">, mean=$</span><span class="sc">{</span>lp_1990<span class="sc">.</span>mean()<span class="op">/</span><span class="dv">1000</span><span class="sc">:.1f}</span><span class="ss">k, std=$</span><span class="sc">{</span>lp_1990<span class="sc">.</span>std()<span class="op">/</span><span class="dv">1000</span><span class="sc">:.1f}</span><span class="ss">k"</span>)</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"2014: n=</span><span class="sc">{</span><span class="bu">len</span>(lp_2014)<span class="sc">}</span><span class="ss">, mean=$</span><span class="sc">{</span>lp_2014<span class="sc">.</span>mean()<span class="op">/</span><span class="dv">1000</span><span class="sc">:.1f}</span><span class="ss">k, std=$</span><span class="sc">{</span>lp_2014<span class="sc">.</span>std()<span class="op">/</span><span class="dv">1000</span><span class="sc">:.1f}</span><span class="ss">k"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Dataset Overview:
Total observations: 2,700
Countries: 108
Years: 1990-2014

Variables: ['id', 'Y', 'K', 'pop', 'L', 's', 'alpha_it', 'GDPpc', 'lp', 'h', 'kl', 'kp', 'ky', 'TFP', 'log_GDPpc_raw', 'log_lp_raw', 'log_ky_raw', 'log_h_raw', 'log_tfp_raw', 'log_GDPpc', 'log_lp', 'log_ky', 'log_h', 'log_tfp', 'isocode', 'hi1990', 'region']

Labor productivity samples:
1990: n=108, mean=$23.2k, std=$20.1k
2014: n=108, mean=$41.0k, std=$33.9k</code></pre>
</div>
</div>
</section>
<section id="how-to-use-these-tasks" class="level3">
<h3 class="anchored" data-anchor-id="how-to-use-these-tasks">How to Use These Tasks</h3>
<p><strong>Task structure:</strong> The 6 tasks below progress from <strong>guided</strong> (fill-in-the-blank code) to <strong>independent</strong> (design your own analysis).</p>
<p><strong>Working approach:</strong></p>
<ol type="1">
<li><strong>Read the task description</strong> - Understand the economic question and learning goal</li>
<li><strong>Study the code template</strong> - Early tasks provide partial code with blanks (<code>_____</code>)</li>
<li><strong>Insert a new code cell</strong> below each task</li>
<li><strong>Complete the code</strong> - Fill in blanks or write from scratch (depending on task level)</li>
<li><strong>Run and interpret</strong> - Execute your code and interpret results economically</li>
<li><strong>Check your understanding</strong> - Does your answer make economic sense?</li>
</ol>
<p><strong>Tips:</strong></p>
<ul>
<li>Reference Section 4.1-4.7 for formulas and methods</li>
<li>Use <code>scipy.stats</code> functions: <code>t.ppf()</code>, <code>ttest_ind()</code>, <code>ttest_1samp()</code></li>
<li>Always interpret p-values: “We reject/fail to reject H₀ at α=0.05 because…”</li>
<li>Connect statistical results to economic meaning: “This suggests that…”</li>
</ul>
<p><strong>Progressive difficulty:</strong></p>
<ul>
<li><strong>Tasks 1-2:</strong> GUIDED (fill 4-8 blanks in provided code)</li>
<li><strong>Tasks 3-4:</strong> SEMI-GUIDED (complete partial structure)</li>
<li><strong>Tasks 5-6:</strong> INDEPENDENT (design full implementation)</li>
</ul>
</section>
<section id="task-1-confidence-intervals-for-mean-productivity-guided" class="level3">
<h3 class="anchored" data-anchor-id="task-1-confidence-intervals-for-mean-productivity-guided">Task 1: Confidence Intervals for Mean Productivity (GUIDED)</h3>
<p><strong>Learning Goal:</strong> Apply Section 4.3 methods to calculate and interpret confidence intervals</p>
<p><strong>Economic Question:</strong> “Can we be 95% confident about the range of global mean labor productivity in 2014?”</p>
<p><strong>Your task:</strong></p>
<ol type="1">
<li>Calculate a 95% confidence interval for mean productivity in 2014</li>
<li>Calculate a 99% confidence interval for comparison</li>
<li>Interpret the difference in interval widths</li>
<li>Compare with a 95% CI for 1990 data</li>
</ol>
<p><strong>Code template (fill in the 6 blanks):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 2014 data: Calculate 95% CI</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>n_2014 <span class="op">=</span> <span class="bu">len</span>(lp_2014)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>mean_2014 <span class="op">=</span> _____  <span class="co"># Calculate sample mean</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>std_2014 <span class="op">=</span> _____   <span class="co"># Calculate sample standard deviation</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>se_2014 <span class="op">=</span> std_2014 <span class="op">/</span> np.sqrt(n_2014)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Get t-critical value for 95% CI (two-tailed, df = n-1)</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>alpha_95 <span class="op">=</span> <span class="fl">0.05</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>t_crit_95 <span class="op">=</span> stats.t.ppf(<span class="dv">1</span> <span class="op">-</span> alpha_95<span class="op">/</span><span class="dv">2</span>, df<span class="op">=</span>_____)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate margin of error and CI bounds</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>me_95 <span class="op">=</span> t_crit_95 <span class="op">*</span> se_2014</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>ci_95_lower <span class="op">=</span> _____</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>ci_95_upper <span class="op">=</span> _____</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"2014 Labor Productivity:"</span>)</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sample mean: $</span><span class="sc">{</span>mean_2014<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"95% CI: [$</span><span class="sc">{</span>ci_95_lower<span class="sc">:,.0f}</span><span class="ss">, $</span><span class="sc">{</span>ci_95_upper<span class="sc">:,.0f}</span><span class="ss">]"</span>)</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Margin of error: $</span><span class="sc">{</span>me_95<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate 99% CI for comparison</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>alpha_99 <span class="op">=</span> <span class="fl">0.01</span></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>t_crit_99 <span class="op">=</span> stats.t.ppf(<span class="dv">1</span> <span class="op">-</span> alpha_99<span class="op">/</span><span class="dv">2</span>, df<span class="op">=</span>n_2014<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>me_99 <span class="op">=</span> t_crit_99 <span class="op">*</span> se_2014</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>ci_99_lower <span class="op">=</span> mean_2014 <span class="op">-</span> me_99</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>ci_99_upper <span class="op">=</span> mean_2014 <span class="op">+</span> me_99</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">99% CI: [$</span><span class="sc">{</span>ci_99_lower<span class="sc">:,.0f}</span><span class="ss">, $</span><span class="sc">{</span>ci_99_upper<span class="sc">:,.0f}</span><span class="ss">]"</span>)</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Margin of error: $</span><span class="sc">{</span>me_99<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Interpretation: The 99% CI is _____ than the 95% CI"</span>)  <span class="co"># Fill in: "wider" or "narrower"</span></span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"because we need more certainty, which requires a larger interval."</span>)</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare with 1990</span></span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>mean_1990 <span class="op">=</span> lp_1990.mean()</span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>std_1990 <span class="op">=</span> lp_1990.std()</span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>se_1990 <span class="op">=</span> std_1990 <span class="op">/</span> np.sqrt(<span class="bu">len</span>(lp_1990))</span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>me_1990 <span class="op">=</span> stats.t.ppf(<span class="fl">0.975</span>, df<span class="op">=</span><span class="bu">len</span>(lp_1990)<span class="op">-</span><span class="dv">1</span>) <span class="op">*</span> se_1990</span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">1990 mean: $</span><span class="sc">{</span>mean_1990<span class="sc">:,.0f}</span><span class="ss">, 95% CI width: $</span><span class="sc">{</span><span class="dv">2</span><span class="op">*</span>me_1990<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"2014 mean: $</span><span class="sc">{</span>mean_2014<span class="sc">:,.0f}</span><span class="ss">, 95% CI width: $</span><span class="sc">{</span><span class="dv">2</span><span class="op">*</span>me_95<span class="sc">:,.0f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Questions to consider:</strong></p>
<ul>
<li>Why is the 99% CI wider than the 95% CI?</li>
<li>Did the mean productivity increase from 1990 to 2014?</li>
<li>Which year has more variability in productivity across countries?</li>
</ul>
</section>
<section id="task-2-testing-productivity-change-over-time-semi-guided" class="level3">
<h3 class="anchored" data-anchor-id="task-2-testing-productivity-change-over-time-semi-guided">Task 2: Testing Productivity Change Over Time (SEMI-GUIDED)</h3>
<p><strong>Learning Goal:</strong> Apply Section 4.4 (two-sided tests) to compare time periods</p>
<p><strong>Economic Question:</strong> “Has global mean labor productivity changed significantly from 1990 to 2014?”</p>
<p><strong>Your task:</strong></p>
<ol type="1">
<li>State null and alternative hypotheses</li>
<li>Conduct a two-sample t-test (independent samples)</li>
<li>Calculate the test statistic manually</li>
<li>Compare with <code>scipy.stats.ttest_ind()</code> result</li>
<li>Interpret the p-value at α = 0.05</li>
</ol>
<p><strong>Code template (fill in the 8 blanks):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># State hypotheses</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"H₀: μ₁₉₉₀ = μ₂₀₁₄  (no change in mean productivity)"</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Hₐ: μ₁₉₉₀ ≠ μ₂₀₁₄  (mean productivity changed)"</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Significance level: α = 0.05</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Manual calculation</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>mean_1990 <span class="op">=</span> lp_1990.mean()</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>mean_2014 <span class="op">=</span> lp_2014.mean()</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>se_1990 <span class="op">=</span> lp_1990.std() <span class="op">/</span> np.sqrt(<span class="bu">len</span>(lp_1990))</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>se_2014 <span class="op">=</span> lp_2014.std() <span class="op">/</span> np.sqrt(<span class="bu">len</span>(lp_2014))</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate pooled standard error for difference in means</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>se_diff <span class="op">=</span> np.sqrt(_____<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> _____<span class="op">**</span><span class="dv">2</span>)  <span class="co"># Fill in: se_1990 and se_2014</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate t-statistic</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>t_stat <span class="op">=</span> (_____ <span class="op">-</span> _____) <span class="op">/</span> se_diff  <span class="co"># Fill in: mean_2014 and mean_1990</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Degrees of freedom (Welch approximation)</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>n1, n2 <span class="op">=</span> <span class="bu">len</span>(lp_1990), <span class="bu">len</span>(lp_2014)</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>s1, s2 <span class="op">=</span> lp_1990.std(), lp_2014.std()</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> ((s1<span class="op">**</span><span class="dv">2</span><span class="op">/</span>n1 <span class="op">+</span> s2<span class="op">**</span><span class="dv">2</span><span class="op">/</span>n2)<span class="op">**</span><span class="dv">2</span>) <span class="op">/</span> ((s1<span class="op">**</span><span class="dv">2</span><span class="op">/</span>n1)<span class="op">**</span><span class="dv">2</span><span class="op">/</span>(n1<span class="op">-</span><span class="dv">1</span>) <span class="op">+</span> (s2<span class="op">**</span><span class="dv">2</span><span class="op">/</span>n2)<span class="op">**</span><span class="dv">2</span><span class="op">/</span>(n2<span class="op">-</span><span class="dv">1</span>))</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate two-sided p-value</span></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>p_value_manual <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> stats.t.cdf(<span class="bu">abs</span>(t_stat), df<span class="op">=</span>df))</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Manual calculation:"</span>)</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Difference in means: $</span><span class="sc">{</span>mean_2014 <span class="op">-</span> mean_1990<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"SE of difference: $</span><span class="sc">{</span>se_diff<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"t-statistic: </span><span class="sc">{</span>t_stat<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Degrees of freedom: </span><span class="sc">{</span>df<span class="sc">:.1f}</span><span class="ss">"</span>)</span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"p-value (two-sided): </span><span class="sc">{</span>p_value_manual<span class="sc">:.4f}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify with scipy</span></span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>t_stat_scipy, p_value_scipy <span class="op">=</span> stats.ttest_ind(_____, _____, equal_var<span class="op">=</span><span class="va">False</span>)  <span class="co"># Fill in: lp_2014, lp_1990</span></span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"scipy.stats.ttest_ind() result:"</span>)</span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"t-statistic: </span><span class="sc">{</span>t_stat_scipy<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"p-value: </span><span class="sc">{</span>p_value_scipy<span class="sc">:.4f}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Decision</span></span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> p_value_scipy <span class="op">&lt;</span> <span class="fl">0.05</span>:</span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Decision: _____ H₀ at α=0.05"</span>)  <span class="co"># Fill in: "Reject" or "Fail to reject"</span></span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Interpretation: Mean productivity _____ significantly from 1990 to 2014."</span>)  <span class="co"># Fill in: "changed" or "did not change"</span></span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Decision: Fail to reject H₀ at α=0.05"</span>)</span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Interpretation: Insufficient evidence that mean productivity changed."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Questions to consider:</strong></p>
<ul>
<li>What does the p-value tell you about the likelihood of observing this difference by chance?</li>
<li>Is the change economically meaningful (not just statistically significant)?</li>
<li>What assumptions does the two-sample t-test make?</li>
</ul>
</section>
<section id="task-3-comparing-regional-productivity-levels-semi-guided" class="level3">
<h3 class="anchored" data-anchor-id="task-3-comparing-regional-productivity-levels-semi-guided">Task 3: Comparing Regional Productivity Levels (SEMI-GUIDED)</h3>
<p><strong>Learning Goal:</strong> Apply hypothesis testing to compare subgroups</p>
<p><strong>Economic Question:</strong> “Do African countries have significantly lower productivity than European countries (2014 data)?”</p>
<p><strong>Your task:</strong></p>
<ol type="1">
<li>Filter 2014 data by region (use <code>region</code> column in dataset)</li>
<li>Test H₀: μ_Africa = μ_Europe vs Hₐ: μ_Africa ≠ μ_Europe</li>
<li>Calculate 95% CI for the difference in means</li>
<li>Visualize distributions with side-by-side box plots</li>
</ol>
<p><strong>Code structure (complete the analysis):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter 2014 data by region</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>df_2014 <span class="op">=</span> df.loc[df.index.get_level_values(<span class="st">'year'</span>) <span class="op">==</span> <span class="dv">2014</span>]</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract productivity for Africa and Europe</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>lp_africa <span class="op">=</span> df_2014.loc[df_2014[<span class="st">'region'</span>] <span class="op">==</span> <span class="st">'Africa'</span>, <span class="st">'lp'</span>]</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>lp_europe <span class="op">=</span> df_2014.loc[df_2014[<span class="st">'region'</span>] <span class="op">==</span> <span class="st">'Europe'</span>, <span class="st">'lp'</span>]</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sample sizes: Africa n=</span><span class="sc">{</span><span class="bu">len</span>(lp_africa)<span class="sc">}</span><span class="ss">, Europe n=</span><span class="sc">{</span><span class="bu">len</span>(lp_europe)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Africa mean: $</span><span class="sc">{</span>lp_africa<span class="sc">.</span>mean()<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Europe mean: $</span><span class="sc">{</span>lp_europe<span class="sc">.</span>mean()<span class="sc">:,.0f}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Conduct two-sample t-test</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="co"># YOUR CODE HERE: Use stats.ttest_ind() to test if means differ</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate and print: t-statistic, p-value, decision at α=0.05</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate 95% CI for difference in means</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a><span class="co"># YOUR CODE HERE: </span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Calculate difference in means</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Calculate SE of difference</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Get t-critical value</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Construct CI: (difference - ME, difference + ME)</span></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize distributions</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>ax.boxplot([lp_africa, lp_europe], labels<span class="op">=</span>[<span class="st">'Africa'</span>, <span class="st">'Europe'</span>])</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Labor Productivity ($)'</span>)</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Labor Productivity Distribution by Region (2014)'</span>)</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>ax.grid(axis<span class="op">=</span><span class="st">'y'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Questions to consider:</strong></p>
<ul>
<li>Is the difference statistically significant?</li>
<li>How large is the productivity gap in dollar terms?</li>
<li>What does the box plot reveal about within-region variation?</li>
<li>Does the CI for the difference include zero? What does that mean?</li>
</ul>
<blockquote class="blockquote">
<p><strong>Key Concept 4.11: Economic vs Statistical Significance</strong></p>
<p>A result can be <strong>statistically significant</strong> (p &lt; 0.05) but <strong>economically trivial</strong>, or vice versa:</p>
<p><strong>Statistical significance</strong> answers: “Is this difference unlikely to be due to chance?” - Depends on sample size: larger samples detect smaller differences - Measured by p-value: probability of observing this result if H₀ is true - Standard: p &lt; 0.05 means &lt;5% chance of Type I error</p>
<p><strong>Economic significance</strong> answers: “Is this difference large enough to matter?” - Depends on context: a $1,000 productivity gap might be huge for low-income countries but trivial for high-income countries - Measured by effect size: actual magnitude of the difference - Judgment call: requires domain expertise</p>
<p><strong>Example:</strong> - With n=10,000 countries, a $100 productivity difference might be statistically significant (p&lt;0.001) but economically meaningless - With n=10 countries, a $10,000 difference might not be statistically significant (p=0.08) but could be economically important</p>
<p><strong>Best practice:</strong> Always report BOTH: 1. Statistical result: “We reject H₀ at α=0.05 (p=0.003)” 2. Economic interpretation: “The $15,000 productivity gap represents a 35% difference, which is economically substantial for development policy”</p>
</blockquote>
</section>
<section id="task-4-one-sided-test-for-growth-more-independent" class="level3">
<h3 class="anchored" data-anchor-id="task-4-one-sided-test-for-growth-more-independent">Task 4: One-Sided Test for Growth (MORE INDEPENDENT)</h3>
<p><strong>Learning Goal:</strong> Apply Section 4.6 (one-sided tests) to directional hypotheses</p>
<p><strong>Economic Question:</strong> “Can we conclude that mean global productivity in 2014 exceeds $50,000 (a policy benchmark)?”</p>
<p><strong>Your task:</strong></p>
<ol type="1">
<li>Test H₀: μ ≤ 50,000 vs Hₐ: μ &gt; 50,000</li>
<li>Use <code>scipy.stats.ttest_1samp()</code> with <code>alternative='greater'</code></li>
<li>Compare one-sided vs two-sided p-values</li>
<li>Discuss Type I error: what does α=0.05 mean in this context?</li>
</ol>
<p><strong>Outline (write your own code):</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: State hypotheses clearly</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co"># H₀: μ ≤ 50,000 (productivity does not exceed benchmark)</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Hₐ: μ &gt; 50,000 (productivity exceeds benchmark)</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Conduct one-sided t-test</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Use: stats.ttest_1samp(lp_2014, popmean=50000, alternative='greater')</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Calculate two-sided p-value for comparison</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Use: stats.ttest_1samp(lp_2014, popmean=50000, alternative='two-sided')</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Report results</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="co"># - Sample mean</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="co"># - t-statistic</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="co"># - One-sided p-value</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a><span class="co"># - Two-sided p-value</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a><span class="co"># - Decision at α=0.05</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Interpret Type I error</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a><span class="co"># If we reject H₀, what is the probability we made a mistake?</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Hint:</strong> Remember that for one-sided tests:</p>
<ul>
<li>If Hₐ: μ &gt; μ₀, use <code>alternative='greater'</code></li>
<li>The one-sided p-value is half the two-sided p-value (when t-stat has correct sign)</li>
<li>Type I error = rejecting H₀ when it’s actually true</li>
</ul>
<p><strong>Questions to consider:</strong></p>
<ul>
<li>Why is the one-sided p-value smaller than the two-sided p-value?</li>
<li>When is a one-sided test appropriate vs a two-sided test?</li>
<li>What are the policy implications if we reject H₀?</li>
</ul>
</section>
<section id="task-5-proportions-analysis---growth-winners-independent" class="level3">
<h3 class="anchored" data-anchor-id="task-5-proportions-analysis---growth-winners-independent">Task 5: Proportions Analysis - Growth Winners (INDEPENDENT)</h3>
<p><strong>Learning Goal:</strong> Apply Section 4.7 (proportions) to binary outcomes</p>
<p><strong>Economic Question:</strong> “What proportion of countries experienced productivity growth from 1990 to 2014, and can we conclude that more than half experienced growth?”</p>
<p><strong>Your task:</strong></p>
<ol type="1">
<li>Create country-level dataset with productivity in both 1990 and 2014</li>
<li>Create binary variable: <code>growth = 1</code> if productivity increased, <code>0</code> otherwise</li>
<li>Calculate sample proportion of “growth winners”</li>
<li>Construct 95% CI for population proportion using normal approximation</li>
<li>Test H₀: p = 0.50 vs Hₐ: p ≠ 0.50 (are half growth winners?)</li>
</ol>
<p><strong>Hints:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Hint 1: Reshape data to country-level</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co"># df_1990 = df.loc[df.index.get_level_values('year') == 1990, ['lp']]</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co"># df_2014 = df.loc[df.index.get_level_values('year') == 2014, ['lp']]</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge on country index</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Hint 2: Create binary growth indicator</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co"># growth = (lp_2014 &gt; lp_1990).astype(int)</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Hint 3: Proportions formulas from Section 4.7</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="co"># p_hat = np.mean(growth)</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="co"># se_p = np.sqrt(p_hat * (1 - p_hat) / n)</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="co"># CI: p_hat ± z_crit * se_p</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="co"># For 95% CI: z_crit = 1.96</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Hint 4: Test statistic for proportions</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a><span class="co"># z = (p_hat - p0) / np.sqrt(p0 * (1 - p0) / n)</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a><span class="co"># where p0 = 0.50 under H₀</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Questions to consider:</strong></p>
<ul>
<li>What proportion of countries experienced growth?</li>
<li>Does the 95% CI include 0.50? What does that mean?</li>
<li>Is there evidence that the proportion differs from 50%?</li>
<li>Which countries did NOT experience growth? (Bonus: investigate why)</li>
</ul>
</section>
<section id="task-6-multi-regional-hypothesis-testing-independent" class="level3">
<h3 class="anchored" data-anchor-id="task-6-multi-regional-hypothesis-testing-independent">Task 6: Multi-Regional Hypothesis Testing (INDEPENDENT)</h3>
<p><strong>Learning Goal:</strong> Integrate multiple inference methods in comprehensive analysis</p>
<p><strong>Economic Question:</strong> “Which regional pairs show statistically significant productivity gaps in 2014?”</p>
<p><strong>Your task:</strong></p>
<ol type="1">
<li>Identify all regions in the dataset (use <code>df_2014['region'].unique()</code>)</li>
<li>Calculate 95% CIs for mean productivity in each region</li>
<li>Conduct pairwise t-tests (Africa vs Europe, Africa vs Asia, Africa vs Americas, etc.)</li>
<li>Create a visualization showing CIs for all regions (error bar plot)</li>
<li>Discuss the <strong>multiple testing problem</strong>: when conducting many tests, what happens to Type I error?</li>
</ol>
<p><strong>Challenge goals (minimal guidance):</strong></p>
<ul>
<li>Design your own analysis structure</li>
<li>Use loops to avoid repetitive code</li>
<li>Create professional visualizations</li>
<li>Write clear economic interpretations</li>
</ul>
<p><strong>Suggested approach:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Get all regions and calculate summary stats</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co"># For each region: mean, std, se, 95% CI</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Store in a DataFrame or dictionary</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Conduct all pairwise tests</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Use itertools.combinations() to generate pairs</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co"># For each pair: run ttest_ind(), store t-stat and p-value</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Visualize CIs</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create error bar plot: plt.errorbar()</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Or bar plot with CI whiskers</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Report significant differences</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Which pairs have p &lt; 0.05?</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a><span class="co"># What is the magnitude of differences?</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Discuss multiple testing</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a><span class="co"># If you run 10 tests at α=0.05, what's the probability of at least one false positive?</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Consider Bonferroni correction: α_adjusted = 0.05 / number_of_tests</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Questions to consider:</strong></p>
<ul>
<li>Which region has the highest mean productivity? Lowest?</li>
<li>Are all pairwise differences statistically significant?</li>
<li>How does the multiple testing problem affect your conclusions?</li>
<li>What economic factors might explain regional productivity gaps?</li>
</ul>
</section>
<section id="what-youve-learned" class="level3">
<h3 class="anchored" data-anchor-id="what-youve-learned">What You’ve Learned</h3>
<p>By completing this case study, you’ve practiced <strong>all the major skills from Chapter 4</strong>:</p>
<p><strong>Statistical Methods:</strong> - Constructed confidence intervals (90%, 95%, 99%) for population means - Conducted two-sided hypothesis tests to compare groups and time periods - Performed one-sided directional tests for benchmark comparisons - Applied proportions inference to binary economic outcomes - Calculated and interpreted t-statistics, p-values, and margins of error - Used both manual calculations and <code>scipy.stats</code> functions</p>
<p><strong>Economic Applications:</strong> - Tested convergence hypotheses (did productivity gaps narrow over time?) - Compared regional development levels (Africa, Europe, Asia, Americas) - Evaluated policy benchmarks (does productivity exceed thresholds?) - Identified “growth winners” and “growth losers” among countries - Distinguished between statistical and economic significance</p>
<p><strong>Programming Skills:</strong> - Filtered and reshaped panel data (multi-index DataFrames) - Implemented statistical tests with <code>scipy.stats</code> - Created informative visualizations (box plots, error bars) - Wrote clear, reproducible analysis code</p>
<p><strong>Critical Thinking:</strong> - Formulated null and alternative hypotheses from economic questions - Interpreted p-values in context (not just “significant” vs “not significant”) - Connected statistical results to economic meaning and policy implications - Recognized limitations (Type I/II errors, multiple testing problem)</p>
<hr>
<p><strong>Next steps:</strong></p>
<p>These skills form the foundation for more advanced methods in later chapters: - <strong>Chapter 5:</strong> Regression analysis (relationship between two variables) - <strong>Chapter 6:</strong> Multiple regression (controlling for confounders) - <strong>Chapter 7:</strong> Hypothesis tests in regression models</p>
<p>Statistical inference is everywhere in empirical economics. You’ve now mastered the core toolkit for: - Quantifying uncertainty - Testing economic theories - Making data-driven decisions - Communicating results with precision</p>
<p><strong>Well done!</strong></p>
</section>
<section id="case-study-2-is-bolivias-development-equal-testing-differences-across-departments" class="level3">
<h3 class="anchored" data-anchor-id="case-study-2-is-bolivias-development-equal-testing-differences-across-departments">Case Study 2: Is Bolivia’s Development Equal? Testing Differences Across Departments</h3>
<p><strong>Research Question</strong>: Are there statistically significant differences in development levels across Bolivia’s nine departments?</p>
<p>In Chapter 1, we introduced the DS4Bolivia project and explored satellite-development relationships across Bolivia’s 339 municipalities. In this case study, we apply Chapter 4’s statistical inference tools—confidence intervals and hypothesis tests—to test whether development levels differ significantly across Bolivia’s departments.</p>
<p><strong>The Data</strong>: Cross-sectional dataset covering 339 Bolivian municipalities from the <a href="https://github.com/quarcs-lab/ds4bolivia">DS4Bolivia Project</a>, including:</p>
<ul>
<li><strong>Development outcomes</strong>: Municipal Sustainable Development Index (IMDS, 0-100 composite)</li>
<li><strong>Satellite data</strong>: Log nighttime lights per capita (2017)</li>
<li><strong>Demographics</strong>: Population (2017), municipality and department names</li>
</ul>
<p><strong>Your Task</strong>: Use confidence intervals, one-sample tests, two-sample tests, and one-sided tests to evaluate whether Bolivia’s departments differ significantly in development—and whether those differences are large enough to matter for policy.</p>
<section id="load-the-ds4bolivia-data" class="level4">
<h4 class="anchored" data-anchor-id="load-the-ds4bolivia-data">Load the DS4Bolivia Data</h4>
<p>Let’s load the DS4Bolivia dataset and prepare the key variables for statistical inference.</p>
<div id="cell-68" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the DS4Bolivia dataset</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>url_bol <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/quarcs-lab/ds4bolivia/master/ds4bolivia_v20250523.csv"</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>bol <span class="op">=</span> pd.read_csv(url_bol)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Select key variables for this case study</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>key_vars <span class="op">=</span> [<span class="st">'mun'</span>, <span class="st">'dep'</span>, <span class="st">'imds'</span>, <span class="st">'ln_NTLpc2017'</span>, <span class="st">'pop2017'</span>]</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>bol_key <span class="op">=</span> bol[key_vars].dropna().copy()</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"DS4BOLIVIA DATASET — STATISTICAL INFERENCE CASE STUDY"</span>)</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Municipalities: </span><span class="sc">{</span><span class="bu">len</span>(bol_key)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Departments:    </span><span class="sc">{</span>bol_key[<span class="st">'dep'</span>]<span class="sc">.</span>nunique()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">IMDS summary:"</span>)</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(bol_key[<span class="st">'imds'</span>].describe().<span class="bu">round</span>(<span class="dv">2</span>))</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Municipalities per department:"</span>)</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(bol_key[<span class="st">'dep'</span>].value_counts().sort_index())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="task-1-confidence-interval-for-mean-imds-guided" class="level4">
<h4 class="anchored" data-anchor-id="task-1-confidence-interval-for-mean-imds-guided">Task 1: Confidence Interval for Mean IMDS (Guided)</h4>
<p><strong>Learning Goal</strong>: Apply Section 4.3 methods to calculate and interpret a confidence interval for a population mean.</p>
<p><strong>Economic Question</strong>: “What is the true average development level across all Bolivian municipalities?”</p>
<p><strong>Instructions</strong>:</p>
<ol type="1">
<li>Calculate the sample mean and standard error of <code>imds</code></li>
<li>Construct a 95% confidence interval using <code>scipy.stats.t.interval()</code></li>
<li>Print the sample mean, standard error, and CI bounds</li>
<li>Interpret the result: “We are 95% confident that the true mean municipal development index lies between X and Y.”</li>
</ol>
<p><strong>Apply what you learned in Section 4.3</strong>: The formula is <span class="math inline">\(\bar{x} \pm t_{\alpha/2} \times SE\)</span>, where <span class="math inline">\(SE = s/\sqrt{n}\)</span>.</p>
<div id="cell-70" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Your code here: 95% Confidence Interval for national mean IMDS</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate sample statistics</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="bu">len</span>(bol_key[<span class="st">'imds'</span>])</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>x_bar <span class="op">=</span> bol_key[<span class="st">'imds'</span>].mean()</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>se <span class="op">=</span> bol_key[<span class="st">'imds'</span>].std() <span class="op">/</span> np.sqrt(n)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 95% confidence interval using t-distribution</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>ci_low, ci_high <span class="op">=</span> stats.t.interval(<span class="fl">0.95</span>, df<span class="op">=</span>n<span class="op">-</span><span class="dv">1</span>, loc<span class="op">=</span>x_bar, scale<span class="op">=</span>se)</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"95% CONFIDENCE INTERVAL FOR MEAN IMDS"</span>)</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sample size (n):       </span><span class="sc">{</span>n<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sample mean:           </span><span class="sc">{</span>x_bar<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Standard error:        </span><span class="sc">{</span>se<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"95% CI:                [</span><span class="sc">{</span>ci_low<span class="sc">:.4f}</span><span class="ss">, </span><span class="sc">{</span>ci_high<span class="sc">:.4f}</span><span class="ss">]"</span>)</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Interpretation: We are 95% confident that the true mean"</span>)</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"municipal development index lies between </span><span class="sc">{</span>ci_low<span class="sc">:.2f}</span><span class="ss"> and </span><span class="sc">{</span>ci_high<span class="sc">:.2f}</span><span class="ss">."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="task-2-hypothesis-test-national-development-target-guided" class="level4">
<h4 class="anchored" data-anchor-id="task-2-hypothesis-test-national-development-target-guided">Task 2: Hypothesis Test — National Development Target (Guided)</h4>
<p><strong>Learning Goal</strong>: Apply Section 4.4 (two-sided test) to test a hypothesis about a population mean.</p>
<p><strong>Economic Question</strong>: “Is the average municipality at the midpoint of the development scale?”</p>
<p>A natural benchmark for the IMDS (which ranges from 0 to 100) is the midpoint of 50. If Bolivia’s municipalities were, on average, at this midpoint, we would expect <span class="math inline">\(\mu_{IMDS} = 50\)</span>.</p>
<p><strong>Instructions</strong>:</p>
<ol type="1">
<li>State the hypotheses: <span class="math inline">\(H_0: \mu = 50\)</span> vs <span class="math inline">\(H_1: \mu \neq 50\)</span></li>
<li>Use <code>scipy.stats.ttest_1samp()</code> to conduct the test</li>
<li>Report the t-statistic and p-value</li>
<li>State your conclusion at <span class="math inline">\(\alpha = 0.05\)</span></li>
<li>Discuss: Is the average municipality at the midpoint of the development scale?</li>
</ol>
<div id="cell-72" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Your code here: One-sample t-test — is mean IMDS = 50?</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Hypothesis test: H0: mu = 50 vs H1: mu != 50</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>t_stat, p_value <span class="op">=</span> stats.ttest_1samp(bol_key[<span class="st">'imds'</span>], popmean<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"HYPOTHESIS TEST: IS MEAN IMDS = 50?"</span>)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"H₀: μ = 50  vs  H₁: μ ≠ 50"</span>)</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Sample mean:   </span><span class="sc">{</span>bol_key[<span class="st">'imds'</span>]<span class="sc">.</span>mean()<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"t-statistic:   </span><span class="sc">{</span>t_stat<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"p-value:       </span><span class="sc">{</span>p_value<span class="sc">:.6f}</span><span class="ss">"</span>)</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Conclusion at α = 0.05:"</span>)</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> p_value <span class="op">&lt;</span> <span class="fl">0.05</span>:</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  Reject H₀ (p = </span><span class="sc">{</span>p_value<span class="sc">:.6f}</span><span class="ss"> &lt; 0.05)"</span>)</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  The average IMDS is significantly different from 50."</span>)</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  Fail to reject H₀ (p = </span><span class="sc">{</span>p_value<span class="sc">:.6f}</span><span class="ss"> ≥ 0.05)"</span>)</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  No significant evidence that mean IMDS differs from 50."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<blockquote class="blockquote">
<p><strong>Key Concept 4.12: Statistical Significance in Development</strong></p>
<p>A statistically significant difference between departments does not automatically imply a <strong>policy-relevant</strong> gap. With 339 municipalities providing large sample sizes, even small differences can achieve statistical significance. Policy makers must evaluate the <strong>magnitude</strong> of differences alongside p-values. A 2-point difference in IMDS may be statistically significant but practically negligible for resource allocation decisions.</p>
</blockquote>
</section>
<section id="task-3-department-level-inference-semi-guided" class="level4">
<h4 class="anchored" data-anchor-id="task-3-department-level-inference-semi-guided">Task 3: Department-Level Inference (Semi-guided)</h4>
<p><strong>Learning Goal</strong>: Apply confidence intervals to compare subgroups.</p>
<p><strong>Economic Question</strong>: “Which departments have significantly different development levels from one another?”</p>
<p><strong>Instructions</strong>:</p>
<ol type="1">
<li>Calculate the 95% confidence interval for mean <code>imds</code> in each of Bolivia’s 9 departments</li>
<li>Create a <strong>forest plot</strong> (horizontal error bars) showing the CI for each department</li>
<li>Identify which departments’ CIs overlap (suggesting no significant difference) and which don’t</li>
<li>Discuss what the pattern reveals about regional inequality</li>
</ol>
<p><strong>Hint</strong>: Use <code>groupby('dep')</code> to calculate department-level statistics, then <code>plt.errorbar()</code> or <code>plt.barh()</code> with error bars for the forest plot.</p>
<div id="cell-75" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Your code here: Department-level 95% CIs and forest plot</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate department-level statistics</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>dept_stats <span class="op">=</span> bol_key.groupby(<span class="st">'dep'</span>)[<span class="st">'imds'</span>].agg([<span class="st">'mean'</span>, <span class="st">'std'</span>, <span class="st">'count'</span>]).sort_values(<span class="st">'mean'</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>dept_stats[<span class="st">'se'</span>] <span class="op">=</span> dept_stats[<span class="st">'std'</span>] <span class="op">/</span> np.sqrt(dept_stats[<span class="st">'count'</span>])</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>dept_stats[<span class="st">'ci_low'</span>] <span class="op">=</span> dept_stats[<span class="st">'mean'</span>] <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> dept_stats[<span class="st">'se'</span>]</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>dept_stats[<span class="st">'ci_high'</span>] <span class="op">=</span> dept_stats[<span class="st">'mean'</span>] <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> dept_stats[<span class="st">'se'</span>]</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"95% CONFIDENCE INTERVALS FOR MEAN IMDS BY DEPARTMENT"</span>)</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dept_stats[[<span class="st">'mean'</span>, <span class="st">'se'</span>, <span class="st">'ci_low'</span>, <span class="st">'ci_high'</span>, <span class="st">'count'</span>]].<span class="bu">round</span>(<span class="dv">2</span>).to_string())</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Forest plot</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>departments <span class="op">=</span> dept_stats.index</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>y_pos <span class="op">=</span> <span class="bu">range</span>(<span class="bu">len</span>(departments))</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>ax.errorbar(dept_stats[<span class="st">'mean'</span>], y_pos,</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>            xerr<span class="op">=</span><span class="fl">1.96</span> <span class="op">*</span> dept_stats[<span class="st">'se'</span>],</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>            fmt<span class="op">=</span><span class="st">'o'</span>, color<span class="op">=</span><span class="st">'navy'</span>, capsize<span class="op">=</span><span class="dv">5</span>, capthick<span class="op">=</span><span class="fl">1.5</span>, markersize<span class="op">=</span><span class="dv">6</span>)</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>ax.set_yticks(y_pos)</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>ax.set_yticklabels(departments)</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Mean IMDS (with 95% CI)'</span>)</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Forest Plot: Municipal Development by Department'</span>)</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>ax.axvline(x<span class="op">=</span>bol_key[<span class="st">'imds'</span>].mean(), color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, label<span class="op">=</span><span class="st">'National mean'</span>)</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>ax.grid(axis<span class="op">=</span><span class="st">'x'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="task-4-one-sided-test-is-the-capital-department-more-developed-semi-guided" class="level4">
<h4 class="anchored" data-anchor-id="task-4-one-sided-test-is-the-capital-department-more-developed-semi-guided">Task 4: One-Sided Test — Is the Capital Department More Developed? (Semi-guided)</h4>
<p><strong>Learning Goal</strong>: Apply Section 4.6 (one-sided tests) to a directional hypothesis.</p>
<p><strong>Economic Question</strong>: “Is La Paz department’s mean IMDS significantly greater than the national mean?”</p>
<p><strong>Instructions</strong>:</p>
<ol type="1">
<li>Extract IMDS values for La Paz department</li>
<li>Test <span class="math inline">\(H_0: \mu_{LP} \leq \mu_{national}\)</span> vs <span class="math inline">\(H_1: \mu_{LP} &gt; \mu_{national}\)</span> using a one-sided t-test</li>
<li>Calculate the one-sided p-value (divide the two-sided p-value by 2, checking direction)</li>
<li>Report and interpret the result at <span class="math inline">\(\alpha = 0.05\)</span></li>
<li>Discuss: Is the capital department significantly more developed?</li>
</ol>
<p><strong>Hint</strong>: Use <code>scipy.stats.ttest_1samp()</code> with the national mean as the test value, then adjust for a one-sided test.</p>
<div id="cell-77" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Your code here: One-sided t-test for La Paz department</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract La Paz IMDS values</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>la_paz <span class="op">=</span> bol_key[bol_key[<span class="st">'dep'</span>] <span class="op">==</span> <span class="st">'La Paz'</span>][<span class="st">'imds'</span>]</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>national_mean <span class="op">=</span> bol_key[<span class="st">'imds'</span>].mean()</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Two-sided test first</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>t_stat_lp, p_two <span class="op">=</span> stats.ttest_1samp(la_paz, popmean<span class="op">=</span>national_mean)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="co"># One-sided p-value: H1: mu_LP &gt; national_mean</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="co"># If t &gt; 0, one-sided p = p_two / 2; if t &lt; 0, one-sided p = 1 - p_two / 2</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>p_one <span class="op">=</span> p_two <span class="op">/</span> <span class="dv">2</span> <span class="cf">if</span> t_stat_lp <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="dv">1</span> <span class="op">-</span> p_two <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"ONE-SIDED TEST: LA PAZ &gt; NATIONAL MEAN?"</span>)</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"H₀: μ_LaPaz ≤ </span><span class="sc">{</span>national_mean<span class="sc">:.2f}</span><span class="ss">  vs  H₁: μ_LaPaz &gt; </span><span class="sc">{</span>national_mean<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">La Paz municipalities:  </span><span class="sc">{</span><span class="bu">len</span>(la_paz)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"La Paz mean IMDS:       </span><span class="sc">{</span>la_paz<span class="sc">.</span>mean()<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"National mean IMDS:     </span><span class="sc">{</span>national_mean<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"t-statistic:            </span><span class="sc">{</span>t_stat_lp<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"One-sided p-value:      </span><span class="sc">{</span>p_one<span class="sc">:.6f}</span><span class="ss">"</span>)</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Conclusion at α = 0.05:"</span>)</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> p_one <span class="op">&lt;</span> <span class="fl">0.05</span>:</span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  Reject H₀ (p = </span><span class="sc">{</span>p_one<span class="sc">:.6f}</span><span class="ss"> &lt; 0.05)"</span>)</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  La Paz's mean IMDS is significantly greater than the national mean."</span>)</span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  Fail to reject H₀ (p = </span><span class="sc">{</span>p_one<span class="sc">:.6f}</span><span class="ss"> ≥ 0.05)"</span>)</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  No significant evidence that La Paz exceeds the national mean."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<blockquote class="blockquote">
<p><strong>Key Concept 4.13: Subnational Inference Challenges</strong></p>
<p>When testing hypotheses about departmental means, each department contains a different number of municipalities (ranging from ~10 to ~50+). Departments with fewer municipalities have <strong>wider confidence intervals</strong> and less statistical power. This means we may fail to detect real differences for smaller departments—not because the differences don’t exist, but because we lack sufficient data to establish them conclusively.</p>
</blockquote>
</section>
<section id="task-5-comparing-two-departments-independent" class="level4">
<h4 class="anchored" data-anchor-id="task-5-comparing-two-departments-independent">Task 5: Comparing Two Departments (Independent)</h4>
<p><strong>Learning Goal</strong>: Apply two-sample t-tests to compare group means.</p>
<p><strong>Economic Question</strong>: “Is the development gap between the most and least developed departments statistically significant?”</p>
<p><strong>Instructions</strong>:</p>
<ol type="1">
<li>Identify the departments with the highest and lowest mean IMDS (from Task 3 results)</li>
<li>Use <code>scipy.stats.ttest_ind()</code> to perform a two-sample t-test comparing these departments</li>
<li>Report the t-statistic and p-value</li>
<li>Discuss both <strong>statistical significance</strong> (p-value) and <strong>practical significance</strong> (magnitude of the gap)</li>
<li>What does this tell us about regional inequality in Bolivia?</li>
</ol>
<div id="cell-80" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Your code here: Two-sample t-test — highest vs lowest IMDS department</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify highest and lowest departments</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>dept_means <span class="op">=</span> bol_key.groupby(<span class="st">'dep'</span>)[<span class="st">'imds'</span>].mean()</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>top_dept <span class="op">=</span> dept_means.idxmax()</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>bot_dept <span class="op">=</span> dept_means.idxmin()</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract IMDS values for each</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>top_values <span class="op">=</span> bol_key[bol_key[<span class="st">'dep'</span>] <span class="op">==</span> top_dept][<span class="st">'imds'</span>]</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>bot_values <span class="op">=</span> bol_key[bol_key[<span class="st">'dep'</span>] <span class="op">==</span> bot_dept][<span class="st">'imds'</span>]</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Two-sample t-test</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>t_stat_2s, p_value_2s <span class="op">=</span> stats.ttest_ind(top_values, bot_values)</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"TWO-SAMPLE T-TEST: </span><span class="sc">{</span>top_dept<span class="sc">.</span>upper()<span class="sc">}</span><span class="ss"> vs </span><span class="sc">{</span>bot_dept<span class="sc">.</span>upper()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Highest IMDS department: </span><span class="sc">{</span>top_dept<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Mean IMDS:   </span><span class="sc">{</span>top_values<span class="sc">.</span>mean()<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  N:           </span><span class="sc">{</span><span class="bu">len</span>(top_values)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Lowest IMDS department:  </span><span class="sc">{</span>bot_dept<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Mean IMDS:   </span><span class="sc">{</span>bot_values<span class="sc">.</span>mean()<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  N:           </span><span class="sc">{</span><span class="bu">len</span>(bot_values)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Difference in means:    </span><span class="sc">{</span>top_values<span class="sc">.</span>mean() <span class="op">-</span> bot_values<span class="sc">.</span>mean()<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"t-statistic:            </span><span class="sc">{</span>t_stat_2s<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"p-value:                </span><span class="sc">{</span>p_value_2s<span class="sc">:.6f}</span><span class="ss">"</span>)</span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Conclusion at α = 0.05:"</span>)</span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> p_value_2s <span class="op">&lt;</span> <span class="fl">0.05</span>:</span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  Reject H₀ (p = </span><span class="sc">{</span>p_value_2s<span class="sc">:.6f}</span><span class="ss"> &lt; 0.05)"</span>)</span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  The development gap of </span><span class="sc">{</span>top_values<span class="sc">.</span>mean() <span class="op">-</span> bot_values<span class="sc">.</span>mean()<span class="sc">:.2f}</span><span class="ss"> points is statistically significant."</span>)</span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  Fail to reject H₀ (p = </span><span class="sc">{</span>p_value_2s<span class="sc">:.6f}</span><span class="ss"> ≥ 0.05)"</span>)</span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  No significant evidence of a development gap."</span>)</span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Practical significance: A gap of </span><span class="sc">{</span>top_values<span class="sc">.</span>mean() <span class="op">-</span> bot_values<span class="sc">.</span>mean()<span class="sc">:.2f}</span><span class="ss"> points on a 0-100 scale"</span>)</span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"represents a </span><span class="sc">{</span><span class="st">'substantial'</span> <span class="cf">if</span> <span class="bu">abs</span>(top_values.mean() <span class="op">-</span> bot_values.mean()) <span class="op">&gt;</span> <span class="dv">10</span> <span class="cf">else</span> <span class="st">'modest'</span><span class="sc">}</span><span class="ss"> difference in development outcomes."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="task-6-policy-brief-on-regional-inequality-independent" class="level4">
<h4 class="anchored" data-anchor-id="task-6-policy-brief-on-regional-inequality-independent">Task 6: Policy Brief on Regional Inequality (Independent)</h4>
<p><strong>Objective</strong>: Write a 200-300 word policy brief summarizing your statistical findings.</p>
<p><strong>Your brief should address</strong>:</p>
<ol type="1">
<li><strong>Are departmental differences statistically significant?</strong> Summarize results from Tasks 3-5.</li>
<li><strong>Which departments need the most attention?</strong> Use the forest plot and CI analysis to identify lagging regions.</li>
<li><strong>How confident are we in these conclusions?</strong> Discuss the confidence levels and what the CIs tell us.</li>
<li><strong>What are the limitations of these tests?</strong> Consider sample sizes, assumptions, and what the tests cannot tell us.</li>
</ol>
<p><strong>Format</strong>: Write your brief in the markdown cell below. Support your arguments with specific numbers from your analysis (means, CIs, p-values).</p>
<p><strong>Tip</strong>: Remember Key Concepts 4.12 and 4.13—distinguish between statistical significance and policy relevance, and consider how unequal sample sizes affect your conclusions.</p>
<div id="cell-82" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Your code here: Additional analysis to support your policy brief</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Suggestions:</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Create a summary table of all department CIs and test results</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Calculate effect sizes (Cohen's d) for the two-sample comparison</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Visualize the national IMDS distribution with department means marked</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: Summary statistics for the policy brief</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"SUMMARY TABLE FOR POLICY BRIEF"</span>)</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>dept_summary <span class="op">=</span> bol_key.groupby(<span class="st">'dep'</span>)[<span class="st">'imds'</span>].agg([<span class="st">'mean'</span>, <span class="st">'std'</span>, <span class="st">'count'</span>]).sort_values(<span class="st">'mean'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>dept_summary[<span class="st">'se'</span>] <span class="op">=</span> dept_summary[<span class="st">'std'</span>] <span class="op">/</span> np.sqrt(dept_summary[<span class="st">'count'</span>])</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>dept_summary[<span class="st">'ci_95'</span>] <span class="op">=</span> dept_summary.<span class="bu">apply</span>(</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">lambda</span> r: <span class="ss">f"[</span><span class="sc">{</span>r[<span class="st">'mean'</span>] <span class="op">-</span> <span class="fl">1.96</span><span class="op">*</span>r[<span class="st">'se'</span>]<span class="sc">:.1f}</span><span class="ss">, </span><span class="sc">{</span>r[<span class="st">'mean'</span>] <span class="op">+</span> <span class="fl">1.96</span><span class="op">*</span>r[<span class="st">'se'</span>]<span class="sc">:.1f}</span><span class="ss">]"</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dept_summary[[<span class="st">'mean'</span>, <span class="st">'std'</span>, <span class="st">'count'</span>, <span class="st">'ci_95'</span>]].<span class="bu">round</span>(<span class="dv">2</span>).to_string())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="what-youve-learned-from-this-case-study" class="level4">
<h4 class="anchored" data-anchor-id="what-youve-learned-from-this-case-study">What You’ve Learned from This Case Study</h4>
<p>Through this analysis of subnational development in Bolivia, you’ve applied the full Chapter 4 statistical inference toolkit:</p>
<ul>
<li><strong>Confidence intervals</strong> for mean development levels</li>
<li><strong>One-sample and two-sample hypothesis tests</strong> to evaluate development benchmarks and compare groups</li>
<li><strong>One-sided tests</strong> for directional hypotheses about specific departments</li>
<li><strong>Forest plots</strong> for comparing group CIs visually</li>
<li><strong>Statistical vs practical significance</strong> in a policy context</li>
<li><strong>Critical thinking</strong> about sample size, statistical power, and inference limitations</li>
</ul>
<p><strong>Connection to research</strong>: The DS4Bolivia project uses these same statistical tools to evaluate whether satellite-predicted development indicators are significantly different from survey-based measures, providing evidence for the reliability of remote sensing approaches to SDG monitoring.</p>
<p><strong>Looking ahead</strong>: In Chapter 5, we’ll move beyond testing means to exploring <em>bivariate relationships</em>—how nighttime lights relate to specific development outcomes across Bolivia’s municipalities.</p>
<hr>
<p><strong>Well done!</strong> You’ve now tested development hypotheses for both cross-country convergence and Bolivian regional inequality using the tools of statistical inference.</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../book/../notebooks_colab/ch03_The_Sample_Mean.html" class="pagination-link" aria-label="Chapter 3: The Sample Mean">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Chapter 3: The Sample Mean</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../book/../notebooks_colab/ch05_Bivariate_Data_Summary.html" class="pagination-link" aria-label="Chapter 5: Bivariate Data Summary">
        <span class="nav-page-text"><span class="chapter-title">Chapter 5: Bivariate Data Summary</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>