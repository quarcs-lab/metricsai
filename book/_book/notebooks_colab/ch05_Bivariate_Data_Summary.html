<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>5. Bivariate Data Summary ‚Äì Econometrics Powered by AI</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../notebooks_colab/ch06_The_Least_Squares_Estimator.html" rel="next">
<link href="../notebooks_colab/ch04_Statistical_Inference_for_the_Mean.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-8b4baf804e461d9b72633f0de59a0cac.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-f1aadacce99040138bbb613f9330654f.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-0da87e08732b0aad79cc276a1be62fe2.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-c77ee8f8b07d41e0e364fbf0a2ddebb9.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../custom.css">
</head>

<body class="nav-sidebar floating quarto-dark"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = true;
    const darkModeDefault = authorPrefersDark;
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../notebooks_colab/ch05_Bivariate_Data_Summary.html">Bivariate Regression</a></li><li class="breadcrumb-item"><a href="../notebooks_colab/ch05_Bivariate_Data_Summary.html"><span class="chapter-title">5. Bivariate Data Summary</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Econometrics Powered by AI</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Statistical Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch01_Analysis_of_Economics_Data.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">1. Analysis of Economics Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch02_Univariate_Data_Summary.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">2. Univariate Data Summary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch03_The_Sample_Mean.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">3. The Sample Mean</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch04_Statistical_Inference_for_the_Mean.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">4. Statistical Inference for the Mean</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Bivariate Regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch05_Bivariate_Data_Summary.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">5. Bivariate Data Summary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch06_The_Least_Squares_Estimator.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">6. The Least Squares Estimator</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch07_Statistical_Inference_for_Bivariate_Regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">7. Statistical Inference for Bivariate Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch08_Case_Studies_for_Bivariate_Regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">8. Case Studies for Bivariate Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch09_Models_with_Natural_Logarithms.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">9. Models with Natural Logarithms</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Multiple Regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch10_Data_Summary_for_Multiple_Regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">10. Data Summary for Multiple Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch11_Statistical_Inference_for_Multiple_Regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">11. Statistical Inference for Multiple Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch12_Further_Topics_in_Multiple_Regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">12. Further Topics in Multiple Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch13_Case_Studies_for_Multiple_Regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">13. Case Studies for Multiple Regression</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Advanced Topics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch14_Regression_with_Indicator_Variables.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">14. Regression with Indicator Variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch15_Regression_with_Transformed_Variables.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">15. Regression with Transformed Variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch16_Checking_the_Model_and_Data.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">16. Checking the Model and Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch17_Panel_Data_Time_Series_Data_Causation.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">17. Panel Data, Time Series Data, Causation</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul class="collapse">
  <li><a href="#chapter-overview" id="toc-chapter-overview" class="nav-link active" data-scroll-target="#chapter-overview">Chapter Overview</a></li>
  <li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#example---house-price-and-size" id="toc-example---house-price-and-size" class="nav-link" data-scroll-target="#example---house-price-and-size">5.1 Example - House Price and Size</a></li>
  <li><a href="#two-way-tabulation" id="toc-two-way-tabulation" class="nav-link" data-scroll-target="#two-way-tabulation">5.2 Two-Way Tabulation</a></li>
  <li><a href="#two-way-scatter-plot" id="toc-two-way-scatter-plot" class="nav-link" data-scroll-target="#two-way-scatter-plot">5.3 Two-Way Scatter Plot</a></li>
  <li><a href="#sample-correlation" id="toc-sample-correlation" class="nav-link" data-scroll-target="#sample-correlation">5.4 Sample Correlation</a></li>
  <li><a href="#regression-line" id="toc-regression-line" class="nav-link" data-scroll-target="#regression-line">5.5 Regression Line</a></li>
  <li><a href="#measures-of-model-fit" id="toc-measures-of-model-fit" class="nav-link" data-scroll-target="#measures-of-model-fit">5.6 Measures of Model Fit</a></li>
  <li><a href="#computer-output-following-regression" id="toc-computer-output-following-regression" class="nav-link" data-scroll-target="#computer-output-following-regression">5.7 Computer Output Following Regression</a></li>
  <li><a href="#prediction-and-outliers" id="toc-prediction-and-outliers" class="nav-link" data-scroll-target="#prediction-and-outliers">5.8 Prediction and Outliers</a></li>
  <li><a href="#regression-and-correlation" id="toc-regression-and-correlation" class="nav-link" data-scroll-target="#regression-and-correlation">5.9 Regression and Correlation</a></li>
  <li><a href="#causation" id="toc-causation" class="nav-link" data-scroll-target="#causation">5.10 Causation</a></li>
  <li><a href="#nonparametric-regression" id="toc-nonparametric-regression" class="nav-link" data-scroll-target="#nonparametric-regression">5.11 Nonparametric Regression</a></li>
  <li><a href="#key-takeaways" id="toc-key-takeaways" class="nav-link" data-scroll-target="#key-takeaways">Key Takeaways</a></li>
  <li><a href="#practice-exercises" id="toc-practice-exercises" class="nav-link" data-scroll-target="#practice-exercises">Practice Exercises</a></li>
  <li><a href="#case-studies" id="toc-case-studies" class="nav-link" data-scroll-target="#case-studies">Case Studies</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<div id="google_translate_element" style="padding: 8px 0;"></div>
<script type="text/javascript">
function googleTranslateElementInit() {
  new google.translate.TranslateElement({
    pageLanguage: 'en',
    layout: google.translate.TranslateElement.InlineLayout.HORIZONTAL
  }, 'google_translate_element');
}
</script>
<script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../notebooks_colab/ch05_Bivariate_Data_Summary.html">Bivariate Regression</a></li><li class="breadcrumb-item"><a href="../notebooks_colab/ch05_Bivariate_Data_Summary.html"><span class="chapter-title">5. Bivariate Data Summary</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-title">5. Bivariate Data Summary</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><strong>metricsAI: An Introduction to Econometrics with Python and AI in the Cloud</strong></p>
<p><em><a href="https://carlos-mendez.org">Carlos Mendez</a></em></p>
<p><img src="https://raw.githubusercontent.com/quarcs-lab/metricsai/main/images/ch05_visual_summary.jpg" alt="Chapter 05 Visual Summary" width="65%"></p>
<p>This notebook provides an interactive introduction to bivariate data analysis and simple linear regression using Python. You‚Äôll learn how to summarize relationships between two variables using correlation, scatter plots, and regression analysis. All code runs directly in Google Colab without any local setup.</p>
<a href="https://colab.research.google.com/github/quarcs-lab/metricsai/blob/main/notebooks_colab/ch05_Bivariate_Data_Summary.ipynb"><img src="https://colab.research.google.com/assets/colab-badge.svg" class="img-fluid" alt="Open In Colab"></a>
<div class="chapter-resources">
<p><a href="https://www.youtube.com/watch?v=sVT1KfjoZQg" target="_blank" class="resource-btn">üé¨ AI Video</a> <a href="https://carlos-mendez.my.canva.site/s05-bivariate-data-summary-pdf" target="_blank" class="resource-btn">‚ú® AI Slides</a> <a href="https://cameron.econ.ucdavis.edu/aed/traedv1_05" target="_blank" class="resource-btn">üìä Cameron Slides</a> <a href="https://app.edcafe.ai/quizzes/697865de2f5d08069e0482cc" target="_blank" class="resource-btn">‚úèÔ∏è Quiz</a> <a href="https://app.edcafe.ai/chatbots/69789e4c2f5d08069e0704c6" target="_blank" class="resource-btn">ü§ñ AI Tutor</a></p>
</div>
<section id="chapter-overview" class="level2">
<h2 class="anchored" data-anchor-id="chapter-overview">Chapter Overview</h2>
<p><strong>Bivariate data</strong> involves observations on two variables‚Äîfor example, house prices and house sizes, or income and education. This chapter teaches you how to summarize and analyze relationships between two variables using correlation and regression.</p>
<p><strong>What you‚Äôll learn:</strong></p>
<ul>
<li>Summarize bivariate relationships using two-way tabulations and scatterplots</li>
<li>Calculate and interpret correlation coefficients and understand their relationship to covariance</li>
<li>Estimate and interpret regression lines using ordinary least squares (OLS)</li>
<li>Evaluate model fit using R-squared, standard error, and variation decomposition</li>
<li>Make predictions and identify outliers in regression analysis</li>
<li>Understand the critical distinction between association and causation</li>
<li>Apply nonparametric regression methods to check linearity assumptions</li>
</ul>
<p><strong>Datasets used:</strong></p>
<ul>
<li><strong>AED_HOUSE.DTA</strong>: House prices and characteristics for 29 houses sold in Central Davis, California in 1999 (price, size, bedrooms, bathrooms, lot size, age)</li>
</ul>
<p><strong>Chapter outline:</strong></p>
<ul>
<li>5.1 Example - House Price and Size</li>
<li>5.2 Two-Way Tabulation</li>
<li>5.3 Two-Way Scatter Plot</li>
<li>5.4 Sample Correlation</li>
<li>5.5 Regression Line</li>
<li>5.6 Measures of Model Fit</li>
<li>5.7 Computer Output Following Regression</li>
<li>5.8 Prediction and Outlying Observations</li>
<li>5.9 Regression and Correlation</li>
<li>5.10 Causation</li>
<li>5.11 Nonparametric Regression</li>
</ul>
</section>
<section id="setup" class="level2">
<h2 class="anchored" data-anchor-id="setup">Setup</h2>
<p>First, we import the necessary Python packages and configure the environment for reproducibility. All data will stream directly from GitHub.</p>
<div id="cell-3" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:27.417644Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:27.417414Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:29.817080Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:29.816414Z&quot;}}" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import required packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.formula.api <span class="im">import</span> ols</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.nonparametric.smoothers_lowess <span class="im">import</span> lowess</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.ndimage <span class="im">import</span> gaussian_filter1d</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Set random seeds for reproducibility</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>RANDOM_SEED <span class="op">=</span> <span class="dv">42</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>random.seed(RANDOM_SEED)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>np.random.seed(RANDOM_SEED)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>os.environ[<span class="st">'PYTHONHASHSEED'</span>] <span class="op">=</span> <span class="bu">str</span>(RANDOM_SEED)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co"># GitHub data URL</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>GITHUB_DATA_URL <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/quarcs-lab/data-open/master/AED/"</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Set plotting style (dark theme matching book design)</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>plt.style.use(<span class="st">'dark_background'</span>)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>sns.set_style(<span class="st">"darkgrid"</span>)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>plt.rcParams.update({</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">'axes.facecolor'</span>: <span class="st">'#1a2235'</span>,</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">'figure.facecolor'</span>: <span class="st">'#12162c'</span>,</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">'grid.color'</span>: <span class="st">'#3a4a6b'</span>,</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">'figure.figsize'</span>: (<span class="dv">10</span>, <span class="dv">6</span>),</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">'text.color'</span>: <span class="st">'white'</span>,</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">'axes.labelcolor'</span>: <span class="st">'white'</span>,</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">'xtick.color'</span>: <span class="st">'white'</span>,</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ytick.color'</span>: <span class="st">'white'</span>,</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">'axes.edgecolor'</span>: <span class="st">'#1a2235'</span>,</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Setup complete! Ready to explore bivariate data analysis."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Setup complete! Ready to explore bivariate data analysis.</code></pre>
</div>
</div>
</section>
<section id="example---house-price-and-size" class="level2">
<h2 class="anchored" data-anchor-id="example---house-price-and-size">5.1 Example - House Price and Size</h2>
<p>We begin by loading and examining data on house prices and sizes from 29 houses sold in Central Davis, California in 1999. This dataset will serve as our main example throughout the chapter.</p>
<p><strong>Why this dataset?</strong></p>
<ul>
<li>Small enough to see individual observations</li>
<li>Large enough to demonstrate statistical relationships</li>
<li>Economically meaningful: housing is a major component of wealth</li>
<li>Clear relationship: larger houses tend to cost more</li>
</ul>
<div id="cell-5" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:29.851945Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:29.851487Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:29.910741Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:29.910171Z&quot;}}" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the house data</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>data_house <span class="op">=</span> pd.read_stata(GITHUB_DATA_URL <span class="op">+</span> <span class="st">'AED_HOUSE.DTA'</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Data loaded successfully!"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Number of observations: </span><span class="sc">{</span><span class="bu">len</span>(data_house)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Number of variables: </span><span class="sc">{</span>data_house<span class="sc">.</span>shape[<span class="dv">1</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Variables: </span><span class="sc">{</span><span class="st">', '</span><span class="sc">.</span>join(data_house.columns.tolist())<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data loaded successfully!
Number of observations: 29
Number of variables: 8

Variables: price, size, bedrooms, bathrooms, lotsize, age, monthsold, list</code></pre>
</div>
</div>
<div id="cell-6" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:29.913441Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:29.913159Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:29.920632Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:29.920060Z&quot;}}" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the complete dataset (Table 5.1)</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"TABLE 5.1: Complete Dataset"</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data_house.to_string())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
TABLE 5.1: Complete Dataset
======================================================================
     price  size  bedrooms  bathrooms  lotsize   age  monthsold    list
0   204000  1400         3        2.0        1  31.0          7  199900
1   212000  1600         3        3.0        2  33.0          5  212000
2   213000  1800         3        2.0        2  51.0          4  219900
3   220000  1600         3        2.0        1  49.0          4  229000
4   224500  2100         4        2.5        2  47.0          6  224500
5   229000  1700         4        2.5        2  35.0          3  229500
6   230000  2100         4        2.0        2  34.0          8  239000
7   233000  1700         3        2.0        1  40.0          6  244500
8   235000  1700         4        2.0        2  29.0          7  245000
9   235000  1600         3        2.0        3  35.0          5  242000
10  236500  1600         3        2.0        3  23.0          8  239500
11  238000  1900         4        2.0        2  29.0          7  249000
12  239500  1600         3        2.0        3  34.0          6  239500
13  241000  1600         4        2.0        2  34.0          8  242500
14  244000  2000         4        2.0        1  29.0          7  249000
15  245000  1400         4        2.0        2  30.0          8  252000
16  249000  1900         4        3.0        3  37.0          6  235000
17  253000  2100         4        2.0        3  47.0          6  269000
18  255000  1500         4        2.0        3  47.0          7  240000
19  258500  1600         3        2.0        1  39.0          8  259900
20  270000  1800         4        2.0        3  31.0          3  263900
21  270000  2000         4        2.5        3  39.0          5  269000
22  272000  1800         4        2.5        2  46.0          3  279500
23  273000  1900         5        2.0        2  37.0          7  273000
24  278500  2600         6        2.0        3  38.0          8  280000
25  279900  2000         4        2.0        2  31.0          7  279900
26  310000  2300         4        2.5        2  28.0          5  315000
27  340000  2400         4        3.0        2  34.0          6  369900
28  375000  3300         4        2.5        2  39.0          3  386000</code></pre>
</div>
</div>
<div id="cell-7" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:29.924276Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:29.923985Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:29.935191Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:29.934637Z&quot;}}" data-execution_count="4">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics (Table 5.2)</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"TABLE 5.2: Summary Statistics"</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data_house[[<span class="st">'price'</span>, <span class="st">'size'</span>]].describe())</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract key variables</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>price <span class="op">=</span> data_house[<span class="st">'price'</span>]</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>size <span class="op">=</span> data_house[<span class="st">'size'</span>]</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Price Statistics:"</span>)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Mean:      $</span><span class="sc">{</span>price<span class="sc">.</span>mean()<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Median:    $</span><span class="sc">{</span>price<span class="sc">.</span>median()<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Min:       $</span><span class="sc">{</span>price<span class="sc">.</span><span class="bu">min</span>()<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Max:       $</span><span class="sc">{</span>price<span class="sc">.</span><span class="bu">max</span>()<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Std Dev:   $</span><span class="sc">{</span>price<span class="sc">.</span>std()<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Size Statistics:"</span>)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Mean:      </span><span class="sc">{</span>size<span class="sc">.</span>mean()<span class="sc">:,.0f}</span><span class="ss"> sq ft"</span>)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Median:    </span><span class="sc">{</span>size<span class="sc">.</span>median()<span class="sc">:,.0f}</span><span class="ss"> sq ft"</span>)</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Min:       </span><span class="sc">{</span>size<span class="sc">.</span><span class="bu">min</span>()<span class="sc">:,.0f}</span><span class="ss"> sq ft"</span>)</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Max:       </span><span class="sc">{</span>size<span class="sc">.</span><span class="bu">max</span>()<span class="sc">:,.0f}</span><span class="ss"> sq ft"</span>)</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Std Dev:   </span><span class="sc">{</span>size<span class="sc">.</span>std()<span class="sc">:,.0f}</span><span class="ss"> sq ft"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
TABLE 5.2: Summary Statistics
======================================================================
               price         size
count      29.000000    29.000000
mean   253910.344828  1882.758621
std     37390.710695   398.272130
min    204000.000000  1400.000000
25%    233000.000000  1600.000000
50%    244000.000000  1800.000000
75%    270000.000000  2000.000000
max    375000.000000  3300.000000

Price Statistics:
  Mean:      $253,910.34
  Median:    $244,000.00
  Min:       $204,000.00
  Max:       $375,000.00
  Std Dev:   $37,390.71

Size Statistics:
  Mean:      1,883 sq ft
  Median:    1,800 sq ft
  Min:       1,400 sq ft
  Max:       3,300 sq ft
  Std Dev:   398 sq ft</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p><strong>Key Concept 5.1: Summary Statistics for Bivariate Data</strong></p>
<p>Summary statistics describe the center, spread, and range of each variable before examining their relationship. For bivariate analysis, compute the mean, median, standard deviation, minimum, and maximum of both variables. Comparing means and medians reveals skewness; standard deviations indicate variability. These univariate summaries provide essential context for interpreting correlation and regression results.</p>
</blockquote>
<p><strong>What do these numbers tell us about the Davis housing market (1999)?</strong></p>
<p><strong>Price Statistics:</strong></p>
<ul>
<li><strong>Mean = $253,910</strong>: Average house price in the sample</li>
<li><strong>Median = $244,000</strong>: Middle value (half above, half below)</li>
<li><strong>Range</strong>: $204,000 to $375,000 (spread of $171,000)</li>
<li><strong>Std Dev = $37,391</strong>: Typical deviation from the mean</li>
</ul>
<p><strong>Size Statistics:</strong></p>
<ul>
<li><strong>Mean = 1,883 sq ft</strong>: Average house size</li>
<li><strong>Median = 1,800 sq ft</strong>: Middle value</li>
<li><strong>Range</strong>: 1,400 to 3,300 sq ft (spread of 1,900 sq ft)</li>
<li><strong>Std Dev = 398 sq ft</strong>: Typical deviation from the mean</li>
</ul>
<p><strong>Key insights:</strong></p>
<ul>
<li>Both distributions are fairly symmetric (means close to medians)</li>
<li>Substantial variation in both price and size (good for regression!)</li>
<li>The price coefficient of variation (CV = 0.15) and size CV (0.21) show moderate variability</li>
<li><strong>Moving from univariate to bivariate</strong>: In Chapter 2, we looked at single variables. Now we ask: <em>how do these two variables move together?</em></li>
</ul>
<p><strong>Economic context:</strong> These are moderate-sized homes in a California college town (UC Davis), with typical prices for the late 1990s.</p>
<p><strong>Key observations:</strong></p>
<ul>
<li>House prices range from $204,000 to $375,000 (mean: $253,910)</li>
<li>House sizes range from 1,400 to 3,300 square feet (mean: 1,883 sq ft)</li>
<li>Both variables show substantial variation, which is good for regression analysis</li>
<li>The data appear to be reasonably symmetric (means close to medians)</li>
</ul>
</section>
<section id="two-way-tabulation" class="level2">
<h2 class="anchored" data-anchor-id="two-way-tabulation">5.2 Two-Way Tabulation</h2>
<p>A <strong>two-way tabulation</strong> (or crosstabulation) shows how observations are distributed across combinations of two categorical variables. For continuous variables like price and size, we first create categorical ranges.</p>
<p><strong>Why use tabulation?</strong></p>
<ul>
<li>Provides a quick summary of the relationship</li>
<li>Useful for discrete or categorical data</li>
<li>Can reveal patterns before formal analysis</li>
</ul>
<div id="cell-12" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:29.938340Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:29.938090Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:29.969633Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:29.969025Z&quot;}}" data-execution_count="5">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create categorical variables</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>price_range <span class="op">=</span> pd.cut(price, bins<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">249999</span>, np.inf],</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                     labels<span class="op">=</span>[<span class="st">'&lt; $250,000'</span>, <span class="st">'‚â• $250,000'</span>])</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>size_range <span class="op">=</span> pd.cut(size, bins<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">1799</span>, <span class="dv">2399</span>, np.inf],</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>                    labels<span class="op">=</span>[<span class="st">'&lt; 1,800'</span>, <span class="st">'1,800-2,399'</span>, <span class="st">'‚â• 2,400'</span>])</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create two-way table </span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Two-Way Tabulation of Price and Size"</span>)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>crosstab <span class="op">=</span> pd.crosstab(price_range, size_range, margins<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(crosstab)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Interpretation:"</span>)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"- 11 houses are both low-priced and small"</span>)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"- 0 houses are both low-priced and large (‚â• 2,400 sq ft)"</span>)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"- 3 houses are both high-priced and large"</span>)</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"- Pattern suggests positive association: larger houses tend to be more expensive"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
Two-Way Tabulation of Price and Size
======================================================================
size        &lt; 1,800  1,800-2,399  ‚â• 2,400  All
price                                         
&lt; $250,000       11            6        0   17
‚â• $250,000        2            7        3   12
All              13           13        3   29

Interpretation:
- 11 houses are both low-priced and small
- 0 houses are both low-priced and large (‚â• 2,400 sq ft)
- 3 houses are both high-priced and large
- Pattern suggests positive association: larger houses tend to be more expensive</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p><strong>Key Concept 5.2: Two-Way Tabulations</strong></p>
<p>Two-way tabulations show the joint distribution of two categorical variables. Expected frequencies (calculated assuming independence) provide the basis for Pearson‚Äôs chi-squared test of statistical independence. The crosstabulation reveals patterns: no low-priced large houses suggests a positive association between size and price.</p>
</blockquote>
<p><strong>What does this crosstab tell us?</strong></p>
<p>Looking at the table:</p>
<ul>
<li><strong>11 houses</strong> are both small (&lt; 1,800 sq ft) AND low-priced (&lt; $250,000)</li>
<li><strong>0 houses</strong> are both large (‚â• 2,400 sq ft) AND low-priced</li>
<li><strong>3 houses</strong> are both large (‚â• 2,400 sq ft) AND high-priced (‚â• $250,000)</li>
<li><strong>6 houses</strong> are medium-sized (1,800-2,399 sq ft) AND low-priced</li>
</ul>
<p><strong>The pattern reveals:</strong></p>
<ul>
<li><strong>Positive association</strong>: Most observations cluster in the ‚Äúsmall and cheap‚Äù or ‚Äúlarge and expensive‚Äù cells</li>
<li><strong>No counterexamples</strong>: We never see ‚Äúlarge and cheap‚Äù houses (the bottom-right cell is empty)</li>
<li><strong>Imperfect relationship</strong>: Some medium-sized houses are low-priced (6 houses), some are high-priced (7 houses)</li>
</ul>
<p><strong>Limitation of tabulation:</strong></p>
<ul>
<li>We lose information by categorizing continuous variables</li>
<li>We can‚Äôt quantify the strength of the relationship</li>
<li>We can‚Äôt make precise predictions</li>
</ul>
<p><strong>Next step:</strong> Use the correlation coefficient and regression to measure the relationship more precisely using the full continuous data.</p>
<p><strong>From Categorical to Continuous:</strong></p>
<p>Crosstabulation is useful but has limitations:</p>
<ul>
<li><strong>Information loss</strong>: We convert continuous data (exact prices/sizes) into categories</li>
<li><strong>Arbitrary bins</strong>: Results can change depending on where we draw category boundaries</li>
<li><strong>No precise measurement</strong>: Can‚Äôt quantify exact strength of relationship</li>
</ul>
<p><strong>Solution</strong>: Use the full continuous data with <strong>correlation</strong> and <strong>regression</strong> to:</p>
<ul>
<li>Preserve all information in the original measurements</li>
<li>Get precise, interpretable measures (r, slope)</li>
<li>Make specific predictions for any value of x</li>
</ul>
</section>
<section id="two-way-scatter-plot" class="level2">
<h2 class="anchored" data-anchor-id="two-way-scatter-plot">5.3 Two-Way Scatter Plot</h2>
<p>A <strong>scatter plot</strong> is the primary visual tool for examining the relationship between two continuous variables. Each point represents one observation, with x-coordinate showing size and y-coordinate showing price.</p>
<p><strong>What to look for:</strong></p>
<ul>
<li><strong>Direction:</strong> Does y increase or decrease as x increases?</li>
<li><strong>Strength:</strong> How closely do points follow a pattern?</li>
<li><strong>Form:</strong> Is the relationship linear or curved?</li>
<li><strong>Outliers:</strong> Are there unusual observations far from the pattern?</li>
</ul>
<div id="cell-17" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:29.973641Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:29.973157Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:30.307520Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:30.306479Z&quot;}}" data-execution_count="6">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot of price vs size</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>ax.scatter(size, price, s<span class="op">=</span><span class="dv">80</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, color<span class="op">=</span><span class="st">'#22d3ee'</span>, edgecolor<span class="op">=</span><span class="st">'#3a4a6b'</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'House size (in square feet)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'House sale price (in dollars)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'House Price vs Size'</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">What the scatter plot shows:"</span>)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"‚úì Positive relationship: Larger houses tend to have higher prices"</span>)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"‚úì Roughly linear: Points follow an upward-sloping pattern"</span>)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"‚úì Moderate scatter: Not all points lie exactly on a line"</span>)</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"‚úì No obvious outliers: All points fit the general pattern"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05_Bivariate_Data_Summary_files/figure-html/cell-7-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
What the scatter plot shows:
‚úì Positive relationship: Larger houses tend to have higher prices
‚úì Roughly linear: Points follow an upward-sloping pattern
‚úì Moderate scatter: Not all points lie exactly on a line
‚úì No obvious outliers: All points fit the general pattern</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p><strong>Key Concept 5.3: Scatterplots and Relationships</strong></p>
<p>Scatterplots provide visual evidence of relationships between two continuous variables. They reveal the direction (positive/negative), strength (tight/loose clustering), form (linear/curved), and outliers of the relationship. The house price-size scatterplot shows a strong, positive, roughly linear relationship with no obvious outliers.</p>
</blockquote>
<p><strong>Visual vs.&nbsp;Quantitative Analysis:</strong></p>
<p>The scatter plot provides <strong>qualitative</strong> insight (direction, form, outliers), but we need <strong>quantitative</strong> measures to:</p>
<ul>
<li><strong>Communicate precisely</strong>: ‚ÄúStrong positive relationship‚Äù is vague; ‚Äúr = 0.79‚Äù is specific</li>
<li><strong>Compare across studies</strong>: Can‚Äôt compare scatter plots directly across datasets</li>
<li><strong>Test hypotheses</strong>: Need numerical values for statistical inference (Chapter 7)</li>
<li><strong>Make predictions</strong>: Visual estimates from graphs are imprecise</li>
</ul>
<p><strong>Next</strong>: We‚Äôll quantify this relationship using the correlation coefficient.</p>
<p><strong>What patterns do we observe?</strong></p>
<p><strong>1. Direction: Positive relationship</strong></p>
<ul>
<li>As house size increases (moving right), house price increases (moving up)</li>
<li>This makes economic sense: bigger houses should cost more</li>
</ul>
<p><strong>2. Form: Roughly linear</strong></p>
<ul>
<li>Points follow an upward-sloping pattern</li>
<li>No obvious curvature (e.g., not exponential or U-shaped)</li>
<li>A straight line appears to be a reasonable summary</li>
</ul>
<p><strong>3. Strength: Moderate to strong</strong></p>
<ul>
<li>Points cluster fairly closely around an imaginary line</li>
<li>Not perfect (some scatter), but clear pattern visible</li>
<li>We‚Äôll quantify this with the correlation coefficient</li>
</ul>
<p><strong>4. Outliers: None obvious</strong></p>
<ul>
<li>No houses wildly far from the general pattern</li>
<li>All observations seem consistent with the relationship</li>
</ul>
<p><strong>Comparison to univariate analysis (Chapter 2):</strong></p>
<ul>
<li><strong>Univariate</strong>: Histogram shows distribution of one variable</li>
<li><strong>Bivariate</strong>: Scatter plot shows <em>relationship</em> between two variables</li>
<li><strong>New question</strong>: How does Y change when X changes?</li>
</ul>
<p><strong>What we can‚Äôt tell from the graph alone:</strong></p>
<ul>
<li>Exact strength of relationship (need correlation)</li>
<li>Precise prediction equation (need regression)</li>
<li>Statistical significance (need inference, Chapter 7)</li>
</ul>
</section>
<section id="sample-correlation" class="level2">
<h2 class="anchored" data-anchor-id="sample-correlation">5.4 Sample Correlation</h2>
<p>The <strong>correlation coefficient</strong> <span class="math inline">\(r\)</span> is a unit-free measure of linear association between two variables. It ranges from -1 to 1:</p>
<ul>
<li><span class="math inline">\(r = 1\)</span>: Perfect positive linear relationship</li>
<li>$0 &lt; r &lt; 1$: Positive linear relationship</li>
<li><span class="math inline">\(r = 0\)</span>: No linear relationship</li>
<li><span class="math inline">\(-1 &lt; r &lt; 0\)</span>: Negative linear relationship</li>
<li><span class="math inline">\(r = -1\)</span>: Perfect negative linear relationship</li>
</ul>
<p><strong>Formula:</strong> <span class="math display">\[r_{xy} = \frac{\sum_{i=1}^{n}(x_i - \bar{x})(y_i - \bar{y})}{\sqrt{\sum_{i=1}^{n}(x_i - \bar{x})^2 \times \sum_{i=1}^{n}(y_i - \bar{y})^2}} = \frac{s_{xy}}{s_x s_y}\]</span></p>
<p>where <span class="math inline">\(s_{xy}\)</span> is the sample covariance, and <span class="math inline">\(s_x\)</span>, <span class="math inline">\(s_y\)</span> are sample standard deviations.</p>
<p><strong>Key Properties of Correlation:</strong></p>
<p>Understanding these properties helps avoid common misinterpretations:</p>
<ol type="1">
<li><strong>Unit-free</strong>: r = 0.79 whether we measure price in dollars, thousands, or millions</li>
<li><strong>Bounded</strong>: Always between -1 and +1 (unlike covariance, which is unbounded)</li>
<li><strong>Symmetric</strong>: r(price, size) = r(size, price) ‚Äî order doesn‚Äôt matter</li>
<li><strong>Only measures linear relationships</strong>: Can miss curved, U-shaped, or other nonlinear patterns</li>
<li><strong>Sensitive to outliers</strong>: One extreme point can dramatically change r</li>
</ol>
<p><strong>Limitation</strong>: Correlation is a summary measure but doesn‚Äôt provide predictions. For that, we need <strong>regression</strong>.</p>
<div id="cell-23" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:30.311939Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:30.311635Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:30.319813Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:30.319288Z&quot;}}" data-execution_count="7">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute correlation and covariance</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>cov_matrix <span class="op">=</span> data_house[[<span class="st">'price'</span>, <span class="st">'size'</span>]].cov()</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>corr_matrix <span class="op">=</span> data_house[[<span class="st">'price'</span>, <span class="st">'size'</span>]].corr()</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"COVARIANCE AND CORRELATION"</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Covariance matrix:"</span>)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cov_matrix)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Correlation matrix:"</span>)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(corr_matrix)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> corr_matrix.loc[<span class="st">'price'</span>, <span class="st">'size'</span>]</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Correlation coefficient: r = </span><span class="sc">{</span>r<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Interpretation:"</span>)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  The correlation of </span><span class="sc">{</span>r<span class="sc">:.4f}</span><span class="ss"> indicates a strong positive linear"</span>)</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  relationship between house price and size."</span>)</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  About </span><span class="sc">{</span>r<span class="op">**</span><span class="dv">2</span><span class="sc">:.1%}</span><span class="ss"> of the variation in price is linearly associated"</span>)</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  with variation in size."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
COVARIANCE AND CORRELATION
======================================================================

Covariance matrix:
              price          size
price  1.398065e+09  1.170161e+07
size   1.170161e+07  1.586207e+05

Correlation matrix:
          price      size
price  1.000000  0.785782
size   0.785782  1.000000

Correlation coefficient: r = 0.7858

Interpretation:
  The correlation of 0.7858 indicates a strong positive linear
  relationship between house price and size.
  About 61.7% of the variation in price is linearly associated
  with variation in size.</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p><strong>Key Concept 5.4: The Correlation Coefficient</strong></p>
<p>The correlation coefficient (r) is a scale-free measure of linear association ranging from -1 (perfect negative) to +1 (perfect positive). A correlation of 0 indicates no linear relationship. For house price and size, r = 0.786 indicates strong positive correlation. The correlation is unit-free, symmetric, and measures only linear relationships.</p>
</blockquote>
<p><strong>What does r = 0.7858 mean?</strong></p>
<p><strong>1. Strength of linear association:</strong></p>
<ul>
<li><strong>r = 0.7858</strong> indicates a <strong>strong positive</strong> linear relationship</li>
<li>Scale reference:
<ul>
<li>|r| &lt; 0.3: weak</li>
<li>0.3 ‚â§ |r| &lt; 0.7: moderate</li>
<li>|r| ‚â• 0.7: strong</li>
</ul></li>
<li>Our value (0.79) is well into the ‚Äústrong‚Äù range</li>
</ul>
<p><strong>2. Direction:</strong></p>
<ul>
<li><strong>Positive</strong>: Larger houses are associated with higher prices</li>
<li>If r were negative, larger houses would be associated with lower prices (unlikely for housing!)</li>
</ul>
<p><strong>3. Variance explained (preview):</strong></p>
<ul>
<li>r¬≤ = (0.7858)¬≤ = 0.617 = <strong>61.7%</strong></li>
<li>About 62% of price variation is linearly associated with size variation</li>
<li>The remaining 38% is due to other factors (location, age, condition, etc.)</li>
</ul>
<p><strong>4. Properties of correlation:</strong></p>
<ul>
<li><strong>Unit-free</strong>: Same value whether we measure price in dollars or thousands of dollars</li>
<li><strong>Symmetric</strong>: r(price, size) = r(size, price) = 0.7858</li>
<li><strong>Bounded</strong>: Always between -1 and +1</li>
<li><strong>Linear measure</strong>: Detects linear relationships, not curves</li>
</ul>
<p><strong>Comparison to Chapter 2 (univariate):</strong></p>
<ul>
<li>Chapter 2: Standard deviation measures spread of ONE variable</li>
<li>Chapter 5: Correlation measures how TWO variables move together</li>
<li>Both are standardized measures (unit-free)</li>
</ul>
<p><strong>Economic interpretation:</strong> The strong correlation confirms what we saw in the scatter plot: house size is a major determinant of house price, but it‚Äôs not the only factor.</p>
<section id="illustration-different-correlation-patterns" class="level3">
<h3 class="anchored" data-anchor-id="illustration-different-correlation-patterns">Illustration: Different Correlation Patterns</h3>
<p>To build intuition, let‚Äôs visualize simulated data with different correlation coefficients.</p>
<div id="cell-27" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:30.323311Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:30.322916Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:31.265551Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:31.265042Z&quot;}}" data-execution_count="8">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Different correlation patterns</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">12345</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">30</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.random.normal(<span class="dv">3</span>, <span class="dv">1</span>, n)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>u1 <span class="op">=</span> np.random.normal(<span class="dv">0</span>, <span class="fl">0.8</span>, n)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>y1 <span class="op">=</span> <span class="dv">3</span> <span class="op">+</span> x <span class="op">+</span> u1  <span class="co"># Strong positive correlation</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>u2 <span class="op">=</span> np.random.normal(<span class="dv">0</span>, <span class="dv">2</span>, n)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>y2 <span class="op">=</span> <span class="dv">3</span> <span class="op">+</span> x <span class="op">+</span> u2  <span class="co"># Moderate positive correlation</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>y3 <span class="op">=</span> <span class="dv">5</span> <span class="op">+</span> u2      <span class="co"># Zero correlation</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>y4 <span class="op">=</span> <span class="dv">10</span> <span class="op">-</span> x <span class="op">-</span> u2 <span class="co"># Moderate negative correlation</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>correlations <span class="op">=</span> [</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    np.corrcoef(x, y1)[<span class="dv">0</span>, <span class="dv">1</span>],</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    np.corrcoef(x, y2)[<span class="dv">0</span>, <span class="dv">1</span>],</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    np.corrcoef(x, y3)[<span class="dv">0</span>, <span class="dv">1</span>],</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    np.corrcoef(x, y4)[<span class="dv">0</span>, <span class="dv">1</span>]</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">12</span>))</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>axes <span class="op">=</span> axes.flatten()</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>datasets <span class="op">=</span> [(x, y1, <span class="st">'Panel A: Strong Positive'</span>),</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>            (x, y2, <span class="st">'Panel B: Moderate Positive'</span>),</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>            (x, y3, <span class="st">'Panel C: Zero Correlation'</span>),</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>            (x, y4, <span class="st">'Panel D: Moderate Negative'</span>)]</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx, (ax, (x_data, y_data, title), corr) <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">zip</span>(axes, datasets, correlations)):</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>    ax.scatter(x_data, y_data, s<span class="op">=</span><span class="dv">60</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, color<span class="op">=</span><span class="st">'#22d3ee'</span>, edgecolor<span class="op">=</span><span class="st">'#3a4a6b'</span>)</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">'x'</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">'y'</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="ss">f'</span><span class="sc">{</span>title<span class="sc">}</span><span class="ch">\n</span><span class="ss">r = </span><span class="sc">{</span>corr<span class="sc">:.2f}</span><span class="ss">'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>    ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">'Different Correlation Patterns'</span>,</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, y<span class="op">=</span><span class="fl">0.995</span>)</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Key observations:"</span>)</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"‚Ä¢ Panel A (r ‚âà 0.78): Points cluster tightly around an upward slope"</span>)</span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"‚Ä¢ Panel B (r ‚âà 0.44): More scatter, but still positive relationship"</span>)</span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"‚Ä¢ Panel C (r ‚âà 0.00): No systematic pattern"</span>)</span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"‚Ä¢ Panel D (r ‚âà -0.53): Points follow a downward slope"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05_Bivariate_Data_Summary_files/figure-html/cell-9-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Key observations:
‚Ä¢ Panel A (r ‚âà 0.78): Points cluster tightly around an upward slope
‚Ä¢ Panel B (r ‚âà 0.44): More scatter, but still positive relationship
‚Ä¢ Panel C (r ‚âà 0.00): No systematic pattern
‚Ä¢ Panel D (r ‚âà -0.53): Points follow a downward slope</code></pre>
</div>
</div>
</section>
</section>
<section id="regression-line" class="level2">
<h2 class="anchored" data-anchor-id="regression-line">5.5 Regression Line</h2>
<p>The <strong>regression line</strong> provides the ‚Äúbest-fitting‚Äù linear summary of the relationship between y (dependent variable) and x (independent variable):</p>
<p><span class="math display">\[\hat{y} = b_1 + b_2 x\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(\hat{y}\)</span> = predicted (fitted) value of y</li>
<li><span class="math inline">\(b_1\)</span> = intercept (predicted y when x = 0)</li>
<li><span class="math inline">\(b_2\)</span> = slope (change in y for one-unit increase in x)</li>
</ul>
<p><strong>Ordinary Least Squares (OLS)</strong> chooses <span class="math inline">\(b_1\)</span> and <span class="math inline">\(b_2\)</span> to minimize the sum of squared residuals:</p>
<p><span class="math display">\[\min_{b_1, b_2} \sum_{i=1}^n (y_i - b_1 - b_2 x_i)^2\]</span></p>
<p><strong>Formulas:</strong> <span class="math display">\[b_2 = \frac{\sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y})}{\sum_{i=1}^n (x_i - \bar{x})^2} = \frac{s_{xy}}{s_x^2}\]</span></p>
<p><span class="math display">\[b_1 = \bar{y} - b_2 \bar{x}\]</span></p>
<p><strong>Transition Note:</strong> Correlation measures the strength of association, but doesn‚Äôt provide a prediction equation. Now we turn to regression analysis, which fits a line to predict y from x and quantifies how much y changes per unit change in x.</p>
<div id="cell-30" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:31.268819Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:31.268526Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:31.284092Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:31.283530Z&quot;}}" data-execution_count="9">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit OLS regression</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ols(<span class="st">'price ~ size'</span>, data<span class="op">=</span>data_house).fit()</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"REGRESSION RESULTS: price ~ size"</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model.summary())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
REGRESSION RESULTS: price ~ size
======================================================================
                            OLS Regression Results                            
==============================================================================
Dep. Variable:                  price   R-squared:                       0.617
Model:                            OLS   Adj. R-squared:                  0.603
Method:                 Least Squares   F-statistic:                     43.58
Date:                Tue, 17 Feb 2026   Prob (F-statistic):           4.41e-07
Time:                        22:12:31   Log-Likelihood:                -332.05
No. Observations:                  29   AIC:                             668.1
Df Residuals:                      27   BIC:                             670.8
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept    1.15e+05   2.15e+04      5.352      0.000    7.09e+04    1.59e+05
size          73.7710     11.175      6.601      0.000      50.842      96.700
==============================================================================
Omnibus:                        0.576   Durbin-Watson:                   1.219
Prob(Omnibus):                  0.750   Jarque-Bera (JB):                0.638
Skew:                          -0.078   Prob(JB):                        0.727
Kurtosis:                       2.290   Cond. No.                     9.45e+03
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The condition number is large, 9.45e+03. This might indicate that there are
strong multicollinearity or other numerical problems.</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p><strong>Key Concept 5.5: Ordinary Least Squares</strong></p>
<p>The method of ordinary least squares (OLS) chooses the regression line to minimize the sum of squared residuals. This yields formulas for the slope (b‚ÇÇ = Œ£(x·µ¢ - xÃÑ)(y·µ¢ - »≥) / Œ£(x·µ¢ - xÃÑ)¬≤) and intercept (b‚ÇÅ = »≥ - b‚ÇÇxÃÑ) that can be computed from the data. The slope equals the covariance divided by the variance of x.</p>
</blockquote>
<div id="cell-32" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:31.286973Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:31.286671Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:31.294092Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:31.293547Z&quot;}}" data-execution_count="10">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract and interpret coefficients</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>intercept <span class="op">=</span> model.params[<span class="st">'Intercept'</span>]</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>slope <span class="op">=</span> model.params[<span class="st">'size'</span>]</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>r_squared <span class="op">=</span> model.rsquared</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"KEY REGRESSION COEFFICIENTS"</span>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Fitted regression line:"</span>)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  ≈∑ = </span><span class="sc">{</span>intercept<span class="sc">:,.2f}</span><span class="ss"> + </span><span class="sc">{</span>slope<span class="sc">:.2f}</span><span class="ss"> √ó size"</span>)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Intercept (b‚ÇÅ): $</span><span class="sc">{</span>intercept<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Interpretation: Predicted price when size = 0"</span>)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  (Not economically meaningful in this case)"</span>)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Slope (b‚ÇÇ): $</span><span class="sc">{</span>slope<span class="sc">:.2f}</span><span class="ss"> per square foot"</span>)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Interpretation: Each additional square foot is associated with"</span>)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  a $</span><span class="sc">{</span>slope<span class="sc">:.2f}</span><span class="ss"> increase in house price, on average."</span>)</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Examples:"</span>)</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  ‚Ä¢ 100 sq ft larger ‚Üí $</span><span class="sc">{</span>slope <span class="op">*</span> <span class="dv">100</span><span class="sc">:,.2f}</span><span class="ss"> higher price"</span>)</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  ‚Ä¢ 500 sq ft larger ‚Üí $</span><span class="sc">{</span>slope <span class="op">*</span> <span class="dv">500</span><span class="sc">:,.2f}</span><span class="ss"> higher price"</span>)</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">R-squared: </span><span class="sc">{</span>r_squared<span class="sc">:.4f}</span><span class="ss"> (</span><span class="sc">{</span>r_squared<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%)"</span>)</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  </span><span class="sc">{</span>r_squared<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">% of price variation is explained by size"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
KEY REGRESSION COEFFICIENTS
======================================================================

Fitted regression line:
  ≈∑ = 115,017.28 + 73.77 √ó size

Intercept (b‚ÇÅ): $115,017.28
  Interpretation: Predicted price when size = 0
  (Not economically meaningful in this case)

Slope (b‚ÇÇ): $73.77 per square foot
  Interpretation: Each additional square foot is associated with
  a $73.77 increase in house price, on average.

Examples:
  ‚Ä¢ 100 sq ft larger ‚Üí $7,377.10 higher price
  ‚Ä¢ 500 sq ft larger ‚Üí $36,885.52 higher price

R-squared: 0.6175 (61.75%)
  61.75% of price variation is explained by size</code></pre>
</div>
</div>
<p><strong>Key findings from the house price regression:</strong></p>
<p><strong>The fitted equation:</strong></p>
<pre><code>≈∑ = 115,017 + 73.77 √ó size</code></pre>
<p><strong>1. Slope coefficient: $73.77 per square foot (p &lt; 0.001)</strong></p>
<ul>
<li><strong>Interpretation</strong>: Each additional square foot is associated with a $73.77 increase in house price, on average</li>
<li><strong>Statistical significance</strong>: p-value ‚âà 0 (highly significant)</li>
<li><strong>Confidence interval</strong>: [50.84, 96.70] ‚Äî we‚Äôre 95% confident the true effect is between $51 and $97 per sq ft</li>
</ul>
<p><strong>2. Practical examples:</strong></p>
<ul>
<li>100 sq ft larger ‚Üí $73.77 √ó 100 = <strong>$7,377</strong> higher price</li>
<li>500 sq ft larger ‚Üí $73.77 √ó 500 = <strong>$36,885</strong> higher price</li>
<li>1,000 sq ft larger ‚Üí $73.77 √ó 1,000 = <strong>$73,770</strong> higher price</li>
</ul>
<p><strong>3. Intercept: $115,017</strong></p>
<ul>
<li><strong>Mathematical interpretation</strong>: Predicted price when size = 0</li>
<li><strong>Reality check</strong>: A house can‚Äôt have zero square feet!</li>
<li><strong>Better interpretation</strong>: This is just where the regression line crosses the y-axis</li>
<li>Don‚Äôt take it literally ‚Äî it‚Äôs outside the data range (1,400-3,300 sq ft)</li>
</ul>
<p><strong>4. R-squared: 0.617 (61.7%)</strong></p>
<ul>
<li>Size explains <strong>62% of the variation</strong> in house prices</li>
<li>The remaining <strong>38%</strong> is due to other factors:</li>
<li>Location (neighborhood quality, schools)</li>
<li>Physical characteristics (bathrooms, garage, condition)</li>
<li>Market conditions (time of sale)</li>
<li>Unique features (view, lot size, upgrades)</li>
</ul>
<p><strong>Comparison to correlation:</strong></p>
<ul>
<li>We computed r = 0.7858</li>
<li>R¬≤ = (0.7858)¬≤ = 0.617 (they match!)</li>
<li>For simple regression, R¬≤ always equals r¬≤</li>
</ul>
<p><strong>Economic interpretation:</strong> The strong relationship (R¬≤ = 0.62) between size and price makes economic sense. Buyers pay a substantial premium for additional space. However, the imperfect fit reminds us that many factors beyond size affect house values.</p>
<section id="visualizing-the-fitted-regression-line" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-the-fitted-regression-line">Visualizing the Fitted Regression Line</h3>
<div id="cell-35" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:31.297371Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:31.297125Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:31.620368Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:31.619746Z&quot;}}" data-execution_count="11">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot with regression line</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>ax.scatter(size, price, s<span class="op">=</span><span class="dv">80</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, color<span class="op">=</span><span class="st">'#22d3ee'</span>,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>           edgecolor<span class="op">=</span><span class="st">'#3a4a6b'</span>, label<span class="op">=</span><span class="st">'Actual prices'</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>ax.plot(size, model.fittedvalues, color<span class="op">=</span><span class="st">'#c084fc'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">'Fitted regression line'</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add equation to plot</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>equation_text <span class="op">=</span> <span class="ss">f'≈∑ = </span><span class="sc">{</span>intercept<span class="sc">:,.0f}</span><span class="ss"> + </span><span class="sc">{</span>slope<span class="sc">:.2f}</span><span class="ss"> √ó size</span><span class="ch">\n</span><span class="ss">R¬≤ = </span><span class="sc">{</span>r_squared<span class="sc">:.4f}</span><span class="ss">'</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>ax.text(<span class="fl">0.05</span>, <span class="fl">0.95</span>, equation_text,</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>        transform<span class="op">=</span>ax.transAxes, fontsize<span class="op">=</span><span class="dv">11</span>,</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>        verticalalignment<span class="op">=</span><span class="st">'top'</span>,</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>        bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'round'</span>, facecolor<span class="op">=</span><span class="st">'#1e2a45'</span>, alpha<span class="op">=</span><span class="fl">0.9</span>))</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'House size (in square feet)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'House sale price (in dollars)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Scatter plot with regression line'</span>,</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>ax.legend(loc<span class="op">=</span><span class="st">'lower right'</span>)</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">The blue line is the 'line of best fit'"</span>)</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"It minimizes the sum of squared vertical distances from each point."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05_Bivariate_Data_Summary_files/figure-html/cell-12-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
The blue line is the 'line of best fit'
It minimizes the sum of squared vertical distances from each point.</code></pre>
</div>
</div>
</section>
<section id="special-case-intercept-only-regression" class="level3">
<h3 class="anchored" data-anchor-id="special-case-intercept-only-regression">Special Case: Intercept-Only Regression</h3>
<p>When we regress y on only an intercept (no x variable), the OLS estimate equals the sample mean of y. This shows that regression is a natural extension of univariate statistics.</p>
<div id="cell-37" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:31.624717Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:31.624401Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:31.632128Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:31.631626Z&quot;}}" data-execution_count="12">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Intercept-only regression</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>model_intercept <span class="op">=</span> ols(<span class="st">'price ~ 1'</span>, data<span class="op">=</span>data_house).fit()</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"INTERCEPT-ONLY REGRESSION"</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Intercept from regression: $</span><span class="sc">{</span>model_intercept<span class="sc">.</span>params[<span class="dv">0</span>]<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sample mean of price:      $</span><span class="sc">{</span>price<span class="sc">.</span>mean()<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">These are equal, confirming that OLS generalizes the sample mean!"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
INTERCEPT-ONLY REGRESSION
======================================================================
Intercept from regression: $253,910.34
Sample mean of price:      $253,910.34

These are equal, confirming that OLS generalizes the sample mean!</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/tq/t98kb27n6djgrh085g476yhc0000gn/T/ipykernel_14787/1986013926.py:7: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  print(f"Intercept from regression: ${model_intercept.params[0]:,.2f}")</code></pre>
</div>
</div>
</section>
</section>
<section id="measures-of-model-fit" class="level2">
<h2 class="anchored" data-anchor-id="measures-of-model-fit">5.6 Measures of Model Fit</h2>
<p>Two key measures assess how well the regression line fits the data:</p>
<section id="r-squared-r¬≤" class="level3">
<h3 class="anchored" data-anchor-id="r-squared-r¬≤">R-squared (R¬≤)</h3>
<p>Proportion of variation in y explained by x (ranges from 0 to 1):</p>
<p><span class="math display">\[R^2 = \frac{\text{Explained SS}}{\text{Total SS}} = \frac{\sum (\hat{y}_i - \bar{y})^2}{\sum (y_i - \bar{y})^2} = 1 - \frac{\sum (y_i - \hat{y}_i)^2}{\sum (y_i - \bar{y})^2}\]</span></p>
<p><strong>Interpretation:</strong></p>
<ul>
<li><span class="math inline">\(R^2 = 0\)</span>: x explains none of the variation in y</li>
<li><span class="math inline">\(R^2 = 1\)</span>: x explains all of the variation in y</li>
<li><span class="math inline">\(R^2 = r^2\)</span> (for simple regression, R¬≤ equals the squared correlation)</li>
</ul>
</section>
<section id="standard-error-of-the-regression-s_e" class="level3">
<h3 class="anchored" data-anchor-id="standard-error-of-the-regression-s_e">Standard Error of the Regression (s_e)</h3>
<p>Standard deviation of the residuals (typical size of prediction errors):</p>
<p><span class="math display">\[s_e = \sqrt{\frac{1}{n-2} \sum_{i=1}^n (y_i - \hat{y}_i)^2}\]</span></p>
<p><strong>Interpretation:</strong></p>
<ul>
<li>Lower <span class="math inline">\(s_e\)</span> means fitted values are closer to actual values</li>
<li>Units: same as y (dollars in our example)</li>
<li>Dividing by (n-2) accounts for estimation of two parameters</li>
</ul>
<div id="cell-39" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:31.635674Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:31.635429Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:31.641045Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:31.640174Z&quot;}}" data-execution_count="13">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute model fit measures</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"MEASURES OF MODEL FIT"</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>r_squared <span class="op">=</span> model.rsquared</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>adj_r_squared <span class="op">=</span> model.rsquared_adj</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>se <span class="op">=</span> np.sqrt(model.mse_resid)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="bu">len</span>(data_house)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">R-squared:               </span><span class="sc">{</span>r_squared<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  </span><span class="sc">{</span>r_squared<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">% of price variation explained by size"</span>)</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Adjusted R-squared:      </span><span class="sc">{</span>adj_r_squared<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Penalizes for number of regressors"</span>)</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Standard error (s_e):    $</span><span class="sc">{</span>se<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Typical prediction error is about $</span><span class="sc">{</span>se<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify R¬≤ = r¬≤</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> corr_matrix.loc[<span class="st">'price'</span>, <span class="st">'size'</span>]</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Verification: R¬≤ = r¬≤"</span>)</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  R¬≤ = </span><span class="sc">{</span>r_squared<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  r¬≤ = </span><span class="sc">{</span>r<span class="op">**</span><span class="dv">2</span><span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Match: </span><span class="sc">{</span>np<span class="sc">.</span>isclose(r_squared, r<span class="op">**</span><span class="dv">2</span>)<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
MEASURES OF MODEL FIT
======================================================================

R-squared:               0.6175
  61.75% of price variation explained by size

Adjusted R-squared:      0.6033
  Penalizes for number of regressors

Standard error (s_e):    $23,550.66
  Typical prediction error is about $23,551

Verification: R¬≤ = r¬≤
  R¬≤ = 0.6175
  r¬≤ = 0.6175
  Match: True</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p><strong>Key Concept 5.6: R-Squared Goodness of Fit</strong></p>
<p>R-squared measures the fraction of variation in y explained by the regression on x. It ranges from 0 (no explanatory power) to 1 (perfect fit). For bivariate regression, R¬≤ equals the squared correlation coefficient (R¬≤ = r¬≤‚Çì·µß). R¬≤ = 0.62 means 62% of house price variation is explained by size variation, while 38% is due to other factors.</p>
</blockquote>
<p><strong>Transition Note:</strong> We‚Äôve estimated the regression line. Now we assess how well this line fits the data using R-squared (proportion of variation explained) and the standard error of regression (typical prediction error).</p>
<p><strong>Understanding R¬≤ = 0.617 and Standard Error = $23,162</strong></p>
<p><strong>1. R-squared (coefficient of determination):</strong></p>
<ul>
<li><strong>Value</strong>: 0.617 or 61.7%</li>
<li><strong>Meaning</strong>: Size explains 61.7% of the variation in house prices</li>
<li><strong>The other 38.3%</strong>: Due to factors not in our model (location, quality, age, etc.)</li>
</ul>
<p><strong>How to think about R¬≤:</strong></p>
<ul>
<li><strong>R¬≤ = 0</strong>: x has no predictive power (horizontal line)</li>
<li><strong>R¬≤ = 0.617</strong>: x has substantial predictive power (our case)</li>
<li><strong>R¬≤ = 1</strong>: x predicts y perfectly (all points on the line)</li>
</ul>
<p><strong>Is R¬≤ = 0.617 ‚Äúgood‚Äù?</strong></p>
<ul>
<li><p><strong>For cross-sectional data</strong>: Yes, this is quite good!</p></li>
<li><p><strong>Context matters</strong>:</p></li>
<li><p>Lab experiments: Often R¬≤ &gt; 0.9</p></li>
<li><p>Cross-sectional economics: R¬≤ = 0.2-0.6 is typical</p></li>
<li><p>Time series: R¬≤ = 0.7-0.95 is common</p></li>
<li><p><strong>Single predictor</strong>: Size alone explains most variation ‚Äî impressive!</p></li>
</ul>
<p><strong>2. Standard error: $23,162</strong></p>
<ul>
<li><strong>Meaning</strong>: Typical prediction error (residual size)</li>
<li><strong>Context</strong>:</li>
<li>Average house price: $253,910</li>
<li>Typical error: $23,162 (about 9% of average)</li>
<li>This is reasonably accurate for house price prediction</li>
</ul>
<p><strong>3. Verification: R¬≤ = r¬≤</strong></p>
<ul>
<li>Correlation: r = 0.7858</li>
<li>R-squared: R¬≤ = 0.617</li>
<li>Check: (0.7858)¬≤ = 0.617</li>
<li>For simple regression, these are always equal</li>
</ul>
<p><strong>4. Sum of Squares decomposition:</strong></p>
<pre><code>Total SS = Explained SS + Residual SS
100% = 61.7% + 38.3%</code></pre>
<p><strong>Practical implications:</strong></p>
<ul>
<li><strong>For predictions</strong>: Expect errors around ¬±$23,000</li>
<li><strong>For policy</strong>: Size is important, but other factors matter too</li>
<li><strong>For research</strong>: May want to add more variables (multiple regression, Chapters 10-12)</li>
</ul>
</section>
<section id="illustration-total-ss-explained-ss-and-residual-ss" class="level3">
<h3 class="anchored" data-anchor-id="illustration-total-ss-explained-ss-and-residual-ss">Illustration: Total SS, Explained SS, and Residual SS</h3>
<p>Let‚Äôs create a simple example to visualize how R¬≤ is computed.</p>
<div id="cell-44" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:31.644614Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:31.644294Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:31.658623Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:31.657934Z&quot;}}" data-execution_count="14">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulated data for demonstration</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">123456</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>x_sim <span class="op">=</span> np.arange(<span class="dv">1</span>, <span class="dv">6</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>epsilon <span class="op">=</span> np.random.normal(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">5</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>y_sim <span class="op">=</span> <span class="dv">1</span> <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>x_sim <span class="op">+</span> epsilon</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>df_sim <span class="op">=</span> pd.DataFrame({<span class="st">'x'</span>: x_sim, <span class="st">'y'</span>: y_sim})</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>model_sim <span class="op">=</span> ols(<span class="st">'y ~ x'</span>, data<span class="op">=</span>df_sim).fit()</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"SIMULATED DATA FOR MODEL FIT ILLUSTRATION"</span>)</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="sc">{</span><span class="st">'x'</span><span class="sc">:&lt;5}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'y'</span><span class="sc">:&lt;10}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'≈∑'</span><span class="sc">:&lt;10}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'Residual (e)'</span><span class="sc">:&lt;15}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'(y - »≥)'</span><span class="sc">:&lt;10}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'(≈∑ - »≥)'</span><span class="sc">:&lt;10}</span><span class="ss">"</span>)</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(x_sim)):</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>x_sim[i]<span class="sc">:&lt;5}</span><span class="ss"> </span><span class="sc">{</span>y_sim[i]<span class="sc">:&lt;10.4f}</span><span class="ss"> </span><span class="sc">{</span>model_sim<span class="sc">.</span>fittedvalues[i]<span class="sc">:&lt;10.4f}</span><span class="ss"> "</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>          <span class="ss">f"</span><span class="sc">{</span>model_sim<span class="sc">.</span>resid[i]<span class="sc">:&lt;15.4f}</span><span class="ss"> </span><span class="sc">{</span>y_sim[i] <span class="op">-</span> y_sim<span class="sc">.</span>mean()<span class="sc">:&lt;10.4f}</span><span class="ss"> "</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>          <span class="ss">f"</span><span class="sc">{</span>model_sim<span class="sc">.</span>fittedvalues[i] <span class="op">-</span> y_sim<span class="sc">.</span>mean()<span class="sc">:&lt;10.4f}</span><span class="ss">"</span>)</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Sums of Squares:"</span>)</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>total_ss <span class="op">=</span> np.<span class="bu">sum</span>((y_sim <span class="op">-</span> y_sim.mean())<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>explained_ss <span class="op">=</span> np.<span class="bu">sum</span>((model_sim.fittedvalues <span class="op">-</span> y_sim.mean())<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>residual_ss <span class="op">=</span> np.<span class="bu">sum</span>(model_sim.resid<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Total SS     = </span><span class="sc">{</span>total_ss<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Explained SS = </span><span class="sc">{</span>explained_ss<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Residual SS  = </span><span class="sc">{</span>residual_ss<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Check: Explained SS + Residual SS = </span><span class="sc">{</span>explained_ss <span class="op">+</span> residual_ss<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"       Total SS                     = </span><span class="sc">{</span>total_ss<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">R¬≤ = Explained SS / Total SS = </span><span class="sc">{</span>explained_ss <span class="op">/</span> total_ss<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"R¬≤ from model = </span><span class="sc">{</span>model_sim<span class="sc">.</span>rsquared<span class="sc">:.4f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
SIMULATED DATA FOR MODEL FIT ILLUSTRATION
======================================================================

x     y          ≈∑          Residual (e)    (y - »≥)    (≈∑ - »≥)   
----------------------------------------------------------------------
1     3.9382     2.2482     1.6900          -2.5632    -4.2533   
2     4.4343     4.3748     0.0595          -2.0672    -2.1266   
3     3.9819     6.5015     -2.5196         -2.5196    -0.0000   
4     6.7287     8.6281     -1.8994         0.2273     2.1266    
5     13.4242    10.7548    2.6695          6.9228     4.2533    

Sums of Squares:
  Total SS     = 65.1680
  Explained SS = 45.2262
  Residual SS  = 19.9418

Check: Explained SS + Residual SS = 65.1680
       Total SS                     = 65.1680

R¬≤ = Explained SS / Total SS = 0.6940
R¬≤ from model = 0.6940</code></pre>
</div>
</div>
<div id="cell-45" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:31.661786Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:31.661253Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:32.217268Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:32.216770Z&quot;}}" data-execution_count="15">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization of model fit</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">5</span>))</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel A: Total SS (deviations from mean)</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].scatter(x_sim, y_sim, s<span class="op">=</span><span class="dv">100</span>, color<span class="op">=</span><span class="st">'#22d3ee'</span>, marker<span class="op">=</span><span class="st">'^'</span>, label<span class="op">=</span><span class="st">'Actual y'</span>, zorder<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].axhline(y<span class="op">=</span>y_sim.mean(), color<span class="op">=</span><span class="st">'red'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, linestyle<span class="op">=</span><span class="st">'--'</span>,</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>                label<span class="op">=</span><span class="ss">f'Mean of y = </span><span class="sc">{</span>y_sim<span class="sc">.</span>mean()<span class="sc">:.2f}</span><span class="ss">'</span>, zorder<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw vertical lines from points to mean</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(x_sim)):</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].plot([x_sim[i], x_sim[i]], [y_sim[i], y_sim.mean()],</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>                 <span class="st">'-'</span>, color<span class="op">=</span><span class="st">'#c084fc'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, zorder<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">'x'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'y'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">'Panel A: Total SS</span><span class="ch">\n</span><span class="st">(Deviations from Mean)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].legend()</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel B: Explained SS (deviations of fitted values from mean)</span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].scatter(x_sim, model_sim.fittedvalues, s<span class="op">=</span><span class="dv">100</span>, color<span class="op">=</span><span class="st">'#22d3ee'</span>,</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>                marker<span class="op">=</span><span class="st">'o'</span>, label<span class="op">=</span><span class="st">'Fitted ≈∑'</span>, zorder<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].axhline(y<span class="op">=</span>y_sim.mean(), color<span class="op">=</span><span class="st">'red'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, linestyle<span class="op">=</span><span class="st">'--'</span>,</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>                label<span class="op">=</span><span class="ss">f'Mean of y = </span><span class="sc">{</span>y_sim<span class="sc">.</span>mean()<span class="sc">:.2f}</span><span class="ss">'</span>, zorder<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw vertical lines from fitted values to mean</span></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(x_sim)):</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].plot([x_sim[i], x_sim[i]], [model_sim.fittedvalues[i], y_sim.mean()],</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>                 <span class="st">'g-'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, zorder<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">'x'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">'≈∑'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">'Panel B: Explained SS</span><span class="ch">\n</span><span class="st">(Fitted Values from Mean)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].legend()</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">'Model Fit Illustration'</span>,</span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, y<span class="op">=</span><span class="fl">1.00</span>)</span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Panel A shows Total SS: how far actual y values are from their mean"</span>)</span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Panel B shows Explained SS: how far fitted values are from the mean"</span>)</span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"R¬≤ = (Explained SS) / (Total SS) measures the proportion explained"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05_Bivariate_Data_Summary_files/figure-html/cell-16-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Panel A shows Total SS: how far actual y values are from their mean
Panel B shows Explained SS: how far fitted values are from the mean
R¬≤ = (Explained SS) / (Total SS) measures the proportion explained</code></pre>
</div>
</div>
<p><strong>Practical Implications of R¬≤ in Economics:</strong></p>
<p>In applied econometrics, R¬≤ values around 0.60 are considered quite strong for cross-sectional data. Our R¬≤ = 0.617 tells us:</p>
<ul>
<li><strong>Size is a major determinant</strong>: House size explains most of the price variation</li>
<li><strong>Other factors matter</strong>: The remaining 38% is due to location, quality, age, amenities, etc.</li>
<li><strong>Single-variable limits</strong>: One predictor can only explain so much in complex real-world data</li>
</ul>
<p><strong>Why R¬≤ varies by context:</strong></p>
<ul>
<li><strong>Lab experiments</strong>: Often R¬≤ &gt; 0.90 (controlled conditions, few confounding factors)</li>
<li><strong>Cross-sectional economics</strong>: Typically R¬≤ = 0.20-0.60 (many unobserved heterogeneities)</li>
<li><strong>Time series data</strong>: Often R¬≤ = 0.70-0.95 (trends and persistence dominate)</li>
</ul>
<p><strong>Next step:</strong> This motivates <strong>multiple regression</strong> (Chapters 10-12), where we include many explanatory variables simultaneously to capture more of the variation in y.</p>
</section>
</section>
<section id="computer-output-following-regression" class="level2">
<h2 class="anchored" data-anchor-id="computer-output-following-regression">5.7 Computer Output Following Regression</h2>
<p>Modern statistical software provides comprehensive regression output. Let‚Äôs examine each component of the output for our house price regression.</p>
<p><strong>Understanding Prediction Uncertainty:</strong></p>
<p>Our prediction ≈∑ = $262,559 for a 2,000 sq ft house is a <strong>point estimate</strong> ‚Äî our best single guess. But predictions have uncertainty:</p>
<p><strong>Sources of uncertainty:</strong></p>
<ul>
<li><strong>Estimation error</strong>: We don‚Äôt know the true Œ≤‚ÇÅ and Œ≤‚ÇÇ, only estimates b‚ÇÅ and b‚ÇÇ</li>
<li><strong>Fundamental randomness</strong>: Even houses of identical size sell for different prices</li>
<li><strong>Model limitations</strong>: Our simple model omits many price determinants</li>
</ul>
<p><strong>Preview of Chapter 7</strong>: We‚Äôll learn to construct <strong>prediction intervals</strong> like:</p>
<ul>
<li>‚ÄúWe‚Äôre 95% confident the price will be between $215,000 and $310,000‚Äù</li>
<li>This acknowledges uncertainty while still providing useful guidance</li>
</ul>
<p>For now, remember: the standard error ($23,551) gives a rough sense of typical prediction errors.</p>
<div id="cell-49" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:32.220759Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:32.220475Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:32.232109Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:32.231564Z&quot;}}" data-execution_count="16">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display full regression output</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"COMPLETE REGRESSION OUTPUT"</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model.summary())</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"GUIDE TO REGRESSION OUTPUT"</span>)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">1. TOP SECTION - Model Summary:"</span>)</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   ‚Ä¢ Dep. Variable: price (what we're predicting)"</span>)</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   ‚Ä¢ No. Observations: </span><span class="sc">{</span><span class="bu">int</span>(model.nobs)<span class="sc">}</span><span class="ss"> (sample size)"</span>)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   ‚Ä¢ R-squared: </span><span class="sc">{</span>model<span class="sc">.</span>rsquared<span class="sc">:.4f}</span><span class="ss"> (goodness of fit)"</span>)</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   ‚Ä¢ F-statistic: </span><span class="sc">{</span>model<span class="sc">.</span>fvalue<span class="sc">:.2f}</span><span class="ss"> (overall significance)"</span>)</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">2. MIDDLE SECTION - Coefficients Table:"</span>)</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   ‚Ä¢ coef: Estimated slope and intercept"</span>)</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   ‚Ä¢ std err: Standard error (precision measure)"</span>)</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   ‚Ä¢ t: t-statistic for testing H‚ÇÄ: coefficient = 0"</span>)</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   ‚Ä¢ P&gt;|t|: p-value for significance test"</span>)</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   ‚Ä¢ [0.025  0.975]: 95% confidence interval"</span>)</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">3. BOTTOM SECTION - Diagnostic Tests:"</span>)</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   ‚Ä¢ Omnibus: Test for normality of residuals"</span>)</span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   ‚Ä¢ Durbin-Watson: Test for autocorrelation"</span>)</span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   ‚Ä¢ Jarque-Bera: Another normality test"</span>)</span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   ‚Ä¢ Cond. No.: Multicollinearity diagnostic"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
COMPLETE REGRESSION OUTPUT
======================================================================
                            OLS Regression Results                            
==============================================================================
Dep. Variable:                  price   R-squared:                       0.617
Model:                            OLS   Adj. R-squared:                  0.603
Method:                 Least Squares   F-statistic:                     43.58
Date:                Tue, 17 Feb 2026   Prob (F-statistic):           4.41e-07
Time:                        22:12:32   Log-Likelihood:                -332.05
No. Observations:                  29   AIC:                             668.1
Df Residuals:                      27   BIC:                             670.8
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept    1.15e+05   2.15e+04      5.352      0.000    7.09e+04    1.59e+05
size          73.7710     11.175      6.601      0.000      50.842      96.700
==============================================================================
Omnibus:                        0.576   Durbin-Watson:                   1.219
Prob(Omnibus):                  0.750   Jarque-Bera (JB):                0.638
Skew:                          -0.078   Prob(JB):                        0.727
Kurtosis:                       2.290   Cond. No.                     9.45e+03
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The condition number is large, 9.45e+03. This might indicate that there are
strong multicollinearity or other numerical problems.

======================================================================
GUIDE TO REGRESSION OUTPUT
======================================================================

1. TOP SECTION - Model Summary:
   ‚Ä¢ Dep. Variable: price (what we're predicting)
   ‚Ä¢ No. Observations: 29 (sample size)
   ‚Ä¢ R-squared: 0.6175 (goodness of fit)
   ‚Ä¢ F-statistic: 43.58 (overall significance)

2. MIDDLE SECTION - Coefficients Table:
   ‚Ä¢ coef: Estimated slope and intercept
   ‚Ä¢ std err: Standard error (precision measure)
   ‚Ä¢ t: t-statistic for testing H‚ÇÄ: coefficient = 0
   ‚Ä¢ P&gt;|t|: p-value for significance test
   ‚Ä¢ [0.025  0.975]: 95% confidence interval

3. BOTTOM SECTION - Diagnostic Tests:
   ‚Ä¢ Omnibus: Test for normality of residuals
   ‚Ä¢ Durbin-Watson: Test for autocorrelation
   ‚Ä¢ Jarque-Bera: Another normality test
   ‚Ä¢ Cond. No.: Multicollinearity diagnostic</code></pre>
</div>
</div>
</section>
<section id="prediction-and-outliers" class="level2">
<h2 class="anchored" data-anchor-id="prediction-and-outliers">5.8 Prediction and Outliers</h2>
<p>Once we have a fitted regression line, we can use it to predict y for any given value of x:</p>
<p><span class="math display">\[\hat{y} = b_1 + b_2 x^*\]</span></p>
<p><strong>Two types of predictions:</strong></p>
<ol type="1">
<li><strong>In-sample:</strong> x is within the range of observed data (reliable)</li>
<li><strong>Out-of-sample:</strong> x is outside the observed range (extrapolation - use with caution)</li>
</ol>
<p><strong>Outliers</strong> are observations that are unusually far from the regression line. They may indicate:</p>
<ul>
<li>Data entry errors</li>
<li>Unusual circumstances</li>
<li>Model misspecification</li>
<li>Natural variation</li>
</ul>
<div id="cell-51" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:32.234810Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:32.234578Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:32.246060Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:32.245324Z&quot;}}" data-execution_count="17">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prediction example</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"PREDICTION EXAMPLES"</span>)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict for a 2000 sq ft house</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>new_size <span class="op">=</span> pd.DataFrame({<span class="st">'size'</span>: [<span class="dv">2000</span>]})</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>predicted_price <span class="op">=</span> model.predict(new_size)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Example 1: Predict price for a 2,000 sq ft house"</span>)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Using the model: ≈∑ = </span><span class="sc">{</span>intercept<span class="sc">:.2f}</span><span class="ss"> + </span><span class="sc">{</span>slope<span class="sc">:.2f}</span><span class="ss"> √ó 2000"</span>)</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Predicted price: $</span><span class="sc">{</span>predicted_price<span class="sc">.</span>values[<span class="dv">0</span>]<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Manual calculation</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>manual_prediction <span class="op">=</span> intercept <span class="op">+</span> slope <span class="op">*</span> <span class="dv">2000</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Manual check: $</span><span class="sc">{</span>manual_prediction<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiple predictions</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Example 2: Predictions for various house sizes"</span>)</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>sizes_to_predict <span class="op">=</span> [<span class="dv">1500</span>, <span class="dv">1800</span>, <span class="dv">2000</span>, <span class="dv">2500</span>, <span class="dv">3000</span>]</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>predictions <span class="op">=</span> pd.DataFrame({<span class="st">'size'</span>: sizes_to_predict})</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>predictions[<span class="st">'predicted_price'</span>] <span class="op">=</span> model.predict(predictions)</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(predictions.to_string(index<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Observed size range: </span><span class="sc">{</span>size<span class="sc">.</span><span class="bu">min</span>()<span class="sc">:.0f}</span><span class="ss"> to </span><span class="sc">{</span>size<span class="sc">.</span><span class="bu">max</span>()<span class="sc">:.0f}</span><span class="ss"> sq ft"</span>)</span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  1500, 1800, 2000 are in-sample (reliable)"</span>)</span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  3000 is at the edge; 3500+ would be extrapolation (less reliable)"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
PREDICTION EXAMPLES
======================================================================

Example 1: Predict price for a 2,000 sq ft house
  Using the model: ≈∑ = 115017.28 + 73.77 √ó 2000
  Predicted price: $262,559.36
  Manual check: $262,559.36

Example 2: Predictions for various house sizes
 size  predicted_price
 1500    225673.843168
 1800    247805.155280
 2000    262559.363354
 2500    299444.883540
 3000    336330.403727

Observed size range: 1400 to 3300 sq ft
  1500, 1800, 2000 are in-sample (reliable)
  3000 is at the edge; 3500+ would be extrapolation (less reliable)</code></pre>
</div>
</div>
<p><strong>Example prediction: 2,000 sq ft house</strong></p>
<p><strong>Predicted price: $262,559</strong></p>
<p>Using our regression equation:</p>
<pre><code>≈∑ = \$115,017 + \$73.77 √ó 2,000 = \$262,559</code></pre>
<p><strong>How reliable is this prediction?</strong></p>
<p><strong>1. In-sample vs.&nbsp;out-of-sample:</strong></p>
<ul>
<li>Our data range: 1,400 to 3,300 sq ft</li>
<li>Prediction at 2,000 sq ft: <strong>in-sample</strong> (safe)</li>
<li>Prediction at 5,000 sq ft: <strong>out-of-sample</strong> (risky extrapolation)</li>
</ul>
<p><strong>2. Prediction accuracy:</strong></p>
<ul>
<li>Standard error: $23,162</li>
<li>Typical error: about ¬±$23,000 around the prediction</li>
<li><strong>Informal prediction interval</strong>: roughly $239,000 to $286,000</li>
<li>(Chapter 7 will cover formal prediction intervals)</li>
</ul>
<p><strong>3. Why predictions aren‚Äôt perfect:</strong></p>
<ul>
<li>Our model only includes size</li>
<li>Missing factors affect individual houses:
<ul>
<li>Neighborhood quality</li>
<li>Number of bathrooms</li>
<li>Lot size</li>
<li>Age and condition</li>
<li>Unique features</li>
</ul></li>
</ul>
<p><strong>Understanding residuals:</strong></p>
<p>A <strong>residual</strong> is the prediction error for one observation:</p>
<pre><code>residual = actual price - predicted price
         = y - ≈∑</code></pre>
<p><strong>Positive residual</strong>: House sold for MORE than predicted (underestimate) <strong>Negative residual</strong>: House sold for LESS than predicted (overestimate)</p>
<p><strong>Why do some houses have large residuals?</strong></p>
<ul>
<li>Particularly desirable/undesirable location</li>
<li>Exceptional quality or poor condition</li>
<li>Unique features not captured by size alone</li>
<li>May indicate measurement error or unusual circumstances</li>
</ul>
<p><strong>Key insight:</strong> The regression line gives the <strong>average</strong> relationship. Individual houses deviate from this average based on their unique characteristics.</p>
<div id="cell-53" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:32.249216Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:32.248962Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:32.261692Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:32.261168Z&quot;}}" data-execution_count="18">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify potential outliers using residuals</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"OUTLIER DETECTION"</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Add residuals and standardized residuals to dataset</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>data_house[<span class="st">'fitted'</span>] <span class="op">=</span> model.fittedvalues</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>data_house[<span class="st">'residual'</span>] <span class="op">=</span> model.resid</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>data_house[<span class="st">'std_resid'</span>] <span class="op">=</span> model.resid <span class="op">/</span> model.resid.std()</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Observations with large residuals (&gt;2 std deviations)</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>outliers <span class="op">=</span> data_house[np.<span class="bu">abs</span>(data_house[<span class="st">'std_resid'</span>]) <span class="op">&gt;</span> <span class="dv">2</span>]</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Observations with large residuals (|standardized residual| &gt; 2):"</span>)</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">len</span>(outliers) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(outliers[[<span class="st">'price'</span>, <span class="st">'size'</span>, <span class="st">'fitted'</span>, <span class="st">'residual'</span>, <span class="st">'std_resid'</span>]])</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"  None found (all residuals within 2 standard deviations)"</span>)</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Top 5 largest residuals (in absolute value):"</span>)</span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>top_residuals <span class="op">=</span> data_house.nlargest(<span class="dv">5</span>, <span class="st">'residual'</span>, keep<span class="op">=</span><span class="st">'all'</span>)[[<span class="st">'price'</span>, <span class="st">'size'</span>, <span class="st">'fitted'</span>, <span class="st">'residual'</span>]]</span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(top_residuals)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
======================================================================
OUTLIER DETECTION
======================================================================

Observations with large residuals (|standardized residual| &gt; 2):
     price  size         fitted      residual  std_resid
27  340000  2400  292067.779503  47932.220497   2.072629

Top 5 largest residuals (in absolute value):
     price  size         fitted      residual
27  340000  2400  292067.779503  47932.220497
18  255000  1500  225673.843168  29326.156832
15  245000  1400  218296.739130  26703.260870
19  258500  1600  233050.947205  25449.052795
26  310000  2300  284690.675466  25309.324534</code></pre>
</div>
</div>
</section>
<section id="regression-and-correlation" class="level2">
<h2 class="anchored" data-anchor-id="regression-and-correlation">5.9 Regression and Correlation</h2>
<p>There‚Äôs a close relationship between the regression slope and the correlation coefficient:</p>
<p><span class="math display">\[b_2 = r_{xy} \times \frac{s_y}{s_x}\]</span></p>
<p><strong>Key insights:</strong></p>
<ul>
<li><span class="math inline">\(r_{xy} &gt; 0 \Rightarrow b_2 &gt; 0\)</span> (positive correlation means positive slope)</li>
<li><span class="math inline">\(r_{xy} &lt; 0 \Rightarrow b_2 &lt; 0\)</span> (negative correlation means negative slope)</li>
<li><span class="math inline">\(r_{xy} = 0 \Rightarrow b_2 = 0\)</span> (zero correlation means zero slope)</li>
</ul>
<p><strong>But regression and correlation differ:</strong></p>
<ul>
<li>Correlation treats x and y symmetrically: <span class="math inline">\(r_{xy} = r_{yx}\)</span></li>
<li>Regression does not: slope from regressing y on x <span class="math inline">\(\neq\)</span> inverse of slope from regressing x on y</li>
</ul>
<p><strong>Why This Relationship Matters:</strong></p>
<p>The formula <strong>b‚ÇÇ = r √ó (s·µß/s‚Çì)</strong> reveals an important insight about the connection between correlation and regression:</p>
<p><strong>Correlation (r):</strong></p>
<ul>
<li>Scale-free measure (unitless)</li>
<li>Same value regardless of measurement units</li>
<li>Symmetric: r(price, size) = r(size, price)</li>
</ul>
<p><strong>Regression slope (b‚ÇÇ):</strong></p>
<ul>
<li>Scale-dependent (has units: $/sq ft in our example)</li>
<li>Changes when we rescale variables</li>
<li>Asymmetric: slope from price~size ‚â† inverse of slope from size~price</li>
</ul>
<p><strong>The ratio (s·µß/s‚Çì):</strong></p>
<ul>
<li>Converts between correlation and slope</li>
<li>Accounts for the relative variability of y and x</li>
<li>Explains why slopes have interpretable units while r does not</li>
</ul>
<p><strong>Practical implication:</strong> This is why we use <strong>regression</strong> (not just correlation) in economics‚Äîwe need interpretable coefficients with units ($/sq ft, % change, etc.) to make policy recommendations and predictions.</p>
<div id="cell-56" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:32.264890Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:32.264632Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:32.270246Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:32.269448Z&quot;}}" data-execution_count="19">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify relationship between slope and correlation</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"RELATIONSHIP: SLOPE = CORRELATION √ó (SD_Y / SD_X)"</span>)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> corr_matrix.loc[<span class="st">'price'</span>, <span class="st">'size'</span>]</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>s_y <span class="op">=</span> price.std()</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>s_x <span class="op">=</span> size.std()</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>b2_from_r <span class="op">=</span> r <span class="op">*</span> (s_y <span class="op">/</span> s_x)</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">From regression:"</span>)</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Slope (b‚ÇÇ) = </span><span class="sc">{</span>slope<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">From correlation:"</span>)</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  r = </span><span class="sc">{</span>r<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  s_y = </span><span class="sc">{</span>s_y<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  s_x = </span><span class="sc">{</span>s_x<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  b‚ÇÇ = r √ó (s_y / s_x) = </span><span class="sc">{</span>r<span class="sc">:.4f}</span><span class="ss"> √ó (</span><span class="sc">{</span>s_y<span class="sc">:.4f}</span><span class="ss"> / </span><span class="sc">{</span>s_x<span class="sc">:.4f}</span><span class="ss">) = </span><span class="sc">{</span>b2_from_r<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Match: </span><span class="sc">{</span>np<span class="sc">.</span>isclose(slope, b2_from_r)<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
RELATIONSHIP: SLOPE = CORRELATION √ó (SD_Y / SD_X)
======================================================================

From regression:
  Slope (b‚ÇÇ) = 73.7710

From correlation:
  r = 0.7858
  s_y = 37390.7107
  s_x = 398.2721
  b‚ÇÇ = r √ó (s_y / s_x) = 0.7858 √ó (37390.7107 / 398.2721) = 73.7710

Match: True</code></pre>
</div>
</div>
</section>
<section id="causation" class="level2">
<h2 class="anchored" data-anchor-id="causation">5.10 Causation</h2>
<p><strong>Critical distinction:</strong> Regression measures <strong>association</strong>, not <strong>causation</strong>.</p>
<p>Our regression shows that larger houses are associated with higher prices. But we cannot conclude that:</p>
<ul>
<li>Adding square footage to a house will increase its price by $73.77 per sq ft</li>
</ul>
<p><strong>Why not?</strong></p>
<ul>
<li><strong>Omitted variables:</strong> Many factors affect price (location, quality, age, condition)</li>
<li><strong>Reverse causality:</strong> Could price influence size? (e.g., builders construct larger houses in expensive areas)</li>
<li><strong>Confounding:</strong> A third variable (e.g., neighborhood quality) may influence both size and price</li>
</ul>
<p><strong>Demonstrating non-symmetry: Reverse regression</strong></p>
<p>If we regress x on y (instead of y on x), we get a different slope:</p>
<ul>
<li>Original: <span class="math inline">\(\hat{y} = b_1 + b_2 x\)</span></li>
<li>Reverse: <span class="math inline">\(\hat{x} = c_1 + c_2 y\)</span></li>
</ul>
<p>These two regressions answer different questions and have different slopes!</p>
<blockquote class="blockquote">
<p><strong>Key Concept 5.7: Association vs.&nbsp;Causation</strong></p>
<p>Regression measures association, not causation. A regression coefficient shows how much y changes when x changes, but does not prove that x causes y. Causation requires additional assumptions, experimental design, or advanced econometric techniques (Chapter 17). Regression is directional and asymmetric: regressing y on x gives a different slope than regressing x on y.</p>
</blockquote>
<p><strong>Transition Note:</strong> We‚Äôve learned how to measure and quantify relationships. Now we address a critical question: does association imply causation? This distinction is fundamental to interpreting regression results correctly.</p>
<div id="cell-60" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:32.274869Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:32.274566Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:32.286047Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:32.285415Z&quot;}}" data-execution_count="20">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reverse regression: size ~ price</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"REVERSE REGRESSION: DEMONSTRATING NON-SYMMETRY"</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>reverse_model <span class="op">=</span> ols(<span class="st">'size ~ price'</span>, data<span class="op">=</span>data_house).fit()</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Original Regression (price ~ size):"</span>)</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  ≈∑ = </span><span class="sc">{</span>model<span class="sc">.</span>params[<span class="st">'Intercept'</span>]<span class="sc">:,.2f}</span><span class="ss"> + </span><span class="sc">{</span>model<span class="sc">.</span>params[<span class="st">'size'</span>]<span class="sc">:.4f}</span><span class="ss"> √ó size"</span>)</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Slope: </span><span class="sc">{</span>model<span class="sc">.</span>params[<span class="st">'size'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  R-squared: </span><span class="sc">{</span>model<span class="sc">.</span>rsquared<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Reverse Regression (size ~ price):"</span>)</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  xÃÇ = </span><span class="sc">{</span>reverse_model<span class="sc">.</span>params[<span class="st">'Intercept'</span>]<span class="sc">:.2f}</span><span class="ss"> + </span><span class="sc">{</span>reverse_model<span class="sc">.</span>params[<span class="st">'price'</span>]<span class="sc">:.6f}</span><span class="ss"> √ó price"</span>)</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Slope: </span><span class="sc">{</span>reverse_model<span class="sc">.</span>params[<span class="st">'price'</span>]<span class="sc">:.6f}</span><span class="ss">"</span>)</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  R-squared: </span><span class="sc">{</span>reverse_model<span class="sc">.</span>rsquared<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Comparison:"</span>)</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  1 / b‚ÇÇ = 1 / </span><span class="sc">{</span>model<span class="sc">.</span>params[<span class="st">'size'</span>]<span class="sc">:.4f}</span><span class="ss"> = </span><span class="sc">{</span><span class="dv">1</span><span class="op">/</span>model<span class="sc">.</span>params[<span class="st">'size'</span>]<span class="sc">:.6f}</span><span class="ss">"</span>)</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  c‚ÇÇ = </span><span class="sc">{</span>reverse_model<span class="sc">.</span>params[<span class="st">'price'</span>]<span class="sc">:.6f}</span><span class="ss">"</span>)</span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Are they equal? </span><span class="sc">{</span>np<span class="sc">.</span>isclose(<span class="dv">1</span><span class="op">/</span>model.params[<span class="st">'size'</span>], reverse_model.params[<span class="st">'price'</span>])<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Key insight:"</span>)</span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  ‚Ä¢ Original slope: $1 increase in size ‚Üí $</span><span class="sc">{:.2f}</span><span class="st"> increase in price"</span>.<span class="bu">format</span>(model.params[<span class="st">'size'</span>]))</span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  ‚Ä¢ Reverse slope: $1 increase in price ‚Üí </span><span class="sc">{:.6f}</span><span class="st"> sq ft increase in size"</span>.<span class="bu">format</span>(reverse_model.params[<span class="st">'price'</span>]))</span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  ‚Ä¢ These answer different questions!"</span>)</span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Note: Both regressions have the same R¬≤ because in simple regression,"</span>)</span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"      R¬≤ = r¬≤ regardless of which variable is on the left-hand side."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
REVERSE REGRESSION: DEMONSTRATING NON-SYMMETRY
======================================================================

Original Regression (price ~ size):
  ≈∑ = 115,017.28 + 73.7710 √ó size
  Slope: 73.7710
  R-squared: 0.6175

Reverse Regression (size ~ price):
  xÃÇ = -242.44 + 0.008370 √ó price
  Slope: 0.008370
  R-squared: 0.6175

Comparison:
  1 / b‚ÇÇ = 1 / 73.7710 = 0.013555
  c‚ÇÇ = 0.008370
  Are they equal? False

Key insight:
  ‚Ä¢ Original slope: $1 increase in size ‚Üí $73.77 increase in price
  ‚Ä¢ Reverse slope: $1 increase in price ‚Üí 0.008370 sq ft increase in size
  ‚Ä¢ These answer different questions!

Note: Both regressions have the same R¬≤ because in simple regression,
      R¬≤ = r¬≤ regardless of which variable is on the left-hand side.</code></pre>
</div>
</div>
<p><strong>CRITICAL DISTINCTION: Association ‚â† Causation</strong></p>
<p><strong>What our regression shows:</strong></p>
<pre><code>price = 115,017 + 73.77 √ó size</code></pre>
<p><strong>What we CAN say:</strong></p>
<ul>
<li>Larger houses are <strong>associated with</strong> higher prices</li>
<li>Size and price move together in a predictable way</li>
<li>We can <strong>predict</strong> price from size with reasonable accuracy</li>
</ul>
<p><strong>What we CANNOT say:</strong></p>
<ul>
<li>Adding square footage to your house will increase its value by exactly $73.77 per sq ft</li>
<li>Size <strong>causes</strong> the price to be higher</li>
<li>Buying a bigger house will make it worth more</li>
</ul>
<p><strong>Why not? Three reasons:</strong></p>
<p><strong>1. Omitted variables (confounding)</strong></p>
<ul>
<li>Many factors affect BOTH size and price:
<ul>
<li><strong>Neighborhood quality</strong>: Rich neighborhoods have larger, more expensive houses</li>
<li><strong>Lot size</strong>: Bigger lots allow bigger houses AND command higher prices</li>
<li><strong>Build quality</strong>: High-quality construction ‚Üí larger AND more expensive</li>
</ul></li>
<li>The $73.77 coefficient captures both direct effects of size AND correlated factors</li>
</ul>
<p><strong>2. Reverse causality</strong></p>
<ul>
<li>Our model: size ‚Üí price</li>
<li>Alternative: price ‚Üí size?
<ul>
<li>In expensive areas, builders construct larger houses because buyers can afford them</li>
<li>The causal arrow may run both ways</li>
</ul></li>
</ul>
<p><strong>3. Measurement of different concepts</strong></p>
<ul>
<li><strong>Cross-sectional comparison</strong>: 2,000 sq ft house vs.&nbsp;1,500 sq ft house (different houses)</li>
<li><strong>Causal question</strong>: What happens if we ADD 500 sq ft to ONE house?</li>
<li>These are different questions with potentially different answers!</li>
</ul>
<p><strong>The reverse regression demonstration:</strong></p>
<p><strong>Original</strong>: price ~ size</p>
<ul>
<li>Slope: $73.77 per sq ft</li>
</ul>
<p><strong>Reverse</strong>: size ~ price</p>
<ul>
<li>Slope: 0.00837 sq ft per dollar</li>
</ul>
<p><strong>Key observation:</strong></p>
<ul>
<li>If regression = causation, these should be reciprocals</li>
<li>1 / 73.77 = 0.01355 ‚â† 0.00837</li>
<li>They‚Äôre NOT reciprocals! This reveals regression measures association, not causation</li>
</ul>
<p><strong>When can we claim causation?</strong></p>
<ul>
<li><strong>Randomized experiments</strong>: Randomly assign house sizes</li>
<li><strong>Natural experiments</strong>: Find exogenous variation in size</li>
<li><strong>Careful econometric methods</strong>: Instrumental variables, difference-in-differences, etc. (advanced topics)</li>
</ul>
<p><strong>Economic intuition:</strong> In reality, building an addition probably DOES increase house value, but perhaps not by exactly $73.77/sq ft. The true causal effect depends on quality, location, and market conditions ‚Äî factors our simple regression doesn‚Äôt isolate.</p>
</section>
<section id="nonparametric-regression" class="level2">
<h2 class="anchored" data-anchor-id="nonparametric-regression">5.11 Nonparametric Regression</h2>
<p><strong>Parametric regression</strong> (like OLS) assumes a specific functional form (e.g., linear).</p>
<p><strong>Nonparametric regression</strong> allows the relationship to be more flexible, letting the data determine the shape without imposing a specific functional form.</p>
<p><strong>Common methods:</strong></p>
<ol type="1">
<li><strong>LOWESS</strong> (Locally Weighted Scatterplot Smoothing): Fits weighted regressions in local neighborhoods</li>
<li><strong>Kernel smoothing:</strong> Weighted averages using kernel functions</li>
<li><strong>Splines:</strong> Piecewise polynomials</li>
</ol>
<p><strong>Uses:</strong></p>
<ul>
<li>Exploratory data analysis</li>
<li>Checking linearity assumption</li>
<li>Flexible modeling when functional form is unknown</li>
</ul>
<p><strong>When to Use Nonparametric vs.&nbsp;Parametric Regression:</strong></p>
<p><strong>Use parametric (OLS linear regression) when:</strong></p>
<ul>
<li>Theory suggests a linear relationship</li>
<li>You need interpretable coefficients ($73.77 per sq ft)</li>
<li>Sample size is small to moderate (n &lt; 100)</li>
<li>You want statistical inference (t-tests, confidence intervals)</li>
</ul>
<p><strong>Use nonparametric (LOWESS, kernel) when:</strong></p>
<ul>
<li>Exploring data without strong prior assumptions</li>
<li>Checking whether linear model is appropriate (diagnostic)</li>
<li>Relationship appears curved or complex</li>
<li>Large sample size (n &gt; 100) provides enough data for flexible fitting</li>
</ul>
<p><strong>Best practice</strong>: Start with scatter plot + nonparametric curve to check for nonlinearity, then use parametric model if linear assumption is reasonable.</p>
<div id="cell-64" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:32.290184Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:32.289842Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:32.734292Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:32.733604Z&quot;}}" data-execution_count="21">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Nonparametric regression</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"NONPARAMETRIC REGRESSION"</span>)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="co"># LOWESS smoothing</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>lowess_result <span class="op">=</span> lowess(price, size, frac<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Kernel smoothing (Gaussian filter approximation)</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>sort_idx <span class="op">=</span> np.argsort(size)</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>size_sorted <span class="op">=</span> size.iloc[sort_idx]</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>price_sorted <span class="op">=</span> price.iloc[sort_idx]</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>sigma <span class="op">=</span> <span class="dv">2</span>  <span class="co"># bandwidth parameter</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>price_smooth <span class="op">=</span> gaussian_filter1d(price_sorted, sigma)</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot comparison</span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">7</span>))</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot</span></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>ax.scatter(size, price, s<span class="op">=</span><span class="dv">80</span>, alpha<span class="op">=</span><span class="fl">0.6</span>, color<span class="op">=</span><span class="st">'#22d3ee'</span>,</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>           edgecolor<span class="op">=</span><span class="st">'#3a4a6b'</span>, label<span class="op">=</span><span class="st">'Actual data'</span>, zorder<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a><span class="co"># OLS line</span></span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>ax.plot(size, model.fittedvalues, color<span class="op">=</span><span class="st">'#c084fc'</span>, linewidth<span class="op">=</span><span class="fl">2.5</span>,</span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>        label<span class="op">=</span><span class="st">'OLS (parametric)'</span>, zorder<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a><span class="co"># LOWESS</span></span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>ax.plot(lowess_result[:, <span class="dv">0</span>], lowess_result[:, <span class="dv">1</span>], color<span class="op">=</span><span class="st">'red'</span>,</span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>        linewidth<span class="op">=</span><span class="fl">2.5</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="st">'LOWESS'</span>, zorder<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Kernel smoothing</span></span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a>ax.plot(size_sorted, price_smooth, color<span class="op">=</span><span class="st">'green'</span>, linewidth<span class="op">=</span><span class="fl">2.5</span>,</span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a>        linestyle<span class="op">=</span><span class="st">':'</span>, label<span class="op">=</span><span class="st">'Kernel smoothing'</span>, zorder<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'House size (in square feet)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'House sale price (in dollars)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Figure 5.6: Parametric vs Nonparametric Regression'</span>,</span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a>ax.legend(fontsize<span class="op">=</span><span class="dv">11</span>, loc<span class="op">=</span><span class="st">'lower right'</span>)</span>
<span id="cb47-40"><a href="#cb47-40" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb47-41"><a href="#cb47-41" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb47-42"><a href="#cb47-42" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb47-43"><a href="#cb47-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-44"><a href="#cb47-44" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Interpretation:"</span>)</span>
<span id="cb47-45"><a href="#cb47-45" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"‚Ä¢ OLS (blue solid): Assumes linear relationship"</span>)</span>
<span id="cb47-46"><a href="#cb47-46" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"‚Ä¢ LOWESS (red dashed): Flexible, data-driven curve"</span>)</span>
<span id="cb47-47"><a href="#cb47-47" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"‚Ä¢ Kernel smoothing (green dotted): Another flexible method"</span>)</span>
<span id="cb47-48"><a href="#cb47-48" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">For this data, all three methods are similar, suggesting"</span>)</span>
<span id="cb47-49"><a href="#cb47-49" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"that the linear model is a reasonable approximation."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
NONPARAMETRIC REGRESSION
======================================================================</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05_Bivariate_Data_Summary_files/figure-html/cell-22-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Interpretation:
‚Ä¢ OLS (blue solid): Assumes linear relationship
‚Ä¢ LOWESS (red dashed): Flexible, data-driven curve
‚Ä¢ Kernel smoothing (green dotted): Another flexible method

For this data, all three methods are similar, suggesting
that the linear model is a reasonable approximation.</code></pre>
</div>
</div>
<p><strong>Comparing three approaches to fitting the data:</strong></p>
<p><strong>1. OLS (Ordinary Least Squares) ‚Äî BLUE LINE</strong></p>
<ul>
<li><strong>Parametric</strong>: Assumes linear relationship</li>
<li><strong>Equation</strong>: ≈∑ = $115,017 + $73.77 √ó size</li>
<li><strong>Advantage</strong>: Simple, interpretable, efficient</li>
<li><strong>Limitation</strong>: Restricted to straight lines</li>
</ul>
<p><strong>2. LOWESS (Locally Weighted Scatterplot Smoothing) ‚Äî RED DASHED</strong></p>
<ul>
<li><strong>Nonparametric</strong>: Lets data determine the shape</li>
<li><strong>Method</strong>: Fits weighted regressions in local neighborhoods</li>
<li><strong>Advantage</strong>: Flexible, can capture curves</li>
<li><strong>Limitation</strong>: Harder to interpret, more complex</li>
</ul>
<p><strong>3. Kernel Smoothing ‚Äî GREEN DOTTED</strong></p>
<ul>
<li><strong>Nonparametric</strong>: Weighted moving averages</li>
<li><strong>Method</strong>: Uses Gaussian kernel to smooth nearby points</li>
<li><strong>Advantage</strong>: Very smooth curves</li>
<li><strong>Limitation</strong>: Choice of bandwidth affects results</li>
</ul>
<p><strong>What does this comparison tell us?</strong></p>
<p><strong>Key observation: All three lines are very similar!</strong></p>
<ul>
<li>LOWESS and kernel smoothing follow OLS closely</li>
<li>No obvious systematic curvature</li>
<li>The relationship appears genuinely linear</li>
</ul>
<p><strong>This validates our linear model:</strong></p>
<ul>
<li>If nonparametric methods showed strong curvature, we‚Äôd question the linear assumption</li>
<li>Since they align with OLS, the linear model is appropriate</li>
<li>We can confidently use the simpler parametric approach</li>
</ul>
<p><strong>When would nonparametric methods differ?</strong></p>
<p><strong>Example scenarios:</strong></p>
<ul>
<li><strong>Diminishing returns</strong>: Price increases with size, but at a decreasing rate</li>
<li><strong>Threshold effects</strong>: Small houses have steep price-size relationship, large houses flatten</li>
<li><strong>Nonlinear relationships</strong>: Exponential, logarithmic, or polynomial patterns</li>
</ul>
<p><strong>For our housing data:</strong></p>
<ul>
<li>Linear model works well</li>
<li>Adding complexity (nonparametric) doesn‚Äôt improve fit much</li>
<li><strong>Occam‚Äôs Razor</strong>: Choose the simpler model when performance is similar</li>
</ul>
<p><strong>Practical use of nonparametric methods:</strong></p>
<ul>
<li><strong>Exploratory analysis</strong>: Check for nonlinearity before modeling</li>
<li><strong>Model diagnostics</strong>: Verify linear assumption</li>
<li><strong>Flexible prediction</strong>: When functional form is unknown</li>
<li><strong>Complex relationships</strong>: When theory doesn‚Äôt suggest specific form</li>
</ul>
<p><strong>Bottom line:</strong> Nonparametric methods confirm that our linear regression is appropriate for this dataset. The relationship between house price and size is genuinely linear, not curved.</p>
</section>
<section id="key-takeaways" class="level2">
<h2 class="anchored" data-anchor-id="key-takeaways">Key Takeaways</h2>
<section id="visualization-and-correlation" class="level3">
<h3 class="anchored" data-anchor-id="visualization-and-correlation">Visualization and Correlation</h3>
<ul>
<li><strong>Two-way tabulations</strong>, scatterplots, and correlation are essential first steps in bivariate analysis</li>
<li><strong>Scatterplots</strong> provide visual evidence of relationships and help identify direction, strength, form, and outliers</li>
<li>Two-way tabulations with <strong>expected frequencies</strong> enable chi-squared tests of independence for categorical data</li>
<li>The <strong>correlation coefficient (r)</strong> is a scale-free measure of linear association ranging from -1 to +1</li>
<li><strong>Covariance</strong> measures the direction of association but depends on the units of measurement</li>
<li>For house price and size, <strong>r = 0.786</strong> indicates strong positive linear association</li>
<li><strong>Autocorrelation</strong> extends correlation to time series, measuring how a variable relates to its own past values</li>
</ul>
</section>
<section id="regression-analysis-and-interpretation" class="level3">
<h3 class="anchored" data-anchor-id="regression-analysis-and-interpretation">Regression Analysis and Interpretation</h3>
<ul>
<li>The <strong>regression line</strong> ≈∑ = b‚ÇÅ + b‚ÇÇx is estimated by <strong>ordinary least squares (OLS)</strong>, which minimizes the sum of squared residuals</li>
<li>The <strong>slope b‚ÇÇ</strong> measures the change in y for a one-unit change in x and is the most important interpretable quantity</li>
<li>For house prices, <strong>b‚ÇÇ = $73.77</strong> means each additional square foot is associated with a $73.77 price increase</li>
<li>The <strong>intercept b‚ÇÅ</strong> represents the predicted y when x = 0 (often not meaningful if x = 0 is outside the data range)</li>
<li><strong>Residuals</strong> (e = y - ≈∑) measure prediction errors; OLS makes the sum of squared residuals as small as possible</li>
<li>Regression of y on only an intercept yields the <strong>sample mean</strong> as the fitted value, showing OLS generalizes univariate statistics</li>
<li>The formulas <strong>b‚ÇÇ = Œ£(x·µ¢ - xÃÑ)(y·µ¢ - »≥) / Œ£(x·µ¢ - xÃÑ)¬≤</strong> and <strong>b‚ÇÅ = »≥ - b‚ÇÇxÃÑ</strong> enable manual computation</li>
<li>The regression slope equals <strong>b‚ÇÇ = r‚Çì·µß √ó (s·µß/s‚Çì)</strong>, connecting regression and correlation</li>
</ul>
</section>
<section id="model-fit-and-evaluation" class="level3">
<h3 class="anchored" data-anchor-id="model-fit-and-evaluation">Model Fit and Evaluation</h3>
<ul>
<li><strong>R-squared</strong> measures the fraction of variation in y explained by x, ranging from 0 (no fit) to 1 (perfect fit)</li>
<li><strong>R¬≤ = (Explained SS) / (Total SS) = 1 - (Residual SS) / (Total SS)</strong></li>
<li>For bivariate regression, <strong>R¬≤ = r¬≤‚Çì·µß</strong> (squared correlation coefficient)</li>
<li>For house prices, <strong>R¬≤ = 0.618</strong> means 62% of price variation is explained by size variation</li>
<li><strong>Standard error of regression (s‚Çë)</strong> measures the typical size of residuals in the units of y</li>
<li><strong>Low R¬≤ doesn‚Äôt mean regression is uninformative</strong>‚Äîthe coefficient can still be statistically significant and economically important</li>
<li>R¬≤ depends on data aggregation and choice of dependent variable; use it to compare models with the <strong>same dependent variable</strong></li>
<li>Computer regression output provides coefficients, standard errors, t-statistics, p-values, F-statistics, and ANOVA decomposition</li>
</ul>
</section>
<section id="prediction-causation-and-extensions" class="level3">
<h3 class="anchored" data-anchor-id="prediction-causation-and-extensions">Prediction, Causation, and Extensions</h3>
<ul>
<li><strong>Predictions</strong> use ≈∑ = b‚ÇÅ + b‚ÇÇx* to forecast y for a given x*</li>
<li><strong>In-sample predictions</strong> use observed x values (fitted values); <strong>out-of-sample predictions</strong> use new x values</li>
<li><strong>Extrapolation</strong> beyond the sample range of x can be unreliable</li>
<li><strong>Outliers</strong> can strongly influence regression estimates, especially if far from both xÃÑ and »≥</li>
<li><strong>Association does not imply causation</strong>‚Äîregression measures correlation, not causal effects</li>
<li><strong>Confounding variables</strong>, reverse causality, or selection bias can create associations without causation</li>
<li>Establishing <strong>causation</strong> requires experimental design, natural experiments, or advanced econometric techniques (Chapter 17)</li>
<li><strong>Regression is directional and asymmetric</strong>: regressing y on x gives a different slope than regressing x on y</li>
<li>The two slopes are <strong>NOT reciprocals</strong>, reflecting that regression treats y and x differently</li>
<li><strong>Nonparametric regression</strong> (local linear, lowess) provides flexible alternatives without assuming linearity</li>
<li>Nonparametric methods are useful for <strong>exploratory analysis</strong> and checking the appropriateness of linear models</li>
</ul>
</section>
<section id="connection-to-economic-analysis" class="level3">
<h3 class="anchored" data-anchor-id="connection-to-economic-analysis">Connection to Economic Analysis</h3>
<ul>
<li>The strong relationship (R¬≤ = 0.62) between size and price makes economic sense: buyers pay a premium for space</li>
<li>The imperfect fit reminds us that <strong>many factors beyond size affect house values</strong> (location, quality, age, condition)</li>
<li>Regression provides the <strong>foundation for econometric analysis</strong>, allowing us to quantify economic relationships</li>
<li>This chapter‚Äôs bivariate methods extend naturally to <strong>multiple regression</strong> (Chapters 10-12) with many explanatory variables</li>
<li>Understanding association vs.&nbsp;causation is <strong>critical for policy analysis</strong> and program evaluation</li>
</ul>
<p><strong>Congratulations!</strong> You‚Äôve mastered the basics of bivariate data analysis and simple linear regression. You now understand how to measure and visualize relationships between two variables, fit and interpret a regression line, assess model fit, and recognize the crucial distinction between association and causation. These tools form the foundation for all econometric analysis!</p>
</section>
</section>
<section id="practice-exercises" class="level2">
<h2 class="anchored" data-anchor-id="practice-exercises">Practice Exercises</h2>
<p>Test your understanding of bivariate data analysis and regression with these exercises.</p>
<p><strong>Exercise 1: Correlation Interpretation</strong></p>
<p>Suppose the correlation between years of education and annual income is r = 0.35.</p>
<ol type="a">
<li><p>What does this correlation tell us about the relationship between education and income?</p></li>
<li><p>If we measured income in thousands of dollars instead of dollars, would the correlation change?</p></li>
<li><p>Can we conclude that education causes higher income? Why or why not?</p></li>
</ol>
<hr>
<p><strong>Exercise 2: Computing Correlation</strong></p>
<p>Given the following data for variables x and y with n = 5 observations:</p>
<ul>
<li>Œ£(x·µ¢ - xÃÑ)(y·µ¢ - »≥) = 20</li>
<li>Œ£(x·µ¢ - xÃÑ)¬≤ = 50</li>
<li>Œ£(y·µ¢ - »≥)¬≤ = 10</li>
</ul>
<ol type="a">
<li><p>Calculate the sample correlation coefficient r.</p></li>
<li><p>Is this a strong, moderate, or weak correlation?</p></li>
<li><p>Is the relationship positive or negative?</p></li>
</ol>
<hr>
<p><strong>Exercise 3: Regression Slope Calculation</strong></p>
<p>For the data in Exercise 2:</p>
<ol type="a">
<li><p>Calculate the regression slope coefficient b‚ÇÇ from regression of y on x.</p></li>
<li><p>Verify the relationship: b‚ÇÇ = r √ó (s·µß / s‚Çì)</p></li>
<li><p>If xÃÑ = 10 and »≥ = 25, calculate the intercept b‚ÇÅ.</p></li>
</ol>
<hr>
<p><strong>Exercise 4: R-squared Interpretation</strong></p>
<p>A regression of test scores on hours studied yields R¬≤ = 0.40.</p>
<ol type="a">
<li><p>What percentage of test score variation is explained by hours studied?</p></li>
<li><p>What percentage is due to other factors?</p></li>
<li><p>Does this mean studying is not important? Explain.</p></li>
<li><p>If the correlation is r = 0.632, verify that R¬≤ = r¬≤.</p></li>
</ol>
<hr>
<p><strong>Exercise 5: Prediction</strong></p>
<p>From the house price regression: ≈∑ = 115,017 + 73.77 √ó size</p>
<ol type="a">
<li><p>Predict the price of a house with 2,200 square feet.</p></li>
<li><p>Predict the price of a house with 5,000 square feet.</p></li>
<li><p>Which prediction is more reliable? Why?</p></li>
<li><p>If the standard error is $23,551, what does this tell us about prediction accuracy?</p></li>
</ol>
<hr>
<p><strong>Exercise 6: Residuals</strong></p>
<p>A house of 1,800 sq ft sold for $270,000. The regression predicts ≈∑ = $247,805.</p>
<ol type="a">
<li><p>Calculate the residual for this observation.</p></li>
<li><p>Is the actual price higher or lower than predicted?</p></li>
<li><p>What might explain this large positive residual?</p></li>
<li><p>Would you consider this an outlier? Why or why not?</p></li>
</ol>
<hr>
<p><strong>Exercise 7: Causation vs.&nbsp;Association</strong></p>
<p>Studies show that ice cream sales and crime rates are positively correlated.</p>
<ol type="a">
<li><p>Does this mean ice cream causes crime? Explain.</p></li>
<li><p>What might be a confounding variable?</p></li>
<li><p>How would you design a study to test for causation?</p></li>
<li><p>Give another example where correlation does not imply causation.</p></li>
</ol>
<hr>
<p><strong>Exercise 8: Python Practice</strong></p>
<p>Using the house price data or your own dataset:</p>
<ol type="a">
<li><p>Create a scatterplot with a fitted regression line.</p></li>
<li><p>Calculate the correlation coefficient using <code>pandas</code> <code>.corr()</code> method.</p></li>
<li><p>Fit an OLS regression using <code>statsmodels</code> and interpret the output.</p></li>
<li><p>Create residual plots to check for outliers.</p></li>
<li><p>Compare OLS with LOWESS nonparametric regression.</p></li>
</ol>
<hr>
<p><strong>Solutions to selected exercises:</strong></p>
<ul>
<li><strong>Exercise 2a</strong>: r = 20 / ‚àö(50 √ó 10) = 20 / ‚àö500 = 0.894</li>
<li><strong>Exercise 3a</strong>: b‚ÇÇ = 20 / 50 = 0.4</li>
<li><strong>Exercise 4a</strong>: 40% explained, 60% due to other factors</li>
<li><strong>Exercise 5a</strong>: ≈∑ = 115,017 + 73.77 √ó 2,200 = $277,311</li>
</ul>
<p>For complete solutions and additional practice problems, see the course website.</p>
</section>
<section id="case-studies" class="level2">
<h2 class="anchored" data-anchor-id="case-studies">Case Studies</h2>
<p>Now that you‚Äôve learned the fundamentals of bivariate analysis, correlation, and regression, let‚Äôs apply these techniques to real economic research questions using the <strong>Economic Convergence Clubs</strong> dataset from Mendez (2020).</p>
<p><strong>Why case studies matter:</strong></p>
<ul>
<li>Bridge theory and application: Move from learning formulas to answering substantive economic questions</li>
<li>Build analytical workflow: Practice the complete cycle from visualization to interpretation</li>
<li>Develop critical thinking: Distinguish association from causation in real data</li>
<li>Connect to research: See how econometric tools support published economic studies</li>
</ul>
<section id="case-study-1-capital-and-productivity-across-countries" class="level3">
<h3 class="anchored" data-anchor-id="case-study-1-capital-and-productivity-across-countries">Case Study 1: Capital and Productivity Across Countries</h3>
<p><strong>Research Question:</strong> What is the relationship between capital per worker and labor productivity across countries? Does this relationship vary by income group?</p>
<p><strong>Background:</strong> Traditional growth theory suggests that countries with more capital per worker should have higher labor productivity. This is the <strong>capital-output relationship</strong>‚Äîa fundamental concept in development economics. However, differences in technology, institutions, and human capital mean that capital alone doesn‚Äôt fully explain productivity differences.</p>
<p>This research (<a href="https://github.com/quarcs-lab/mendez2020-convergence-clubs-code-data">Mendez, 2020</a>) uses panel data from 108 countries to study convergence clubs in labor productivity. Rather than assuming all countries converge to a single equilibrium, the analysis identifies distinct groups (clubs) that converge toward different productivity levels.</p>
<p><strong>The Data:</strong> We‚Äôll use the same dataset from Chapter 1, but now apply Chapter 5‚Äôs bivariate tools:</p>
<ul>
<li><strong>Panel dataset:</strong> 108 countries observed from 1990-2014 (2,700 country-year observations)</li>
<li><strong>Key variables:</strong></li>
<li><code>lp</code>: Labor productivity (output per worker, in 2011 USD PPP)</li>
<li><code>kl</code>: Capital per worker (physical capital stock per worker)</li>
<li><code>h</code>: Human capital index (based on years of schooling)</li>
<li><code>TFP</code>: Total factor productivity (aggregate efficiency)</li>
<li><code>hi1990</code>: High-income country indicator (as of 1990)</li>
<li><code>region</code>: Regional classification</li>
</ul>
<p><strong>Your Task:</strong> Use Chapter 5‚Äôs visualization, correlation, and regression tools to explore the capital-productivity relationship and test whether it differs across country groups.</p>
<blockquote class="blockquote">
<p><strong>Key Concept 5.8: Capital-Productivity Relationship</strong></p>
<p>The regression of labor productivity on capital per worker quantifies the <strong>capital-output elasticity</strong>‚Äîhow much productivity increases when capital per worker rises by 1%. In cross-country data, this relationship reflects both:</p>
<ol type="1">
<li><strong>Diminishing returns to capital</strong> (holding technology constant)</li>
<li><strong>Technology differences</strong> across countries (correlated with capital accumulation)</li>
</ol>
<p>Distinguishing these two effects requires controlling for other factors (human capital, TFP), which we‚Äôll learn in later chapters on multiple regression.</p>
</blockquote>
</section>
<section id="how-to-use-these-tasks" class="level3">
<h3 class="anchored" data-anchor-id="how-to-use-these-tasks">How to Use These Tasks</h3>
<p><strong>Progressive difficulty:</strong></p>
<ul>
<li><strong>Tasks 1-2:</strong> Guided (detailed instructions, code provided)</li>
<li><strong>Tasks 3-4:</strong> Semi-guided (moderate guidance, you write most code)</li>
<li><strong>Tasks 5-6:</strong> Independent (minimal guidance, design your own analysis)</li>
</ul>
<p><strong>Work incrementally:</strong> Complete tasks in order. Each builds on previous skills.</p>
<p><strong>Learn by doing:</strong> Modify code, experiment with variables, interpret results economically.</p>
<section id="task-1-load-and-explore-the-data-guided" class="level4">
<h4 class="anchored" data-anchor-id="task-1-load-and-explore-the-data-guided">Task 1: Load and Explore the Data (Guided)</h4>
<p><strong>Objective:</strong> Load the convergence clubs dataset and generate descriptive statistics for key variables.</p>
<p><strong>Instructions:</strong> Run the code below to load data and examine the structure.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import required libraries</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.formula.api <span class="im">import</span> ols</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Load convergence clubs dataset</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a> <span class="st">"https://raw.githubusercontent.com/quarcs-lab/mendez2020-convergence-clubs-code-data/master/assets/dat.csv"</span>,</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a> index_col<span class="op">=</span>[<span class="st">"country"</span>, <span class="st">"year"</span>]</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>).sort_index()</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Display dataset info</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Dataset shape: </span><span class="sc">{</span>df<span class="sc">.</span>shape[<span class="dv">0</span>]<span class="sc">}</span><span class="ss"> observations, </span><span class="sc">{</span>df<span class="sc">.</span>shape[<span class="dv">1</span>]<span class="sc">}</span><span class="ss"> variables"</span>)</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Countries: </span><span class="sc">{</span><span class="bu">len</span>(df.index.get_level_values(<span class="st">'country'</span>).unique())<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Years: </span><span class="sc">{</span>df<span class="sc">.</span>index<span class="sc">.</span>get_level_values(<span class="st">'year'</span>)<span class="sc">.</span><span class="bu">min</span>()<span class="sc">}</span><span class="ss"> to </span><span class="sc">{</span>df<span class="sc">.</span>index<span class="sc">.</span>get_level_values(<span class="st">'year'</span>)<span class="sc">.</span><span class="bu">max</span>()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Preview first few observations</span></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">First 5 observations:"</span>)</span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df[[<span class="st">'lp'</span>, <span class="st">'kl'</span>, <span class="st">'h'</span>, <span class="st">'TFP'</span>, <span class="st">'hi1990'</span>, <span class="st">'region'</span>]].head())</span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate descriptive statistics</span></span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Descriptive statistics (key variables):"</span>)</span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df[[<span class="st">'lp'</span>, <span class="st">'kl'</span>, <span class="st">'h'</span>, <span class="st">'TFP'</span>]].describe().<span class="bu">round</span>(<span class="dv">2</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>What to observe:</strong></p>
<ul>
<li>How many observations? How many countries?</li>
<li>What is the range of labor productivity (<code>lp</code>)? Capital per worker (<code>kl</code>)?</li>
<li>Are there missing values in key variables?</li>
</ul>
</section>
<section id="task-2-visualize-the-capital-productivity-relationship-semi-guided" class="level4">
<h4 class="anchored" data-anchor-id="task-2-visualize-the-capital-productivity-relationship-semi-guided">Task 2: Visualize the Capital-Productivity Relationship (Semi-guided)</h4>
<p><strong>Objective:</strong> Create a scatterplot to visualize the relationship between capital per worker and labor productivity.</p>
<p><strong>Instructions:</strong></p>
<ol type="1">
<li>Prepare a subset of data with non-missing values for <code>lp</code> and <code>kl</code></li>
<li>Create a scatterplot with capital per worker on the x-axis and labor productivity on the y-axis</li>
<li>Add appropriate labels and title</li>
<li>Interpret the pattern: positive/negative? Linear? Outliers?</li>
</ol>
<p><strong>Starter code:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data (remove missing values)</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>plot_data <span class="op">=</span> df[[<span class="st">'lp'</span>, <span class="st">'kl'</span>]].dropna()</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create scatterplot</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>ax.scatter(plot_data[<span class="st">'kl'</span>], plot_data[<span class="st">'lp'</span>], alpha<span class="op">=</span><span class="fl">0.5</span>, s<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Add labels and formatting</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Capital per Worker (thousands, 2011 USD PPP)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Labor Productivity (thousands, 2011 USD PPP)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Capital per Worker vs. Labor Productivity (108 countries, 1990-2014)'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a><span class="co"># What pattern do you see?</span></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st"> Interpretation:"</span>)</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"- Relationship: [Positive/Negative/No clear pattern]"</span>)</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"- Strength: [Strong/Moderate/Weak]"</span>)</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"- Outliers: [Yes/No] - [Describe if present]"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Questions:</strong></p>
<ul>
<li>Is the relationship positive (as theory predicts)?</li>
<li>Is it approximately linear, or curved?</li>
<li>Are there countries with very high capital but moderate productivity (or vice versa)?</li>
</ul>
</section>
<section id="task-3-calculate-the-correlation-coefficient-semi-guided" class="level4">
<h4 class="anchored" data-anchor-id="task-3-calculate-the-correlation-coefficient-semi-guided">Task 3: Calculate the Correlation Coefficient (Semi-guided)</h4>
<p><strong>Objective:</strong> Quantify the strength of the linear relationship between capital and productivity using the correlation coefficient.</p>
<p><strong>Instructions:</strong></p>
<ol type="1">
<li>Calculate the Pearson correlation coefficient between <code>lp</code> and <code>kl</code></li>
<li>Interpret the magnitude: Is it close to 0 (weak), 0.5 (moderate), or 1.0 (strong)?</li>
<li>Test statistical significance: Is the relationship likely due to chance?</li>
</ol>
<p><strong>Hint:</strong> Use <code>.corr()</code> method or <code>np.corrcoef()</code> function.</p>
<p><strong>Example structure:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate correlation</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>corr <span class="op">=</span> plot_data[[<span class="st">'lp'</span>, <span class="st">'kl'</span>]].corr()</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Correlation matrix:"</span>)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(corr)</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the correlation coefficient</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> corr.loc[<span class="st">'lp'</span>, <span class="st">'kl'</span>]</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Correlation between capital and productivity: r = </span><span class="sc">{</span>r<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Interpretation</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Interpretation:"</span>)</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"- Magnitude: </span><span class="sc">{</span><span class="st">'Strong'</span> <span class="cf">if</span> <span class="bu">abs</span>(r) <span class="op">&gt;</span> <span class="fl">0.7</span> <span class="cf">else</span> <span class="st">'Moderate'</span> <span class="cf">if</span> <span class="bu">abs</span>(r) <span class="op">&gt;</span> <span class="fl">0.4</span> <span class="cf">else</span> <span class="st">'Weak'</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"- Direction: </span><span class="sc">{</span><span class="st">'Positive'</span> <span class="cf">if</span> r <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="st">'Negative'</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"- R¬≤ (shared variation): </span><span class="sc">{</span>r<span class="op">**</span><span class="dv">2</span><span class="sc">:.4f}</span><span class="ss"> (</span><span class="sc">{</span>r<span class="op">**</span><span class="dv">2</span><span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%)"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Questions:</strong></p>
<ul>
<li>How much of the variation in productivity is explained by capital?</li>
<li>Does this match what you observed in the scatterplot?</li>
</ul>
</section>
<section id="task-4-estimate-the-regression-line-more-independent" class="level4">
<h4 class="anchored" data-anchor-id="task-4-estimate-the-regression-line-more-independent">Task 4: Estimate the Regression Line (More Independent)</h4>
<p><strong>Objective:</strong> Estimate an OLS regression of labor productivity on capital per worker and interpret the slope coefficient.</p>
<p><strong>Instructions:</strong></p>
<ol type="1">
<li>Prepare regression data (remove missing values, reset index if needed)</li>
<li>Estimate: <code>lp ~ kl</code> using <code>ols()</code> from statsmodels</li>
<li>Display the regression summary</li>
<li>Extract and interpret the slope coefficient economically</li>
<li>Report the R-squared value</li>
</ol>
<p><strong>Key questions to answer:</strong></p>
<ul>
<li>What is the slope coefficient? Interpret it in economic terms.</li>
<li>Is the coefficient statistically significant (p &lt; 0.05)?</li>
<li>What percentage of productivity variation is explained by capital?</li>
<li>Does the relationship appear causal, or could there be omitted variables?</li>
</ul>
<p><strong>Hint:</strong> Remember to reset the index before regression if you‚Äôre using formula syntax.</p>
<blockquote class="blockquote">
<p><strong>Key Concept 5.9: Interpreting Slope in Economic Context</strong></p>
<p>The regression slope Œ≤‚ÇÅ in <code>productivity = Œ≤‚ÇÄ + Œ≤‚ÇÅ √ó capital</code> measures the <strong>average change in productivity (in thousands of USD) for each additional thousand USD of capital per worker</strong>.</p>
<p>In cross-country data, this captures both: - <strong>True capital effect</strong> (more machines ‚Üí higher output) - <strong>Confounding factors</strong> (richer countries have both more capital AND better technology/institutions)</p>
<p>To isolate the true capital effect, we need <strong>multiple regression</strong> (Chapters 6-9) to control for human capital, TFP, and other factors.</p>
</blockquote>
</section>
<section id="task-5-compare-relationships-across-income-groups-independent" class="level4">
<h4 class="anchored" data-anchor-id="task-5-compare-relationships-across-income-groups-independent">Task 5: Compare Relationships Across Income Groups (Independent)</h4>
<p><strong>Objective:</strong> Investigate whether the capital-productivity relationship differs between high-income and developing countries.</p>
<p><strong>Research Question:</strong> Do high-income countries have a stronger/weaker capital-productivity association than developing countries?</p>
<p><strong>Instructions:</strong></p>
<ol type="1">
<li>Group the data by <code>hi1990</code> (high-income indicator)</li>
<li>Calculate the correlation coefficient for each group separately</li>
<li>Create comparative scatterplots (one color per group)</li>
<li>(Advanced) Run separate regressions for each group and compare slope coefficients</li>
<li>Interpret differences: Why might the relationship vary by income level?</li>
</ol>
<p><strong>Hints:</strong></p>
<ul>
<li>Use <code>df.groupby('hi1990')</code> to split data</li>
<li>Use different colors in scatter plot for each group</li>
<li>Compare both correlations and regression slopes</li>
</ul>
<p><strong>Expected findings:</strong></p>
<ul>
<li>High-income countries may show <strong>weaker</strong> capital-productivity correlation (approaching diminishing returns)</li>
<li>Developing countries may show <strong>stronger</strong> correlation (still accumulating capital)</li>
<li>Consider alternative explanations!</li>
</ul>
</section>
<section id="task-6-explore-alternative-relationships-independent" class="level4">
<h4 class="anchored" data-anchor-id="task-6-explore-alternative-relationships-independent">Task 6: Explore Alternative Relationships (Independent)</h4>
<p><strong>Objective:</strong> Investigate other bivariate relationships relevant to growth and convergence.</p>
<p><strong>Choose ONE of the following research questions:</strong></p>
<p><strong>Option A:</strong> Human capital vs.&nbsp;productivity</p>
<ul>
<li>Research question: Does education (human capital) explain productivity differences?</li>
<li>Variables: <code>lp</code> (productivity) and <code>h</code> (human capital index)</li>
<li>Expected: Positive relationship, but possibly weaker than capital</li>
</ul>
<p><strong>Option B:</strong> TFP vs.&nbsp;productivity</p>
<ul>
<li>Research question: How much of productivity is driven by aggregate efficiency (TFP)?</li>
<li>Variables: <code>lp</code> (productivity) and <code>TFP</code> (total factor productivity)</li>
<li>Expected: Strong positive relationship (TFP is a key driver)</li>
</ul>
<p><strong>Option C:</strong> Time trend in productivity</p>
<ul>
<li>Research question: Has average global productivity increased over time?</li>
<li>Variables: Year vs.&nbsp;average <code>lp</code> across all countries</li>
<li>Expected: Positive trend, but with variation across countries</li>
</ul>
<p><strong>Your analysis should include:</strong></p>
<ol type="1">
<li>Scatterplot with clear labels</li>
<li>Correlation coefficient</li>
<li>Regression results (slope, R¬≤, significance)</li>
<li>Economic interpretation: What does this relationship tell us about growth and development?</li>
</ol>
<blockquote class="blockquote">
<p><strong>Key Concept 5.10: Correlation vs.&nbsp;Causation in Growth Economics</strong></p>
<p>Our regressions show <strong>associations</strong>‚Äîcapital and productivity move together. But association ‚â† causation:</p>
<ol type="1">
<li><strong>Reverse causality:</strong> Does capital cause productivity, or does high productivity enable more capital accumulation?</li>
<li><strong>Omitted variables:</strong> Technology, institutions, geography, culture‚Äîall affect both capital and productivity</li>
<li><strong>Selection effects:</strong> High-income countries differ systematically from developing countries in ways beyond capital</li>
</ol>
<p>Establishing causation requires: - <strong>Controlled experiments</strong> (rarely feasible for countries) - <strong>Natural experiments</strong> (e.g., policy changes, resource discoveries) - <strong>Instrumental variables</strong> (advanced econometric methods, Chapter 14-15)</p>
<p>For now, interpret regression slopes as <strong>descriptive associations</strong>, not causal effects.</p>
</blockquote>
</section>
</section>
<section id="what-youve-learned-from-this-case-study" class="level3">
<h3 class="anchored" data-anchor-id="what-youve-learned-from-this-case-study">What You‚Äôve Learned from This Case Study</h3>
<p>Through this hands-on exploration of capital and productivity across countries, you‚Äôve applied all Chapter 5 tools:</p>
<p><strong>Visualization:</strong> Scatterplots reveal patterns before quantifying relationships</p>
<p><strong>Correlation:</strong> Pearson coefficient quantifies linear association strength</p>
<p><strong>Regression:</strong> OLS slope measures average change in Y per unit change in X</p>
<p><strong>Interpretation:</strong> Translated coefficients into economic meaning (dollars, percentages)</p>
<p><strong>Model fit:</strong> R-squared shows explanatory power (proportion of variation explained)</p>
<p><strong>Comparative analysis:</strong> Group comparisons reveal heterogeneity (relationships vary by income level)</p>
<p><strong>Critical thinking:</strong> Distinguished association from causation; recognized omitted variable bias</p>
<p><strong>Connection to the Research:</strong> The patterns you‚Äôve discovered‚Äîthe capital-productivity relationship, differences across income groups, the role of TFP‚Äîare the empirical foundations for Mendez (2020)‚Äôs convergence clubs analysis. The full research uses advanced methods (nonparametric regression, clustering algorithms) to formally identify clubs, which you‚Äôll learn in later chapters.</p>
<p><strong>Looking ahead:</strong></p>
<ul>
<li><strong>Chapter 6-7:</strong> Multiple regression to control for human capital, TFP, and other factors</li>
<li><strong>Chapter 10-11:</strong> Panel data methods to exploit time variation within countries</li>
<li><strong>Chapter 15-17:</strong> Advanced methods for causal inference and club detection</li>
</ul>
<p><strong>Congratulations!</strong> You‚Äôve completed Chapter 5 and applied bivariate analysis to real cross-country growth data. Continue to Chapter 6 to learn how to extend regression analysis to multiple explanatory variables.</p>
</section>
<section id="case-study-2-nighttime-lights-and-development-a-bivariate-exploration" class="level3">
<h3 class="anchored" data-anchor-id="case-study-2-nighttime-lights-and-development-a-bivariate-exploration">Case Study 2: Nighttime Lights and Development: A Bivariate Exploration</h3>
<p>In Chapter 1, we introduced the DS4Bolivia project and estimated a simple regression of development on nighttime lights. In this case study, we apply Chapter 5‚Äôs bivariate tools‚Äîscatter plots, correlations, OLS regression, and model fit measures‚Äîto explore multiple satellite-development relationships in greater depth.</p>
<p><strong>Data</strong>: Cross-sectional dataset covering 339 Bolivian municipalities from the <a href="https://github.com/quarcs-lab/ds4bolivia">DS4Bolivia Project</a>.</p>
<p><strong>Key variables</strong>:</p>
<ul>
<li><code>mun</code>: Municipality name</li>
<li><code>dep</code>: Department (administrative region)</li>
<li><code>imds</code>: Municipal Sustainable Development Index (0‚Äì100 composite)</li>
<li><code>ln_NTLpc2017</code>: Log nighttime lights per capita (2017)</li>
<li><code>index_sdg1</code>: SDG 1 Index ‚Äî No Poverty (0‚Äì100)</li>
<li><code>index_sdg4</code>: SDG 4 Index ‚Äî Quality Education (0‚Äì100)</li>
<li><code>index_sdg8</code>: SDG 8 Index ‚Äî Decent Work and Economic Growth (0‚Äì100)</li>
<li><code>sdg7_1_ec</code>: SDG 7.1 ‚Äî Electricity coverage (%)</li>
<li><code>sdg1_1_ubn</code>: Unsatisfied Basic Needs (% of population)</li>
</ul>
<section id="task-1-load-and-explore-guided" class="level4">
<h4 class="anchored" data-anchor-id="task-1-load-and-explore-guided">Task 1: Load and Explore (Guided)</h4>
<p><strong>Objective</strong>: Load the DS4Bolivia dataset, select key variables, and create a two-way frequency table.</p>
<p><strong>Instructions</strong>:</p>
<ol type="1">
<li>Load the data from the URL below and select the key variables listed above</li>
<li>Use <code>pd.cut()</code> to bin the <code>imds</code> variable into three equal-frequency groups labeled <strong>Low</strong>, <strong>Medium</strong>, and <strong>High</strong> (terciles)</li>
<li>Create a two-way frequency table (cross-tabulation) of <code>imds</code> terciles against department using <code>pd.crosstab()</code></li>
<li>Examine the table: Which departments have the most municipalities in the <em>Low</em> development category?</li>
</ol>
<div id="cell-71" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:32.738376Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:32.738117Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:32.933091Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:32.932401Z&quot;}}" data-execution_count="22">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the DS4Bolivia dataset</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>url_bol <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/quarcs-lab/ds4bolivia/master/ds4bolivia_v20250523.csv"</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>bol <span class="op">=</span> pd.read_csv(url_bol)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Select key variables for this case study</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>key_vars <span class="op">=</span> [<span class="st">'mun'</span>, <span class="st">'dep'</span>, <span class="st">'imds'</span>, <span class="st">'ln_NTLpc2017'</span>,</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">'index_sdg1'</span>, <span class="st">'index_sdg4'</span>, <span class="st">'index_sdg8'</span>,</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>            <span class="st">'sdg7_1_ec'</span>, <span class="st">'sdg1_1_ubn'</span>]</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>bol_cs <span class="op">=</span> bol[key_vars].copy()</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Dataset: </span><span class="sc">{</span>bol_cs<span class="sc">.</span>shape[<span class="dv">0</span>]<span class="sc">}</span><span class="ss"> municipalities, </span><span class="sc">{</span>bol_cs<span class="sc">.</span>shape[<span class="dv">1</span>]<span class="sc">}</span><span class="ss"> variables"</span>)</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Departments: </span><span class="sc">{</span><span class="bu">sorted</span>(bol_cs[<span class="st">'dep'</span>].unique())<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Bin imds into terciles</span></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>bol_cs[<span class="st">'imds_group'</span>] <span class="op">=</span> pd.cut(bol_cs[<span class="st">'imds'</span>],</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>                               bins<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>                               labels<span class="op">=</span>[<span class="st">'Low'</span>, <span class="st">'Medium'</span>, <span class="st">'High'</span>])</span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Two-way frequency table: imds tercile x department</span></span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>cross_tab <span class="op">=</span> pd.crosstab(bol_cs[<span class="st">'imds_group'</span>], bol_cs[<span class="st">'dep'</span>],</span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>                        margins<span class="op">=</span><span class="va">True</span>, margins_name<span class="op">=</span><span class="st">'Total'</span>)</span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Two-Way Frequency Table: IMDS Tercile by Department"</span>)</span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cross_tab)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Dataset: 339 municipalities, 9 variables
Departments: ['Beni', 'Chuquisaca', 'Cochabamba', 'La Paz', 'Oruro', 'Pando', 'Potos√≠', 'Santa Cruz', 'Tarija']

Two-Way Frequency Table: IMDS Tercile by Department
======================================================================
dep         Beni  Chuquisaca  Cochabamba  La Paz  Oruro  Pando  Potos√≠  \
imds_group                                                               
Low            9          21          20      45     21     13      28   
Medium        10           7          22      40     13      2      11   
High           0           1           5       2      1      0       1   
Total         19          29          47      87     35     15      40   

dep         Santa Cruz  Tarija  Total  
imds_group                             
Low                 13       0    170  
Medium              43       9    157  
High                 0       2     12  
Total               56      11    339  </code></pre>
</div>
</div>
</section>
<section id="task-2-scatter-plots-guided" class="level4">
<h4 class="anchored" data-anchor-id="task-2-scatter-plots-guided">Task 2: Scatter Plots (Guided)</h4>
<p><strong>Objective</strong>: Create a 2√ó2 grid of scatter plots to compare different satellite-development relationships.</p>
<p><strong>Instructions</strong>:</p>
<ol type="1">
<li>Create a figure with four subplots arranged in a 2√ó2 grid</li>
<li>Plot the following relationships:
<ul>
<li><ol type="a">
<li><code>ln_NTLpc2017</code> vs <code>imds</code></li>
</ol></li>
<li><ol start="2" type="a">
<li><code>ln_NTLpc2017</code> vs <code>index_sdg1</code></li>
</ol></li>
<li><ol start="3" type="a">
<li><code>ln_NTLpc2017</code> vs <code>sdg7_1_ec</code></li>
</ol></li>
<li><ol start="4" type="a">
<li><code>sdg1_1_ubn</code> vs <code>imds</code></li>
</ol></li>
</ul></li>
<li>Add axis labels and subplot titles</li>
<li>Discuss: Which relationship appears strongest? Which appears weakest?</li>
</ol>
<div id="cell-73" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:32.936128Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:32.935878Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:33.917779Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:33.916965Z&quot;}}" data-execution_count="23">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2x2 scatter plot grid</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">10</span>))</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>plot_data <span class="op">=</span> bol_cs.dropna(subset<span class="op">=</span>[<span class="st">'ln_NTLpc2017'</span>, <span class="st">'imds'</span>, <span class="st">'index_sdg1'</span>,</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">'sdg7_1_ec'</span>, <span class="st">'sdg1_1_ubn'</span>])</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="co"># (a) NTL vs IMDS</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">0</span>].scatter(plot_data[<span class="st">'ln_NTLpc2017'</span>], plot_data[<span class="st">'imds'</span>],</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>                   alpha<span class="op">=</span><span class="fl">0.5</span>, color<span class="op">=</span><span class="st">'#008CB7'</span>, s<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">0</span>].set_xlabel(<span class="st">'Log NTL per Capita (2017)'</span>)</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">0</span>].set_ylabel(<span class="st">'IMDS'</span>)</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">0</span>].set_title(<span class="st">'(a) Nighttime Lights vs Development Index'</span>)</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a><span class="co"># (b) NTL vs SDG1 (No Poverty)</span></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">1</span>].scatter(plot_data[<span class="st">'ln_NTLpc2017'</span>], plot_data[<span class="st">'index_sdg1'</span>],</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>                   alpha<span class="op">=</span><span class="fl">0.5</span>, color<span class="op">=</span><span class="st">'#7A209F'</span>, s<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">1</span>].set_xlabel(<span class="st">'Log NTL per Capita (2017)'</span>)</span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">1</span>].set_ylabel(<span class="st">'SDG 1 Index (No Poverty)'</span>)</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">1</span>].set_title(<span class="st">'(b) Nighttime Lights vs No Poverty'</span>)</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a><span class="co"># (c) NTL vs SDG7.1 (Electricity Coverage)</span></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].scatter(plot_data[<span class="st">'ln_NTLpc2017'</span>], plot_data[<span class="st">'sdg7_1_ec'</span>],</span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>                   alpha<span class="op">=</span><span class="fl">0.5</span>, color<span class="op">=</span><span class="st">'#C21E72'</span>, s<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].set_xlabel(<span class="st">'Log NTL per Capita (2017)'</span>)</span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].set_ylabel(<span class="st">'Electricity Coverage (%)'</span>)</span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].set_title(<span class="st">'(c) Nighttime Lights vs Electricity Coverage'</span>)</span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a><span class="co"># (d) UBN vs IMDS</span></span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">1</span>].scatter(plot_data[<span class="st">'sdg1_1_ubn'</span>], plot_data[<span class="st">'imds'</span>],</span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a>                   alpha<span class="op">=</span><span class="fl">0.5</span>, color<span class="op">=</span><span class="st">'#2E86AB'</span>, s<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb55-31"><a href="#cb55-31" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">1</span>].set_xlabel(<span class="st">'Unsatisfied Basic Needs (%)'</span>)</span>
<span id="cb55-32"><a href="#cb55-32" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">1</span>].set_ylabel(<span class="st">'IMDS'</span>)</span>
<span id="cb55-33"><a href="#cb55-33" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">1</span>].set_title(<span class="st">'(d) Unsatisfied Basic Needs vs Development Index'</span>)</span>
<span id="cb55-34"><a href="#cb55-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-35"><a href="#cb55-35" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">'Bivariate Relationships: Satellite Data and Development in Bolivia'</span>,</span>
<span id="cb55-36"><a href="#cb55-36" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, y<span class="op">=</span><span class="fl">1.02</span>)</span>
<span id="cb55-37"><a href="#cb55-37" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb55-38"><a href="#cb55-38" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="ch05_Bivariate_Data_Summary_files/figure-html/cell-24-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<blockquote class="blockquote">
<p><strong>Key Concept 5.11: Nighttime Lights as Development Proxy</strong></p>
<p>Nighttime light (NTL) intensity measured by satellites correlates with GDP, electrification, and urbanization across the world. The <strong>log per-capita</strong> transformation serves two purposes: the logarithm compresses the highly skewed raw luminosity values, and dividing by population accounts for the mechanical relationship between more people and more light. After these transformations, NTL becomes a meaningful proxy for <em>economic intensity</em> rather than simply population density.</p>
</blockquote>
</section>
<section id="task-3-correlation-analysis-semi-guided" class="level4">
<h4 class="anchored" data-anchor-id="task-3-correlation-analysis-semi-guided">Task 3: Correlation Analysis (Semi-guided)</h4>
<p><strong>Objective</strong>: Calculate and visualize the correlation matrix for key development and satellite variables.</p>
<p><strong>Instructions</strong>:</p>
<ol type="1">
<li>Select the variables: <code>imds</code>, <code>ln_NTLpc2017</code>, <code>index_sdg1</code>, <code>index_sdg4</code>, <code>index_sdg8</code>, <code>sdg7_1_ec</code>, <code>sdg1_1_ubn</code></li>
<li>Calculate the Pearson correlation matrix using <code>.corr()</code></li>
<li>Display the results as a heatmap or formatted table</li>
<li>Identify: Which variable has the <strong>strongest</strong> correlation with <code>imds</code>? Which has the <strong>weakest</strong>?</li>
</ol>
<p><strong>Hint</strong>: Use <code>plt.imshow()</code> or <code>sns.heatmap()</code> (if seaborn is available) to visualize the correlation matrix.</p>
<div id="cell-76" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:33.921858Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:33.921596Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:33.926837Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:33.926157Z&quot;}}" data-execution_count="24">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Your code here: Correlation analysis</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Steps:</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Select numeric variables of interest</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Compute correlation matrix</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Display as heatmap or formatted table</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Identify strongest/weakest correlations with imds</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Example structure:</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a><span class="co"># corr_vars = ['imds', 'ln_NTLpc2017', 'index_sdg1', 'index_sdg4',</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a><span class="co">#              'index_sdg8', 'sdg7_1_ec', 'sdg1_1_ubn']</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a><span class="co"># corr_matrix = bol_cs[corr_vars].corr()</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a><span class="co"># print(corr_matrix.round(3))</span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a><span class="co"># # Heatmap</span></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a><span class="co"># fig, ax = plt.subplots(figsize=(9, 7))</span></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a><span class="co"># im = ax.imshow(corr_matrix, cmap='RdBu_r', vmin=-1, vmax=1)</span></span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a><span class="co"># ax.set_xticks(range(len(corr_vars)))</span></span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a><span class="co"># ax.set_yticks(range(len(corr_vars)))</span></span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a><span class="co"># ax.set_xticklabels(corr_vars, rotation=45, ha='right')</span></span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a><span class="co"># ax.set_yticklabels(corr_vars)</span></span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a><span class="co"># for i in range(len(corr_vars)):</span></span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a><span class="co">#     for j in range(len(corr_vars)):</span></span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a><span class="co">#         ax.text(j, i, f"{corr_matrix.iloc[i, j]:.2f}",</span></span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a><span class="co">#                 ha='center', va='center', fontsize=8)</span></span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.colorbar(im, ax=ax, label='Pearson Correlation')</span></span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a><span class="co"># ax.set_title('Correlation Matrix: Development and Satellite Variables')</span></span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.tight_layout()</span></span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.show()</span></span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a><span class="co"># # Identify strongest/weakest correlations with imds</span></span>
<span id="cb56-32"><a href="#cb56-32" aria-hidden="true" tabindex="-1"></a><span class="co"># imds_corrs = corr_matrix['imds'].drop('imds').abs().sort_values(ascending=False)</span></span>
<span id="cb56-33"><a href="#cb56-33" aria-hidden="true" tabindex="-1"></a><span class="co"># print(f"\nStrongest correlation with IMDS: {imds_corrs.index[0]} (r = {corr_matrix.loc['imds', imds_corrs.index[0]]:.3f})")</span></span>
<span id="cb56-34"><a href="#cb56-34" aria-hidden="true" tabindex="-1"></a><span class="co"># print(f"Weakest correlation with IMDS: {imds_corrs.index[-1]} (r = {corr_matrix.loc['imds', imds_corrs.index[-1]]:.3f})")</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="task-4-ols-regression-line-semi-guided" class="level4">
<h4 class="anchored" data-anchor-id="task-4-ols-regression-line-semi-guided">Task 4: OLS Regression Line (Semi-guided)</h4>
<p><strong>Objective</strong>: Estimate and compare OLS regressions predicting IMDS from different variables.</p>
<p><strong>Instructions</strong>:</p>
<ol type="1">
<li>Estimate OLS: <code>imds ~ ln_NTLpc2017</code>. Report the slope, intercept, and R¬≤</li>
<li>Overlay the fitted regression line on a scatter plot of <code>ln_NTLpc2017</code> vs <code>imds</code></li>
<li>Estimate a second OLS: <code>imds ~ sdg1_1_ubn</code>. Report slope, intercept, and R¬≤</li>
<li>Compare: Which predictor explains more variation in development?</li>
</ol>
<p><strong>Hint</strong>: Use <code>ols()</code> from statsmodels as practiced in this chapter.</p>
<div id="cell-78" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:33.929971Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:33.929714Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:33.932951Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:33.932418Z&quot;}}" data-execution_count="25">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Your code here: OLS regression with fitted lines</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Steps:</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Estimate imds ~ ln_NTLpc2017</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Overlay fitted line on scatter plot</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Estimate imds ~ sdg1_1_ubn</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Compare R-squared values</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Example structure:</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a><span class="co"># reg_data = bol_cs[['imds', 'ln_NTLpc2017', 'sdg1_1_ubn']].dropna()</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a><span class="co"># # Model 1: NTL</span></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a><span class="co"># model_ntl = ols('imds ~ ln_NTLpc2017', data=reg_data).fit()</span></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a><span class="co"># print("Model 1: IMDS ~ Log NTL per Capita")</span></span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a><span class="co"># print(f"  Slope:     {model_ntl.params['ln_NTLpc2017']:.4f}")</span></span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a><span class="co"># print(f"  Intercept: {model_ntl.params['Intercept']:.4f}")</span></span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a><span class="co"># print(f"  R-squared: {model_ntl.rsquared:.4f}")</span></span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a><span class="co"># # Model 2: UBN</span></span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a><span class="co"># model_ubn = ols('imds ~ sdg1_1_ubn', data=reg_data).fit()</span></span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a><span class="co"># print("\nModel 2: IMDS ~ Unsatisfied Basic Needs")</span></span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a><span class="co"># print(f"  Slope:     {model_ubn.params['sdg1_1_ubn']:.4f}")</span></span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a><span class="co"># print(f"  Intercept: {model_ubn.params['Intercept']:.4f}")</span></span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a><span class="co"># print(f"  R-squared: {model_ubn.rsquared:.4f}")</span></span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a><span class="co"># # Scatter + fitted line for Model 1</span></span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a><span class="co"># fig, ax = plt.subplots(figsize=(8, 6))</span></span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a><span class="co"># ax.scatter(reg_data['ln_NTLpc2017'], reg_data['imds'], alpha=0.4, color='#008CB7', s=20)</span></span>
<span id="cb57-29"><a href="#cb57-29" aria-hidden="true" tabindex="-1"></a><span class="co"># x_range = np.linspace(reg_data['ln_NTLpc2017'].min(), reg_data['ln_NTLpc2017'].max(), 100)</span></span>
<span id="cb57-30"><a href="#cb57-30" aria-hidden="true" tabindex="-1"></a><span class="co"># ax.plot(x_range, model_ntl.params['Intercept'] + model_ntl.params['ln_NTLpc2017'] * x_range,</span></span>
<span id="cb57-31"><a href="#cb57-31" aria-hidden="true" tabindex="-1"></a><span class="co">#         color='#C21E72', linewidth=2, label=f'OLS: R¬≤ = {model_ntl.rsquared:.3f}')</span></span>
<span id="cb57-32"><a href="#cb57-32" aria-hidden="true" tabindex="-1"></a><span class="co"># ax.set_xlabel('Log NTL per Capita (2017)')</span></span>
<span id="cb57-33"><a href="#cb57-33" aria-hidden="true" tabindex="-1"></a><span class="co"># ax.set_ylabel('IMDS')</span></span>
<span id="cb57-34"><a href="#cb57-34" aria-hidden="true" tabindex="-1"></a><span class="co"># ax.set_title('OLS Regression: Nighttime Lights Predicting Development')</span></span>
<span id="cb57-35"><a href="#cb57-35" aria-hidden="true" tabindex="-1"></a><span class="co"># ax.legend()</span></span>
<span id="cb57-36"><a href="#cb57-36" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.tight_layout()</span></span>
<span id="cb57-37"><a href="#cb57-37" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.show()</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<blockquote class="blockquote">
<p><strong>Key Concept 5.12: Prediction vs.&nbsp;Causation with Satellite Data</strong></p>
<p>A high R¬≤ between nighttime lights and development indices does <strong>not</strong> mean that lights <em>cause</em> development. Both NTL and IMDS reflect underlying economic activity, infrastructure, and urbanization. NTL is best understood as a <strong>proxy variable</strong>‚Äîan observable measure that correlates with the unobserved concept we care about (true economic development). The correlation is useful for prediction but should not be interpreted as a causal relationship.</p>
</blockquote>
</section>
<section id="task-5-departmental-comparisons-independent" class="level4">
<h4 class="anchored" data-anchor-id="task-5-departmental-comparisons-independent">Task 5: Departmental Comparisons (Independent)</h4>
<p><strong>Objective</strong>: Assess whether the NTL-development relationship differs across Bolivia‚Äôs departments.</p>
<p><strong>Instructions</strong>:</p>
<ol type="1">
<li>Create a scatter plot of <code>ln_NTLpc2017</code> vs <code>imds</code> with points colored by department</li>
<li>Visually assess: Does the relationship appear to differ across departments?</li>
<li>Run separate OLS regressions for 2‚Äì3 departments and compare slopes and R¬≤ values</li>
<li>Discuss: What might explain differences in the satellite-development relationship across regions?</li>
</ol>
<div id="cell-81" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:33.936576Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:33.936335Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:33.940154Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:33.939202Z&quot;}}" data-execution_count="26">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Your code here: Departmental comparisons</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Steps:</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Create scatter plot colored by department</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Run separate regressions for 2-3 departments</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Compare slopes and R-squared</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Example structure:</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_data = bol_cs[['ln_NTLpc2017', 'imds', 'dep']].dropna()</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a><span class="co"># departments = plot_data['dep'].unique()</span></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a><span class="co"># colors = plt.cm.tab10(np.linspace(0, 1, len(departments)))</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a><span class="co"># fig, ax = plt.subplots(figsize=(10, 7))</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a><span class="co"># for dep, color in zip(sorted(departments), colors):</span></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a><span class="co">#     subset = plot_data[plot_data['dep'] == dep]</span></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a><span class="co">#     ax.scatter(subset['ln_NTLpc2017'], subset['imds'],</span></span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a><span class="co">#                alpha=0.6, color=color, label=dep, s=25)</span></span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a><span class="co"># ax.set_xlabel('Log NTL per Capita (2017)')</span></span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a><span class="co"># ax.set_ylabel('IMDS')</span></span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a><span class="co"># ax.set_title('NTL vs Development by Department')</span></span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a><span class="co"># ax.legend(bbox_to_anchor=(1.05, 1), loc='upper left', fontsize=8)</span></span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.tight_layout()</span></span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.show()</span></span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a><span class="co"># # Separate regressions for selected departments</span></span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a><span class="co"># for dep_name in ['La Paz', 'Santa Cruz', 'Potos√≠']:</span></span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a><span class="co">#     dep_data = plot_data[plot_data['dep'] == dep_name]</span></span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a><span class="co">#     if len(dep_data) &gt; 5:</span></span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a><span class="co">#         model_dep = ols('imds ~ ln_NTLpc2017', data=dep_data).fit()</span></span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true" tabindex="-1"></a><span class="co">#         print(f"{dep_name}: slope = {model_dep.params['ln_NTLpc2017']:.3f}, "</span></span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true" tabindex="-1"></a><span class="co">#               f"R¬≤ = {model_dep.rsquared:.3f}, n = {len(dep_data)}")</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="task-6-alternative-predictors-independent" class="level4">
<h4 class="anchored" data-anchor-id="task-6-alternative-predictors-independent">Task 6: Alternative Predictors (Independent)</h4>
<p><strong>Objective</strong>: Compare nighttime lights with unsatisfied basic needs (UBN) as predictors of development.</p>
<p><strong>Instructions</strong>:</p>
<ol type="1">
<li>Compare the R¬≤ values from <code>imds ~ ln_NTLpc2017</code> and <code>imds ~ sdg1_1_ubn</code></li>
<li>Create side-by-side scatter plots with fitted regression lines for both models</li>
<li>Discuss: Which predictor has the higher R¬≤? Why might a socioeconomic variable (UBN) predict development better than satellite data (NTL)?</li>
<li>Reflect: What are the advantages of satellite data even if its R¬≤ is lower?</li>
</ol>
<div id="cell-83" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:33.943746Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:33.943500Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:33.947162Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:33.946377Z&quot;}}" data-execution_count="27">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Your code here: Compare NTL vs UBN as predictors of IMDS</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Steps:</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Estimate both models (if not already done in Task 4)</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Create side-by-side fitted line plots</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Compare R-squared values</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Discuss advantages and limitations</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Example structure:</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="co"># reg_data = bol_cs[['imds', 'ln_NTLpc2017', 'sdg1_1_ubn']].dropna()</span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a><span class="co"># model_ntl = ols('imds ~ ln_NTLpc2017', data=reg_data).fit()</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a><span class="co"># model_ubn = ols('imds ~ sdg1_1_ubn', data=reg_data).fit()</span></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a><span class="co"># fig, axes = plt.subplots(1, 2, figsize=(14, 5))</span></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a><span class="co"># # Left: NTL model</span></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a><span class="co"># axes[0].scatter(reg_data['ln_NTLpc2017'], reg_data['imds'], alpha=0.4, color='#008CB7', s=20)</span></span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a><span class="co"># x1 = np.linspace(reg_data['ln_NTLpc2017'].min(), reg_data['ln_NTLpc2017'].max(), 100)</span></span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a><span class="co"># axes[0].plot(x1, model_ntl.predict(pd.DataFrame({'ln_NTLpc2017': x1})),</span></span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a><span class="co">#              color='#C21E72', linewidth=2)</span></span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a><span class="co"># axes[0].set_xlabel('Log NTL per Capita (2017)')</span></span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a><span class="co"># axes[0].set_ylabel('IMDS')</span></span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a><span class="co"># axes[0].set_title(f'Model 1: NTL (R¬≤ = {model_ntl.rsquared:.3f})')</span></span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a><span class="co"># # Right: UBN model</span></span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a><span class="co"># axes[1].scatter(reg_data['sdg1_1_ubn'], reg_data['imds'], alpha=0.4, color='#7A209F', s=20)</span></span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a><span class="co"># x2 = np.linspace(reg_data['sdg1_1_ubn'].min(), reg_data['sdg1_1_ubn'].max(), 100)</span></span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a><span class="co"># axes[1].plot(x2, model_ubn.predict(pd.DataFrame({'sdg1_1_ubn': x2})),</span></span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a><span class="co">#              color='#C21E72', linewidth=2)</span></span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a><span class="co"># axes[1].set_xlabel('Unsatisfied Basic Needs (%)')</span></span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a><span class="co"># axes[1].set_ylabel('IMDS')</span></span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true" tabindex="-1"></a><span class="co"># axes[1].set_title(f'Model 2: UBN (R¬≤ = {model_ubn.rsquared:.3f})')</span></span>
<span id="cb59-33"><a href="#cb59-33" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb59-34"><a href="#cb59-34" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.suptitle('Comparing Predictors of Municipal Development',</span></span>
<span id="cb59-35"><a href="#cb59-35" aria-hidden="true" tabindex="-1"></a><span class="co">#              fontsize=13, fontweight='bold')</span></span>
<span id="cb59-36"><a href="#cb59-36" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.tight_layout()</span></span>
<span id="cb59-37"><a href="#cb59-37" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.show()</span></span>
<span id="cb59-38"><a href="#cb59-38" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb59-39"><a href="#cb59-39" aria-hidden="true" tabindex="-1"></a><span class="co"># print(f"\nR¬≤ comparison:")</span></span>
<span id="cb59-40"><a href="#cb59-40" aria-hidden="true" tabindex="-1"></a><span class="co"># print(f"  NTL model: {model_ntl.rsquared:.4f}")</span></span>
<span id="cb59-41"><a href="#cb59-41" aria-hidden="true" tabindex="-1"></a><span class="co"># print(f"  UBN model: {model_ubn.rsquared:.4f}")</span></span>
<span id="cb59-42"><a href="#cb59-42" aria-hidden="true" tabindex="-1"></a><span class="co"># print(f"  Difference: {abs(model_ubn.rsquared - model_ntl.rsquared):.4f}")</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="what-youve-learned-from-this-case-study-1" class="level3">
<h3 class="anchored" data-anchor-id="what-youve-learned-from-this-case-study-1">What You‚Äôve Learned from This Case Study</h3>
<p>Through this bivariate exploration of satellite data and municipal development in Bolivia, you‚Äôve applied the full Chapter 5 toolkit:</p>
<ul>
<li><strong>Two-way tabulations</strong> for categorical exploration of development levels across departments</li>
<li><strong>Multiple scatter plots</strong> comparing satellite-development relationships across different indicators</li>
<li><strong>Correlation analysis</strong> across multiple SDG indicators to identify strongest and weakest associations</li>
<li><strong>OLS regression with fitted lines and R¬≤</strong> to quantify the NTL-development relationship</li>
<li><strong>Regional heterogeneity</strong> in bivariate relationships across Bolivia‚Äôs departments</li>
<li><strong>Comparing alternative predictors</strong> of development (satellite data vs.&nbsp;socioeconomic measures)</li>
</ul>
<p><strong>Connection to the research</strong>: The DS4Bolivia project extends this bivariate analysis to multivariate machine learning models, using 64-dimensional satellite embeddings alongside nighttime lights to achieve higher predictive accuracy for SDG indicators.</p>
<p><strong>Looking ahead</strong>: In Chapter 7, we‚Äôll apply <em>statistical inference</em> to these regressions‚Äîtesting whether the NTL coefficient is significantly different from zero and constructing confidence intervals for the effect of satellite data on development.</p>
<p><strong>Well done!</strong> You‚Äôve now explored two real-world datasets‚Äîcross-country convergence and Bolivian municipal development‚Äîusing the complete bivariate analysis toolkit from Chapter 5.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "Óßã";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../notebooks_colab/ch04_Statistical_Inference_for_the_Mean.html" class="pagination-link" aria-label="4. Statistical Inference for the Mean">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">4. Statistical Inference for the Mean</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../notebooks_colab/ch06_The_Least_Squares_Estimator.html" class="pagination-link" aria-label="6. The Least Squares Estimator">
        <span class="nav-page-text"><span class="chapter-title">6. The Least Squares Estimator</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  /* ‚îÄ‚îÄ Book cover image in right sidebar ‚îÄ‚îÄ */
  var tocNav = document.getElementById('TOC');
  if (tocNav) {
    var coverDiv = document.createElement('div');
    coverDiv.id = 'toc-cover-image';
    var img = document.createElement('img');
    var path = window.location.pathname;
    if (path.indexOf('/notebooks_colab/') !== -1) {
      img.src = '../images/book1cover.jpg';
    } else {
      img.src = 'images/book1cover.jpg';
    }
    img.alt = 'Econometrics Powered by AI';
    coverDiv.appendChild(img);
    tocNav.parentNode.insertBefore(coverDiv, tocNav);
  }

  /* ‚îÄ‚îÄ Mobile TOC: floating button + slide-in panel ‚îÄ‚îÄ */
  var toc = document.getElementById('TOC');
  if (!toc) return;
  var tocList = toc.querySelector('ul');
  if (!tocList || tocList.children.length === 0) return;

  /* Create floating action button */
  var btn = document.createElement('button');
  btn.className = 'mobile-toc-btn';
  btn.setAttribute('aria-label', 'On this page');
  btn.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/><circle cx="3" cy="6" r="1" fill="currentColor"/><circle cx="3" cy="12" r="1" fill="currentColor"/><circle cx="3" cy="18" r="1" fill="currentColor"/></svg>';

  /* Create overlay backdrop */
  var overlay = document.createElement('div');
  overlay.className = 'mobile-toc-overlay';

  /* Create slide-in panel */
  var panel = document.createElement('div');
  panel.className = 'mobile-toc-panel';

  /* Panel header with title and close button */
  var header = document.createElement('div');
  header.className = 'mobile-toc-header';
  var title = document.createElement('h3');
  title.textContent = 'On this page';
  var closeBtn = document.createElement('button');
  closeBtn.className = 'mobile-toc-close';
  closeBtn.setAttribute('aria-label', 'Close');
  closeBtn.innerHTML = '\u00d7';
  header.appendChild(title);
  header.appendChild(closeBtn);

  /* Clone TOC content into panel */
  var content = document.createElement('div');
  content.className = 'mobile-toc-content';
  var tocClone = tocList.cloneNode(true);
  tocClone.classList.remove('collapse');
  tocClone.style.display = 'block';
  content.appendChild(tocClone);

  panel.appendChild(header);
  panel.appendChild(content);
  document.body.appendChild(btn);
  document.body.appendChild(overlay);
  document.body.appendChild(panel);

  /* Toggle functions */
  function openPanel() {
    panel.classList.add('active');
    overlay.classList.add('active');
    document.body.style.overflow = 'hidden';
  }
  function closePanel() {
    panel.classList.remove('active');
    overlay.classList.remove('active');
    document.body.style.overflow = '';
  }

  btn.addEventListener('click', openPanel);
  overlay.addEventListener('click', closePanel);
  closeBtn.addEventListener('click', closePanel);

  /* Close panel when a TOC link is clicked */
  content.querySelectorAll('a').forEach(function(link) {
    link.addEventListener('click', closePanel);
  });

  /* Close on Escape key */
  document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape' && panel.classList.contains('active')) {
      closePanel();
    }
  });

  /* ‚îÄ‚îÄ Desktop sidebar toggle buttons (floating chevrons) ‚îÄ‚îÄ */
  if (window.innerWidth >= 992) {
    /* Restore saved states */
    if (localStorage.getItem('left-collapsed') === 'true') {
      document.body.classList.add('left-collapsed');
    }
    if (localStorage.getItem('toc-collapsed') === 'true') {
      document.body.classList.add('toc-collapsed');
    }

    /* Left sidebar toggle */
    var leftBtn = document.createElement('button');
    leftBtn.className = 'sidebar-toggle sidebar-toggle-left';
    leftBtn.setAttribute('aria-label', 'Toggle book navigation');
    leftBtn.title = 'Toggle book navigation';
    leftBtn.innerHTML = '<i class="bi bi-chevron-left"></i>';
    document.body.appendChild(leftBtn);
    leftBtn.addEventListener('click', function() {
      document.body.classList.toggle('left-collapsed');
      localStorage.setItem('left-collapsed', document.body.classList.contains('left-collapsed'));
    });

    /* Right sidebar toggle */
    var rightBtn = document.createElement('button');
    rightBtn.className = 'sidebar-toggle sidebar-toggle-right';
    rightBtn.setAttribute('aria-label', 'Toggle table of contents');
    rightBtn.title = 'Toggle table of contents';
    rightBtn.innerHTML = '<i class="bi bi-chevron-right"></i>';
    document.body.appendChild(rightBtn);
    rightBtn.addEventListener('click', function() {
      document.body.classList.toggle('toc-collapsed');
      localStorage.setItem('toc-collapsed', document.body.classList.contains('toc-collapsed'));
    });
  }
});
</script>




<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>