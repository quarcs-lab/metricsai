<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>7. Statistical Inference for Bivariate Regression ‚Äì Econometrics Powered by AI</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../notebooks_colab/ch08_Case_Studies_for_Bivariate_Regression.html" rel="next">
<link href="../notebooks_colab/ch06_The_Least_Squares_Estimator.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-8b4baf804e461d9b72633f0de59a0cac.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-0da87e08732b0aad79cc276a1be62fe2.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../custom.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../notebooks_colab/ch05_Bivariate_Data_Summary.html">Bivariate Regression</a></li><li class="breadcrumb-item"><a href="../notebooks_colab/ch07_Statistical_Inference_for_Bivariate_Regression.html"><span class="chapter-title">7. Statistical Inference for Bivariate Regression</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Econometrics Powered by AI</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch00_Preface.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Statistical Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch01_Analysis_of_Economics_Data.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">1. Analysis of Economics Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch02_Univariate_Data_Summary.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">2. Univariate Data Summary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch03_The_Sample_Mean.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">3. The Sample Mean</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch04_Statistical_Inference_for_the_Mean.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">4. Statistical Inference for the Mean</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Bivariate Regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch05_Bivariate_Data_Summary.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">5. Bivariate Data Summary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch06_The_Least_Squares_Estimator.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">6. The Least Squares Estimator</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch07_Statistical_Inference_for_Bivariate_Regression.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">7. Statistical Inference for Bivariate Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch08_Case_Studies_for_Bivariate_Regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">8. Case Studies for Bivariate Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch09_Models_with_Natural_Logarithms.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">9. Models with Natural Logarithms</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Multiple Regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch10_Data_Summary_for_Multiple_Regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">10. Data Summary for Multiple Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch11_Statistical_Inference_for_Multiple_Regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">11. Statistical Inference for Multiple Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch12_Further_Topics_in_Multiple_Regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">12. Further Topics in Multiple Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch13_Case_Studies_for_Multiple_Regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">13. Case Studies for Multiple Regression</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Advanced Topics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch14_Regression_with_Indicator_Variables.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">14. Regression with Indicator Variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch15_Regression_with_Transformed_Variables.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">15. Regression with Transformed Variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch16_Checking_the_Model_and_Data.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">16. Checking the Model and Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch17_Panel_Data_Time_Series_Data_Causation.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">17. Panel Data, Time Series Data, Causation</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul class="collapse">
  <li><a href="#chapter-overview" id="toc-chapter-overview" class="nav-link active" data-scroll-target="#chapter-overview">Chapter Overview</a></li>
  <li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#example-house-price-and-size" id="toc-example-house-price-and-size" class="nav-link" data-scroll-target="#example-house-price-and-size">7.1 Example: House Price and Size</a></li>
  <li><a href="#the-t-statistic" id="toc-the-t-statistic" class="nav-link" data-scroll-target="#the-t-statistic">7.2 The t Statistic</a></li>
  <li><a href="#confidence-intervals" id="toc-confidence-intervals" class="nav-link" data-scroll-target="#confidence-intervals">7.3 Confidence Intervals</a></li>
  <li><a href="#tests-of-statistical-significance" id="toc-tests-of-statistical-significance" class="nav-link" data-scroll-target="#tests-of-statistical-significance">7.4 Tests of Statistical Significance</a></li>
  <li><a href="#two-sided-hypothesis-tests" id="toc-two-sided-hypothesis-tests" class="nav-link" data-scroll-target="#two-sided-hypothesis-tests">7.5 Two-Sided Hypothesis Tests</a></li>
  <li><a href="#one-sided-directional-hypothesis-tests" id="toc-one-sided-directional-hypothesis-tests" class="nav-link" data-scroll-target="#one-sided-directional-hypothesis-tests">7.6 One-Sided Directional Hypothesis Tests</a></li>
  <li><a href="#robust-standard-errors" id="toc-robust-standard-errors" class="nav-link" data-scroll-target="#robust-standard-errors">7.7 Robust Standard Errors</a></li>
  <li><a href="#key-takeaways" id="toc-key-takeaways" class="nav-link" data-scroll-target="#key-takeaways">Key Takeaways</a></li>
  <li><a href="#practice-exercises" id="toc-practice-exercises" class="nav-link" data-scroll-target="#practice-exercises">Practice Exercises</a></li>
  <li><a href="#case-studies" id="toc-case-studies" class="nav-link" data-scroll-target="#case-studies">Case Studies</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">
<div id="google_translate_element" style="padding: 8px 0;"></div>
<script type="text/javascript">
function googleTranslateElementInit() {
  new google.translate.TranslateElement({
    pageLanguage: 'en',
    layout: google.translate.TranslateElement.InlineLayout.HORIZONTAL
  }, 'google_translate_element');
}
</script>
<script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../notebooks_colab/ch05_Bivariate_Data_Summary.html">Bivariate Regression</a></li><li class="breadcrumb-item"><a href="../notebooks_colab/ch07_Statistical_Inference_for_Bivariate_Regression.html"><span class="chapter-title">7. Statistical Inference for Bivariate Regression</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-title">7. Statistical Inference for Bivariate Regression</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><strong>metricsAI: An Introduction to Econometrics with Python and AI in the Cloud</strong></p>
<p><em><a href="https://carlos-mendez.org">Carlos Mendez</a></em></p>
<p><img src="https://raw.githubusercontent.com/quarcs-lab/metricsai/main/images/ch07_visual_summary.jpg" alt="Chapter 07 Visual Summary" width="65%"></p>
<p>This notebook provides an interactive introduction to statistical inference for bivariate regression models. All code runs directly in Google Colab without any local setup.</p>
<a href="https://colab.research.google.com/github/quarcs-lab/metricsai/blob/main/notebooks_colab/ch07_Statistical_Inference_for_Bivariate_Regression.ipynb"><img src="https://colab.research.google.com/assets/colab-badge.svg" class="img-fluid" alt="Open In Colab"></a>
<div class="chapter-resources">
<p><a href="https://www.youtube.com/watch?v=iMi1Fa-PYLs" target="_blank" class="resource-btn">üé¨ AI Video</a> <a href="https://carlos-mendez.my.canva.site/s07-statistical-inference-for-bivariate-regression-pdf" target="_blank" class="resource-btn">‚ú® AI Slides</a> <a href="https://cameron.econ.ucdavis.edu/aed/traedv1_07" target="_blank" class="resource-btn">üìä Cameron Slides</a> <a href="https://app.edcafe.ai/quizzes/697866e42f5d08069e04934f" target="_blank" class="resource-btn">‚úèÔ∏è Quiz</a> <a href="https://app.edcafe.ai/chatbots/69789f042f5d08069e070885" target="_blank" class="resource-btn">ü§ñ AI Tutor</a></p>
</div>
<section id="chapter-overview" class="level2">
<h2 class="anchored" data-anchor-id="chapter-overview">Chapter Overview</h2>
<p>This chapter extends statistical inference from univariate to bivariate regression. You‚Äôll gain both theoretical understanding and practical skills through hands-on Python examples, learning how to test hypotheses about regression coefficients and construct confidence intervals.</p>
<p><strong>What you‚Äôll learn:</strong></p>
<ul>
<li>The t-statistic for testing hypotheses about regression coefficients</li>
<li>Constructing and interpreting confidence intervals for slope parameters</li>
<li>Tests of statistical significance (whether a regressor matters)</li>
<li>Two-sided hypothesis tests for specific parameter values</li>
<li>One-sided directional hypothesis tests</li>
<li>Heteroskedasticity-robust standard errors and their importance</li>
<li>Economic vs.&nbsp;statistical significance</li>
</ul>
<p><strong>Datasets used:</strong></p>
<ul>
<li><strong>AED_HOUSE.DTA</strong>: House prices and characteristics for 29 houses sold in Central Davis, California in 1999 (price, size, bedrooms, bathrooms, lot size, age)</li>
</ul>
<p><strong>Chapter outline:</strong></p>
<ul>
<li>7.1 Example: House Price and Size</li>
<li>7.2 The t Statistic</li>
<li>7.3 Confidence Intervals</li>
<li>7.4 Tests of Statistical Significance</li>
<li>7.5 Two-Sided Hypothesis Tests</li>
<li>7.6 One-Sided Directional Hypothesis Tests</li>
<li>7.7 Robust Standard Errors</li>
<li>7.8 Case Studies</li>
<li>Key Takeaways</li>
<li>Practice Exercises</li>
</ul>
</section>
<section id="setup" class="level2">
<h2 class="anchored" data-anchor-id="setup">Setup</h2>
<p>First, we import the necessary Python packages and configure the environment for reproducibility. All data will stream directly from GitHub.</p>
<div id="cell-3" class="cell" data-execution_count="18">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import required packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.formula.api <span class="im">import</span> ols</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.stats.sandwich_covariance <span class="im">import</span> cov_hc1</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Set random seeds for reproducibility</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>RANDOM_SEED <span class="op">=</span> <span class="dv">42</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>random.seed(RANDOM_SEED)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>np.random.seed(RANDOM_SEED)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>os.environ[<span class="st">'PYTHONHASHSEED'</span>] <span class="op">=</span> <span class="bu">str</span>(RANDOM_SEED)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co"># GitHub data URL</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>GITHUB_DATA_URL <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/quarcs-lab/data-open/master/AED/"</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Set plotting style</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>sns.set_style(<span class="st">"whitegrid"</span>)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'figure.figsize'</span>] <span class="op">=</span> (<span class="dv">10</span>, <span class="dv">6</span>)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Setup complete! Ready to explore statistical inference for bivariate regression."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Setup complete! Ready to explore statistical inference for bivariate regression.</code></pre>
</div>
</div>
</section>
<section id="example-house-price-and-size" class="level2">
<h2 class="anchored" data-anchor-id="example-house-price-and-size">7.1 Example: House Price and Size</h2>
<p>We begin with a motivating example: the relationship between house price and house size.</p>
<p><strong>The regression model:</strong></p>
<p><span class="math display">\[\text{price} = \beta_1 + \beta_2 \times \text{size} + u\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(\text{price}\)</span> is the house sale price (in thousands of dollars)</li>
<li><span class="math inline">\(\text{size}\)</span> is the house size (in square feet)</li>
<li><span class="math inline">\(\beta_2\)</span> is the population slope (price increase per square foot)</li>
<li><span class="math inline">\(b_2\)</span> is the sample estimate of <span class="math inline">\(\beta_2\)</span></li>
</ul>
<p><strong>Key regression output:</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 18%">
<col style="width: 23%">
<col style="width: 18%">
<col style="width: 13%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th>Coefficient</th>
<th>Standard Error</th>
<th>t-statistic</th>
<th>p-value</th>
<th>95% CI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Size</td>
<td>73.77</td>
<td>11.17</td>
<td>6.60</td>
<td>0.000</td>
<td>[50.84, 96.70]</td>
</tr>
<tr class="even">
<td>Intercept</td>
<td>115,017.30</td>
<td>21,489.36</td>
<td>5.35</td>
<td>0.000</td>
<td>[70,924.76, 159,109.8]</td>
</tr>
</tbody>
</table>
<p><strong>Interpretation:</strong></p>
<ul>
<li>Each additional square foot increases house price by approximately $73.77</li>
<li>The standard error (11.17) measures uncertainty in this estimate</li>
<li>The t-statistic (6.60) tests whether the effect is statistically significant</li>
<li>The 95% confidence interval is [50.84, 96.70]</li>
</ul>
<div id="cell-5" class="cell" data-execution_count="19">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"7.1 EXAMPLE: HOUSE PRICE AND SIZE"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in the house data</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>data_house <span class="op">=</span> pd.read_stata(GITHUB_DATA_URL <span class="op">+</span> <span class="st">'AED_HOUSE.DTA'</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Data summary:"</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>data_summary <span class="op">=</span> data_house.describe()</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data_summary)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">First few observations:"</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data_house.head())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
7.1 EXAMPLE: HOUSE PRICE AND SIZE
======================================================================

Data summary:
               price         size   bedrooms  bathrooms    lotsize        age  \
count      29.000000    29.000000  29.000000  29.000000  29.000000  29.000000   
mean   253910.344828  1882.758621   3.793103   2.206897   2.137931  36.413792   
std     37390.710695   398.272130   0.675030   0.341144   0.693034   7.118975   
min    204000.000000  1400.000000   3.000000   2.000000   1.000000  23.000000   
25%    233000.000000  1600.000000   3.000000   2.000000   2.000000  31.000000   
50%    244000.000000  1800.000000   4.000000   2.000000   2.000000  35.000000   
75%    270000.000000  2000.000000   4.000000   2.500000   3.000000  39.000000   
max    375000.000000  3300.000000   6.000000   3.000000   3.000000  51.000000   

       monthsold           list  
count  29.000000      29.000000  
mean    5.965517  257824.137931  
std     1.679344   40860.264099  
min     3.000000  199900.000000  
25%     5.000000  239000.000000  
50%     6.000000  245000.000000  
75%     7.000000  269000.000000  
max     8.000000  386000.000000  

First few observations:
    price  size  bedrooms  bathrooms  lotsize   age  monthsold    list
0  204000  1400         3        2.0        1  31.0          7  199900
1  212000  1600         3        3.0        2  33.0          5  212000
2  213000  1800         3        2.0        2  51.0          4  219900
3  220000  1600         3        2.0        1  49.0          4  229000
4  224500  2100         4        2.5        2  47.0          6  224500</code></pre>
</div>
</div>
<section id="basic-regression-price-on-size" class="level3">
<h3 class="anchored" data-anchor-id="basic-regression-price-on-size">Basic Regression: Price on Size</h3>
<p>We estimate the bivariate regression model using ordinary least squares (OLS).</p>
<div id="cell-7" class="cell" data-execution_count="20">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Table 7.1 - Basic regression</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Table 7.1: Regression of House Price on Size"</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>model_basic <span class="op">=</span> ols(<span class="st">'price ~ size'</span>, data<span class="op">=</span>data_house).fit()</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model_basic.summary())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
Table 7.1: Regression of House Price on Size
======================================================================
                            OLS Regression Results                            
==============================================================================
Dep. Variable:                  price   R-squared:                       0.617
Model:                            OLS   Adj. R-squared:                  0.603
Method:                 Least Squares   F-statistic:                     43.58
Date:                Tue, 20 Jan 2026   Prob (F-statistic):           4.41e-07
Time:                        23:33:22   Log-Likelihood:                -332.05
No. Observations:                  29   AIC:                             668.1
Df Residuals:                      27   BIC:                             670.8
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept    1.15e+05   2.15e+04      5.352      0.000    7.09e+04    1.59e+05
size          73.7710     11.175      6.601      0.000      50.842      96.700
==============================================================================
Omnibus:                        0.576   Durbin-Watson:                   1.219
Prob(Omnibus):                  0.750   Jarque-Bera (JB):                0.638
Skew:                          -0.078   Prob(JB):                        0.727
Kurtosis:                       2.290   Cond. No.                     9.45e+03
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The condition number is large, 9.45e+03. This might indicate that there are
strong multicollinearity or other numerical problems.</code></pre>
</div>
</div>
</section>
<section id="coefficient-table" class="level3">
<h3 class="anchored" data-anchor-id="coefficient-table">Coefficient Table</h3>
<p>Let‚Äôs create a clean table showing the key statistics for statistical inference.</p>
<div id="cell-9" class="cell" data-execution_count="21">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save coefficients in a clean table</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>coef_table <span class="op">=</span> pd.DataFrame({</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Coefficient'</span>: model_basic.params,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Std. Error'</span>: model_basic.bse,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'t-statistic'</span>: model_basic.tvalues,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'p-value'</span>: model_basic.pvalues</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Coefficient Table:"</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(coef_table)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Interpretation:"</span>)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  - Slope (size): Each additional sq ft increases price by $73.77"</span>)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  - Standard error: Measures uncertainty in the slope estimate"</span>)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  - t-statistic: Tests whether slope differs from zero"</span>)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  - p-value: Probability of observing such extreme values under H‚ÇÄ: Œ≤‚ÇÇ = 0"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Coefficient Table:
             Coefficient    Std. Error  t-statistic       p-value
Intercept  115017.282609  21489.359861     5.352290  1.183545e-05
size           73.771040     11.174911     6.601488  4.408752e-07

Interpretation:
  - Slope (size): Each additional sq ft increases price by $73.77
  - Standard error: Measures uncertainty in the slope estimate
  - t-statistic: Tests whether slope differs from zero
  - p-value: Probability of observing such extreme values under H‚ÇÄ: Œ≤‚ÇÇ = 0</code></pre>
</div>
</div>
</section>
</section>
<section id="the-t-statistic" class="level2">
<h2 class="anchored" data-anchor-id="the-t-statistic">7.2 The t Statistic</h2>
<p>The t-statistic is fundamental to statistical inference in regression.</p>
<p><strong>Statistical inference problem:</strong></p>
<ul>
<li><strong>Sample</strong>: <span class="math inline">\(\hat{y} = b_1 + b_2 x\)</span> where <span class="math inline">\(b_1\)</span> and <span class="math inline">\(b_2\)</span> are least squares estimates</li>
<li><strong>Population</strong>: <span class="math inline">\(E[y|x] = \beta_1 + \beta_2 x\)</span> and <span class="math inline">\(y = \beta_1 + \beta_2 x + u\)</span></li>
<li><strong>Goal</strong>: Make inferences about the slope parameter <span class="math inline">\(\beta_2\)</span></li>
</ul>
<p><strong>The t-statistic:</strong></p>
<p><span class="math display">\[T = \frac{\text{estimate} - \text{parameter}}{\text{standard error}} = \frac{b_2 - \beta_2}{se(b_2)} \sim T(n-2)\]</span></p>
<p><strong>Why use the T(n-2) distribution?</strong></p>
<p>Under assumptions 1-4:</p>
<ul>
<li><span class="math inline">\(Var[b_2] = \sigma_u^2 / \sum_{i=1}^n (x_i - \bar{x})^2\)</span></li>
<li>We don‚Äôt know <span class="math inline">\(\sigma_u^2\)</span>, so we replace it with <span class="math inline">\(s_e^2 = \frac{1}{n-2} \sum_{i=1}^n (y_i - \hat{y}_i)^2\)</span></li>
<li>This introduces additional uncertainty, so we use <span class="math inline">\(T(n-2)\)</span> instead of <span class="math inline">\(N(0,1)\)</span></li>
</ul>
<p><strong>Model Assumptions (1-4):</strong></p>
<ol type="1">
<li>The population model is <span class="math inline">\(y = \beta_1 + \beta_2 x + u\)</span></li>
<li>The error has mean zero conditional on x: <span class="math inline">\(E[u_i | x_i] = 0\)</span></li>
<li>The error has constant variance: <span class="math inline">\(Var[u_i | x_i] = \sigma_u^2\)</span></li>
<li>The errors are statistically independent: <span class="math inline">\(u_i\)</span> independent of <span class="math inline">\(u_j\)</span></li>
</ol>
<section id="understanding-standard-errors-the-foundation-of-inference" class="level3">
<h3 class="anchored" data-anchor-id="understanding-standard-errors-the-foundation-of-inference">Understanding Standard Errors: The Foundation of Inference</h3>
<p><strong>What is a standard error?</strong></p>
<p>The standard error measures the uncertainty in our estimate. It answers: ‚ÄúIf we repeatedly sampled from the population and computed b‚ÇÇ each time, how much would b‚ÇÇ vary across samples?‚Äù</p>
<p><strong>Key distinction:</strong></p>
<ul>
<li><strong>Standard deviation</strong>: Variability of individual observations (data spread)</li>
<li><strong>Standard error</strong>: Variability of the estimate across samples (estimation uncertainty)</li>
</ul>
<p><strong>Formula for SE of the slope:</strong></p>
<p><span class="math display">\[se(b_2) = \frac{\sigma_u}{\sqrt{\sum_{i=1}^n (x_i - \bar{x})^2}} = \frac{\sigma_u}{\sqrt{n} \cdot \sigma_x}\]</span></p>
<p>where:</p>
<ul>
<li>œÉ_u = standard deviation of the error term</li>
<li>œÉ_x = standard deviation of x</li>
<li>n = sample size</li>
</ul>
<p><strong>What affects the standard error?</strong></p>
<p><strong>1. Error variance (œÉ¬≤_u): Larger œÉ_u ‚Üí Larger SE</strong></p>
<ul>
<li>More unexplained variation in y</li>
<li>Data points farther from regression line</li>
<li>Less precise estimates</li>
</ul>
<p><strong>2. Sample size (n): Larger n ‚Üí Smaller SE</strong></p>
<ul>
<li>More data reduces uncertainty</li>
<li>SE decreases at rate 1/‚àön</li>
<li>Quadruple n to halve SE</li>
</ul>
<p><strong>3. Variation in x (œÉ_x): Larger œÉ_x ‚Üí Smaller SE</strong></p>
<ul>
<li>More spread in x provides more information</li>
<li>Extreme x values help identify the slope</li>
<li>Concentrated x values give less precision</li>
</ul>
<p><strong>Intuition:</strong></p>
<p>Think of the regression line as a seesaw balanced at (xÃÑ, »≥):</p>
<ul>
<li>With wide spread in x: Small changes in slope make big differences at the extremes (easy to detect slope)</li>
<li>With narrow spread in x: Hard to distinguish different slopes (difficult to detect slope)</li>
</ul>
<p><strong>Example calculation for our house price data:</strong></p>
<p>Given:</p>
<ul>
<li>Sample size: n = 29</li>
<li>Standard error of regression: œÉ_u ‚âà 37,000</li>
<li>Standard deviation of size: œÉ_x ‚âà 360</li>
<li>Estimated SE(b‚ÇÇ) = 37,000 / (‚àö29 √ó 360) ‚âà 19.1</li>
</ul>
<p>(Actual SE is 11.17, smaller because the relationship is quite strong)</p>
<p><strong>Why standard errors matter:</strong></p>
<ol type="1">
<li><strong>Confidence intervals</strong>: CI = b‚ÇÇ ¬± t √ó SE(b‚ÇÇ)</li>
<li><strong>Hypothesis tests</strong>: t = (b‚ÇÇ - Œ≤‚ÇÇ‚Å∞) / SE(b‚ÇÇ)</li>
<li><strong>Practical significance</strong>: Small SE ‚Üí precise estimate ‚Üí more reliable</li>
<li><strong>Study design</strong>: Calculate required n for desired SE</li>
</ol>
<p><strong>Relationship to R¬≤:</strong></p>
<p>Higher R¬≤ (better fit) ‚Üí Smaller œÉ_u ‚Üí Smaller SE ‚Üí More precise estimates</p>
<p>For our house price example:</p>
<ul>
<li>R¬≤ = 0.62 (size explains 62% of price variation)</li>
<li>This gives relatively small SE</li>
<li>If R¬≤ were 0.10, SE would be about 2.5 times larger</li>
</ul>
<div id="cell-12" class="cell" data-execution_count="22">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"7.2 THE T STATISTIC"</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Regression coefficients and t-statistics:"</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model_basic.summary2().tables[<span class="dv">1</span>])</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract key statistics</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>coef_size <span class="op">=</span> model_basic.params[<span class="st">'size'</span>]</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>se_size <span class="op">=</span> model_basic.bse[<span class="st">'size'</span>]</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>t_stat_size <span class="op">=</span> model_basic.tvalues[<span class="st">'size'</span>]</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>p_value_size <span class="op">=</span> model_basic.pvalues[<span class="st">'size'</span>]</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Detailed statistics for 'size' coefficient:"</span>)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Coefficient: $</span><span class="sc">{</span>coef_size<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Standard Error: $</span><span class="sc">{</span>se_size<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  t-statistic: </span><span class="sc">{</span>t_stat_size<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  p-value: </span><span class="sc">{</span>p_value_size<span class="sc">:.6f}</span><span class="ss">"</span>)</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">The t-statistic formula:"</span>)</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  t = b‚ÇÇ / se(b‚ÇÇ) = </span><span class="sc">{</span>coef_size<span class="sc">:.4f}</span><span class="ss"> / </span><span class="sc">{</span>se_size<span class="sc">:.4f}</span><span class="ss"> = </span><span class="sc">{</span>t_stat_size<span class="sc">:.4f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
7.2 THE T STATISTIC
======================================================================

Regression coefficients and t-statistics:
                   Coef.      Std.Err.         t         P&gt;|t|        [0.025  \
Intercept  115017.282609  21489.359861  5.352290  1.183545e-05  70924.758265   
size           73.771040     11.174911  6.601488  4.408752e-07     50.842017   

                  0.975]  
Intercept  159109.806952  
size           96.700064  

Detailed statistics for 'size' coefficient:
  Coefficient: $73.7710
  Standard Error: $11.1749
  t-statistic: 6.6015
  p-value: 0.000000

The t-statistic formula:
  t = b‚ÇÇ / se(b‚ÇÇ) = 73.7710 / 11.1749 = 6.6015</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p><strong>Key Concept 7.1: The t-Distribution and Degrees of Freedom</strong></p>
<p>The <strong>t-distribution</strong> is used for statistical inference when the population variance is unknown (which is always the case in practice). Unlike the standard normal distribution, the t-distribution accounts for the additional uncertainty from estimating the variance.</p>
<p><strong>Key properties:</strong> - Bell-shaped and symmetric (like the normal distribution) - Heavier tails than the normal distribution (more probability in extremes) - Converges to the normal distribution as sample size increases - Characterized by degrees of freedom (df)</p>
<p><strong>Degrees of freedom = n - 2</strong> for bivariate regression: - Start with n observations - Estimate Œ≤‚ÇÅ (intercept): -1 df - Estimate Œ≤‚ÇÇ (slope): -1 df<br>
- Remaining df for estimating variance: n - 2</p>
<p><strong>Practical implication:</strong> For small samples (n &lt; 30), the t-distribution‚Äôs heavier tails lead to wider confidence intervals and more conservative hypothesis tests compared to the normal distribution. For large samples (n &gt; 100), the difference becomes negligible.</p>
</blockquote>
</section>
</section>
<section id="confidence-intervals" class="level2">
<h2 class="anchored" data-anchor-id="confidence-intervals">7.3 Confidence Intervals</h2>
<p>A confidence interval provides a range of plausible values for the population parameter.</p>
<p><strong>Formula for a $100(1-)%$ confidence interval:</strong></p>
<p><span class="math display">\[b_2 \pm t_{n-2, \alpha/2} \times se(b_2)\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(b_2\)</span> is the slope estimate</li>
<li><span class="math inline">\(se(b_2)\)</span> is the standard error of <span class="math inline">\(b_2\)</span></li>
<li><span class="math inline">\(t_{n-2, \alpha/2}\)</span> is the critical value from Student‚Äôs t-distribution with <span class="math inline">\(n-2\)</span> degrees of freedom</li>
</ul>
<p><strong>95% confidence interval (approximate):</strong></p>
<p><span class="math display">\[b_2 \pm 2 \times se(b_2)\]</span></p>
<p><strong>Interpretation:</strong></p>
<ul>
<li>If we repeatedly sampled from the population and constructed 95% CIs, approximately 95% of these intervals would contain the true parameter value <span class="math inline">\(\beta_2\)</span></li>
<li>The calculated 95% CI will correctly include <span class="math inline">\(\beta_2\)</span> 95% of the time</li>
</ul>
<p><strong>Example calculation for house price:</strong></p>
<p><span class="math display">\[\begin{aligned}
b_2 \pm t_{27, 0.025} \times se(b_2) &amp;= 73.77 \pm 2.052 \times 11.17 \\
&amp;= 73.77 \pm 22.93 \\
&amp;= [50.84, 96.70]
\end{aligned}\]</span></p>
<blockquote class="blockquote">
<p><strong>Key Concept 7.2: Interpreting Confidence Intervals</strong></p>
<p>A <strong>confidence interval</strong> provides a range of plausible values for the population parameter. For regression slopes, the 95% CI is:</p>
<p><span class="math display">\[b_2 \pm t_{n-2, 0.025} \times se(b_2)\]</span></p>
<p><strong>Common misconceptions:</strong> - WRONG: ‚ÄúThere‚Äôs a 95% probability that Œ≤‚ÇÇ is in this interval‚Äù - CORRECT: ‚ÄúIf we repeated the sampling process many times, 95% of the constructed intervals would contain Œ≤‚ÇÇ‚Äù</p>
<p><strong>Practical interpretation:</strong> - The interval represents our uncertainty about the true parameter value - Wider intervals indicate more uncertainty (large SE, small n, or high variability) - Narrower intervals indicate more precision (small SE, large n, or low variability) - Values inside the interval are ‚Äúplausible‚Äù at the chosen confidence level - Values outside the interval would be rejected in a hypothesis test</p>
<p><strong>Relationship to hypothesis testing:</strong> If a null value Œ≤‚ÇÇ* falls inside the 95% CI, we fail to reject H‚ÇÄ: Œ≤‚ÇÇ = Œ≤‚ÇÇ* at the 5% significance level. This makes CIs more informative than hypothesis tests alone.</p>
</blockquote>
<section id="understanding-confidence-intervals-a-deep-dive" class="level3">
<h3 class="anchored" data-anchor-id="understanding-confidence-intervals-a-deep-dive">Understanding Confidence Intervals: A Deep Dive</h3>
<p><strong>What is a confidence interval?</strong></p>
<p>A confidence interval (CI) is NOT a probability statement about the parameter. Instead, it‚Äôs a statement about the procedure used to construct the interval.</p>
<p><strong>Common misconceptions:</strong></p>
<p><strong>WRONG</strong>: ‚ÄúThere is a 95% probability that Œ≤‚ÇÇ is between 50.84 and 96.70‚Äù</p>
<ul>
<li>The parameter Œ≤‚ÇÇ is fixed (not random)</li>
<li>The interval either contains Œ≤‚ÇÇ or it doesn‚Äôt</li>
</ul>
<p><strong>CORRECT</strong>: ‚ÄúIf we repeatedly sampled and constructed 95% CIs, approximately 95% of these intervals would contain the true Œ≤‚ÇÇ‚Äù</p>
<ul>
<li>The randomness is in the sampling process</li>
<li>Our particular interval is one realization from this process</li>
</ul>
<p><strong>Intuitive explanation:</strong></p>
<p>Imagine conducting 100 different studies using different random samples from the same population:</p>
<ul>
<li>Each study estimates Œ≤‚ÇÇ and constructs a 95% CI</li>
<li>About 95 of the 100 intervals will contain the true Œ≤‚ÇÇ</li>
<li>About 5 of the 100 intervals will miss Œ≤‚ÇÇ (just by chance)</li>
</ul>
<p><strong>Width of confidence intervals:</strong></p>
<p>The CI width depends on three factors:</p>
<p><span class="math display">\[\text{Width} = 2 \times t_{n-2, \alpha/2} \times se(b_2)\]</span></p>
<ol type="1">
<li><strong>Confidence level (1-Œ±)</strong>: Higher confidence ‚Üí wider interval</li>
</ol>
<ul>
<li>90% CI: Narrower (less confident)</li>
<li>95% CI: Standard choice (balance)</li>
<li>99% CI: Wider (more confident)</li>
</ul>
<ol start="2" type="1">
<li><strong>Sample size (n)</strong>: Larger sample ‚Üí narrower interval</li>
</ol>
<ul>
<li>More data reduces uncertainty</li>
<li>Critical value t_{n-2, Œ±/2} decreases as n increases</li>
</ul>
<ol start="3" type="1">
<li><strong>Variability in data</strong>: More scatter ‚Üí wider interval</li>
</ol>
<ul>
<li>se(b‚ÇÇ) increases with unexplained variation</li>
<li>Tighter relationship ‚Üí more precise estimates</li>
</ul>
<p><strong>Practical use:</strong></p>
<p>Confidence intervals are more informative than hypothesis tests because they show:</p>
<ul>
<li>The point estimate (center of interval)</li>
<li>The precision of the estimate (width of interval)</li>
<li>All null values that would not be rejected (values inside interval)</li>
</ul>
<div id="cell-17" class="cell" data-execution_count="23">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"7.3 CONFIDENCE INTERVALS"</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 95% confidence intervals</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>conf_int <span class="op">=</span> model_basic.conf_int(alpha<span class="op">=</span><span class="fl">0.05</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">95% Confidence Intervals:"</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(conf_int)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
7.3 CONFIDENCE INTERVALS
======================================================================

95% Confidence Intervals:
                      0              1
Intercept  70924.758265  159109.806952
size          50.842017      96.700064</code></pre>
</div>
</div>
</section>
<section id="the-t-distribution-vs-normal-distribution-why-it-matters" class="level3">
<h3 class="anchored" data-anchor-id="the-t-distribution-vs-normal-distribution-why-it-matters">The t-Distribution vs Normal Distribution: Why It Matters</h3>
<p><strong>Why not use the normal distribution?</strong></p>
<p>In theory, when we know the population variance œÉ¬≤_u, the test statistic follows a standard normal distribution:</p>
<p><span class="math display">\[Z = \frac{b_2 - \beta_2}{\sigma / \sqrt{\sum(x_i - \bar{x})^2}} \sim N(0,1)\]</span></p>
<p><strong>The problem:</strong> We never know œÉ_u in practice!</p>
<p><strong>The solution:</strong> Replace œÉ_u with its estimate s_e (residual standard error):</p>
<p><span class="math display">\[T = \frac{b_2 - \beta_2}{s_e / \sqrt{\sum(x_i - \bar{x})^2}} \sim T(n-2)\]</span></p>
<p>This substitution introduces additional uncertainty, so we use the t-distribution instead of normal.</p>
<p><strong>Properties of the t-distribution:</strong></p>
<ol type="1">
<li><strong>Shape</strong>: Bell-shaped and symmetric (like normal)</li>
<li><strong>Mean</strong>: 0 (like normal)</li>
<li><strong>Variance</strong>: df/(df-2) &gt; 1 (heavier tails than normal)</li>
<li><strong>Degrees of freedom</strong>: n - 2 for bivariate regression
<ul>
<li>n observations</li>
<li>Minus 2 parameters estimated (Œ≤‚ÇÅ and Œ≤‚ÇÇ)</li>
</ul></li>
</ol>
<p><strong>Key differences from normal:</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 18%">
<col style="width: 38%">
<col style="width: 25%">
<col style="width: 17%">
</colgroup>
<thead>
<tr class="header">
<th>Sample Size</th>
<th>t Critical Value (Œ±=0.05)</th>
<th>z Critical Value</th>
<th>Difference</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>n = 5 (df=3)</td>
<td>3.182</td>
<td>1.96</td>
<td>+62%</td>
</tr>
<tr class="even">
<td>n = 10 (df=8)</td>
<td>2.306</td>
<td>1.96</td>
<td>+18%</td>
</tr>
<tr class="odd">
<td>n = 30 (df=28)</td>
<td>2.048</td>
<td>1.96</td>
<td>+4%</td>
</tr>
<tr class="even">
<td>n = 100 (df=98)</td>
<td>1.984</td>
<td>1.96</td>
<td>+1%</td>
</tr>
<tr class="odd">
<td>n ‚Üí ‚àû</td>
<td>1.96</td>
<td>1.96</td>
<td>0%</td>
</tr>
</tbody>
</table>
<p><strong>What this means:</strong></p>
<ul>
<li><strong>Small samples</strong>: t critical values much larger ‚Üí wider CIs, harder to reject H‚ÇÄ</li>
<li><strong>Large samples</strong>: t ‚âà normal ‚Üí approximately same inference</li>
<li><strong>Our house data</strong>: n=29, df=27, t(0.025) = 2.052 vs z = 1.96</li>
</ul>
<p><strong>Why degrees of freedom = n - 2?</strong></p>
<ul>
<li>Start with n observations</li>
<li>Estimate Œ≤‚ÇÅ (intercept): loses 1 df</li>
<li>Estimate Œ≤‚ÇÇ (slope): loses 1 df</li>
<li>Remaining df for estimating variance: n - 2</li>
</ul>
<p><strong>Practical implications:</strong></p>
<p><strong>For n = 29 (our house price data):</strong></p>
<ul>
<li>Using normal: 95% CI margin = 1.96 √ó 11.17 = 21.89</li>
<li>Using t(27): 95% CI margin = 2.052 √ó 11.17 = 22.92</li>
<li>Difference: 5% wider with t-distribution (more conservative)</li>
</ul>
<p><strong>For n = 10 (small sample):</strong></p>
<ul>
<li>Using normal: 95% CI margin = 1.96 √ó SE</li>
<li>Using t(8): 95% CI margin = 2.306 √ó SE</li>
<li>Difference: 18% wider with t-distribution (much more conservative!)</li>
</ul>
<p><strong>Rule of thumb:</strong></p>
<ul>
<li>n &lt; 30: Must use t-distribution</li>
<li>30 ‚â§ n &lt; 100: Use t-distribution (small difference)</li>
<li>n ‚â• 100: Normal approximation usually fine, but still use t</li>
</ul>
<p><strong>Modern practice:</strong> Statistical software always uses t-distribution (why not? It‚Äôs correct for any n)</p>
<p><strong>Visual intuition:</strong></p>
<p>The t-distribution has heavier tails:</p>
<ul>
<li>More probability in the extremes</li>
<li>Less probability near the center</li>
<li>This accounts for the uncertainty in estimating œÉ_u</li>
<li>As n increases, estimation uncertainty decreases, and t ‚Üí normal</li>
</ul>
</section>
<section id="manual-calculation-of-confidence-interval" class="level3">
<h3 class="anchored" data-anchor-id="manual-calculation-of-confidence-interval">Manual Calculation of Confidence Interval</h3>
<p>Let‚Äôs manually calculate the confidence interval for the size coefficient to understand the mechanics.</p>
<div id="cell-20" class="cell" data-execution_count="24">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Manual calculation of confidence interval for size</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="bu">len</span>(data_house)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> n <span class="op">-</span> <span class="dv">2</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>t_crit <span class="op">=</span> stats.t.ppf(<span class="fl">0.975</span>, df)  <span class="co"># 97.5th percentile for two-sided 95% CI</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>ci_lower <span class="op">=</span> coef_size <span class="op">-</span> t_crit <span class="op">*</span> se_size</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>ci_upper <span class="op">=</span> coef_size <span class="op">+</span> t_crit <span class="op">*</span> se_size</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Manual calculation for 'size' coefficient:"</span>)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Sample size: </span><span class="sc">{</span>n<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Degrees of freedom: </span><span class="sc">{</span>df<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Critical t-value (Œ±=0.05): </span><span class="sc">{</span>t_crit<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Margin of error: </span><span class="sc">{</span>t_crit <span class="op">*</span> se_size<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  95% CI: [$</span><span class="sc">{</span>ci_lower<span class="sc">:.4f}</span><span class="ss">, $</span><span class="sc">{</span>ci_upper<span class="sc">:.4f}</span><span class="ss">]"</span>)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Interpretation:"</span>)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  We are 95% confident that each additional square foot"</span>)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  increases house price by between $</span><span class="sc">{</span>ci_lower<span class="sc">:.2f}</span><span class="ss"> and $</span><span class="sc">{</span>ci_upper<span class="sc">:.2f}</span><span class="ss">."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Manual calculation for 'size' coefficient:
  Sample size: 29
  Degrees of freedom: 27
  Critical t-value (Œ±=0.05): 2.0518
  Margin of error: 22.9290
  95% CI: [$50.8420, $96.7001]

Interpretation:
  We are 95% confident that each additional square foot
  increases house price by between $50.84 and $96.70.</code></pre>
</div>
</div>
</section>
<section id="example-with-artificial-data" class="level3">
<h3 class="anchored" data-anchor-id="example-with-artificial-data">Example with Artificial Data</h3>
<p>To illustrate the concepts more clearly, let‚Äôs work with a simple artificial dataset.</p>
</section>
</section>
<section id="tests-of-statistical-significance" class="level2">
<h2 class="anchored" data-anchor-id="tests-of-statistical-significance">7.4 Tests of Statistical Significance</h2>
<p>A regressor <span class="math inline">\(x\)</span> has no relationship with <span class="math inline">\(y\)</span> if <span class="math inline">\(\beta_2 = 0\)</span>.</p>
<p><strong>Test of statistical significance</strong> (two-sided test):</p>
<p><span class="math display">\[H_0: \beta_2 = 0 \quad \text{vs.} \quad H_a: \beta_2 \neq 0\]</span></p>
<p><strong>Test statistic:</strong></p>
<p><span class="math display">\[t = \frac{b_2}{se(b_2)} \sim T(n-2)\]</span></p>
<p><strong>Decision rules:</strong></p>
<ol type="1">
<li><p><strong>p-value approach</strong>: Reject <span class="math inline">\(H_0\)</span> at level <span class="math inline">\(\alpha\)</span> if <span class="math inline">\(p = Pr[|T_{n-2}| &gt; |t|] &lt; \alpha\)</span></p></li>
<li><p><strong>Critical value approach</strong>: Reject <span class="math inline">\(H_0\)</span> at level <span class="math inline">\(\alpha\)</span> if <span class="math inline">\(|t| &gt; c = t_{n-2, \alpha/2}\)</span></p></li>
</ol>
<p><strong>For the house price example:</strong></p>
<ul>
<li><span class="math inline">\(t = 73.77 / 11.17 = 6.60\)</span></li>
<li><span class="math inline">\(p = Pr[|T_{27}| &gt; 6.60] \approx 0.000\)</span></li>
<li>Critical value: <span class="math inline">\(c = t_{27, 0.025} = 2.052\)</span></li>
<li>Since <span class="math inline">\(|t| = 6.60 &gt; 2.052\)</span>, reject <span class="math inline">\(H_0\)</span></li>
<li><strong>Conclusion</strong>: House size is statistically significant at the 5% level</li>
</ul>
<blockquote class="blockquote">
<p><strong>Key Concept 7.3: The Hypothesis Testing Framework</strong></p>
<p><strong>Hypothesis testing</strong> is a formal procedure for making decisions about population parameters. The key steps are:</p>
<p><strong>1. State the hypotheses:</strong> - <strong>Null hypothesis (H‚ÇÄ)</strong>: The claim we‚Äôre testing (usually ‚Äúno effect‚Äù) - <strong>Alternative hypothesis (H‚Çê)</strong>: What we conclude if we reject H‚ÇÄ</p>
<p><strong>2. Choose significance level (Œ±):</strong> - Common choices: 0.10, 0.05, 0.01 - Œ± = probability of Type I error (rejecting H‚ÇÄ when it‚Äôs true)</p>
<p><strong>3. Calculate test statistic:</strong> - Standardizes the difference: t = (estimate - null value) / SE</p>
<p><strong>4. Determine p-value:</strong> - Probability of observing our result (or more extreme) if H‚ÇÄ is true - Smaller p-value = stronger evidence against H‚ÇÄ</p>
<p><strong>5. Make decision:</strong> - Reject H‚ÇÄ if p-value &lt; Œ± - Fail to reject H‚ÇÄ if p-value ‚â• Œ± (never ‚Äúaccept‚Äù H‚ÇÄ)</p>
<p><strong>Understanding p-values:</strong> If p = 0.001, this means ‚Äúif H‚ÇÄ were true, we‚Äôd observe a result this extreme only 0.1% of the time.‚Äù This is strong evidence against H‚ÇÄ.</p>
</blockquote>
<blockquote class="blockquote">
<p><strong>Key Concept 7.4: Statistical vs.&nbsp;Economic Significance</strong></p>
<p><strong>Statistical significance</strong> and <strong>economic significance</strong> are distinct concepts that answer different questions:</p>
<p><strong>Statistical Significance:</strong> - <strong>Question:</strong> Is the effect different from zero? - <strong>Determined by:</strong> t-statistic = b‚ÇÇ / se(b‚ÇÇ), which depends on sample size, variability, and effect size - <strong>Interpretation:</strong> We can confidently say the effect exists (not due to chance)</p>
<p><strong>Economic Significance:</strong> - <strong>Question:</strong> Is the effect large enough to matter in practice? - <strong>Determined by:</strong> The magnitude of b‚ÇÇ and the context - <strong>Interpretation:</strong> The effect has real-world importance</p>
<p><strong>Why they can diverge:</strong> 1. <strong>Large n:</strong> Even tiny effects become statistically significant - Example: Œ≤‚ÇÇ = $0.01 with n = 10,000 might have p &lt; 0.001 but be economically trivial 2. <strong>Small n:</strong> Large effects may not reach statistical significance<br>
- Example: Œ≤‚ÇÇ = $100 with n = 10 might have p = 0.12 but be economically important</p>
<p><strong>Best practice:</strong> Always report both the coefficient estimate (economic magnitude) and the standard error/confidence interval (statistical precision). Focus on confidence intervals, which show both dimensions simultaneously.</p>
</blockquote>
<blockquote class="blockquote">
<p><strong>Key Concept 7.5: One-Sided vs.&nbsp;Two-Sided Tests</strong></p>
<p>The choice between one-sided and two-sided tests depends on your research question:</p>
<p><strong>Two-Sided Test (Most Common):</strong> - H‚ÇÄ: Œ≤‚ÇÇ = Œ≤‚ÇÇ* vs.&nbsp;H‚Çê: Œ≤‚ÇÇ ‚â† Œ≤‚ÇÇ* - Detects deviations in either direction - Standard practice in academic research - Rejection region: Both tails of t-distribution</p>
<p><strong>One-Sided Test (Directional):</strong> - Upper: H‚ÇÄ: Œ≤‚ÇÇ ‚â§ Œ≤‚ÇÇ* vs.&nbsp;H‚Çê: Œ≤‚ÇÇ &gt; Œ≤‚ÇÇ<em> - Lower: H‚ÇÄ: Œ≤‚ÇÇ ‚â• Œ≤‚ÇÇ</em> vs.&nbsp;H‚Çê: Œ≤‚ÇÇ &lt; Œ≤‚ÇÇ*<br>
- Detects deviations in one specific direction - Rejection region: One tail only</p>
<p><strong>Key relationship:</strong> For the same test statistic, one-sided p-value = (two-sided p-value) / 2 (if sign is correct)</p>
<p><strong>When to use one-sided tests:</strong> - Strong theoretical prediction of direction (before seeing data) - Only care about deviations in one direction - Be cautious: Journals typically require two-sided tests</p>
<p><strong>Important:</strong> If your data contradicts the predicted direction, you cannot reject H‚ÇÄ with a one-sided test (p-value &gt; 0.5).</p>
</blockquote>
<div id="cell-26" class="cell" data-execution_count="25">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Example with Artificial Data"</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>])</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>])</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>df_artificial <span class="op">=</span> pd.DataFrame({<span class="st">'x'</span>: x, <span class="st">'y'</span>: y})</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>model_artificial <span class="op">=</span> ols(<span class="st">'y ~ x'</span>, data<span class="op">=</span>df_artificial).fit()</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model_artificial.summary())</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>coef_x <span class="op">=</span> model_artificial.params[<span class="st">'x'</span>]</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>se_x <span class="op">=</span> model_artificial.bse[<span class="st">'x'</span>]</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>n_art <span class="op">=</span> <span class="bu">len</span>(x)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>df_art <span class="op">=</span> n_art <span class="op">-</span> <span class="dv">2</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>t_crit_art <span class="op">=</span> stats.t.ppf(<span class="fl">0.975</span>, df_art)</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>ci_lower_art <span class="op">=</span> coef_x <span class="op">-</span> t_crit_art <span class="op">*</span> se_x</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>ci_upper_art <span class="op">=</span> coef_x <span class="op">+</span> t_crit_art <span class="op">*</span> se_x</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Manual CI for artificial data:"</span>)</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Coefficient: </span><span class="sc">{</span>coef_x<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Standard Error: </span><span class="sc">{</span>se_x<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  95% CI: [</span><span class="sc">{</span>ci_lower_art<span class="sc">:.4f}</span><span class="ss">, </span><span class="sc">{</span>ci_upper_art<span class="sc">:.4f}</span><span class="ss">]"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
Example with Artificial Data
======================================================================
                            OLS Regression Results                            
==============================================================================
Dep. Variable:                      y   R-squared:                       0.800
Model:                            OLS   Adj. R-squared:                  0.733
Method:                 Least Squares   F-statistic:                     12.00
Date:                Tue, 20 Jan 2026   Prob (F-statistic):             0.0405
Time:                        23:33:22   Log-Likelihood:               -0.78037
No. Observations:                   5   AIC:                             5.561
Df Residuals:                       3   BIC:                             4.780
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept      0.8000      0.383      2.089      0.128      -0.419       2.019
x              0.4000      0.115      3.464      0.041       0.033       0.767
==============================================================================
Omnibus:                          nan   Durbin-Watson:                   2.600
Prob(Omnibus):                    nan   Jarque-Bera (JB):                0.352
Skew:                          -0.000   Prob(JB):                        0.839
Kurtosis:                       1.700   Cond. No.                         8.37
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.

Manual CI for artificial data:
  Coefficient: 0.4000
  Standard Error: 0.1155
  95% CI: [0.0325, 0.7675]</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/Users/carlosmendez/miniforge3/lib/python3.10/site-packages/statsmodels/stats/stattools.py:74: ValueWarning: omni_normtest is not valid with less than 8 observations; 5 samples were given.
  warn("omni_normtest is not valid with less than 8 observations; %i "</code></pre>
</div>
</div>
<section id="understanding-hypothesis-testing-the-complete-workflow" class="level3">
<h3 class="anchored" data-anchor-id="understanding-hypothesis-testing-the-complete-workflow">Understanding Hypothesis Testing: The Complete Workflow</h3>
<p><strong>The hypothesis testing framework:</strong></p>
<p>Hypothesis testing is a formal procedure for making decisions about population parameters using sample data.</p>
<p><strong>Step-by-step workflow:</strong></p>
<p><strong>1. State the hypotheses</strong></p>
<ul>
<li><strong>Null hypothesis (H‚ÇÄ)</strong>: The claim we‚Äôre testing (usually ‚Äúno effect‚Äù)</li>
<li><strong>Alternative hypothesis (H‚Çê)</strong>: What we conclude if we reject H‚ÇÄ</li>
<li>Example: H‚ÇÄ: Œ≤‚ÇÇ = 0 vs H‚Çê: Œ≤‚ÇÇ ‚â† 0</li>
</ul>
<p><strong>2. Choose the significance level (Œ±)</strong></p>
<ul>
<li>Common choices: 0.10, 0.05, 0.01</li>
<li>Œ± = probability of rejecting H‚ÇÄ when it‚Äôs actually true (Type I error)</li>
<li>Convention: Œ± = 0.05 (5% significance level)</li>
</ul>
<p><strong>3. Calculate the test statistic</strong></p>
<ul>
<li>Formula: t = (b‚ÇÇ - Œ≤‚ÇÇ‚Å∞) / se(b‚ÇÇ)</li>
<li>This standardizes the difference between estimate and null value</li>
<li>Under H‚ÇÄ, t follows a t-distribution with n-2 degrees of freedom</li>
</ul>
<p><strong>4. Determine the p-value</strong></p>
<ul>
<li>p-value = probability of observing a test statistic as extreme as ours if H‚ÇÄ is true</li>
<li>Smaller p-value = stronger evidence against H‚ÇÄ</li>
<li>p-value &lt; Œ± ‚Üí reject H‚ÇÄ</li>
</ul>
<p><strong>5. Make a decision</strong></p>
<ul>
<li><strong>Reject H‚ÇÄ</strong>: Strong evidence against the null hypothesis</li>
<li><strong>Fail to reject H‚ÇÄ</strong>: Insufficient evidence to reject the null</li>
<li>Note: We never ‚Äúaccept‚Äù H‚ÇÄ, we only fail to reject it</li>
</ul>
<p><strong>6. State the conclusion</strong></p>
<ul>
<li>Translate the statistical decision into plain language</li>
<li>Example: ‚ÄúHouse size has a statistically significant effect on price at the 5% level‚Äù</li>
</ul>
<p><strong>Understanding p-values:</strong></p>
<p>The p-value answers this question: ‚ÄúIf the null hypothesis were true, what is the probability of getting a result at least as extreme as what we observed?‚Äù</p>
<p><strong>Example interpretation:</strong></p>
<ul>
<li>p = 0.000: If Œ≤‚ÇÇ were truly zero, the probability of getting t ‚â• 6.60 is less than 0.1%</li>
<li>This is very unlikely, so we have strong evidence against H‚ÇÄ</li>
</ul>
<p><strong>Two approaches to hypothesis testing:</strong></p>
<ol type="1">
<li><strong>p-value approach</strong>: Reject H‚ÇÄ if p-value &lt; Œ±</li>
<li><strong>Critical value approach</strong>: Reject H‚ÇÄ if |t| &gt; critical value</li>
</ol>
<p>Both approaches always give the same conclusion!</p>
<p><strong>Common significance levels and interpretations:</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>p-value</th>
<th>Interpretation</th>
<th>Strength of Evidence</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>p &gt; 0.10</td>
<td>Not significant</td>
<td>Weak/no evidence</td>
</tr>
<tr class="even">
<td>0.05 &lt; p ‚â§ 0.10</td>
<td>Marginally significant</td>
<td>Moderate evidence</td>
</tr>
<tr class="odd">
<td>0.01 &lt; p ‚â§ 0.05</td>
<td>Significant</td>
<td>Strong evidence</td>
</tr>
<tr class="even">
<td>p ‚â§ 0.01</td>
<td>Highly significant</td>
<td>Very strong evidence</td>
</tr>
</tbody>
</table>
</section>
<section id="statistical-significance-vs-economic-significance" class="level3">
<h3 class="anchored" data-anchor-id="statistical-significance-vs-economic-significance">Statistical Significance vs Economic Significance</h3>
<p>A crucial distinction that is often confused:</p>
<p><strong>Statistical Significance</strong></p>
<ul>
<li>Answers: ‚ÄúIs the effect different from zero?‚Äù</li>
<li>Depends on: Sample size, variability, effect size</li>
<li>Formula: t = b‚ÇÇ / se(b‚ÇÇ)</li>
<li>Interpretation: We can confidently say the effect exists</li>
</ul>
<p><strong>Economic Significance</strong></p>
<ul>
<li>Answers: ‚ÄúIs the effect large enough to matter?‚Äù</li>
<li>Depends on: The magnitude of b‚ÇÇ and context</li>
<li>Requires: Domain knowledge and practical judgment</li>
<li>Interpretation: The effect has real-world importance</li>
</ul>
<p><strong>Key insights:</strong></p>
<p><strong>1. Statistical significance ‚â† Economic significance</strong></p>
<p>You can have:</p>
<ul>
<li>Statistically significant but economically trivial effects
<ul>
<li>Example: With n=10,000, Œ≤‚ÇÇ = 0.001 might be statistically significant but meaningless</li>
</ul></li>
<li>Economically important but statistically insignificant effects
<ul>
<li>Example: With n=10, Œ≤‚ÇÇ = 100 might not be statistically significant but potentially important</li>
</ul></li>
</ul>
<p><strong>2. Sample size matters for statistical significance</strong></p>
<p><span class="math display">\[t = \frac{b_2}{se(b_2)} = \frac{b_2}{\sigma_u / \sqrt{\sum(x_i - \bar{x})^2}}\]</span></p>
<p>As sample size increases:</p>
<ul>
<li>The denominator (standard error) decreases</li>
<li>The t-statistic increases</li>
<li>Small effects become statistically significant</li>
</ul>
<p><strong>3. Economic significance requires context</strong></p>
<p>For the house price example:</p>
<ul>
<li>Statistical result: Œ≤‚ÇÇ = 73.77, highly significant (p &lt; 0.001)</li>
<li>Economic interpretation: Each sq ft adds $73.77 to price</li>
<li>Context matters:
<ul>
<li>For a 100 sq ft difference: $7,377 difference (substantial!)</li>
<li>For a 10 sq ft difference: $737.70 difference (moderate)</li>
<li>This is economically meaningful in the housing market</li>
</ul></li>
</ul>
<p><strong>Practical guidance:</strong></p>
<ol type="1">
<li><strong>Always report both</strong>:
<ul>
<li>The coefficient estimate (economic magnitude)</li>
<li>The p-value or confidence interval (statistical precision)</li>
</ul></li>
<li><strong>Focus on confidence intervals</strong>:
<ul>
<li>Shows both statistical and economic significance</li>
<li>Example: 95% CI = [50.84, 96.70]</li>
<li>Interpretation: Effect is between $50.84 and $96.70 per sq ft</li>
<li>Even the lower bound is economically meaningful</li>
</ul></li>
<li><strong>Consider practical importance</strong>:
<ul>
<li>Would anyone change their behavior based on this result?</li>
<li>Is the effect large enough to justify policy interventions?</li>
<li>Does the effect matter in real-world terms?</li>
</ul></li>
</ol>
<p><strong>Example of the distinction:</strong></p>
<p>Suppose we study the effect of an expensive job training program on wages:</p>
<ul>
<li>Statistical result: Training increases wages by $0.50/hour (p = 0.001)</li>
<li>Statistical significance: YES (highly significant)</li>
<li>Economic significance: Questionable
<ul>
<li>Annual benefit: $0.50 √ó 2000 hours = $1,000</li>
<li>If program costs $10,000, not worth it</li>
<li>If program costs $500, might be worth it</li>
</ul></li>
</ul>
<p><strong>Bottom line:</strong> Statistical significance tells you the effect exists. Economic significance tells you whether you should care.</p>
</section>
<section id="understanding-two-sided-vs-one-sided-tests" class="level3">
<h3 class="anchored" data-anchor-id="understanding-two-sided-vs-one-sided-tests">Understanding Two-Sided vs One-Sided Tests</h3>
<p><strong>When to use which test?</strong></p>
<p>The choice between two-sided and one-sided tests depends on your research question and what you want to conclude.</p>
<p><strong>Two-Sided Test (Most Common)</strong></p>
<p><strong>Setup:</strong></p>
<ul>
<li>H‚ÇÄ: Œ≤‚ÇÇ = Œ≤‚ÇÇ*</li>
<li>H‚Çê: Œ≤‚ÇÇ ‚â† Œ≤‚ÇÇ*</li>
</ul>
<p><strong>Use when:</strong></p>
<ul>
<li>You want to detect any difference from the null value</li>
<li>You don‚Äôt have a strong prior about the direction</li>
<li>You want to be conservative (standard practice in research)</li>
</ul>
<p><strong>Rejection region:</strong> Both tails of the distribution</p>
<p><strong>Example:</strong> Does house size affect price?</p>
<ul>
<li>H‚ÇÄ: Œ≤‚ÇÇ = 0 (no effect)</li>
<li>H‚Çê: Œ≤‚ÇÇ ‚â† 0 (some effect, positive or negative)</li>
<li>We reject if the effect is either very positive or very negative</li>
</ul>
<p><strong>One-Sided Test (Directional)</strong></p>
<p><strong>Setup (upper tail):</strong></p>
<ul>
<li>H‚ÇÄ: Œ≤‚ÇÇ ‚â§ Œ≤‚ÇÇ*</li>
<li>H‚Çê: Œ≤‚ÇÇ &gt; Œ≤‚ÇÇ*</li>
</ul>
<p><strong>Setup (lower tail):</strong></p>
<ul>
<li>H‚ÇÄ: Œ≤‚ÇÇ ‚â• Œ≤‚ÇÇ*</li>
<li>H‚Çê: Œ≤‚ÇÇ &lt; Œ≤‚ÇÇ*</li>
</ul>
<p><strong>Use when:</strong></p>
<ul>
<li>You have a specific directional hypothesis</li>
<li>Economic theory predicts a specific direction</li>
<li>You only care about deviations in one direction</li>
</ul>
<p><strong>Rejection region:</strong> One tail of the distribution</p>
<p><strong>Example:</strong> Does house size increase price by less than $90/sq ft?</p>
<ul>
<li>Claim: Œ≤‚ÇÇ &lt; 90</li>
<li>H‚ÇÄ: Œ≤‚ÇÇ ‚â• 90 (null is opposite of claim)</li>
<li>H‚Çê: Œ≤‚ÇÇ &lt; 90 (this is what we want to prove)</li>
<li>We only reject if the effect is significantly below 90</li>
</ul>
<p><strong>Mathematical relationship:</strong></p>
<p>For the same test statistic t:</p>
<ul>
<li>Two-sided p-value = 2 √ó Pr[T &gt; |t|]</li>
<li>One-sided p-value = Pr[T &gt; t] (upper tail) or Pr[T &lt; t] (lower tail)</li>
<li>One-sided p-value = (Two-sided p-value) / 2 (if sign is correct)</li>
</ul>
<p><strong>Important considerations:</strong></p>
<p><strong>1. Direction matters for one-sided tests</strong></p>
<ul>
<li>If testing H‚Çê: Œ≤‚ÇÇ &gt; Œ≤‚ÇÇ* but get b‚ÇÇ &lt; Œ≤‚ÇÇ*, you CANNOT reject H‚ÇÄ</li>
<li>The data contradicts your hypothesis, so rejection is impossible</li>
<li>In this case, one-sided p-value &gt; 0.5</li>
</ul>
<p><strong>2. Two-sided tests are safer</strong></p>
<ul>
<li>Academic journals typically require two-sided tests</li>
<li>Avoids ‚Äúfishing‚Äù for significant results</li>
<li>More conservative approach</li>
</ul>
<p><strong>3. One-sided tests have more power</strong></p>
<ul>
<li>For the same significance level Œ±, easier to reject in the predicted direction</li>
<li>Critical value is smaller: t(n-2, Œ±) vs t(n-2, Œ±/2)</li>
<li>Example: For Œ± = 0.05 and df = 27
<ul>
<li>Two-sided: t(27, 0.025) = 2.052</li>
<li>One-sided: t(27, 0.05) = 1.703</li>
</ul></li>
</ul>
<p><strong>Practical example from our house price data:</strong></p>
<p><strong>Question 1: Does size affect price? (Two-sided)</strong></p>
<ul>
<li>H‚ÇÄ: Œ≤‚ÇÇ = 0 vs H‚Çê: Œ≤‚ÇÇ ‚â† 0</li>
<li>t = 6.60, p-value = 0.000 (two-sided)</li>
<li>Conclusion: Reject H‚ÇÄ, size affects price</li>
</ul>
<p><strong>Question 2: Does size increase price? (One-sided)</strong></p>
<ul>
<li>H‚ÇÄ: Œ≤‚ÇÇ ‚â§ 0 vs H‚Çê: Œ≤‚ÇÇ &gt; 0</li>
<li>t = 6.60, p-value = 0.000 / 2 = 0.000 (one-sided)</li>
<li>Conclusion: Reject H‚ÇÄ, size increases price</li>
</ul>
<p><strong>Question 3: Does size increase price by less than $90/sq ft? (One-sided)</strong></p>
<ul>
<li>H‚ÇÄ: Œ≤‚ÇÇ ‚â• 90 vs H‚Çê: Œ≤‚ÇÇ &lt; 90</li>
<li>t = (73.77 - 90) / 11.17 = -1.452</li>
<li>p-value = 0.079 (one-sided, lower tail)</li>
<li>Conclusion: Fail to reject H‚ÇÄ at Œ± = 0.05 (but would reject at Œ± = 0.10)</li>
</ul>
<p><strong>Decision rule:</strong></p>
<p>Use two-sided tests unless:</p>
<ol type="1">
<li>You have strong theoretical reasons for a directional hypothesis</li>
<li>You specified the direction before seeing the data</li>
<li>You only care about deviations in one direction (rare in economics)</li>
</ol>
<div id="cell-30" class="cell" data-execution_count="26">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"7.4 TESTS OF STATISTICAL SIGNIFICANCE"</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Null hypothesis: Œ≤‚ÇÇ = 0 (size has no effect on price)"</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"t-statistic: </span><span class="sc">{</span>t_stat_size<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"p-value: </span><span class="sc">{</span>p_value_size<span class="sc">:.6f}</span><span class="ss">"</span>)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Critical value (Œ±=0.05): ¬±</span><span class="sc">{</span>t_crit<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> p_value_size <span class="op">&lt;</span> <span class="fl">0.05</span>:</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Result: Reject H‚ÇÄ at 5</span><span class="sc">% s</span><span class="st">ignificance level"</span>)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Conclusion: Size has a statistically significant effect on price"</span>)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Result: Fail to reject H‚ÇÄ at 5</span><span class="sc">% s</span><span class="st">ignificance level"</span>)</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Note: Statistical significance ‚â† Economic significance"</span>)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  - Statistical significance depends on t = b‚ÇÇ / se(b‚ÇÇ)"</span>)</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  - Economic significance depends directly on the size of b‚ÇÇ"</span>)</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  - With large samples, even small b‚ÇÇ can be statistically significant"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
7.4 TESTS OF STATISTICAL SIGNIFICANCE
======================================================================

Null hypothesis: Œ≤‚ÇÇ = 0 (size has no effect on price)
t-statistic: 6.6015
p-value: 0.000000
Critical value (Œ±=0.05): ¬±2.0518

Result: Reject H‚ÇÄ at 5% significance level
Conclusion: Size has a statistically significant effect on price

Note: Statistical significance ‚â† Economic significance
  - Statistical significance depends on t = b‚ÇÇ / se(b‚ÇÇ)
  - Economic significance depends directly on the size of b‚ÇÇ
  - With large samples, even small b‚ÇÇ can be statistically significant</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p><strong>Key Concept 7.6: Heteroskedasticity and Robust Standard Errors</strong></p>
<p><strong>Heteroskedasticity</strong> occurs when the error variance is not constant across observations: Var[u_i | x_i] = œÉ¬≤_i (varies with i).</p>
<p><strong>Homoskedasticity assumption</strong> (Assumption 3): Var[u_i | x_i] = œÉ¬≤_u (constant)</p>
<p><strong>Why heteroskedasticity matters:</strong> - Coefficient estimates (b‚ÇÇ): Still unbiased - Standard errors: WRONG (biased) - t-statistics, p-values, CIs: All invalid</p>
<p><strong>Solution: Heteroskedasticity-robust standard errors</strong> - Valid whether or not heteroskedasticity exists - No need to test for heteroskedasticity first - Modern best practice for cross-sectional data</p>
<p><strong>Practical impact:</strong> - Robust SEs usually larger ‚Üí more conservative inference - Protects against false positives (Type I errors) - Sometimes smaller ‚Üí gain power</p>
<p><strong>Types of robust SEs:</strong> - <strong>HC (Heteroskedasticity-Consistent):</strong> Cross-sectional data - <strong>HAC (Heteroskedasticity and Autocorrelation Consistent):</strong> Time series - <strong>Cluster-robust:</strong> Grouped/clustered data</p>
<p><strong>Bottom line:</strong> Always report heteroskedasticity-robust standard errors for cross-sectional data. They‚Äôre free insurance against model misspecification.</p>
</blockquote>
</section>
</section>
<section id="two-sided-hypothesis-tests" class="level2">
<h2 class="anchored" data-anchor-id="two-sided-hypothesis-tests">7.5 Two-Sided Hypothesis Tests</h2>
<p>Sometimes we want to test whether the slope equals a specific non-zero value.</p>
<p><strong>General two-sided test:</strong></p>
<p><span class="math display">\[H_0: \beta_2 = \beta_2^* \quad \text{vs.} \quad H_a: \beta_2 \neq \beta_2^*\]</span></p>
<p><strong>Test statistic:</strong></p>
<p><span class="math display">\[t = \frac{b_2 - \beta_2^*}{se(b_2)} \sim T(n-2)\]</span></p>
<p><strong>Decision rules:</strong></p>
<ul>
<li><strong>p-value approach</strong>: Reject if <span class="math inline">\(p = Pr[|T_{n-2}| &gt; |t|] &lt; \alpha\)</span></li>
<li><strong>Critical value approach</strong>: Reject if <span class="math inline">\(|t| &gt; t_{n-2, \alpha/2}\)</span></li>
</ul>
<p><strong>Example</strong>: Test whether house price increases by $90 per square foot.</p>
<p><span class="math display">\[t = \frac{73.77 - 90}{11.17} = -1.452\]</span></p>
<ul>
<li><span class="math inline">\(p = Pr[|T_{27}| &gt; 1.452] = 0.158\)</span></li>
<li>Since <span class="math inline">\(p = 0.158 &gt; 0.05\)</span>, do not reject <span class="math inline">\(H_0\)</span></li>
<li><strong>Conclusion</strong>: The data are consistent with <span class="math inline">\(\beta_2 = 90\)</span></li>
</ul>
<p><strong>Relationship to confidence intervals:</strong></p>
<ul>
<li>If <span class="math inline">\(\beta_2^*\)</span> falls inside the 95% CI, do not reject <span class="math inline">\(H_0\)</span> at 5% level</li>
<li>Since 90 is inside [50.84, 96.70], we do not reject</li>
</ul>
<div id="cell-33" class="cell" data-execution_count="27">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"7.5 TWO-SIDED HYPOTHESIS TESTS"</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Test H‚ÇÄ: Œ≤‚ÇÇ = 90 vs H‚ÇÅ: Œ≤‚ÇÇ ‚â† 90</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>null_value <span class="op">=</span> <span class="dv">90</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>t_stat_90 <span class="op">=</span> (coef_size <span class="op">-</span> null_value) <span class="op">/</span> se_size</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>p_value_90 <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> stats.t.cdf(<span class="bu">abs</span>(t_stat_90), df))</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>t_crit_90 <span class="op">=</span> stats.t.ppf(<span class="fl">0.975</span>, df)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Test: H‚ÇÄ: Œ≤‚ÇÇ = </span><span class="sc">{</span>null_value<span class="sc">}</span><span class="ss"> vs H‚ÇÅ: Œ≤‚ÇÇ ‚â† </span><span class="sc">{</span>null_value<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  t-statistic: </span><span class="sc">{</span>t_stat_90<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  p-value: </span><span class="sc">{</span>p_value_90<span class="sc">:.6f}</span><span class="ss">"</span>)</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Critical value (Œ±=0.05): ¬±</span><span class="sc">{</span>t_crit_90<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">abs</span>(t_stat_90) <span class="op">&gt;</span> t_crit_90:</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Result: Reject H‚ÇÄ (|t| = </span><span class="sc">{</span><span class="bu">abs</span>(t_stat_90)<span class="sc">:.4f}</span><span class="ss"> &gt; </span><span class="sc">{</span>t_crit_90<span class="sc">:.4f}</span><span class="ss">)"</span>)</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Result: Fail to reject H‚ÇÄ (|t| = </span><span class="sc">{</span><span class="bu">abs</span>(t_stat_90)<span class="sc">:.4f}</span><span class="ss"> &lt; </span><span class="sc">{</span>t_crit_90<span class="sc">:.4f}</span><span class="ss">)"</span>)</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Conclusion: The data are consistent with Œ≤‚ÇÇ = </span><span class="sc">{</span>null_value<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">95% CI for Œ≤‚ÇÇ: [</span><span class="sc">{</span>ci_lower<span class="sc">:.2f}</span><span class="ss">, </span><span class="sc">{</span>ci_upper<span class="sc">:.2f}</span><span class="ss">]"</span>)</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Since </span><span class="sc">{</span>null_value<span class="sc">}</span><span class="ss"> is inside the CI, we do not reject H‚ÇÄ."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
7.5 TWO-SIDED HYPOTHESIS TESTS
======================================================================

Test: H‚ÇÄ: Œ≤‚ÇÇ = 90 vs H‚ÇÅ: Œ≤‚ÇÇ ‚â† 90
  t-statistic: -1.4523
  p-value: 0.157950
  Critical value (Œ±=0.05): ¬±2.0518

Result: Fail to reject H‚ÇÄ (|t| = 1.4523 &lt; 2.0518)
Conclusion: The data are consistent with Œ≤‚ÇÇ = 90

95% CI for Œ≤‚ÇÇ: [50.84, 96.70]
Since 90 is inside the CI, we do not reject H‚ÇÄ.</code></pre>
</div>
</div>
<section id="hypothesis-test-using-statsmodels" class="level3">
<h3 class="anchored" data-anchor-id="hypothesis-test-using-statsmodels">Hypothesis Test Using statsmodels</h3>
<p>Python‚Äôs statsmodels package provides convenient methods for hypothesis testing.</p>
</section>
<section id="why-robust-standard-errors-matter" class="level3">
<h3 class="anchored" data-anchor-id="why-robust-standard-errors-matter">Why Robust Standard Errors Matter</h3>
<p><strong>The problem with default standard errors:</strong></p>
<p>Default (classical) standard errors rely on a strong assumption:</p>
<p><strong>Assumption 3 (Homoskedasticity):</strong> Var[u_i | x_i] = œÉ¬≤_u (constant variance)</p>
<p>This means:</p>
<ul>
<li>The spread of errors is the same for all values of x</li>
<li>Residuals should have constant variance across fitted values</li>
<li>In reality, this assumption is often violated</li>
</ul>
<p><strong>What is heteroskedasticity?</strong></p>
<p><strong>Heteroskedasticity</strong> means the error variance changes with x:</p>
<ul>
<li>Var[u_i | x_i] = œÉ¬≤_i (varies with i)</li>
<li>Common in cross-sectional data</li>
<li>Examples:</li>
<li>Income variation increases with education level</li>
<li>Sales variance increases with firm size</li>
<li>Medical costs vary more for older patients</li>
</ul>
<p><strong>Visual detection:</strong></p>
<p>Check the residual plot (residuals vs fitted values):</p>
<ul>
<li><strong>Homoskedasticity</strong>: Random scatter, constant spread</li>
<li><strong>Heteroskedasticity</strong>: Funnel shape, increasing/decreasing spread</li>
</ul>
<p><strong>Consequences of heteroskedasticity:</strong></p>
<p>If heteroskedasticity is present but you use default SEs:</p>
<ol type="1">
<li><strong>Coefficient estimates (b‚ÇÇ)</strong>: Still unbiased and consistent</li>
<li><strong>Standard errors</strong>: WRONG (biased)</li>
<li><strong>t-statistics</strong>: WRONG (biased)</li>
<li><strong>p-values</strong>: WRONG (invalid)</li>
<li><strong>Confidence intervals</strong>: WRONG (invalid coverage)</li>
</ol>
<p><strong>Direction of bias:</strong></p>
<ul>
<li>Heteroskedasticity can cause SEs to be too small or too large</li>
<li>Cannot predict direction without knowing the form of heteroskedasticity</li>
<li>Could lead to false significance or miss true significance</li>
</ul>
<p><strong>The solution: Robust standard errors</strong></p>
<p><strong>Heteroskedasticity-robust standard errors</strong> (HC, White, Huber-White):</p>
<ul>
<li>Valid whether or not heteroskedasticity is present</li>
<li>Automatically adjust for non-constant variance</li>
<li>No need to test for heteroskedasticity first</li>
<li>Modern best practice: Always use for cross-sectional data</li>
</ul>
<p><strong>How they work:</strong></p>
<p>Default SE formula (assumes homoskedasticity): <span class="math display">\[se(b_2) = \frac{\sigma_u}{\sqrt{\sum(x_i - \bar{x})^2}}\]</span></p>
<p>Robust SE formula (allows heteroskedasticity): <span class="math display">\[se_{robust}(b_2) = \frac{\sqrt{\sum e_i^2 (x_i - \bar{x})^2}}{\sum(x_i - \bar{x})^2}\]</span></p>
<p>Key difference: Uses individual residuals e¬≤_i instead of pooled variance œÉ¬≤_u</p>
<p><strong>Practical implications:</strong></p>
<ol type="1">
<li><strong>Coefficient estimates unchanged</strong></li>
</ol>
<ul>
<li>Only standard errors change</li>
<li>Point estimates remain the same</li>
</ul>
<ol start="2" type="1">
<li><strong>Standard errors typically larger</strong></li>
</ol>
<ul>
<li>Robust SEs are usually (but not always) bigger</li>
<li>More conservative inference</li>
<li>Wider confidence intervals</li>
</ul>
<ol start="3" type="1">
<li><strong>t-statistics typically smaller</strong></li>
</ol>
<ul>
<li>Less likely to find statistical significance</li>
<li>Protects against false positives</li>
</ul>
<ol start="4" type="1">
<li><strong>Results may change qualitative conclusions</strong></li>
</ol>
<ul>
<li>Variable significant with default SEs might become insignificant</li>
<li>Or the reverse (if robust SEs are smaller)</li>
</ul>
<p><strong>Types of robust standard errors:</strong></p>
<p>Different formulas for finite-sample adjustment:</p>
<ul>
<li><strong>HC0</strong>: Basic White formula</li>
<li><strong>HC1</strong>: Degrees of freedom correction (n/(n-k)), most common in Stata</li>
<li><strong>HC2</strong>: Leverage-weighted</li>
<li><strong>HC3</strong>: Even more conservative</li>
</ul>
<p><strong>Python default:</strong> HC1 (matches Stata‚Äôs ‚Äúrobust‚Äù option)</p>
<p><strong>For our house price example:</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Coefficient</th>
<th>Standard SE</th>
<th>Robust SE</th>
<th>% Change</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>size</td>
<td>11.17</td>
<td>11.33</td>
<td>+1.4%</td>
</tr>
<tr class="even">
<td>Intercept</td>
<td>21,489</td>
<td>21,825</td>
<td>+1.6%</td>
</tr>
</tbody>
</table>
<ul>
<li>Difference is small (good news!)</li>
<li>Suggests heteroskedasticity is not severe</li>
<li>But always report robust SEs as standard practice</li>
</ul>
<p><strong>Other types of robust SEs:</strong></p>
<ol type="1">
<li><strong>HAC (Heteroskedasticity and Autocorrelation Consistent)</strong></li>
</ol>
<ul>
<li>For time series data</li>
<li>Accounts for both heteroskedasticity and serial correlation</li>
</ul>
<ol start="2" type="1">
<li><strong>Cluster-robust</strong></li>
</ol>
<ul>
<li>For clustered/grouped data</li>
<li>Students within schools, patients within hospitals</li>
<li>Accounts for within-cluster correlation</li>
</ul>
<p><strong>Best practices:</strong></p>
<ol type="1">
<li><strong>Cross-sectional data</strong>: Always use heteroskedasticity-robust SEs</li>
<li><strong>Time series data</strong>: Use HAC robust SEs (Newey-West)</li>
<li><strong>Panel/clustered data</strong>: Use cluster-robust SEs</li>
<li><strong>When in doubt</strong>: Use robust SEs (can‚Äôt hurt, might help)</li>
</ol>
<p><strong>Bottom line:</strong> Robust standard errors provide valid inference under weaker assumptions. They‚Äôre essentially free insurance against heteroskedasticity.</p>
</section>
<section id="comparing-standard-vs-robust-standard-errors-a-practical-guide" class="level3">
<h3 class="anchored" data-anchor-id="comparing-standard-vs-robust-standard-errors-a-practical-guide">Comparing Standard vs Robust Standard Errors: A Practical Guide</h3>
<p><strong>How to interpret the comparison:</strong></p>
<p>When you compute both standard and robust SEs, you‚Äôre essentially running two different analyses:</p>
<p><strong>Standard SEs (Classical):</strong></p>
<ul>
<li>Assumes: Homoskedasticity (constant variance)</li>
<li>Valid only if: Assumption 3 holds</li>
<li>Interpretation: ‚ÄúIf errors have constant variance, here‚Äôs the uncertainty‚Äù</li>
</ul>
<p><strong>Robust SEs (Heteroskedasticity-Consistent):</strong></p>
<ul>
<li>Assumes: Heteroskedasticity allowed (no constant variance assumption)</li>
<li>Valid: Whether or not heteroskedasticity exists</li>
<li>Interpretation: ‚ÄúHere‚Äôs the uncertainty, accounting for possible non-constant variance‚Äù</li>
</ul>
<p><strong>What do differences tell us?</strong></p>
<p><strong>Case 1: Robust SE ‚âà Standard SE (difference &lt; 10%)</strong></p>
<ul>
<li>Example: Our house price data (11.33 vs 11.17)</li>
<li>Interpretation: Little evidence of heteroskedasticity</li>
<li>Implication: Assumption 3 approximately holds</li>
<li>Decision: Still report robust SEs (good practice)</li>
</ul>
<p><strong>Case 2: Robust SE &gt; Standard SE (difference &gt; 20%)</strong></p>
<ul>
<li>Example: Robust SE = 15.0, Standard SE = 10.0</li>
<li>Interpretation: Evidence of heteroskedasticity</li>
<li>Implication: Standard SEs underestimate uncertainty</li>
<li>Consequence: Default t-stats too large, p-values too small</li>
<li>Risk: False positives (finding significance that isn‚Äôt real)</li>
<li>Decision: MUST use robust SEs</li>
</ul>
<p><strong>Case 3: Robust SE &lt; Standard SE (less common)</strong></p>
<ul>
<li>Example: Robust SE = 8.0, Standard SE = 10.0</li>
<li>Interpretation: Specific pattern of heteroskedasticity</li>
<li>Implication: Standard SEs overestimate uncertainty</li>
<li>Consequence: Default t-stats too small, p-values too large</li>
<li>Risk: False negatives (missing real significance)</li>
<li>Decision: Use robust SEs (more powerful)</li>
</ul>
<p><strong>Visual comparison for our house price data:</strong></p>
<pre><code>Variable: size
 Standard SE: 11.17 |‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà|
 Robust SE: 11.33 |‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| (+1.4%)
 
Variable: Intercept
 Standard SE: 21,489 |‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà|
 Robust SE: 21,825 |‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| (+1.6%)</code></pre>
<p><strong>Impact on inference:</strong></p>
<p>Let‚Äôs see how the choice affects our conclusions:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 30%">
<col style="width: 26%">
<col style="width: 28%">
</colgroup>
<thead>
<tr class="header">
<th>Test</th>
<th>Standard SE</th>
<th>Robust SE</th>
<th>Conclusion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>t-statistic</td>
<td>73.77/11.17 = 6.60</td>
<td>73.77/11.33 = 6.51</td>
<td>Both highly significant</td>
</tr>
<tr class="even">
<td>p-value</td>
<td>0.0000</td>
<td>0.0000</td>
<td>Both p &lt; 0.001</td>
</tr>
<tr class="odd">
<td>95% CI</td>
<td>[50.84, 96.70]</td>
<td>[50.33, 97.21]</td>
<td>Nearly identical</td>
</tr>
<tr class="even">
<td>Reject H‚ÇÄ?</td>
<td>YES</td>
<td>YES</td>
<td>Same conclusion</td>
</tr>
</tbody>
</table>
<p><strong>When robust SEs matter most:</strong></p>
<ol type="1">
<li><strong>Large sample differences</strong></li>
</ol>
<ul>
<li>If robust SE = 2 √ó standard SE</li>
<li>Significance can disappear</li>
<li>Example: t = 2.5 (p=0.02) ‚Üí t = 1.25 (p=0.22)</li>
</ul>
<ol start="2" type="1">
<li><strong>Borderline significance</strong></li>
</ol>
<ul>
<li>If p-value near 0.05 with standard SEs</li>
<li>Might become non-significant with robust SEs</li>
<li>Example: p = 0.04 ‚Üí p = 0.07</li>
</ul>
<ol start="3" type="1">
<li><strong>High-stakes decisions</strong></li>
</ol>
<ul>
<li>Policy recommendations</li>
<li>Medical treatments</li>
<li>Financial investments</li>
<li>Need valid inference</li>
</ul>
<p><strong>Reading regression output in practice:</strong></p>
<p>Most statistical software now reports both:</p>
<pre><code> Standard Robust
Variable Coef. SE t SE t
size 73.77 11.17 6.60 11.33 6.51</code></pre>
<p><strong>What to report in your paper:</strong></p>
<p><strong>Minimum:</strong> Robust standard errors in main results <strong>Better:</strong> Show both, explain differences if substantial <strong>Best:</strong> Report robust SEs, note ‚ÄúResults similar with classical SEs‚Äù</p>
<p><strong>Example write-up:</strong></p>
<p>‚ÄúWe find that each additional square foot increases house price by $73.77 (robust SE = 11.33, t = 6.51, p &lt; 0.001). The heteroskedasticity-robust standard error is nearly identical to the classical standard error (11.17), suggesting homoskedasticity is approximately satisfied. The effect is highly statistically significant and economically meaningful, with a 95% confidence interval of [$50.33, $97.21].‚Äù</p>
<p><strong>Common mistakes to avoid:</strong></p>
<ol type="1">
<li><strong>Using standard SEs for cross-sectional data</strong></li>
</ol>
<ul>
<li>Modern practice: Always use robust SEs</li>
</ul>
<ol start="2" type="1">
<li><strong>Testing for heteroskedasticity first</strong></li>
</ol>
<ul>
<li>Just use robust SEs (they‚Äôre valid either way)</li>
<li>Pre-testing affects inference in complex ways</li>
</ul>
<ol start="3" type="1">
<li><strong>Switching between standard and robust to get significance</strong></li>
</ol>
<ul>
<li>This is p-hacking</li>
<li>Choose robust SEs before looking at results</li>
</ul>
<ol start="4" type="1">
<li><strong>Ignoring large differences</strong></li>
</ol>
<ul>
<li>If robust SE &gt;&gt; standard SE, investigate</li>
<li>Might indicate model misspecification</li>
<li>Consider transformations or different functional forms</li>
</ul>
<p><strong>The bottom line:</strong></p>
<p>Think of robust SEs as the ‚Äúsafe‚Äù choice:</p>
<ul>
<li>If no heteroskedasticity: Robust SEs ‚âà Standard SEs (no harm done)</li>
<li>If heteroskedasticity exists: Robust SEs correct the problem (saved you!)</li>
</ul>
<p>It‚Äôs like wearing a seatbelt: doesn‚Äôt hurt if you don‚Äôt crash, saves you if you do.</p>
<div id="cell-37" class="cell" data-execution_count="28">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Hypothesis test using statsmodels:"</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative approach using t_test</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>hypothesis <span class="op">=</span> <span class="ss">f'size = </span><span class="sc">{</span>null_value<span class="sc">}</span><span class="ss">'</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>t_test_result <span class="op">=</span> model_basic.t_test(hypothesis)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(t_test_result)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">This confirms our manual calculation."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
Hypothesis test using statsmodels:
======================================================================
                             Test for Constraints                             
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
c0            73.7710     11.175     -1.452      0.158      50.842      96.700
==============================================================================

This confirms our manual calculation.</code></pre>
</div>
</div>
</section>
</section>
<section id="one-sided-directional-hypothesis-tests" class="level2">
<h2 class="anchored" data-anchor-id="one-sided-directional-hypothesis-tests">7.6 One-Sided Directional Hypothesis Tests</h2>
<p>Sometimes we have a directional hypothesis (greater than or less than).</p>
<p><strong>One-sided tests:</strong></p>
<ol type="1">
<li><strong>Upper one-tailed</strong>: <span class="math inline">\(H_0: \beta_2 \leq \beta_2^*\)</span> vs <span class="math inline">\(H_a: \beta_2 &gt; \beta_2^*\)</span>
<ul>
<li>Reject in the right tail: <span class="math inline">\(p = Pr[T_{n-2} &gt; t]\)</span></li>
</ul></li>
<li><strong>Lower one-tailed</strong>: <span class="math inline">\(H_0: \beta_2 \geq \beta_2^*\)</span> vs <span class="math inline">\(H_a: \beta_2 &lt; \beta_2^*\)</span>
<ul>
<li>Reject in the left tail: <span class="math inline">\(p = Pr[T_{n-2} &lt; t]\)</span></li>
</ul></li>
</ol>
<p><strong>Example</strong>: Test whether house price rises by less than $90 per square foot.</p>
<ul>
<li>Claim: <span class="math inline">\(\beta_2 &lt; 90\)</span></li>
<li>Test: <span class="math inline">\(H_0: \beta_2 \geq 90\)</span> vs <span class="math inline">\(H_a: \beta_2 &lt; 90\)</span> (lower-tailed)</li>
<li><span class="math inline">\(t = (73.77 - 90) / 11.17 = -1.452\)</span></li>
<li><span class="math inline">\(p = Pr[T_{27} &lt; -1.452] = 0.079\)</span></li>
<li>Since <span class="math inline">\(p = 0.079 &gt; 0.05\)</span>, do not reject <span class="math inline">\(H_0\)</span> at 5% level</li>
<li><strong>Conclusion</strong>: Not enough evidence to support the claim at 5% level</li>
</ul>
<p><strong>Note on computer output:</strong></p>
<ul>
<li>Computer gives p-value for two-sided test of <span class="math inline">\(H_0: \beta_2 = 0\)</span></li>
<li>For one-sided test of significance:
<ul>
<li>If <span class="math inline">\(b_2\)</span> has expected sign, halve the printed p-value</li>
<li>If <span class="math inline">\(b_2\)</span> has wrong sign, reject is not possible (p &gt; 0.5)</li>
</ul></li>
</ul>
<div id="cell-39" class="cell" data-execution_count="29">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"7.6 ONE-SIDED DIRECTIONAL HYPOTHESIS TESTS"</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Upper one-tailed test: H‚ÇÄ: Œ≤‚ÇÇ ‚â§ 90 vs H‚ÇÅ: Œ≤‚ÇÇ &gt; 90</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>p_value_upper <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> stats.t.cdf(t_stat_90, df)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>t_crit_upper <span class="op">=</span> stats.t.ppf(<span class="fl">0.95</span>, df)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Upper one-tailed test: H‚ÇÄ: Œ≤‚ÇÇ ‚â§ </span><span class="sc">{</span>null_value<span class="sc">}</span><span class="ss"> vs H‚ÇÅ: Œ≤‚ÇÇ &gt; </span><span class="sc">{</span>null_value<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  t-statistic: </span><span class="sc">{</span>t_stat_90<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  p-value (one-tailed): </span><span class="sc">{</span>p_value_upper<span class="sc">:.6f}</span><span class="ss">"</span>)</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Critical value (Œ±=0.05): </span><span class="sc">{</span>t_crit_upper<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> t_stat_90 <span class="op">&gt;</span> t_crit_upper:</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"  Result: Reject H‚ÇÄ"</span>)</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"  Result: Fail to reject H‚ÇÄ"</span>)</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Lower one-tailed test: H‚ÇÄ: Œ≤‚ÇÇ ‚â• 90 vs H‚ÇÅ: Œ≤‚ÇÇ &lt; 90</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>p_value_lower <span class="op">=</span> stats.t.cdf(t_stat_90, df)</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Lower one-tailed test: H‚ÇÄ: Œ≤‚ÇÇ ‚â• </span><span class="sc">{</span>null_value<span class="sc">}</span><span class="ss"> vs H‚ÇÅ: Œ≤‚ÇÇ &lt; </span><span class="sc">{</span>null_value<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  t-statistic: </span><span class="sc">{</span>t_stat_90<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  p-value (one-tailed): </span><span class="sc">{</span>p_value_lower<span class="sc">:.6f}</span><span class="ss">"</span>)</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Critical value (Œ±=0.05): </span><span class="sc">{</span><span class="op">-</span>t_crit_upper<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> t_stat_90 <span class="op">&lt;</span> <span class="op">-</span>t_crit_upper:</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"  Result: Reject H‚ÇÄ"</span>)</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"  Conclusion: There is evidence that Œ≤‚ÇÇ &lt; 90"</span>)</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"  Result: Fail to reject H‚ÇÄ"</span>)</span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"  Conclusion: Not enough evidence to support Œ≤‚ÇÇ &lt; 90 at 5</span><span class="sc">% le</span><span class="st">vel"</span>)</span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  (Would reject at 10% level since p = </span><span class="sc">{</span>p_value_lower<span class="sc">:.3f}</span><span class="ss"> &lt; 0.10)"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
7.6 ONE-SIDED DIRECTIONAL HYPOTHESIS TESTS
======================================================================

Upper one-tailed test: H‚ÇÄ: Œ≤‚ÇÇ ‚â§ 90 vs H‚ÇÅ: Œ≤‚ÇÇ &gt; 90
  t-statistic: -1.4523
  p-value (one-tailed): 0.921025
  Critical value (Œ±=0.05): 1.7033
  Result: Fail to reject H‚ÇÄ

Lower one-tailed test: H‚ÇÄ: Œ≤‚ÇÇ ‚â• 90 vs H‚ÇÅ: Œ≤‚ÇÇ &lt; 90
  t-statistic: -1.4523
  p-value (one-tailed): 0.078975
  Critical value (Œ±=0.05): -1.7033
  Result: Fail to reject H‚ÇÄ
  Conclusion: Not enough evidence to support Œ≤‚ÇÇ &lt; 90 at 5% level
  (Would reject at 10% level since p = 0.079 &lt; 0.10)</code></pre>
</div>
</div>
</section>
<section id="robust-standard-errors" class="level2">
<h2 class="anchored" data-anchor-id="robust-standard-errors">7.7 Robust Standard Errors</h2>
<p>Default standard errors make assumptions 1-4. Robust standard errors relax some of these assumptions.</p>
<p><strong>Heteroskedasticity-Robust Standard Errors:</strong></p>
<ul>
<li><strong>Default assumption</strong> (homoskedasticity): <span class="math inline">\(Var[u_i | x_i] = \sigma_u^2\)</span> (constant)</li>
<li><strong>Relaxed assumption</strong> (heteroskedasticity): <span class="math inline">\(Var[u_i | x_i] = \sigma_i^2\)</span> (varies with <span class="math inline">\(i\)</span>)</li>
</ul>
<p><strong>Why use robust standard errors?</strong></p>
<ul>
<li>Heteroskedasticity is common in cross-sectional data</li>
<li>Default SEs are incorrect when heteroskedasticity is present</li>
<li>Robust SEs are valid whether or not heteroskedasticity exists</li>
<li><strong>Modern practice</strong>: Always report robust SEs for cross-sectional data</li>
</ul>
<p><strong>Heteroskedastic-robust SE formula:</strong></p>
<p><span class="math display">\[se_{het}(b_2) = \frac{\sqrt{\sum_{i=1}^n e_i^2 (x_i - \bar{x})^2}}{\sum_{i=1}^n (x_i - \bar{x})^2}\]</span></p>
<p><strong>Effect on inference:</strong></p>
<ul>
<li>Coefficient estimates unchanged</li>
<li>Standard errors typically increase (more conservative)</li>
<li>t-statistics typically decrease</li>
<li>Confidence intervals typically wider</li>
</ul>
<p><strong>Other robust SEs:</strong></p>
<ul>
<li><strong>HAC robust</strong>: For time series with autocorrelation</li>
<li><strong>Cluster robust</strong>: For clustered data (students in schools, people in villages, etc.)</li>
</ul>
<div id="cell-41" class="cell" data-execution_count="30">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"7.7 ROBUST STANDARD ERRORS"</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Get heteroskedasticity-robust standard errors (HC1)</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>robust_results <span class="op">=</span> model_basic.get_robustcov_results(cov_type<span class="op">=</span><span class="st">'HC1'</span>)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Comparison of standard and robust standard errors:"</span>)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>comparison_df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Coefficient'</span>: model_basic.params,</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Std. Error'</span>: model_basic.bse,</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Robust SE'</span>: robust_results.bse,</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'t-stat (standard)'</span>: model_basic.tvalues,</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'t-stat (robust)'</span>: robust_results.tvalues,</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'p-value (standard)'</span>: model_basic.pvalues,</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'p-value (robust)'</span>: robust_results.pvalues</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(comparison_df)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
7.7 ROBUST STANDARD ERRORS
======================================================================

Comparison of standard and robust standard errors:
             Coefficient    Std. Error     Robust SE  t-stat (standard)  \
Intercept  115017.282609  21489.359861  20298.704493           5.352290   
size           73.771040     11.174911     11.329669           6.601488   

           t-stat (robust)  p-value (standard)  p-value (robust)  
Intercept         5.666238        1.183545e-05      5.120101e-06  
size              6.511315        4.408752e-07      5.564663e-07  </code></pre>
</div>
</div>
<section id="full-regression-output-with-robust-standard-errors" class="level3">
<h3 class="anchored" data-anchor-id="full-regression-output-with-robust-standard-errors">Full Regression Output with Robust Standard Errors</h3>
<div id="cell-43" class="cell" data-execution_count="31">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Regression with Robust Standard Errors:"</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(robust_results.summary())</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Robust confidence intervals</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>robust_conf_int <span class="op">=</span> robust_results.conf_int(alpha<span class="op">=</span><span class="fl">0.05</span>)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">95% Confidence Intervals (Robust):"</span>)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(robust_conf_int)</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Interpretation:"</span>)</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  - For this dataset, robust and standard SEs are similar"</span>)</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  - Robust SE for size: 11.33 vs standard SE: 11.17"</span>)</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  - Robust 95% CI: [50.33, 97.02] vs standard: [50.84, 96.70]"</span>)</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  - Statistical significance unchanged (both highly significant)"</span>)</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">General principle: Always report robust SEs for cross-sectional data"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
Regression with Robust Standard Errors:
======================================================================
                            OLS Regression Results                            
==============================================================================
Dep. Variable:                  price   R-squared:                       0.617
Model:                            OLS   Adj. R-squared:                  0.603
Method:                 Least Squares   F-statistic:                     42.40
Date:                Tue, 20 Jan 2026   Prob (F-statistic):           5.56e-07
Time:                        23:33:22   Log-Likelihood:                -332.05
No. Observations:                  29   AIC:                             668.1
Df Residuals:                      27   BIC:                             670.8
Df Model:                           1                                         
Covariance Type:                  HC1                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept    1.15e+05   2.03e+04      5.666      0.000    7.34e+04    1.57e+05
size          73.7710     11.330      6.511      0.000      50.524      97.018
==============================================================================
Omnibus:                        0.576   Durbin-Watson:                   1.219
Prob(Omnibus):                  0.750   Jarque-Bera (JB):                0.638
Skew:                          -0.078   Prob(JB):                        0.727
Kurtosis:                       2.290   Cond. No.                     9.45e+03
==============================================================================

Notes:
[1] Standard Errors are heteroscedasticity robust (HC1)
[2] The condition number is large, 9.45e+03. This might indicate that there are
strong multicollinearity or other numerical problems.

95% Confidence Intervals (Robust):
[[7.33677813e+04 1.56666784e+05]
 [5.05244796e+01 9.70176011e+01]]

Interpretation:
  - For this dataset, robust and standard SEs are similar
  - Robust SE for size: 11.33 vs standard SE: 11.17
  - Robust 95% CI: [50.33, 97.02] vs standard: [50.84, 96.70]
  - Statistical significance unchanged (both highly significant)

General principle: Always report robust SEs for cross-sectional data</code></pre>
</div>
</div>
</section>
<section id="visualization-scatter-plot-with-regression-line" class="level3">
<h3 class="anchored" data-anchor-id="visualization-scatter-plot-with-regression-line">Visualization: Scatter Plot with Regression Line</h3>
<p>Visual representation of the bivariate regression relationship.</p>
<div id="cell-45" class="cell" data-execution_count="32">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figure 7.1: Scatter plot with regression line</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>ax.scatter(data_house[<span class="st">'size'</span>], data_house[<span class="st">'price'</span>], alpha<span class="op">=</span><span class="fl">0.6</span>, s<span class="op">=</span><span class="dv">50</span>,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>           color<span class="op">=</span><span class="st">'black'</span>, label<span class="op">=</span><span class="st">'Actual observations'</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>ax.plot(data_house[<span class="st">'size'</span>], model_basic.fittedvalues, color<span class="op">=</span><span class="st">'blue'</span>,</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>        linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">'Fitted regression line'</span>)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Size (square feet)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Price ($1000s)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Figure 7.1: House Price vs Size with Regression Line'</span>,</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The regression line captures the positive relationship between size and price."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="ch07_Statistical_Inference_for_Bivariate_Regression_files/figure-html/cell-16-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>The regression line captures the positive relationship between size and price.</code></pre>
</div>
</div>
</section>
<section id="visualization-confidence-intervals" class="level3">
<h3 class="anchored" data-anchor-id="visualization-confidence-intervals">Visualization: Confidence Intervals</h3>
<p>Graphical display of coefficient estimates with confidence intervals.</p>
<div id="cell-47" class="cell" data-execution_count="33">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figure 7.2: Confidence interval visualization</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot point estimate and confidence interval</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>coef_names <span class="op">=</span> [<span class="st">'Intercept'</span>, <span class="st">'Size'</span>]</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>coefs <span class="op">=</span> model_basic.params.values</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>ci_low <span class="op">=</span> conf_int.iloc[:, <span class="dv">0</span>].values</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>ci_high <span class="op">=</span> conf_int.iloc[:, <span class="dv">1</span>].values</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>y_pos <span class="op">=</span> np.arange(<span class="bu">len</span>(coef_names))</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>ax.errorbar(coefs, y_pos, xerr<span class="op">=</span>[coefs <span class="op">-</span> ci_low, ci_high <span class="op">-</span> coefs],</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>            fmt<span class="op">=</span><span class="st">'o'</span>, markersize<span class="op">=</span><span class="dv">8</span>, capsize<span class="op">=</span><span class="dv">5</span>, capthick<span class="op">=</span><span class="dv">2</span>, linewidth<span class="op">=</span><span class="dv">2</span>, color<span class="op">=</span><span class="st">'blue'</span>)</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>ax.set_yticks(y_pos)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>ax.set_yticklabels(coef_names)</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>ax.axvline(x<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">1</span>, alpha<span class="op">=</span><span class="fl">0.5</span>,</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>           label<span class="op">=</span><span class="st">'H‚ÇÄ: Œ≤ = 0'</span>)</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Coefficient Value'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Figure 7.2: Coefficient Estimates with 95% Confidence Intervals'</span>,</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>, axis<span class="op">=</span><span class="st">'x'</span>)</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Both coefficients are statistically significant (CIs exclude zero)."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/tq/t98kb27n6djgrh085g476yhc0000gn/T/ipykernel_82940/1126987400.py:22: UserWarning: Glyph 8320 (\N{SUBSCRIPT ZERO}) missing from current font.
  plt.tight_layout()
/Users/carlosmendez/miniforge3/lib/python3.10/site-packages/IPython/core/pylabtools.py:170: UserWarning: Glyph 8320 (\N{SUBSCRIPT ZERO}) missing from current font.
  fig.canvas.print_figure(bytes_io, **kw)</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="ch07_Statistical_Inference_for_Bivariate_Regression_files/figure-html/cell-17-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Both coefficients are statistically significant (CIs exclude zero).</code></pre>
</div>
</div>
</section>
<section id="visualization-residual-plot" class="level3">
<h3 class="anchored" data-anchor-id="visualization-residual-plot">Visualization: Residual Plot</h3>
<p>Check for patterns in residuals that might violate model assumptions.</p>
<div id="cell-49" class="cell" data-execution_count="34">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figure 7.3: Residual plot</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>ax.scatter(model_basic.fittedvalues, model_basic.resid, alpha<span class="op">=</span><span class="fl">0.6</span>, s<span class="op">=</span><span class="dv">50</span>, color<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>ax.axhline(y<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">'Zero residual line'</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Fitted values'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Residuals'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Figure 7.3: Residual Plot'</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Check for:"</span>)</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  - Heteroskedasticity: Non-constant variance (funnel shape)"</span>)</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  - Outliers: Points far from zero line"</span>)</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  - Non-linearity: Systematic patterns in residuals"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="ch07_Statistical_Inference_for_Bivariate_Regression_files/figure-html/cell-18-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Check for:
  - Heteroskedasticity: Non-constant variance (funnel shape)
  - Outliers: Points far from zero line
  - Non-linearity: Systematic patterns in residuals</code></pre>
</div>
</div>
</section>
</section>
<section id="key-takeaways" class="level2">
<h2 class="anchored" data-anchor-id="key-takeaways">Key Takeaways</h2>
<p><strong>Key Takeaways:</strong></p>
<ol type="1">
<li><strong>The t-statistic</strong> is fundamental to statistical inference in regression:
<ul>
<li>Formula: <span class="math inline">\(t = \frac{b_2 - \beta_2}{se(b_2)} \sim T(n-2)\)</span></li>
<li>Parallels univariate inference: <span class="math inline">\(t = \frac{\bar{x} - \mu}{se(\bar{x})} \sim T(n-1)\)</span></li>
</ul></li>
<li><strong>Confidence intervals</strong> provide a range of plausible values:
<ul>
<li>Formula: <span class="math inline">\(b_2 \pm t_{n-2, \alpha/2} \times se(b_2)\)</span></li>
<li>95% CI (approximate): <span class="math inline">\(b_2 \pm 2 \times se(b_2)\)</span></li>
<li>Interpretation: 95% of such intervals will contain the true <span class="math inline">\(\beta_2\)</span></li>
</ul></li>
<li><strong>Tests of statistical significance</strong> assess whether a regressor matters:
<ul>
<li><span class="math inline">\(H_0: \beta_2 = 0\)</span> vs <span class="math inline">\(H_a: \beta_2 \neq 0\)</span></li>
<li>Reject if <span class="math inline">\(p\)</span>-value <span class="math inline">\(&lt; \alpha\)</span> or <span class="math inline">\(|t| &gt; t_{n-2, \alpha/2}\)</span></li>
<li>Statistical significance <span class="math inline">\(\neq\)</span> economic significance</li>
</ul></li>
<li><strong>Two-sided tests</strong> for specific values:
<ul>
<li><span class="math inline">\(H_0: \beta_2 = \beta_2^*\)</span> vs <span class="math inline">\(H_a: \beta_2 \neq \beta_2^*\)</span></li>
<li>Equivalent to checking if <span class="math inline">\(\beta_2^*\)</span> is in the confidence interval</li>
</ul></li>
<li><strong>One-sided tests</strong> for directional hypotheses:
<ul>
<li>Upper tail: <span class="math inline">\(H_0: \beta_2 \leq \beta_2^*\)</span> vs <span class="math inline">\(H_a: \beta_2 &gt; \beta_2^*\)</span></li>
<li>Lower tail: <span class="math inline">\(H_0: \beta_2 \geq \beta_2^*\)</span> vs <span class="math inline">\(H_a: \beta_2 &lt; \beta_2^*\)</span></li>
<li>p-value is half the two-sided p-value (if sign is correct)</li>
</ul></li>
<li><strong>Robust standard errors</strong> provide valid inference under weaker assumptions:
<ul>
<li>Heteroskedasticity-robust (HC1): Relaxes constant variance assumption</li>
<li>Modern practice: Always use for cross-sectional data</li>
<li>Other types: HAC (time series), cluster (grouped data)</li>
</ul></li>
</ol>
<p><strong>Model Assumptions (1-4):</strong></p>
<ol type="1">
<li>Linearity: <span class="math inline">\(y = \beta_1 + \beta_2 x + u\)</span></li>
<li>Zero conditional mean: <span class="math inline">\(E[u_i | x_i] = 0\)</span></li>
<li>Constant variance: <span class="math inline">\(Var[u_i | x_i] = \sigma_u^2\)</span> (relaxed with robust SEs)</li>
<li>Independence: <span class="math inline">\(u_i\)</span> independent of <span class="math inline">\(u_j\)</span></li>
</ol>
<p><strong>House Price Example Results:</strong></p>
<ul>
<li>Coefficient: Each additional sq ft increases price by $73.77</li>
<li>95% CI: [$50.84, $96.70]</li>
<li>Highly statistically significant (t = 6.60, p &lt; 0.001)</li>
<li>Economically meaningful effect</li>
</ul>
<p><strong>Python Tools Used:</strong></p>
<ul>
<li><code>pandas</code>: Data manipulation and summary statistics</li>
<li><code>statsmodels</code>: Econometric estimation and hypothesis testing</li>
<li><code>scipy.stats</code>: Statistical distributions and critical values</li>
<li><code>matplotlib</code> &amp; <code>seaborn</code>: Visualization</li>
</ul>
<p><strong>Practical Skills Developed:</strong></p>
<ul>
<li>Conducting t-tests on regression coefficients</li>
<li>Constructing and interpreting confidence intervals</li>
<li>Testing economic hypotheses (two-sided and one-sided)</li>
<li>Using robust standard errors for valid inference</li>
<li>Visualizing regression results</li>
<li>Distinguishing statistical from economic significance</li>
</ul>
<p><strong>Next Steps:</strong></p>
<ul>
<li>Extend to multiple regression (Chapter 11)</li>
<li>Learn about model specification and variable selection</li>
<li>Study violations of assumptions and diagnostics</li>
<li>Practice with different datasets and research questions</li>
</ul>
<hr>
<p><strong>Congratulations!</strong> You‚Äôve completed Chapter 7. You now have both theoretical understanding and practical skills in conducting statistical inference for bivariate regression models!</p>
</section>
<section id="practice-exercises" class="level2">
<h2 class="anchored" data-anchor-id="practice-exercises">Practice Exercises</h2>
<p><strong>Exercise 1: Understanding Standard Errors</strong></p>
<p>Suppose you estimate a regression of wages on education using data from 100 workers. The estimated slope is b‚ÇÇ = 5.2 (each additional year of education increases wages by $5.20/hour) with standard error se(b‚ÇÇ) = 1.8.</p>
<ol type="a">
<li>Calculate the 95% confidence interval for Œ≤‚ÇÇ (use t-critical value ‚âà 2.0).<br>
</li>
<li>Interpret the confidence interval in plain language.<br>
</li>
<li>If the sample size were 400 instead of 100, how would the standard error change (approximately)? Explain why.</li>
</ol>
<p><strong>Exercise 2: Hypothesis Testing Mechanics</strong></p>
<p>Using the wage-education regression from Exercise 1 (b‚ÇÇ = 5.2, se(b‚ÇÇ) = 1.8):</p>
<ol type="a">
<li>Test H‚ÇÄ: Œ≤‚ÇÇ = 0 vs.&nbsp;H‚Çê: Œ≤‚ÇÇ ‚â† 0 at the 5% level. Calculate the t-statistic and state your conclusion.<br>
</li>
<li>Calculate the approximate p-value for this test.<br>
</li>
<li>Would you reject H‚ÇÄ at the 1% level? Explain.</li>
</ol>
<p><strong>Exercise 3: Two-Sided Tests</strong></p>
<p>A researcher claims that each year of education increases wages by exactly $6.00/hour. Using the regression from Exercise 1:</p>
<ol type="a">
<li>State the null and alternative hypotheses to test this claim.<br>
</li>
<li>Calculate the test statistic.<br>
</li>
<li>At the 5% level, do you reject the researcher‚Äôs claim? Explain your reasoning.<br>
</li>
<li>Is the claim consistent with the 95% confidence interval from Exercise 1?</li>
</ol>
<p><strong>Exercise 4: One-Sided Tests</strong></p>
<p>A policy analyst claims that education increases wages by less than $3.00/hour. Using the regression from Exercise 1:</p>
<ol type="a">
<li>State the appropriate one-sided hypotheses (Hint: The claim becomes H‚Çê).<br>
</li>
<li>Calculate the test statistic.<br>
</li>
<li>Find the one-sided p-value (using t ‚âà normal approximation).<br>
</li>
<li>At the 5% level, do you reject H‚ÇÄ? What do you conclude about the analyst‚Äôs claim?</li>
</ol>
<p><strong>Exercise 5: Statistical vs.&nbsp;Economic Significance</strong></p>
<p>Consider two regressions:</p>
<p><strong>Regression A:</strong> n = 50, b‚ÇÇ = 0.05, se(b‚ÇÇ) = 0.10<br>
<strong>Regression B:</strong> n = 10,000, b‚ÇÇ = 0.05, se(b‚ÇÇ) = 0.01</p>
<ol type="a">
<li>For each regression, test H‚ÇÄ: Œ≤‚ÇÇ = 0 at the 5% level. What do you conclude?<br>
</li>
<li>Despite having the same coefficient (0.05), why do the conclusions differ?<br>
</li>
<li>In which regression is the effect more economically significant? Explain.</li>
</ol>
<p><strong>Exercise 6: Confidence Interval Properties</strong></p>
<p>True or False? Explain your reasoning for each:</p>
<ol type="a">
<li>A 95% confidence interval means there‚Äôs a 95% probability that Œ≤‚ÇÇ is in the interval.<br>
</li>
<li>If we reject H‚ÇÄ: Œ≤‚ÇÇ = Œ≤‚ÇÇ* at the 5% level, then Œ≤‚ÇÇ* will be outside the 95% CI.<br>
</li>
<li>Wider confidence intervals are always worse than narrow ones.<br>
</li>
<li>With n = 30, a 95% CI uses a t-critical value of approximately 2.0.</li>
</ol>
<p><strong>Exercise 7: Robust Standard Errors</strong></p>
<p>A researcher estimates a house price regression using n = 100 houses:</p>
<ul>
<li>Standard SE: 15.0</li>
<li>Robust SE: 22.5</li>
</ul>
<ol type="a">
<li>What does the large difference suggest about the data?<br>
</li>
<li>Which standard error should be reported? Why?<br>
</li>
<li>How does the difference affect the t-statistic and hypothesis tests?<br>
</li>
<li>Is heteroskedasticity a problem for the coefficient estimates themselves? Explain.</li>
</ol>
<p><strong>Exercise 8: Comprehensive Analysis</strong></p>
<p>You‚Äôre analyzing the effect of advertising spending (x, in thousands of dollars) on sales revenue (y, in millions of dollars) using data from 80 firms. Your regression output shows:</p>
<ul>
<li>Intercept: 2.5, SE = 0.8</li>
<li>Slope (advertising): 3.2, SE = 0.9<br>
</li>
<li>R¬≤ = 0.45</li>
<li>n = 80</li>
</ul>
<ol type="a">
<li>Construct a 95% confidence interval for the slope coefficient.<br>
</li>
<li>Test whether advertising has a statistically significant effect on sales at the 5% level.<br>
</li>
<li>A colleague claims that $1,000 in advertising spending increases sales by more than $5 million. Test this claim using a one-sided test at the 5% level.<br>
</li>
<li>Is the effect of advertising economically significant? Consider that the average firm in the sample spends $10,000 on advertising and has $5 million in sales revenue.</li>
</ol>
<hr>
<p><strong>Hint for all exercises:</strong> When degrees of freedom are large (n &gt; 30), you can use t-critical values of approximately 1.645 (10% level), 1.96 (5% level), and 2.576 (1% level).</p>
</section>
<section id="case-studies" class="level2">
<h2 class="anchored" data-anchor-id="case-studies">Case Studies</h2>
<section id="case-study-1-testing-convergence-hypotheses" class="level3">
<h3 class="anchored" data-anchor-id="case-study-1-testing-convergence-hypotheses">Case Study 1: Testing Convergence Hypotheses</h3>
<p>In this case study, you‚Äôll apply statistical inference concepts to test economic hypotheses about productivity convergence across countries. You‚Äôll construct confidence intervals, test hypotheses about regression coefficients, and interpret the results in economic terms.</p>
<p><strong>Research Question:</strong> Does the relationship between labor productivity and capital per worker support convergence theory predictions?</p>
<p><strong>Background:</strong><br>
Economic growth theory suggests that countries with lower initial capital should experience faster productivity growth as they ‚Äúcatch up‚Äù to richer countries. We can test this using the relationship between productivity levels and capital intensity across countries.</p>
<p><strong>Dataset:</strong><br>
We‚Äôll use the <strong>Convergence Clubs</strong> dataset (Mendez 2020) containing data for 108 countries in 2014:</p>
<ul>
<li><strong>productivity</strong>: Real GDP per capita (thousands of dollars)</li>
<li><strong>capital</strong>: Physical capital per worker (thousands of dollars)</li>
</ul>
<p><strong>Econometric Model:</strong></p>
<p><span class="math display">\[\text{productivity}_i = \beta_1 + \beta_2 \times \text{capital}_i + u_i\]</span></p>
<p><strong>Key Hypotheses to Test:</strong></p>
<ol type="1">
<li>Does capital significantly affect productivity? (H‚ÇÄ: Œ≤‚ÇÇ = 0)</li>
<li>Is the effect economically meaningful?</li>
<li>Does the relationship differ across country income groups?</li>
</ol>
<hr>
<p><strong>Learning Objectives:</strong></p>
<ul>
<li>Construct and interpret confidence intervals for regression coefficients</li>
<li>Conduct two-sided and one-sided hypothesis tests</li>
<li>Compare statistical and economic significance</li>
<li>Use robust standard errors appropriately</li>
<li>Apply hypothesis testing to economic questions</li>
</ul>
<blockquote class="blockquote">
<p><strong>Key Concept 7.7: Economic Convergence and Statistical Testing</strong></p>
<p><strong>Convergence theory</strong> predicts that poorer countries should grow faster than richer countries, leading to a narrowing of income gaps over time. Two main types:</p>
<p><strong>Absolute convergence:</strong> - All countries converge to the same income level - Predicts negative relationship between initial income and growth rate - Test: H‚ÇÄ: Œ≤ (growth on initial income) ‚â• 0 vs.&nbsp;H‚Çê: Œ≤ &lt; 0</p>
<p><strong>Conditional convergence:</strong><br>
- Countries converge to their own steady states - After controlling for determinants (savings, education, institutions) - More empirically supported than absolute convergence</p>
<p><strong>Testing convergence hypotheses:</strong> - Requires careful hypothesis formulation - One-sided tests appropriate (theory predicts direction) - Economic significance matters (how fast is convergence?) - Must account for heteroskedasticity (countries differ in volatility)</p>
<p><strong>Our approach:</strong> We examine the cross-sectional relationship between productivity and capital intensity to understand the fundamentals underlying convergence patterns.</p>
</blockquote>
<div id="cell-54" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"CASE STUDY: TESTING CONVERGENCE HYPOTHESES"</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Read convergence clubs data</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>data_convergence <span class="op">=</span> pd.read_stata(GITHUB_DATA_URL <span class="op">+</span> <span class="st">'AED_ConvergenceClubs.dta'</span>)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter to 2014 cross-section</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>data_2014 <span class="op">=</span> data_convergence[data_convergence[<span class="st">'year'</span>] <span class="op">==</span> <span class="dv">2014</span>].copy()</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create productivity and capital variables (divide by 1000 for better scale)</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>data_2014[<span class="st">'productivity'</span>] <span class="op">=</span> data_2014[<span class="st">'rgdppc'</span>] <span class="op">/</span> <span class="dv">1000</span>  <span class="co"># GDP per capita in thousands</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>data_2014[<span class="st">'capital'</span>] <span class="op">=</span> data_2014[<span class="st">'rk'</span>] <span class="op">/</span> <span class="dv">1000</span>  <span class="co"># Capital per worker in thousands</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Sample: </span><span class="sc">{</span><span class="bu">len</span>(data_2014)<span class="sc">}</span><span class="ss"> countries in 2014"</span>)</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Variable summary:"</span>)</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data_2014[[<span class="st">'productivity'</span>, <span class="st">'capital'</span>]].describe())</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Show a few countries</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Sample countries:"</span>)</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>sample_countries <span class="op">=</span> data_2014[[<span class="st">'country'</span>, <span class="st">'productivity'</span>, <span class="st">'capital'</span>]].sort_values(<span class="st">'productivity'</span>, ascending<span class="op">=</span><span class="va">False</span>).head(<span class="dv">10</span>)</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sample_countries.to_string(index<span class="op">=</span><span class="va">False</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="task-1-estimate-the-productivity-capital-relationship-guided" class="level3">
<h3 class="anchored" data-anchor-id="task-1-estimate-the-productivity-capital-relationship-guided">Task 1: Estimate the Productivity-Capital Relationship (Guided)</h3>
<p><strong>Objective:</strong> Estimate the bivariate regression and interpret the results.</p>
<p><strong>Your task:</strong><br>
Run the code below to estimate the regression and examine the output. Then answer:</p>
<ol type="a">
<li>What is the estimated effect of capital on productivity? Interpret the coefficient.<br>
</li>
<li>Construct a 95% confidence interval for Œ≤‚ÇÇ. What does this interval tell you?<br>
</li>
<li>Is the effect statistically significant at the 5% level?<br>
</li>
<li>Is the effect economically significant? (Consider that the average country has capital = 50 and productivity = 25)</li>
</ol>
<div id="cell-56" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Task 1: Basic regression</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>model_convergence <span class="op">=</span> ols(<span class="st">'productivity ~ capital'</span>, data<span class="op">=</span>data_2014).fit()</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Task 1: Regression of Productivity on Capital"</span>)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model_convergence.summary())</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract key statistics</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>beta2 <span class="op">=</span> model_convergence.params[<span class="st">'capital'</span>]</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>se_beta2 <span class="op">=</span> model_convergence.bse[<span class="st">'capital'</span>]</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>t_stat <span class="op">=</span> model_convergence.tvalues[<span class="st">'capital'</span>]</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>p_value <span class="op">=</span> model_convergence.pvalues[<span class="st">'capital'</span>]</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Key Statistics:"</span>)</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Coefficient (Œ≤‚ÇÇ): </span><span class="sc">{</span>beta2<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Standard Error: </span><span class="sc">{</span>se_beta2<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  t-statistic: </span><span class="sc">{</span>t_stat<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  p-value: </span><span class="sc">{</span>p_value<span class="sc">:.6f}</span><span class="ss">"</span>)</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a><span class="co"># 95% Confidence Interval</span></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>ci_95 <span class="op">=</span> model_convergence.conf_int(alpha<span class="op">=</span><span class="fl">0.05</span>).loc[<span class="st">'capital'</span>]</span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">95% Confidence Interval: [</span><span class="sc">{</span>ci_95[<span class="dv">0</span>]<span class="sc">:.4f}</span><span class="ss">, </span><span class="sc">{</span>ci_95[<span class="dv">1</span>]<span class="sc">:.4f}</span><span class="ss">]"</span>)</span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Interpretation:"</span>)</span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Each additional $1,000 in capital per worker is associated with"</span>)</span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  an increase of $</span><span class="sc">{</span>beta2<span class="sc">:.2f}</span><span class="ss">k in labor productivity (GDP per capita)."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="task-2-test-specific-hypotheses-semi-guided" class="level3">
<h3 class="anchored" data-anchor-id="task-2-test-specific-hypotheses-semi-guided">Task 2: Test Specific Hypotheses (Semi-guided)</h3>
<p><strong>Objective:</strong> Conduct formal hypothesis tests about the productivity-capital relationship.</p>
<p><strong>Your tasks:</strong></p>
<ol type="a">
<li><p><strong>Test for statistical significance:</strong></p>
<ul>
<li>H‚ÇÄ: Œ≤‚ÇÇ = 0 (capital has no effect) vs.&nbsp;H‚Çê: Œ≤‚ÇÇ ‚â† 0<br>
</li>
<li>Use the t-statistic and p-value from Task 1<br>
</li>
<li>State your conclusion at the 5% level</li>
</ul></li>
<li><p><strong>Test economic theory prediction:</strong></p>
<ul>
<li>Economic theory suggests that the marginal product of capital in developing countries might be around 0.5 (50 cents of GDP per dollar of capital)<br>
</li>
<li>H‚ÇÄ: Œ≤‚ÇÇ = 0.5 vs.&nbsp;H‚Çê: Œ≤‚ÇÇ ‚â† 0.5<br>
</li>
<li>Calculate the test statistic: t = (Œ≤‚ÇÇ - 0.5) / se(Œ≤‚ÇÇ)<br>
</li>
<li>Find the p-value and state your conclusion</li>
</ul></li>
<li><p><strong>Test pessimistic hypothesis:</strong></p>
<ul>
<li>A pessimist claims that capital contributes less than $0.30 to productivity<br>
</li>
<li>Formulate appropriate one-sided hypotheses<br>
</li>
<li>Calculate the test statistic and one-sided p-value<br>
</li>
<li>Do you reject the pessimist‚Äôs claim at the 5% level?</li>
</ul></li>
</ol>
<p><strong>Code hints:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For part (b)</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>t_test_05 <span class="op">=</span> (beta2 <span class="op">-</span> <span class="fl">0.5</span>) <span class="op">/</span> se_beta2</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>p_value_05 <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> stats.t.cdf(<span class="bu">abs</span>(t_test_05), df<span class="op">=</span>model_convergence.df_resid))</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="co"># For part (c) - one-sided test</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>null_value <span class="op">=</span> <span class="fl">0.30</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>t_test_pessimist <span class="op">=</span> (beta2 <span class="op">-</span> null_value) <span class="op">/</span> se_beta2</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="co"># p-value depends on direction: use stats.t.cdf() or (1 - stats.t.cdf())</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div id="cell-58" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Task 2: Your hypothesis tests here</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Part (a): Statistical significance test</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Task 2(a): Test H‚ÇÄ: Œ≤‚ÇÇ = 0"</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"t-statistic: </span><span class="sc">{</span>t_stat<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"p-value: </span><span class="sc">{</span>p_value<span class="sc">:.6f}</span><span class="ss">"</span>)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> p_value <span class="op">&lt;</span> <span class="fl">0.05</span>:</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Conclusion: Reject H‚ÇÄ at 5</span><span class="sc">% le</span><span class="st">vel. Capital significantly affects productivity."</span>)</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Conclusion: Fail to reject H‚ÇÄ at 5</span><span class="sc">% le</span><span class="st">vel."</span>)</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Part (b): Test Œ≤‚ÇÇ = 0.5</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Task 2(b): Test H‚ÇÄ: Œ≤‚ÇÇ = 0.5"</span>)</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>null_value_b <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>t_test_05 <span class="op">=</span> (beta2 <span class="op">-</span> null_value_b) <span class="op">/</span> se_beta2</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>p_value_05 <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> stats.t.cdf(<span class="bu">abs</span>(t_test_05), df<span class="op">=</span>model_convergence.df_resid))</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"t-statistic: </span><span class="sc">{</span>t_test_05<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"p-value: </span><span class="sc">{</span>p_value_05<span class="sc">:.6f}</span><span class="ss">"</span>)</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> p_value_05 <span class="op">&lt;</span> <span class="fl">0.05</span>:</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Conclusion: Reject H‚ÇÄ. The coefficient differs significantly from </span><span class="sc">{</span>null_value_b<span class="sc">}</span><span class="ss">."</span>)</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Conclusion: Fail to reject H‚ÇÄ. The data are consistent with Œ≤‚ÇÇ = </span><span class="sc">{</span>null_value_b<span class="sc">}</span><span class="ss">."</span>)</span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Part (c): One-sided test (pessimistic claim: Œ≤‚ÇÇ &lt; 0.30)</span></span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Task 2(c): Test Pessimist's Claim (Œ≤‚ÇÇ &lt; 0.30)"</span>)</span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>null_value_c <span class="op">=</span> <span class="fl">0.30</span></span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"H‚ÇÄ: Œ≤‚ÇÇ ‚â• 0.30 vs. H‚Çê: Œ≤‚ÇÇ &lt; 0.30 (pessimist's claim)"</span>)</span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>t_test_pessimist <span class="op">=</span> (beta2 <span class="op">-</span> null_value_c) <span class="op">/</span> se_beta2</span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a><span class="co"># For lower-tailed test: if t &gt; 0, we're rejecting in favor of Œ≤‚ÇÇ &gt; 0.30 (opposite direction)</span></span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>p_value_pessimist_lower <span class="op">=</span> stats.t.cdf(t_test_pessimist, df<span class="op">=</span>model_convergence.df_resid)</span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"t-statistic: </span><span class="sc">{</span>t_test_pessimist<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"One-sided p-value (lower tail): </span><span class="sc">{</span>p_value_pessimist_lower<span class="sc">:.6f}</span><span class="ss">"</span>)</span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> t_test_pessimist <span class="op">&lt;</span> <span class="dv">0</span>:</span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Test statistic is negative - consistent with pessimist's claim"</span>)</span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> p_value_pessimist_lower <span class="op">&lt;</span> <span class="fl">0.05</span>:</span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"Conclusion: Reject H‚ÇÄ. Evidence supports Œ≤‚ÇÇ &lt; 0.30."</span>)</span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"Conclusion: Fail to reject H‚ÇÄ at 5</span><span class="sc">% le</span><span class="st">vel."</span>)</span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb42-43"><a href="#cb42-43" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Test statistic is positive - contradicts pessimist's claim"</span>)</span>
<span id="cb42-44"><a href="#cb42-44" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Conclusion: Cannot reject H‚ÇÄ in favor of H‚Çê (data contradicts the claim)."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<blockquote class="blockquote">
<p><strong>Key Concept 7.8: p-Values and Statistical Significance in Practice</strong></p>
<p>The <strong>p-value</strong> measures the strength of evidence against the null hypothesis. But interpreting p-values requires care:</p>
<p><strong>What p-values tell you:</strong> - p = 0.001: Very strong evidence against H‚ÇÄ (occurs 0.1% of the time if H‚ÇÄ true) - p = 0.04: Evidence against H‚ÇÄ (occurs 4% of the time if H‚ÇÄ true) - p = 0.15: Weak/no evidence against H‚ÇÄ</p>
<p><strong>Common p-value thresholds:</strong></p>
<ul>
<li>‚òÖ‚òÖ‚òÖ <strong>p &lt; 0.01</strong>: Highly significant</li>
<li>‚òÖ‚òÖ <strong>0.01 ‚â§ p &lt; 0.05</strong>: Significant</li>
<li>‚òÖ <strong>0.05 ‚â§ p &lt; 0.10</strong>: Marginally significant</li>
<li><strong>p ‚â• 0.10</strong>: Not significant</li>
</ul>
<p><strong>Critical insights:</strong> 1. <strong>Arbitrary thresholds:</strong> The 0.05 cutoff is convention, not law 2. <strong>p-values ‚â† importance:</strong> p &lt; 0.001 doesn‚Äôt mean ‚Äúmore true‚Äù than p = 0.04 3. <strong>Near the threshold:</strong> p = 0.051 and p = 0.049 provide similar evidence 4. <strong>Large samples:</strong> With n = 10,000, even tiny effects become ‚Äúsignificant‚Äù 5. <strong>Publication bias:</strong> Studies with p &lt; 0.05 more likely to be published</p>
<p><strong>Best practice:</strong> Report exact p-values and confidence intervals rather than just ‚Äúsignificant‚Äù or ‚Äúnot significant.‚Äù Let readers judge the evidence.</p>
</blockquote>
</section>
<section id="task-3-heteroskedasticity-robust-inference-semi-guided" class="level3">
<h3 class="anchored" data-anchor-id="task-3-heteroskedasticity-robust-inference-semi-guided">Task 3: Heteroskedasticity-Robust Inference (Semi-guided)</h3>
<p><strong>Objective:</strong> Compare standard and robust standard errors for cross-country data.</p>
<p><strong>Background:</strong><br>
Cross-country data often exhibits heteroskedasticity because larger/richer countries tend to have more variable outcomes. We should use robust standard errors for valid inference.</p>
<p><strong>Your tasks:</strong></p>
<ol type="a">
<li><p>Obtain heteroskedasticity-robust standard errors (HC1) using:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>robust_model <span class="op">=</span> model_convergence.get_robustcov_results(cov_type<span class="op">=</span><span class="st">'HC1'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
<li><p>Compare standard vs.&nbsp;robust standard errors:</p>
<ul>
<li>How much do they differ? (Calculate percentage change)</li>
<li>What does this suggest about heteroskedasticity in the data?</li>
</ul></li>
<li><p>Re-test H‚ÇÄ: Œ≤‚ÇÇ = 0 using robust standard errors:</p>
<ul>
<li>Calculate the robust t-statistic</li>
<li>Has your conclusion changed?</li>
</ul></li>
<li><p>Construct a 95% CI using robust standard errors:</p>
<ul>
<li>Compare to the standard CI from Task 1</li>
<li>Which should you report in a research paper?</li>
</ul></li>
</ol>
<div id="cell-61" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Task 3: Robust standard errors</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>robust_model <span class="op">=</span> model_convergence.get_robustcov_results(cov_type<span class="op">=</span><span class="st">'HC1'</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Task 3: Robust Standard Errors Analysis"</span>)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract robust statistics</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>beta2_robust <span class="op">=</span> robust_model.params[<span class="st">'capital'</span>]</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>se_beta2_robust <span class="op">=</span> robust_model.bse[<span class="st">'capital'</span>]</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>t_stat_robust <span class="op">=</span> robust_model.tvalues[<span class="st">'capital'</span>]</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>p_value_robust <span class="op">=</span> robust_model.pvalues[<span class="st">'capital'</span>]</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparison table</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Comparison of Standard vs. Robust Standard Errors:"</span>)</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>comparison_df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Statistic'</span>: [<span class="st">'Coefficient'</span>, <span class="st">'Standard SE'</span>, <span class="st">'Robust SE'</span>, <span class="st">'t-statistic (standard)'</span>, </span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'t-statistic (robust)'</span>, <span class="st">'p-value (standard)'</span>, <span class="st">'p-value (robust)'</span>],</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Value'</span>: [beta2, se_beta2, se_beta2_robust, t_stat, t_stat_robust, p_value, p_value_robust]</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(comparison_df.to_string(index<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Percent change in SE</span></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>pct_change <span class="op">=</span> ((se_beta2_robust <span class="op">-</span> se_beta2) <span class="op">/</span> se_beta2) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Robust SE is </span><span class="sc">{</span>pct_change<span class="sc">:+.1f}</span><span class="ss">% different from standard SE"</span>)</span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">abs</span>(pct_change) <span class="op">&gt;</span> <span class="dv">10</span>:</span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"‚Üí Substantial difference suggests heteroskedasticity is present"</span>)</span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"‚Üí MUST use robust SEs for valid inference"</span>)</span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"‚Üí Small difference suggests heteroskedasticity is mild"</span>)</span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"‚Üí Still best practice to use robust SEs"</span>)</span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Robust confidence interval</span></span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a>ci_95_robust <span class="op">=</span> robust_model.conf_int(alpha<span class="op">=</span><span class="fl">0.05</span>).loc[<span class="st">'capital'</span>]</span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">95% Confidence Intervals:"</span>)</span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Standard CI: [</span><span class="sc">{</span>ci_95[<span class="dv">0</span>]<span class="sc">:.4f}</span><span class="ss">, </span><span class="sc">{</span>ci_95[<span class="dv">1</span>]<span class="sc">:.4f}</span><span class="ss">]"</span>)</span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Robust CI:   [</span><span class="sc">{</span>ci_95_robust[<span class="dv">0</span>]<span class="sc">:.4f}</span><span class="ss">, </span><span class="sc">{</span>ci_95_robust[<span class="dv">1</span>]<span class="sc">:.4f}</span><span class="ss">]"</span>)</span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Recommendation: Report robust standard errors in your analysis."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="task-4-heterogeneity-across-income-groups-more-independent" class="level3">
<h3 class="anchored" data-anchor-id="task-4-heterogeneity-across-income-groups-more-independent">Task 4: Heterogeneity Across Income Groups (More Independent)</h3>
<p><strong>Objective:</strong> Investigate whether the productivity-capital relationship differs between high-income and developing countries.</p>
<p><strong>Your tasks (design your own analysis):</strong></p>
<ol type="a">
<li><p><strong>Split the sample:</strong></p>
<ul>
<li>Create two subsamples: high-income countries (productivity &gt; 30) and developing countries (productivity ‚â§ 30)</li>
<li>How many countries in each group?</li>
</ul></li>
<li><p><strong>Estimate separate regressions:</strong></p>
<ul>
<li>Run the same regression for each subsample</li>
<li>Use robust standard errors for both</li>
<li>Create a comparison table showing Œ≤‚ÇÇ, robust SE, t-statistic, and p-value for each group</li>
</ul></li>
<li><p><strong>Compare the results:</strong></p>
<ul>
<li>Is the effect of capital on productivity stronger in one group?</li>
<li>Test H‚ÇÄ: Œ≤‚ÇÇ = 0.5 for each group separately</li>
<li>Are the effects statistically significant in both groups?</li>
<li>What might explain any differences you find?</li>
</ul></li>
</ol>
<p><strong>Hints:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Split data</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>high_income <span class="op">=</span> data_2014[data_2014[<span class="st">'productivity'</span>] <span class="op">&gt;</span> <span class="dv">30</span>]</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>developing <span class="op">=</span> data_2014[data_2014[<span class="st">'productivity'</span>] <span class="op">&lt;=</span> <span class="dv">30</span>]</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Run regressions</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>model_high <span class="op">=</span> ols(<span class="st">'productivity ~ capital'</span>, data<span class="op">=</span>high_income).fit()</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>model_dev <span class="op">=</span> ols(<span class="st">'productivity ~ capital'</span>, data<span class="op">=</span>developing).fit()</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Get robust SEs</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>robust_high <span class="op">=</span> model_high.get_robustcov_results(cov_type<span class="op">=</span><span class="st">'HC1'</span>)</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>robust_dev <span class="op">=</span> model_dev.get_robustcov_results(cov_type<span class="op">=</span><span class="st">'HC1'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div id="cell-63" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Task 4: Your analysis here</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the sample</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>threshold <span class="op">=</span> <span class="dv">30</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>high_income <span class="op">=</span> data_2014[data_2014[<span class="st">'productivity'</span>] <span class="op">&gt;</span> threshold].copy()</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>developing <span class="op">=</span> data_2014[data_2014[<span class="st">'productivity'</span>] <span class="op">&lt;=</span> threshold].copy()</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Task 4: Income Group Analysis (threshold = $</span><span class="sc">{</span>threshold<span class="sc">}</span><span class="ss">k)"</span>)</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"High-income countries: </span><span class="sc">{</span><span class="bu">len</span>(high_income)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Developing countries: </span><span class="sc">{</span><span class="bu">len</span>(developing)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate separate regressions</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>model_high <span class="op">=</span> ols(<span class="st">'productivity ~ capital'</span>, data<span class="op">=</span>high_income).fit()</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>model_dev <span class="op">=</span> ols(<span class="st">'productivity ~ capital'</span>, data<span class="op">=</span>developing).fit()</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Get robust results</span></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>robust_high <span class="op">=</span> model_high.get_robustcov_results(cov_type<span class="op">=</span><span class="st">'HC1'</span>)</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>robust_dev <span class="op">=</span> model_dev.get_robustcov_results(cov_type<span class="op">=</span><span class="st">'HC1'</span>)</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Create comparison table</span></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>comparison_groups <span class="op">=</span> pd.DataFrame({</span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Group'</span>: [<span class="st">'High-Income'</span>, <span class="st">'Developing'</span>, <span class="st">'Full Sample'</span>],</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">'n'</span>: [<span class="bu">len</span>(high_income), <span class="bu">len</span>(developing), <span class="bu">len</span>(data_2014)],</span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Œ≤‚ÇÇ'</span>: [robust_high.params[<span class="st">'capital'</span>], robust_dev.params[<span class="st">'capital'</span>], beta2_robust],</span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Robust SE'</span>: [robust_high.bse[<span class="st">'capital'</span>], robust_dev.bse[<span class="st">'capital'</span>], se_beta2_robust],</span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">'t-stat'</span>: [robust_high.tvalues[<span class="st">'capital'</span>], robust_dev.tvalues[<span class="st">'capital'</span>], t_stat_robust],</span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">'p-value'</span>: [robust_high.pvalues[<span class="st">'capital'</span>], robust_dev.pvalues[<span class="st">'capital'</span>], p_value_robust]</span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Regression Results by Income Group:"</span>)</span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(comparison_groups.to_string(index<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Test Œ≤‚ÇÇ = 0.5 for each group</span></span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Test H‚ÇÄ: Œ≤‚ÇÇ = 0.5 for each group:"</span>)</span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, robust_res <span class="kw">in</span> [(<span class="st">'High-Income'</span>, robust_high), (<span class="st">'Developing'</span>, robust_dev)]:</span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a>    beta <span class="op">=</span> robust_res.params[<span class="st">'capital'</span>]</span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a>    se <span class="op">=</span> robust_res.bse[<span class="st">'capital'</span>]</span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true" tabindex="-1"></a>    t_05 <span class="op">=</span> (beta <span class="op">-</span> <span class="fl">0.5</span>) <span class="op">/</span> se</span>
<span id="cb46-41"><a href="#cb46-41" aria-hidden="true" tabindex="-1"></a>    p_05 <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> stats.t.cdf(<span class="bu">abs</span>(t_05), df<span class="op">=</span>robust_res.df_resid))</span>
<span id="cb46-42"><a href="#cb46-42" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="sc">{</span>name<span class="sc">}</span><span class="ss">:"</span>)</span>
<span id="cb46-43"><a href="#cb46-43" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  t-statistic: </span><span class="sc">{</span>t_05<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb46-44"><a href="#cb46-44" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  p-value: </span><span class="sc">{</span>p_05<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb46-45"><a href="#cb46-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> p_05 <span class="op">&lt;</span> <span class="fl">0.05</span>:</span>
<span id="cb46-46"><a href="#cb46-46" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"  Conclusion: Reject H‚ÇÄ. Œ≤‚ÇÇ differs significantly from 0.5"</span>)</span>
<span id="cb46-47"><a href="#cb46-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb46-48"><a href="#cb46-48" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"  Conclusion: Fail to reject H‚ÇÄ. Data consistent with Œ≤‚ÇÇ = 0.5"</span>)</span>
<span id="cb46-49"><a href="#cb46-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-50"><a href="#cb46-50" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Interpretation:"</span>)</span>
<span id="cb46-51"><a href="#cb46-51" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> comparison_groups.loc[<span class="dv">0</span>, <span class="st">'Œ≤‚ÇÇ'</span>] <span class="op">&gt;</span> comparison_groups.loc[<span class="dv">1</span>, <span class="st">'Œ≤‚ÇÇ'</span>]:</span>
<span id="cb46-52"><a href="#cb46-52" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"  The effect of capital is stronger in high-income countries."</span>)</span>
<span id="cb46-53"><a href="#cb46-53" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb46-54"><a href="#cb46-54" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"  The effect of capital is stronger in developing countries."</span>)</span>
<span id="cb46-55"><a href="#cb46-55" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  This heterogeneity suggests that one-size-fits-all models may miss"</span>)</span>
<span id="cb46-56"><a href="#cb46-56" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  important differences in the productivity-capital relationship across countries."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<blockquote class="blockquote">
<p><strong>Key Concept 7.9: Economic Interpretation of Hypothesis Test Results</strong></p>
<p>Statistical hypothesis tests answer specific questions, but their economic interpretation requires care and context.</p>
<p><strong>Translating statistical results to economic conclusions:</strong></p>
<p><strong>1. Rejecting H‚ÇÄ: Œ≤‚ÇÇ = 0 (statistical significance)</strong> - Statistical: ‚ÄúCapital has a statistically significant effect on productivity‚Äù - Economic: ‚ÄúCountries with more capital per worker tend to have higher productivity, and this pattern is unlikely due to chance alone‚Äù - Limitations: Says nothing about causation, magnitude, or policy relevance</p>
<p><strong>2. Rejecting H‚ÇÄ: Œ≤‚ÇÇ = 0.5 (testing theory predictions)</strong><br>
- Statistical: ‚ÄúThe coefficient differs significantly from 0.5‚Äù - Economic: ‚ÄúThe marginal product of capital differs from theory‚Äôs prediction, suggesting other factors (technology, institutions) matter‚Äù - Implications: May indicate model misspecification or heterogeneity across countries</p>
<p><strong>3. Failing to reject H‚ÇÄ (no statistical significance)</strong> - Statistical: ‚ÄúCannot rule out Œ≤‚ÇÇ = 0 (or other null value)‚Äù - Economic: Multiple interpretations possible: - Effect truly absent - Effect present but sample too small to detect it (low power) - High variability obscures the relationship - <strong>Never conclude:</strong> ‚ÄúProved Œ≤‚ÇÇ = 0‚Äù or ‚ÄúNo relationship exists‚Äù</p>
<p><strong>4. Heterogeneity across groups</strong> - If Œ≤‚ÇÇ(high-income) &gt; Œ≤‚ÇÇ(developing): Capital complementary with other factors more abundant in rich countries (technology, institutions, human capital) - If Œ≤‚ÇÇ(developing) &gt; Œ≤‚ÇÇ(high-income): Diminishing returns to capital more pronounced in capital-abundant countries</p>
<p><strong>Best practices for economic interpretation:</strong> 1. Report point estimates, not just significance 2. Use confidence intervals to show uncertainty 3. Assess economic magnitude (not just statistical significance) 4. Consider alternative explanations and limitations 5. Link findings to economic theory and policy implications</p>
</blockquote>
</section>
<section id="task-5-visual-analysis-independent" class="level3">
<h3 class="anchored" data-anchor-id="task-5-visual-analysis-independent">Task 5: Visual Analysis (Independent)</h3>
<p><strong>Objective:</strong> Create visualizations to communicate your statistical inference results effectively.</p>
<p><strong>Your tasks (completely open-ended):</strong></p>
<ol type="a">
<li><p>Create a scatter plot showing the productivity-capital relationship:</p>
<ul>
<li>Include the regression line</li>
<li>Color-code points by income group (high-income vs.&nbsp;developing)</li>
<li>Add 95% confidence bands around the regression line (advanced)</li>
</ul></li>
<li><p>Create a coefficient plot comparing:</p>
<ul>
<li>Full sample estimate</li>
<li>High-income group estimate</li>
<li>Developing group estimate</li>
<li>Show 95% confidence intervals as error bars</li>
</ul></li>
<li><p>Create a residual plot:</p>
<ul>
<li>Check for heteroskedasticity visually</li>
<li>Does the spread of residuals increase with fitted values?</li>
</ul></li>
</ol>
<p><strong>Challenge:</strong> Can you create a single figure that tells the complete story of your analysis?</p>
<div id="cell-66" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Task 5: Your visualizations here</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Figure 1: Scatter plot with regression lines by group</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">6</span>))</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Left panel: Full sample</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> axes[<span class="dv">0</span>]</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>ax1.scatter(data_2014[<span class="st">'capital'</span>], data_2014[<span class="st">'productivity'</span>], </span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>           alpha<span class="op">=</span><span class="fl">0.5</span>, s<span class="op">=</span><span class="dv">40</span>, color<span class="op">=</span><span class="st">'blue'</span>, label<span class="op">=</span><span class="st">'All countries'</span>)</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>ax1.plot(data_2014[<span class="st">'capital'</span>], model_convergence.fittedvalues, </span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">'red'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">'Regression line'</span>)</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'Capital per Worker ($1000s)'</span>)</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'Labor Productivity ($1000s)'</span>)</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Full Sample Regression'</span>)</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>ax1.legend()</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>ax1.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Right panel: By income group</span></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> axes[<span class="dv">1</span>]</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>ax2.scatter(high_income[<span class="st">'capital'</span>], high_income[<span class="st">'productivity'</span>],</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>           alpha<span class="op">=</span><span class="fl">0.5</span>, s<span class="op">=</span><span class="dv">40</span>, color<span class="op">=</span><span class="st">'green'</span>, label<span class="op">=</span><span class="st">'High-income'</span>)</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>ax2.scatter(developing[<span class="st">'capital'</span>], developing[<span class="st">'productivity'</span>],</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>           alpha<span class="op">=</span><span class="fl">0.5</span>, s<span class="op">=</span><span class="dv">40</span>, color<span class="op">=</span><span class="st">'orange'</span>, label<span class="op">=</span><span class="st">'Developing'</span>)</span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Add regression lines</span></span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>high_income_sorted <span class="op">=</span> high_income.sort_values(<span class="st">'capital'</span>)</span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>developing_sorted <span class="op">=</span> developing.sort_values(<span class="st">'capital'</span>)</span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>ax2.plot(high_income_sorted[<span class="st">'capital'</span>], model_high.predict(high_income_sorted),</span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">'darkgreen'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="st">'High-income fit'</span>)</span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>ax2.plot(developing_sorted[<span class="st">'capital'</span>], model_dev.predict(developing_sorted),</span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">'darkorange'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="st">'Developing fit'</span>)</span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'Capital per Worker ($1000s)'</span>)</span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'Labor Productivity ($1000s)'</span>)</span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'By Income Group'</span>)</span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a>ax2.legend()</span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a>ax2.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-40"><a href="#cb47-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Figure 2: Coefficient plot with confidence intervals</span></span>
<span id="cb47-41"><a href="#cb47-41" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb47-42"><a href="#cb47-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-43"><a href="#cb47-43" aria-hidden="true" tabindex="-1"></a>groups <span class="op">=</span> [<span class="st">'Full Sample'</span>, <span class="st">'High-Income'</span>, <span class="st">'Developing'</span>]</span>
<span id="cb47-44"><a href="#cb47-44" aria-hidden="true" tabindex="-1"></a>estimates <span class="op">=</span> [beta2_robust, robust_high.params[<span class="st">'capital'</span>], robust_dev.params[<span class="st">'capital'</span>]]</span>
<span id="cb47-45"><a href="#cb47-45" aria-hidden="true" tabindex="-1"></a>ses <span class="op">=</span> [se_beta2_robust, robust_high.bse[<span class="st">'capital'</span>], robust_dev.bse[<span class="st">'capital'</span>]]</span>
<span id="cb47-46"><a href="#cb47-46" aria-hidden="true" tabindex="-1"></a>cis_lower <span class="op">=</span> [e <span class="op">-</span> <span class="fl">1.96</span><span class="op">*</span>se <span class="cf">for</span> e, se <span class="kw">in</span> <span class="bu">zip</span>(estimates, ses)]</span>
<span id="cb47-47"><a href="#cb47-47" aria-hidden="true" tabindex="-1"></a>cis_upper <span class="op">=</span> [e <span class="op">+</span> <span class="fl">1.96</span><span class="op">*</span>se <span class="cf">for</span> e, se <span class="kw">in</span> <span class="bu">zip</span>(estimates, ses)]</span>
<span id="cb47-48"><a href="#cb47-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-49"><a href="#cb47-49" aria-hidden="true" tabindex="-1"></a>y_pos <span class="op">=</span> <span class="bu">range</span>(<span class="bu">len</span>(groups))</span>
<span id="cb47-50"><a href="#cb47-50" aria-hidden="true" tabindex="-1"></a>ax.errorbar(estimates, y_pos, </span>
<span id="cb47-51"><a href="#cb47-51" aria-hidden="true" tabindex="-1"></a>           xerr<span class="op">=</span>[[e <span class="op">-</span> l <span class="cf">for</span> e, l <span class="kw">in</span> <span class="bu">zip</span>(estimates, cis_lower)],</span>
<span id="cb47-52"><a href="#cb47-52" aria-hidden="true" tabindex="-1"></a>                 [u <span class="op">-</span> e <span class="cf">for</span> e, u <span class="kw">in</span> <span class="bu">zip</span>(estimates, cis_upper)]],</span>
<span id="cb47-53"><a href="#cb47-53" aria-hidden="true" tabindex="-1"></a>           fmt<span class="op">=</span><span class="st">'o'</span>, markersize<span class="op">=</span><span class="dv">10</span>, capsize<span class="op">=</span><span class="dv">8</span>, capthick<span class="op">=</span><span class="dv">2</span>, linewidth<span class="op">=</span><span class="dv">2</span>, color<span class="op">=</span><span class="st">'blue'</span>)</span>
<span id="cb47-54"><a href="#cb47-54" aria-hidden="true" tabindex="-1"></a>ax.set_yticks(y_pos)</span>
<span id="cb47-55"><a href="#cb47-55" aria-hidden="true" tabindex="-1"></a>ax.set_yticklabels(groups)</span>
<span id="cb47-56"><a href="#cb47-56" aria-hidden="true" tabindex="-1"></a>ax.axvline(x<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">1</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, label<span class="op">=</span><span class="st">'H‚ÇÄ: Œ≤‚ÇÇ = 0'</span>)</span>
<span id="cb47-57"><a href="#cb47-57" aria-hidden="true" tabindex="-1"></a>ax.axvline(x<span class="op">=</span><span class="fl">0.5</span>, color<span class="op">=</span><span class="st">'green'</span>, linestyle<span class="op">=</span><span class="st">':'</span>, linewidth<span class="op">=</span><span class="dv">1</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, label<span class="op">=</span><span class="st">'Theory: Œ≤‚ÇÇ = 0.5'</span>)</span>
<span id="cb47-58"><a href="#cb47-58" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Estimated Coefficient (Œ≤‚ÇÇ) with 95% CI'</span>)</span>
<span id="cb47-59"><a href="#cb47-59" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Capital-Productivity Relationship: Point Estimates and Confidence Intervals'</span>)</span>
<span id="cb47-60"><a href="#cb47-60" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb47-61"><a href="#cb47-61" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>, axis<span class="op">=</span><span class="st">'x'</span>)</span>
<span id="cb47-62"><a href="#cb47-62" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb47-63"><a href="#cb47-63" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb47-64"><a href="#cb47-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-65"><a href="#cb47-65" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Figure interpretation:"</span>)</span>
<span id="cb47-66"><a href="#cb47-66" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  - All three estimates are positive and statistically significant"</span>)</span>
<span id="cb47-67"><a href="#cb47-67" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  - Confidence intervals exclude zero but include 0.5 (theory prediction)"</span>)</span>
<span id="cb47-68"><a href="#cb47-68" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  - High-income countries show slightly stronger relationship"</span>)</span>
<span id="cb47-69"><a href="#cb47-69" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  - But confidence intervals overlap, suggesting difference may not be significant"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="task-6-write-a-research-summary-independent" class="level3">
<h3 class="anchored" data-anchor-id="task-6-write-a-research-summary-independent">Task 6: Write a Research Summary (Independent)</h3>
<p><strong>Objective:</strong> Communicate your statistical findings in a clear, professional manner.</p>
<p><strong>Your task:</strong><br>
Write a 200-300 word summary of your analysis as if for an economics journal. Your summary should include:</p>
<ol type="1">
<li><strong>Research question</strong> - What were you investigating?</li>
<li><strong>Data and methods</strong> - What data did you use? What regressions did you run?</li>
<li><strong>Key findings</strong> - What did you discover? Report specific numbers (coefficients, CIs, p-values)</li>
<li><strong>Statistical inference</strong> - Were effects statistically significant? Did you use robust SEs?</li>
<li><strong>Economic interpretation</strong> - What do the results mean economically?</li>
<li><strong>Limitations and extensions</strong> - What are the caveats? What should future research explore?</li>
</ol>
<p><strong>Grading criteria:</strong></p>
<ul>
<li>Clear and concise writing</li>
<li>Appropriate use of statistical terminology</li>
<li>Correct interpretation of results</li>
<li>Discussion of both statistical and economic significance</li>
<li>Professional tone suitable for academic publication</li>
</ul>
<p><strong>Example opening:</strong><br>
‚ÄúUsing cross-sectional data for 108 countries in 2014, I investigate the relationship between labor productivity (GDP per capita) and physical capital per worker. The estimated coefficient of 0.XX (robust SE = 0.YY, p &lt; 0.001) indicates that‚Ä¶‚Äù</p>
<p><em>Write your summary in the markdown cell below.</em></p>
</section>
<section id="your-research-summary" class="level3">
<h3 class="anchored" data-anchor-id="your-research-summary">Your Research Summary</h3>
<p><em>(Write your 200-300 word summary here)</em></p>
<p>[Your text goes here]</p>
<hr>
</section>
<section id="what-youve-learned" class="level3">
<h3 class="anchored" data-anchor-id="what-youve-learned">What You‚Äôve Learned</h3>
<p><strong>Congratulations!</strong> You‚Äôve completed a comprehensive statistical inference analysis. You practiced:</p>
<p><strong>Statistical Skills:</strong></p>
<ul>
<li>Estimating bivariate regression models</li>
<li>Constructing and interpreting 95% confidence intervals</li>
<li>Conducting two-sided hypothesis tests (H‚ÇÄ: Œ≤ = Œ≤*)</li>
<li>Conducting one-sided hypothesis tests (directional claims)</li>
<li>Using heteroskedasticity-robust standard errors</li>
<li>Comparing results across subsamples (heterogeneity analysis)</li>
<li>Creating publication-quality visualizations</li>
<li>Writing professional research summaries</li>
</ul>
<p><strong>Economic Insights:</strong></p>
<ul>
<li>Understanding the productivity-capital relationship across countries</li>
<li>Testing economic theory predictions with data</li>
<li>Interpreting coefficients in economic terms (marginal products)</li>
<li>Recognizing heterogeneity across country income groups</li>
<li>Distinguishing statistical from economic significance</li>
</ul>
<p><strong>Practical Skills:</strong></p>
<ul>
<li>Using Python for comprehensive econometric analysis</li>
<li>Generating robust standard errors with <code>statsmodels</code></li>
<li>Creating compelling visualizations with <code>matplotlib</code></li>
<li>Communicating statistical results to non-technical audiences</li>
</ul>
<p><strong>Next Steps:</strong></p>
<ul>
<li>Chapter 8 will extend these methods to multiple regression</li>
<li>You‚Äôll learn how to control for confounding variables</li>
<li>And test joint hypotheses about multiple coefficients</li>
</ul>
<hr>
<p><strong>Key Takeaway:</strong> Statistical inference transforms sample estimates into insights about populations. By constructing confidence intervals and testing hypotheses, you move beyond ‚ÄúWhat did we find in our data?‚Äù to ‚ÄúWhat can we confidently say about the world?‚Äù This is the foundation of evidence-based economics.</p>
</section>
<section id="case-study-2-is-the-light-development-relationship-significant" class="level3">
<h3 class="anchored" data-anchor-id="case-study-2-is-the-light-development-relationship-significant">Case Study 2: Is the Light-Development Relationship Significant?</h3>
<p>In Chapter 1, we introduced the DS4Bolivia project and estimated a simple regression of municipal development (IMDS) on nighttime lights (NTL). In Chapter 5, we explored bivariate relationships in depth. Now we apply Chapter 7‚Äôs inference tools to test whether the NTL-development relationship is statistically significant and construct confidence intervals for the effect.</p>
<p><strong>Research Question:</strong> Is the association between nighttime lights and municipal development statistically significant, and how precisely can we estimate the effect?</p>
<p><strong>Data:</strong> Cross-sectional dataset covering 339 Bolivian municipalities from the <a href="https://github.com/quarcs-lab/ds4bolivia">DS4Bolivia Project</a>.</p>
<p><strong>Key Variables:</strong></p>
<ul>
<li><code>imds</code>: Municipal Sustainable Development Index (0-100)</li>
<li><code>ln_NTLpc2017</code>: Log nighttime lights per capita (2017)</li>
<li><code>mun</code>: Municipality name</li>
<li><code>dep</code>: Department (administrative region)</li>
</ul>
<section id="load-the-ds4bolivia-data" class="level4">
<h4 class="anchored" data-anchor-id="load-the-ds4bolivia-data">Load the DS4Bolivia Data</h4>
<p>Load the DS4Bolivia dataset and prepare the regression sample.</p>
<div id="cell-72" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the DS4Bolivia dataset</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>url_bol <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/quarcs-lab/ds4bolivia/master/ds4bolivia_v20250523.csv"</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>bol <span class="op">=</span> pd.read_csv(url_bol)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Select key variables and prepare regression data</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>key_vars <span class="op">=</span> [<span class="st">'mun'</span>, <span class="st">'dep'</span>, <span class="st">'imds'</span>, <span class="st">'ln_NTLpc2017'</span>]</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>bol_key <span class="op">=</span> bol[key_vars].copy()</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>reg_data <span class="op">=</span> bol_key[[<span class="st">'imds'</span>, <span class="st">'ln_NTLpc2017'</span>]].dropna()</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"DS4BOLIVIA DATASET ‚Äî REGRESSION SAMPLE"</span>)</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Total municipalities: </span><span class="sc">{</span><span class="bu">len</span>(bol_key)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Complete cases for regression: </span><span class="sc">{</span><span class="bu">len</span>(reg_data)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Descriptive statistics:"</span>)</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(reg_data.describe().<span class="bu">round</span>(<span class="dv">3</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="task-1-estimate-and-test-slope-guided" class="level3">
<h3 class="anchored" data-anchor-id="task-1-estimate-and-test-slope-guided">Task 1: Estimate and Test Slope (Guided)</h3>
<p><strong>Objective:</strong> Estimate the OLS regression of IMDS on log NTL per capita and test whether the slope is statistically significant.</p>
<p><strong>Instructions:</strong></p>
<ol type="1">
<li>Estimate the regression <code>imds ~ ln_NTLpc2017</code> using OLS</li>
<li>Display the full regression summary</li>
<li>Extract the t-statistic and p-value for the slope coefficient</li>
<li>Test the null hypothesis H‚ÇÄ: Œ≤‚ÇÅ = 0 (no linear relationship)</li>
<li>State your conclusion: Can we reject the null at the 5% significance level?</li>
</ol>
<div id="cell-74" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Task 1: Estimate OLS and test the slope</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate the model</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ols(<span class="st">'imds ~ ln_NTLpc2017'</span>, data<span class="op">=</span>reg_data).fit()</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model.summary())</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract t-statistic and p-value for the slope</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>t_stat <span class="op">=</span> model.tvalues[<span class="st">'ln_NTLpc2017'</span>]</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>p_value <span class="op">=</span> model.pvalues[<span class="st">'ln_NTLpc2017'</span>]</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"HYPOTHESIS TEST: H‚ÇÄ: Œ≤‚ÇÅ = 0"</span>)</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Slope coefficient: </span><span class="sc">{</span>model<span class="sc">.</span>params[<span class="st">'ln_NTLpc2017'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Standard error:    </span><span class="sc">{</span>model<span class="sc">.</span>bse[<span class="st">'ln_NTLpc2017'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"t-statistic:       </span><span class="sc">{</span>t_stat<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"p-value:           </span><span class="sc">{</span>p_value<span class="sc">:.6f}</span><span class="ss">"</span>)</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Conclusion: </span><span class="sc">{</span><span class="st">'Reject'</span> <span class="cf">if</span> p_value <span class="op">&lt;</span> <span class="fl">0.05</span> <span class="cf">else</span> <span class="st">'Fail to reject'</span><span class="sc">}</span><span class="ss"> H‚ÇÄ at the 5% level."</span>)</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The NTL-development relationship is </span><span class="sc">{</span><span class="st">'statistically significant'</span> <span class="cf">if</span> p_value <span class="op">&lt;</span> <span class="fl">0.05</span> <span class="cf">else</span> <span class="st">'not statistically significant'</span><span class="sc">}</span><span class="ss">."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="task-2-confidence-interval-for-slope-guided" class="level3">
<h3 class="anchored" data-anchor-id="task-2-confidence-interval-for-slope-guided">Task 2: Confidence Interval for Slope (Guided)</h3>
<p><strong>Objective:</strong> Construct and interpret a 95% confidence interval for the NTL coefficient.</p>
<p><strong>Instructions:</strong></p>
<ol type="1">
<li>Use <code>model.conf_int()</code> to obtain the 95% confidence interval</li>
<li>Extract the lower and upper bounds for the slope</li>
<li>Interpret: ‚ÄúWe are 95% confident that a 1-unit increase in log NTL per capita is associated with between X and Y points of IMDS.‚Äù</li>
<li>Does the confidence interval contain zero? What does that tell us?</li>
</ol>
<div id="cell-76" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Task 2: Confidence interval for the slope</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>ci <span class="op">=</span> model.conf_int(alpha<span class="op">=</span><span class="fl">0.05</span>)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>ci_lower <span class="op">=</span> ci.loc[<span class="st">'ln_NTLpc2017'</span>, <span class="dv">0</span>]</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>ci_upper <span class="op">=</span> ci.loc[<span class="st">'ln_NTLpc2017'</span>, <span class="dv">1</span>]</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"95% CONFIDENCE INTERVAL FOR NTL COEFFICIENT"</span>)</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Point estimate:  </span><span class="sc">{</span>model<span class="sc">.</span>params[<span class="st">'ln_NTLpc2017'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"95% CI:          [</span><span class="sc">{</span>ci_lower<span class="sc">:.4f}</span><span class="ss">, </span><span class="sc">{</span>ci_upper<span class="sc">:.4f}</span><span class="ss">]"</span>)</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Interpretation: We are 95% confident that a 1-unit increase in"</span>)</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"log NTL per capita is associated with between </span><span class="sc">{</span>ci_lower<span class="sc">:.2f}</span><span class="ss"> and </span><span class="sc">{</span>ci_upper<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"points of IMDS."</span>)</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Does the CI contain zero? </span><span class="sc">{</span><span class="st">'Yes'</span> <span class="cf">if</span> ci_lower <span class="op">&lt;=</span> <span class="dv">0</span> <span class="op">&lt;=</span> ci_upper <span class="cf">else</span> <span class="st">'No'</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"This is consistent with </span><span class="sc">{</span><span class="st">'failing to reject'</span> <span class="cf">if</span> ci_lower <span class="op">&lt;=</span> <span class="dv">0</span> <span class="op">&lt;=</span> ci_upper <span class="cf">else</span> <span class="st">'rejecting'</span><span class="sc">}</span><span class="ss"> H‚ÇÄ: Œ≤‚ÇÅ = 0."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="task-3-robust-standard-errors-semi-guided" class="level3">
<h3 class="anchored" data-anchor-id="task-3-robust-standard-errors-semi-guided">Task 3: Robust Standard Errors (Semi-guided)</h3>
<p><strong>Objective:</strong> Compare default (homoskedastic) standard errors with heteroskedasticity-robust (HC1) standard errors.</p>
<p><strong>Instructions:</strong></p>
<ol type="1">
<li>Re-estimate the model with HC1 robust standard errors using <code>cov_type='HC1'</code></li>
<li>Compare the standard errors, t-statistics, and p-values between the two models</li>
<li>Discuss: Do the robust SEs differ substantially from the default SEs?</li>
<li>Why might robust standard errors matter for municipality-level spatial data?</li>
</ol>
<p><strong>Hint:</strong> Use <code>model_robust = ols('imds ~ ln_NTLpc2017', data=reg_data).fit(cov_type='HC1')</code></p>
<div id="cell-78" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Task 3: Robust standard errors</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-estimate with HC1 robust standard errors</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>model_robust <span class="op">=</span> ols(<span class="st">'imds ~ ln_NTLpc2017'</span>, data<span class="op">=</span>reg_data).fit(cov_type<span class="op">=</span><span class="st">'HC1'</span>)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare default vs robust results</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"COMPARISON: DEFAULT vs ROBUST STANDARD ERRORS"</span>)</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">''</span><span class="sc">:30s}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'Default'</span><span class="sc">:&gt;12s}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'Robust (HC1)'</span><span class="sc">:&gt;12s}</span><span class="ss">"</span>)</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">55</span>)</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'Slope coefficient'</span><span class="sc">:30s}</span><span class="ss"> </span><span class="sc">{</span>model<span class="sc">.</span>params[<span class="st">'ln_NTLpc2017'</span>]<span class="sc">:12.4f}</span><span class="ss"> </span><span class="sc">{</span>model_robust<span class="sc">.</span>params[<span class="st">'ln_NTLpc2017'</span>]<span class="sc">:12.4f}</span><span class="ss">"</span>)</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'Standard error'</span><span class="sc">:30s}</span><span class="ss"> </span><span class="sc">{</span>model<span class="sc">.</span>bse[<span class="st">'ln_NTLpc2017'</span>]<span class="sc">:12.4f}</span><span class="ss"> </span><span class="sc">{</span>model_robust<span class="sc">.</span>bse[<span class="st">'ln_NTLpc2017'</span>]<span class="sc">:12.4f}</span><span class="ss">"</span>)</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'t-statistic'</span><span class="sc">:30s}</span><span class="ss"> </span><span class="sc">{</span>model<span class="sc">.</span>tvalues[<span class="st">'ln_NTLpc2017'</span>]<span class="sc">:12.4f}</span><span class="ss"> </span><span class="sc">{</span>model_robust<span class="sc">.</span>tvalues[<span class="st">'ln_NTLpc2017'</span>]<span class="sc">:12.4f}</span><span class="ss">"</span>)</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'p-value'</span><span class="sc">:30s}</span><span class="ss"> </span><span class="sc">{</span>model<span class="sc">.</span>pvalues[<span class="st">'ln_NTLpc2017'</span>]<span class="sc">:12.6f}</span><span class="ss"> </span><span class="sc">{</span>model_robust<span class="sc">.</span>pvalues[<span class="st">'ln_NTLpc2017'</span>]<span class="sc">:12.6f}</span><span class="ss">"</span>)</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">SE ratio (robust/default): </span><span class="sc">{</span>model_robust<span class="sc">.</span>bse[<span class="st">'ln_NTLpc2017'</span>] <span class="op">/</span> model<span class="sc">.</span>bse[<span class="st">'ln_NTLpc2017'</span>]<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Note: A ratio substantially different from 1.0 signals heteroskedasticity."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<blockquote class="blockquote">
<p><strong>Key Concept 7.12: Robust Inference with Spatial Data</strong></p>
<p>Municipality-level data often exhibits <strong>heteroskedasticity</strong>: the variance of development outcomes may differ between urban areas (where IMDS is tightly clustered around high values) and rural areas (where IMDS varies widely). Heteroskedasticity-robust standard errors (HC1) provide valid inference without assuming constant variance. When standard and robust SEs differ substantially, this signals heteroskedasticity in the data.</p>
</blockquote>
</section>
<section id="task-4-two-sided-hypothesis-test-semi-guided" class="level3">
<h3 class="anchored" data-anchor-id="task-4-two-sided-hypothesis-test-semi-guided">Task 4: Two-Sided Hypothesis Test (Semi-guided)</h3>
<p><strong>Objective:</strong> Test whether the NTL coefficient equals a specific hypothesized value.</p>
<p><strong>Instructions:</strong></p>
<ol type="1">
<li>Test H‚ÇÄ: Œ≤‚ÇÅ = 5 (a specific hypothesized effect size)</li>
<li>Calculate the t-statistic manually: t = (Œ≤ÃÇ‚ÇÅ ‚àí 5) / SE(Œ≤ÃÇ‚ÇÅ)</li>
<li>Compute the two-sided p-value using <code>scipy.stats.t.sf()</code></li>
<li>Can we reject that the true effect equals exactly 5?</li>
</ol>
<p><strong>Hint:</strong> Use robust standard errors for this test. The degrees of freedom are <code>model_robust.df_resid</code>.</p>
<div id="cell-81" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Task 4: Two-sided hypothesis test for H0: beta_1 = 5</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Hypothesized value</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>beta_0_hyp <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate t-statistic manually</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>beta_hat <span class="op">=</span> model_robust.params[<span class="st">'ln_NTLpc2017'</span>]</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>se_robust <span class="op">=</span> model_robust.bse[<span class="st">'ln_NTLpc2017'</span>]</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> model_robust.df_resid</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>t_manual <span class="op">=</span> (beta_hat <span class="op">-</span> beta_0_hyp) <span class="op">/</span> se_robust</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>p_two_sided <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> stats.t.sf(<span class="bu">abs</span>(t_manual), df<span class="op">=</span>df)</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"HYPOTHESIS TEST: H‚ÇÄ: Œ≤‚ÇÅ = </span><span class="sc">{</span>beta_0_hyp<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Estimated slope:   </span><span class="sc">{</span>beta_hat<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Hypothesized value: </span><span class="sc">{</span>beta_0_hyp<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Robust SE:          </span><span class="sc">{</span>se_robust<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"t-statistic:        </span><span class="sc">{</span>t_manual<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Degrees of freedom: </span><span class="sc">{</span>df<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Two-sided p-value:  </span><span class="sc">{</span>p_two_sided<span class="sc">:.6f}</span><span class="ss">"</span>)</span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Conclusion: </span><span class="sc">{</span><span class="st">'Reject'</span> <span class="cf">if</span> p_two_sided <span class="op">&lt;</span> <span class="fl">0.05</span> <span class="cf">else</span> <span class="st">'Fail to reject'</span><span class="sc">}</span><span class="ss"> H‚ÇÄ at the 5% level."</span>)</span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'The effect is significantly different from 5.'</span> <span class="cf">if</span> p_two_sided <span class="op">&lt;</span> <span class="fl">0.05</span> <span class="cf">else</span> <span class="st">'We cannot reject that the effect equals 5.'</span><span class="sc">}</span><span class="ss">"</span>) </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="task-5-one-sided-test-independent" class="level3">
<h3 class="anchored" data-anchor-id="task-5-one-sided-test-independent">Task 5: One-Sided Test (Independent)</h3>
<p><strong>Objective:</strong> Test whether the NTL coefficient is positive (NTL has a positive effect on development).</p>
<p><strong>Instructions:</strong></p>
<ol type="1">
<li>State the hypotheses: H‚ÇÄ: Œ≤‚ÇÅ ‚â§ 0 vs H‚ÇÅ: Œ≤‚ÇÅ &gt; 0</li>
<li>Calculate the one-sided p-value from the t-statistic</li>
<li>Use robust standard errors</li>
<li>Discuss: Is there strong evidence for a positive relationship between nighttime lights and development?</li>
</ol>
<p><strong>Hint:</strong> For a right-sided test, the one-sided p-value is <code>stats.t.sf(t_stat, df=df)</code>.</p>
<div id="cell-83" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Task 5: One-sided test ‚Äî H0: beta_1 &lt;= 0 vs H1: beta_1 &gt; 0</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="co"># t-statistic for H0: beta_1 = 0 using robust SEs</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>t_onesided <span class="op">=</span> model_robust.tvalues[<span class="st">'ln_NTLpc2017'</span>]</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>p_onesided <span class="op">=</span> stats.t.sf(t_onesided, df<span class="op">=</span>model_robust.df_resid)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"ONE-SIDED TEST: H‚ÇÄ: Œ≤‚ÇÅ ‚â§ 0 vs H‚ÇÅ: Œ≤‚ÇÅ &gt; 0"</span>)</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Estimated slope:     </span><span class="sc">{</span>model_robust<span class="sc">.</span>params[<span class="st">'ln_NTLpc2017'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Robust SE:           </span><span class="sc">{</span>model_robust<span class="sc">.</span>bse[<span class="st">'ln_NTLpc2017'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"t-statistic:         </span><span class="sc">{</span>t_onesided<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"One-sided p-value:   </span><span class="sc">{</span>p_onesided<span class="sc">:.8f}</span><span class="ss">"</span>)</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Conclusion: </span><span class="sc">{</span><span class="st">'Reject'</span> <span class="cf">if</span> p_onesided <span class="op">&lt;</span> <span class="fl">0.05</span> <span class="cf">else</span> <span class="st">'Fail to reject'</span><span class="sc">}</span><span class="ss"> H‚ÇÄ at the 5% level."</span>)</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"There </span><span class="sc">{</span><span class="st">'is'</span> <span class="cf">if</span> p_onesided <span class="op">&lt;</span> <span class="fl">0.05</span> <span class="cf">else</span> <span class="st">'is not'</span><span class="sc">}</span><span class="ss"> strong evidence for a positive NTL-development relationship."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<blockquote class="blockquote">
<p><strong>Key Concept 7.13: Practical Significance in Development</strong></p>
<p>A statistically significant regression coefficient must be evaluated for <strong>practical significance</strong>. In the DS4Bolivia context, the NTL coefficient tells us how much IMDS changes for a 1-unit increase in log NTL per capita. Since IMDS ranges from roughly 20 to 80, an effect of, say, 5 points represents about 8% of the total range‚Äîa meaningful but not transformative association. Policy decisions should weigh both statistical confidence and effect magnitude.</p>
</blockquote>
</section>
<section id="task-6-economic-vs-statistical-significance-independent" class="level3">
<h3 class="anchored" data-anchor-id="task-6-economic-vs-statistical-significance-independent">Task 6: Economic vs Statistical Significance (Independent)</h3>
<p><strong>Objective:</strong> Write a 200-300 word discussion evaluating both the statistical and practical significance of the NTL-development relationship.</p>
<p><strong>Your discussion should address:</strong></p>
<ol type="1">
<li><strong>Statistical significance:</strong> Summarize the hypothesis test results. Is the coefficient significant at the 1%, 5%, and 10% levels?</li>
<li><strong>Effect magnitude:</strong> A 1-unit change in log NTL per capita corresponds to roughly a 172% increase in NTL per capita (since exp(1) ‚âà 2.72). What does the estimated coefficient imply for development?</li>
<li><strong>Scale context:</strong> Compare the effect magnitude with the full range of IMDS across municipalities. Is the effect large or small in practical terms?</li>
<li><strong>Policy implications:</strong> If a policy could double NTL per capita in a municipality (a 0.69 increase in log NTL), how much IMDS improvement would we predict? Is that meaningful for SDG progress?</li>
<li><strong>Limitations:</strong> Does statistical significance prove causation? What omitted variables could confound this relationship?</li>
</ol>
<div id="cell-86" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Task 6: Supporting analysis for economic vs statistical significance</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics for context</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>imds_range <span class="op">=</span> reg_data[<span class="st">'imds'</span>].<span class="bu">max</span>() <span class="op">-</span> reg_data[<span class="st">'imds'</span>].<span class="bu">min</span>()</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>imds_std <span class="op">=</span> reg_data[<span class="st">'imds'</span>].std()</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>beta <span class="op">=</span> model_robust.params[<span class="st">'ln_NTLpc2017'</span>]</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"ECONOMIC vs STATISTICAL SIGNIFICANCE ‚Äî KEY FACTS"</span>)</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Estimated slope (robust): </span><span class="sc">{</span>beta<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Robust p-value:           </span><span class="sc">{</span>model_robust<span class="sc">.</span>pvalues[<span class="st">'ln_NTLpc2017'</span>]<span class="sc">:.6f}</span><span class="ss">"</span>)</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">IMDS range:     </span><span class="sc">{</span>reg_data[<span class="st">'imds'</span>]<span class="sc">.</span><span class="bu">min</span>()<span class="sc">:.1f}</span><span class="ss"> to </span><span class="sc">{</span>reg_data[<span class="st">'imds'</span>]<span class="sc">.</span><span class="bu">max</span>()<span class="sc">:.1f}</span><span class="ss"> (range = </span><span class="sc">{</span>imds_range<span class="sc">:.1f}</span><span class="ss">)"</span>)</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"IMDS std dev:   </span><span class="sc">{</span>imds_std<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Effect of 1-unit increase in log NTL:"</span>)</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  IMDS change:           </span><span class="sc">{</span>beta<span class="sc">:.2f}</span><span class="ss"> points"</span>)</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  As % of IMDS range:    </span><span class="sc">{</span><span class="dv">100</span> <span class="op">*</span> beta <span class="op">/</span> imds_range<span class="sc">:.1f}</span><span class="ss">%"</span>)</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  As % of IMDS std dev:  </span><span class="sc">{</span><span class="dv">100</span> <span class="op">*</span> beta <span class="op">/</span> imds_std<span class="sc">:.1f}</span><span class="ss">%"</span>)</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Effect of doubling NTL per capita (0.693 increase in log NTL):"</span>)</span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Predicted IMDS change: </span><span class="sc">{</span>beta <span class="op">*</span> <span class="fl">0.693</span><span class="sc">:.2f}</span><span class="ss"> points"</span>)</span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  As % of IMDS range:    </span><span class="sc">{</span><span class="dv">100</span> <span class="op">*</span> beta <span class="op">*</span> <span class="fl">0.693</span> <span class="op">/</span> imds_range<span class="sc">:.1f}</span><span class="ss">%"</span>)</span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">R-squared: </span><span class="sc">{</span>model<span class="sc">.</span>rsquared<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"NTL explains </span><span class="sc">{</span>model<span class="sc">.</span>rsquared <span class="op">*</span> <span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">% of variation in IMDS across municipalities."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="what-youve-learned-1" class="level3">
<h3 class="anchored" data-anchor-id="what-youve-learned-1">What You‚Äôve Learned</h3>
<p>Through this case study on statistical inference for the NTL-development relationship in Bolivia, you practiced:</p>
<p><strong>Statistical Inference Skills:</strong></p>
<ul>
<li>Estimating OLS regression and extracting test statistics</li>
<li>Constructing and interpreting 95% confidence intervals</li>
<li>Computing heteroskedasticity-robust standard errors (HC1)</li>
<li>Conducting two-sided hypothesis tests for specific values</li>
<li>Conducting one-sided hypothesis tests for directional claims</li>
</ul>
<p><strong>Economic Reasoning Skills:</strong></p>
<ul>
<li>Distinguishing statistical significance from practical significance</li>
<li>Evaluating effect magnitudes in the context of policy-relevant scales</li>
<li>Recognizing the role of heteroskedasticity in spatial economic data</li>
</ul>
<p><strong>Connection to Future Chapters:</strong> In Chapters 10-12, we extend this analysis to <em>multiple regression</em>‚Äîadding satellite embeddings alongside NTL to improve predictive power and test which features matter.</p>
<hr>
<p><strong>Well done!</strong> You‚Äôve now applied the full toolkit of regression inference‚Äîhypothesis tests, confidence intervals, robust standard errors, and significance evaluation‚Äîto real-world satellite development data.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "Óßã";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../notebooks_colab/ch06_The_Least_Squares_Estimator.html" class="pagination-link" aria-label="6. The Least Squares Estimator">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">6. The Least Squares Estimator</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../notebooks_colab/ch08_Case_Studies_for_Bivariate_Regression.html" class="pagination-link" aria-label="8. Case Studies for Bivariate Regression">
        <span class="nav-page-text"><span class="chapter-title">8. Case Studies for Bivariate Regression</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>