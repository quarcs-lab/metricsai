<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Econometrics Powered by AI - 4. Statistical Inference for the Mean</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../notebooks_colab/ch05_Bivariate_Data_Summary.html" rel="next">
<link href="../notebooks_colab/ch03_The_Sample_Mean.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../custom.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../notebooks_colab/ch01_Analysis_of_Economics_Data.html">Statistical Foundations</a></li><li class="breadcrumb-item"><a href="../notebooks_colab/ch04_Statistical_Inference_for_the_Mean.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">4. Statistical Inference for the Mean</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Econometrics Powered by AI</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Statistical Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch01_Analysis_of_Economics_Data.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">1. Analysis of Economics Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch02_Univariate_Data_Summary.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">2. Univariate Data Summary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch03_The_Sample_Mean.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">3. The Sample Mean</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch04_Statistical_Inference_for_the_Mean.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">4. Statistical Inference for the Mean</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Bivariate Regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch05_Bivariate_Data_Summary.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">5. Bivariate Data Summary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch06_The_Least_Squares_Estimator.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">6. The Least Squares Estimator</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch07_Statistical_Inference_for_Bivariate_Regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">7. Statistical Inference for Bivariate Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch08_Case_Studies_for_Bivariate_Regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">8. Case Studies for Bivariate Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch09_Models_with_Natural_Logarithms.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">9. Models with Natural Logarithms</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Multiple Regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch10_Data_Summary_for_Multiple_Regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">10. Data Summary for Multiple Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch11_Statistical_Inference_for_Multiple_Regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">11. Statistical Inference for Multiple Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch12_Further_Topics_in_Multiple_Regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">12. Further Topics in Multiple Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch13_Case_Studies_for_Multiple_Regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">13. Case Studies for Multiple Regression</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Advanced Topics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch14_Regression_with_Indicator_Variables.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">14. Regression with Indicator Variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch15_Regression_with_Transformed_Variables.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">15. Regression with Transformed Variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch16_Checking_the_Model_and_Data.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">16. Checking the Model and Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch17_Panel_Data_Time_Series_Data_Causation.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">17. Panel Data, Time Series Data, Causation</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul class="collapse">
  <li><a href="#chapter-overview" id="toc-chapter-overview" class="nav-link active" data-scroll-target="#chapter-overview">Chapter Overview</a></li>
  <li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#example-mean-annual-earnings" id="toc-example-mean-annual-earnings" class="nav-link" data-scroll-target="#example-mean-annual-earnings">4.1 Example: Mean Annual Earnings</a></li>
  <li><a href="#t-statistic-and-t-distribution" id="toc-t-statistic-and-t-distribution" class="nav-link" data-scroll-target="#t-statistic-and-t-distribution">4.2 t Statistic and t Distribution</a></li>
  <li><a href="#confidence-intervals" id="toc-confidence-intervals" class="nav-link" data-scroll-target="#confidence-intervals">4.3 Confidence Intervals</a></li>
  <li><a href="#two-sided-hypothesis-tests" id="toc-two-sided-hypothesis-tests" class="nav-link" data-scroll-target="#two-sided-hypothesis-tests">4.4 Two-Sided Hypothesis Tests</a></li>
  <li><a href="#hypothesis-test-examples" id="toc-hypothesis-test-examples" class="nav-link" data-scroll-target="#hypothesis-test-examples">4.5 Hypothesis Test Examples</a></li>
  <li><a href="#one-sided-directional-hypothesis-tests" id="toc-one-sided-directional-hypothesis-tests" class="nav-link" data-scroll-target="#one-sided-directional-hypothesis-tests">4.6 One-Sided Directional Hypothesis Tests</a></li>
  <li><a href="#proportions-data" id="toc-proportions-data" class="nav-link" data-scroll-target="#proportions-data">4.7 Proportions Data</a></li>
  <li><a href="#key-takeaways" id="toc-key-takeaways" class="nav-link" data-scroll-target="#key-takeaways">Key Takeaways</a></li>
  <li><a href="#practice-exercises" id="toc-practice-exercises" class="nav-link" data-scroll-target="#practice-exercises">Practice Exercises</a></li>
  <li><a href="#case-studies" id="toc-case-studies" class="nav-link" data-scroll-target="#case-studies">Case Studies</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">
<div id="google_translate_element" style="padding: 8px 0;"></div>
<script type="text/javascript">
function googleTranslateElementInit() {
  new google.translate.TranslateElement({
    pageLanguage: 'en',
    layout: google.translate.TranslateElement.InlineLayout.HORIZONTAL
  }, 'google_translate_element');
}
</script>
<script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-title">4. Statistical Inference for the Mean</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p><strong>metricsAI: An Introduction to Econometrics with Python and AI in the Cloud</strong></p>
<p><em><a href="https://carlos-mendez.org">Carlos Mendez</a></em></p>
<p><img src="https://raw.githubusercontent.com/quarcs-lab/metricsai/main/images/ch04_visual_summary.jpg" alt="Chapter 04 Visual Summary" width="65%"></p>
<p>This notebook provides an interactive introduction to statistical inference, teaching you how to extrapolate from sample statistics to population parameters using confidence intervals and hypothesis tests.</p>
<a href="https://colab.research.google.com/github/quarcs-lab/metricsai/blob/main/notebooks_colab/ch04_Statistical_Inference_for_the_Mean.ipynb"><img src="https://colab.research.google.com/assets/colab-badge.svg" class="img-fluid" alt="Open In Colab"></a>
<div class="chapter-resources">
<p><a href="https://www.youtube.com/watch?v=8wn00FpUz38" target="_blank" class="resource-btn">üé¨ AI Video</a> <a href="https://carlos-mendez.my.canva.site/s04-statistical-inference-for-the-mean-pdf" target="_blank" class="resource-btn">‚ú® AI Slides</a> <a href="https://cameron.econ.ucdavis.edu/aed/traedv1_04" target="_blank" class="resource-btn">üìä Cameron Slides</a> <a href="https://app.edcafe.ai/quizzes/6978656c2f5d08069e0479cb" target="_blank" class="resource-btn">‚úèÔ∏è Quiz</a> <a href="https://app.edcafe.ai/chatbots/69789d9f2f5d08069e06ffa5" target="_blank" class="resource-btn">ü§ñ AI Tutor</a></p>
</div>
<section id="chapter-overview" class="level2">
<h2 class="anchored" data-anchor-id="chapter-overview">Chapter Overview</h2>
<p>This chapter introduces <strong>statistical inference for the mean</strong>‚Äîthe foundational methods for extrapolating from sample statistics to population parameters with quantified uncertainty.</p>
<p><strong>What you‚Äôll learn:</strong></p>
<ul>
<li>Construct and interpret <strong>confidence intervals</strong> for population means</li>
<li>Understand the <strong>t-distribution</strong> and when to use it (vs.&nbsp;normal distribution)</li>
<li>Conduct <strong>hypothesis tests</strong> to evaluate claims about population parameters</li>
<li>Calculate and interpret <strong>p-values</strong> and understand statistical significance</li>
<li>Distinguish between <strong>one-sided and two-sided tests</strong></li>
<li>Apply inference methods to <strong>proportions data</strong> and binary outcomes</li>
</ul>
<p><strong>Datasets used:</strong></p>
<ul>
<li><strong>AED_EARNINGS.DTA</strong>: Sample of 171 30-year-old female full-time workers in 2010 (earnings in dollars)</li>
<li><strong>AED_GASPRICE.DTA</strong>: Weekly gasoline prices in the U.S. (testing price level hypotheses)</li>
<li><strong>AED_EARNINGSMALE.DTA</strong>: Male earnings data for hypothesis testing examples</li>
<li><strong>AED_REALGDPPC.DTA</strong>: Real GDP per capita growth rates (testing economic growth hypotheses)</li>
</ul>
<p><strong>Chapter outline:</strong></p>
<ul>
<li><strong>4.1 Example: Mean Annual Earnings</strong></li>
<li><strong>4.2 t Statistic and t Distribution</strong></li>
<li><strong>4.3 Confidence Intervals</strong></li>
<li><strong>4.4 Two-Sided Hypothesis Tests</strong></li>
<li><strong>4.5 Hypothesis Test Examples</strong></li>
<li><strong>4.6 One-Sided Directional Hypothesis Tests</strong></li>
<li><strong>4.7 Proportions Data</strong></li>
</ul>
</section>
<section id="setup" class="level2">
<h2 class="anchored" data-anchor-id="setup">Setup</h2>
<p>Run this cell first to import all required packages and configure the environment.</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import required libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Set random seeds for reproducibility</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>RANDOM_SEED <span class="op">=</span> <span class="dv">42</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>random.seed(RANDOM_SEED)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>np.random.seed(RANDOM_SEED)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>os.environ[<span class="st">'PYTHONHASHSEED'</span>] <span class="op">=</span> <span class="bu">str</span>(RANDOM_SEED)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># GitHub data URL (data streams directly from here)</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>GITHUB_DATA_URL <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/quarcs-lab/data-open/master/AED/"</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Optional: Create directories for saving outputs locally</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>IMAGES_DIR <span class="op">=</span> <span class="st">'images'</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>TABLES_DIR <span class="op">=</span> <span class="st">'tables'</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>os.makedirs(IMAGES_DIR, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>os.makedirs(TABLES_DIR, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Set plotting style</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>sns.set_style(<span class="st">"whitegrid"</span>)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'figure.figsize'</span>] <span class="op">=</span> (<span class="dv">10</span>, <span class="dv">6</span>)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"‚úì Setup complete! All packages imported successfully."</span>)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"‚úì Random seed set to </span><span class="sc">{</span>RANDOM_SEED<span class="sc">}</span><span class="ss"> for reproducibility."</span>)</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"‚úì Data will stream from: </span><span class="sc">{</span>GITHUB_DATA_URL<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>‚úì Setup complete! All packages imported successfully.
‚úì Random seed set to 42 for reproducibility.
‚úì Data will stream from: https://raw.githubusercontent.com/quarcs-lab/data-open/master/AED/</code></pre>
</div>
</div>
</section>
<section id="example-mean-annual-earnings" class="level2">
<h2 class="anchored" data-anchor-id="example-mean-annual-earnings">4.1 Example: Mean Annual Earnings</h2>
<p>We‚Äôll use a motivating example throughout this chapter: estimating the <strong>population mean annual earnings</strong> for 30-year-old female full-time workers in the U.S. in 2010.</p>
<p><strong>The Problem:</strong></p>
<ul>
<li>We have a <strong>sample</strong> of 171 women</li>
<li>We want to make inferences about the <strong>population</strong> of all such women</li>
</ul>
<p><strong>Key Statistics:</strong></p>
<ul>
<li><strong>Sample mean</strong> <span class="math inline">\(\bar{x}\)</span>: Our point estimate of population mean Œº</li>
<li><strong>Standard deviation</strong> s: Measures variability in the sample</li>
<li><strong>Standard error</strong> se(<span class="math inline">\(\bar{x}\)</span>) = s/‚àön: Measures precision of <span class="math inline">\(\bar{x}\)</span> as an estimate of Œº</li>
</ul>
<p>The <strong>standard error</strong> is crucial‚Äîit quantifies our uncertainty about Œº. Smaller standard errors mean more precise estimates.</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load earnings data</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>data_earnings <span class="op">=</span> pd.read_stata(GITHUB_DATA_URL <span class="op">+</span> <span class="st">'AED_EARNINGS.DTA'</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>earnings <span class="op">=</span> data_earnings[<span class="st">'earnings'</span>]</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate key statistics</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="bu">len</span>(earnings)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>mean_earnings <span class="op">=</span> earnings.mean()</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>std_earnings <span class="op">=</span> earnings.std(ddof<span class="op">=</span><span class="dv">1</span>)  <span class="co"># ddof=1 for sample std dev</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>se_earnings <span class="op">=</span> std_earnings <span class="op">/</span> np.sqrt(n)  <span class="co"># Standard error</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"SAMPLE STATISTICS FOR ANNUAL EARNINGS"</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sample size (n):        </span><span class="sc">{</span>n<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mean:                   $</span><span class="sc">{</span>mean_earnings<span class="sc">:,</span><span class="fl">.2</span><span class="er">f</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Standard deviation:     $</span><span class="sc">{</span>std_earnings<span class="sc">:,</span><span class="fl">.2</span><span class="er">f</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Standard error:         $</span><span class="sc">{</span>se_earnings<span class="sc">:,</span><span class="fl">.2</span><span class="er">f</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Interpretation: Our best estimate of population mean earnings is $</span><span class="sc">{</span>mean_earnings<span class="sc">:,</span><span class="fl">.2</span><span class="er">f</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The standard error of $</span><span class="sc">{</span>se_earnings<span class="sc">:,</span><span class="fl">.2</span><span class="er">f</span><span class="sc">}</span><span class="ss"> measures the precision of this estimate."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
SAMPLE STATISTICS FOR ANNUAL EARNINGS
======================================================================
Sample size (n):        171
Mean:                   $41,412.69
Standard deviation:     $25,527.05
Standard error:         $1,952.10

Interpretation: Our best estimate of population mean earnings is $41,412.69
The standard error of $1,952.10 measures the precision of this estimate.</code></pre>
</div>
</div>
<p><strong>Key Statistics from our Sample (n = 171 women):</strong></p>
<ul>
<li>Sample mean: $41,412.69</li>
<li>Standard deviation: $25,527.05</li>
<li>Standard error: $1,952.10</li>
</ul>
<p><strong>What is the standard error telling us?</strong></p>
<p>The standard error of $1,952.10 measures the <strong>precision</strong> of our sample mean as an estimate of the true population mean. Think of it as quantifying our uncertainty.</p>
<p><strong>Statistical interpretation:</strong></p>
<ul>
<li>If we repeatedly drew samples of 171 women, the sample means would vary</li>
<li>The standard error tells us the typical amount by which sample means differ from the true population mean</li>
<li>Formula: SE = s/‚àön = $25,527.05/‚àö171 = $1,952.10</li>
</ul>
<p><strong>Why is the SE much smaller than the standard deviation?</strong></p>
<ul>
<li>Standard deviation ($25,527) measures variability among individual women‚Äôs earnings</li>
<li>Standard error ($1,952) measures variability of the sample mean across different samples</li>
<li>The larger the sample size, the smaller the SE ‚Üí more precise estimates</li>
</ul>
<p><strong>Practical insight:</strong></p>
<ul>
<li>A standard error of $1,952 is relatively small compared to the mean ($41,413)</li>
<li>This suggests our estimate is reasonably precise</li>
<li>If we had only 43 women (n=43), SE would double to $3,904 (less precise)</li>
<li>With 684 women (n=684), SE would halve to $976 (more precise)</li>
</ul>
<blockquote class="blockquote">
<p><strong>Key Concept 4.1: Standard Error and Precision</strong></p>
<p>The standard error se(<span class="math inline">\(\bar{x}\)</span>) = s/‚àön measures the precision of the sample mean as an estimate of the population mean Œº. It quantifies sampling uncertainty‚Äîsmaller standard errors mean more precise estimates. The SE decreases with sample size at rate 1/‚àön, so quadrupling the sample size halves the standard error.</p>
</blockquote>
</section>
<section id="t-statistic-and-t-distribution" class="level2">
<h2 class="anchored" data-anchor-id="t-statistic-and-t-distribution">4.2 t Statistic and t Distribution</h2>
<p>For inference on the population mean Œº, we use the <strong>t-statistic</strong>:</p>
<p><span class="math display">\[t = \frac{\bar{x} - \mu}{\text{se}(\bar{x})} = \frac{\bar{x} - \mu}{s / \sqrt{n}}\]</span></p>
<p>Under certain assumptions, this statistic follows a <strong>t-distribution</strong> with (n - 1) degrees of freedom:</p>
<p><span class="math display">\[t \sim T(n-1)\]</span></p>
<p><strong>Why t-distribution instead of normal?</strong></p>
<ul>
<li>We don‚Äôt know the population standard deviation œÉ, so we estimate it with sample std dev s</li>
<li>This adds uncertainty, making the distribution have <strong>fatter tails</strong> than the normal</li>
<li>As sample size increases (n ‚Üí ‚àû), the t-distribution approaches the standard normal distribution</li>
</ul>
<p><strong>Key properties:</strong></p>
<ul>
<li>Symmetric around zero (like the normal)</li>
<li>Fatter tails than normal (more probability in extremes)</li>
<li>Converges to N(0,1) as degrees of freedom increase</li>
</ul>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize t-distribution vs standard normal</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">16</span>, <span class="dv">6</span>))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">200</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel A: t(4) vs standard normal</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].plot(x, stats.norm.pdf(x), <span class="st">'b--'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">'Standard Normal'</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].plot(x, stats.t.pdf(x, df<span class="op">=</span><span class="dv">4</span>), <span class="st">'r-'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">'t(4)'</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">'x value'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'Density'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">'Panel A: t(4) and Standard Normal'</span>, fontsize<span class="op">=</span><span class="dv">13</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].legend()</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].text(<span class="dv">0</span>, <span class="fl">0.35</span>, <span class="st">'Notice: t(4) has fatter tails</span><span class="ch">\n</span><span class="st">(more extreme values likely)'</span>, </span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>             ha<span class="op">=</span><span class="st">'center'</span>, bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'round'</span>, facecolor<span class="op">=</span><span class="st">'wheat'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>))</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel B: t(30) vs standard normal</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(x, stats.norm.pdf(x), <span class="st">'b--'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">'Standard Normal'</span>)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(x, stats.t.pdf(x, df<span class="op">=</span><span class="dv">30</span>), <span class="st">'r-'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">'t(30)'</span>)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">'x value'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">'Density'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">'Panel B: t(30) and Standard Normal'</span>, fontsize<span class="op">=</span><span class="dv">13</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].legend()</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].text(<span class="dv">0</span>, <span class="fl">0.35</span>, <span class="st">'As df increases, t approaches</span><span class="ch">\n</span><span class="st">the standard normal'</span>, </span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>             ha<span class="op">=</span><span class="st">'center'</span>, bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'round'</span>, facecolor<span class="op">=</span><span class="st">'wheat'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>))</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">'Figure 4.1: t Distribution vs Standard Normal'</span>,</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, y<span class="op">=</span><span class="fl">1.0</span>)</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">üìä Key Observation:"</span>)</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   With more degrees of freedom (larger n), the t-distribution looks more like the normal."</span>)</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   For n &gt; 30, they're nearly identical."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="ch04_Statistical_Inference_for_the_Mean_files/figure-html/cell-4-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
üìä Key Observation:
   With more degrees of freedom (larger n), the t-distribution looks more like the normal.
   For n &gt; 30, they're nearly identical.</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p><strong>Key Concept 4.2: The t-Distribution</strong></p>
<p>The t-distribution is used when the population standard deviation <span class="math inline">\(\sigma\)</span> is unknown and must be estimated from the sample. It is similar to the standard normal N(0,1) but with fatter tails that reflect the additional uncertainty from estimating <span class="math inline">\(\sigma\)</span>. As the sample size <span class="math inline">\(n\)</span> grows, the t-distribution approaches the normal distribution, making the normal a good approximation for large samples.</p>
</blockquote>
</section>
<section id="confidence-intervals" class="level2">
<h2 class="anchored" data-anchor-id="confidence-intervals">4.3 Confidence Intervals</h2>
<p>A <strong>confidence interval</strong> provides a range of plausible values for the population parameter Œº.</p>
<p><strong>General formula:</strong> <span class="math display">\[\text{estimate} \pm \text{critical value} \times \text{standard error}\]</span></p>
<p>For the population mean, a <strong>100(1 - Œ±)% confidence interval</strong> is: <span class="math display">\[\bar{x} \pm t_{n-1, \alpha/2} \times \text{se}(\bar{x})\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\bar{x}\)</span> = sample mean (our estimate)</li>
<li><span class="math inline">\(t_{n-1, \alpha/2}\)</span> = critical value from t-distribution with (n-1) degrees of freedom</li>
<li>se(<span class="math inline">\(\bar{x}\)</span>) = s/‚àön = standard error</li>
<li>Œ± = significance level (e.g., 0.05 for 95% confidence)</li>
</ul>
<p><strong>Interpretation:</strong> If we repeatedly drew samples and constructed 95% CIs, about 95% of those intervals would contain the true population mean Œº.</p>
<p><strong>Practical interpretation:</strong> We are ‚Äú95% confident‚Äù that Œº lies within this interval.</p>
<p><strong>Rule of thumb:</strong> For n &gt; 30, <span class="math inline">\(t_{n-1, 0.025} \approx 2\)</span>, so a 95% CI is approximately: <span class="math display">\[\bar{x} \pm 2 \times \text{se}(\bar{x})\]</span></p>
<blockquote class="blockquote">
<p><strong>Key Concept 4.3: Confidence Intervals</strong></p>
<p>A confidence interval provides a range of plausible values for the population parameter <span class="math inline">\(\mu\)</span>. A 95% confidence interval means: if we repeated the sampling procedure many times, approximately 95% of the resulting intervals would contain the true <span class="math inline">\(\mu\)</span>. The interval is constructed as <span class="math inline">\(\bar{x} \pm t_{\alpha/2} \times se(\bar{x})\)</span>, where wider intervals indicate less precision.</p>
</blockquote>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate 95% confidence interval for mean earnings</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>conf_level <span class="op">=</span> <span class="fl">0.95</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> conf_level</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>t_crit <span class="op">=</span> stats.t.ppf(<span class="dv">1</span> <span class="op">-</span> alpha<span class="op">/</span><span class="dv">2</span>, n <span class="op">-</span> <span class="dv">1</span>)  <span class="co"># Critical value</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>margin_of_error <span class="op">=</span> t_crit <span class="op">*</span> se_earnings</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>ci_lower <span class="op">=</span> mean_earnings <span class="op">-</span> margin_of_error</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>ci_upper <span class="op">=</span> mean_earnings <span class="op">+</span> margin_of_error</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"95% CONFIDENCE INTERVAL FOR POPULATION MEAN EARNINGS"</span>)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sample mean:            $</span><span class="sc">{</span>mean_earnings<span class="sc">:,</span><span class="fl">.2</span><span class="er">f</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Standard error:         $</span><span class="sc">{</span>se_earnings<span class="sc">:,</span><span class="fl">.2</span><span class="er">f</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Critical value t‚ÇÅ‚Çá‚ÇÄ:     </span><span class="sc">{</span>t_crit<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Margin of error:        $</span><span class="sc">{</span>margin_of_error<span class="sc">:,</span><span class="fl">.2</span><span class="er">f</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">95% Confidence Interval: [$</span><span class="sc">{</span>ci_lower<span class="sc">:,</span><span class="fl">.2</span><span class="er">f</span><span class="sc">}</span><span class="ss">, $</span><span class="sc">{</span>ci_upper<span class="sc">:,</span><span class="fl">.2</span><span class="er">f</span><span class="sc">}</span><span class="ss">]"</span>)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Interpretation: We are 95% confident that the true population mean"</span>)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"earnings lies between $</span><span class="sc">{</span>ci_lower<span class="sc">:,</span><span class="fl">.2</span><span class="er">f</span><span class="sc">}</span><span class="ss"> and $</span><span class="sc">{</span>ci_upper<span class="sc">:,</span><span class="fl">.2</span><span class="er">f</span><span class="sc">}</span><span class="ss">."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
95% CONFIDENCE INTERVAL FOR POPULATION MEAN EARNINGS
======================================================================
Sample mean:            $41,412.69
Standard error:         $1,952.10
Critical value t‚ÇÅ‚Çá‚ÇÄ:     1.9740
Margin of error:        $3,853.48

95% Confidence Interval: [$37,559.21, $45,266.17]

Interpretation: We are 95% confident that the true population mean
earnings lies between $37,559.21 and $45,266.17.</code></pre>
</div>
</div>
<p><strong>95% Confidence Interval for Mean Earnings: [$37,559.21, $45,266.17]</strong></p>
<p><strong>What this interval means:</strong></p>
<p>The correct interpretation: If we repeatedly drew samples of 171 women and calculated 95% CIs for each sample, approximately 95% of those intervals would contain the true population mean Œº.</p>
<p><strong>Common misconceptions (WRONG interpretations):</strong></p>
<ul>
<li>‚ÄúThere is a 95% probability that Œº is in this interval‚Äù</li>
<li>‚Äú95% of individual women earn between $37,559 and $45,266‚Äù</li>
<li>‚ÄúThe interval captures 95% of the data‚Äù</li>
</ul>
<p><strong>Correct interpretation:</strong></p>
<ul>
<li>We are 95% confident that the true population mean earnings lie between $37,559 and $45,266</li>
<li>The interval accounts for sampling uncertainty through the standard error</li>
<li>The population mean Œº is fixed (but unknown); our interval is random</li>
</ul>
<p><strong>Breaking down the calculation:</strong></p>
<ul>
<li>Sample mean: $41,412.69</li>
<li>Critical value (t‚ÇÅ‚Çá‚ÇÄ, 0.025): 1.9740</li>
<li>Margin of error: 1.9740 √ó $1,952.10 = $3,853.48</li>
<li>Interval: $41,412.69 ¬± $3,853.48</li>
</ul>
<p><strong>Practical insights:</strong></p>
<ul>
<li>The interval does NOT include $36,000 or $46,000, suggesting these are implausible values for Œº</li>
<li>The interval is fairly narrow (width = $7,707), indicating good precision</li>
<li>The critical value (1.974) is close to 2, confirming the ‚Äúrule of thumb‚Äù: CI ‚âà mean ¬± 2√óSE</li>
</ul>
<p><strong>Why use 95% confidence?</strong></p>
<ul>
<li>Convention in most scientific fields (Œ± = 0.05)</li>
<li>Balances precision (narrow interval) with confidence (high probability of capturing Œº)</li>
<li>Could use 90% (narrower, less confident) or 99% (wider, more confident)</li>
</ul>
<p><strong>Transition:</strong> Now that we understand how the t-distribution differs from the normal distribution, we can use it to construct confidence intervals that account for the uncertainty in estimating œÉ from our sample.</p>
<section id="confidence-precision-trade-off" class="level3">
<h3 class="anchored" data-anchor-id="confidence-precision-trade-off">Confidence-Precision Trade-off</h3>
<p><strong>Comparing Confidence Intervals at Different Levels:</strong></p>
<ul>
<li>90% CI: [$38,184.17, $44,641.21] ‚Äî Width: $6,457.03</li>
<li>95% CI: [$37,559.21, $45,266.17] ‚Äî Width: $7,706.97</li>
<li>99% CI: [$36,327.35, $46,498.03] ‚Äî Width: $10,170.68</li>
</ul>
<p><strong>The fundamental trade-off:</strong></p>
<p>Higher confidence requires wider intervals. You cannot have both maximum precision (narrow interval) AND maximum confidence (high probability of capturing Œº) simultaneously.</p>
<p><strong>Why does this happen?</strong></p>
<ul>
<li>To be more confident we‚Äôve captured Œº, we must cast a wider net</li>
<li>The critical value increases with confidence level:
<ul>
<li>90% CI: t-critical ‚âà 1.66 ‚Üí smaller multiplier</li>
<li>95% CI: t-critical ‚âà 1.97 ‚Üí moderate multiplier<br>
</li>
<li>99% CI: t-critical ‚âà 2.61 ‚Üí larger multiplier</li>
</ul></li>
</ul>
<p><strong>Practical implications:</strong></p>
<ol type="1">
<li><strong>90% CI ($6,457 width):</strong>
<ul>
<li>Narrower, more precise</li>
<li>BUT: 10% chance the interval misses Œº</li>
<li>Use when: precision is critical and you can tolerate more risk</li>
</ul></li>
<li><strong>95% CI ($7,707 width):</strong>
<ul>
<li>Standard choice in economics and most sciences</li>
<li>Good balance between precision and confidence</li>
<li>Use when: following standard practice (almost always)</li>
</ul></li>
<li><strong>99% CI ($10,171 width):</strong>
<ul>
<li>Wider, less precise</li>
<li>BUT: Only 1% chance the interval misses Œº</li>
<li>Use when: being wrong is very costly (medical, safety applications)</li>
</ul></li>
</ol>
<p><strong>How to improve BOTH confidence AND precision?</strong></p>
<ul>
<li>Increase sample size (n)! Larger n ‚Üí smaller SE ‚Üí narrower intervals at any confidence level</li>
<li>With n = 684 (4√ó larger), the 95% CI would be approximately half as wide</li>
</ul>
<p><strong>Trade-off:</strong> Higher confidence ‚Üí wider intervals</p>
<ul>
<li>90% CI: Narrower, but less confident</li>
<li>95% CI: Standard choice (most common)</li>
<li>99% CI: Wider, but more confident</li>
</ul>
<p>Let‚Äôs compare:</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare confidence intervals at different levels</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>conf_levels <span class="op">=</span> [<span class="fl">0.90</span>, <span class="fl">0.95</span>, <span class="fl">0.99</span>]</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"CONFIDENCE INTERVALS AT DIFFERENT LEVELS"</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'Level'</span><span class="sc">:&lt;10}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'Lower Bound'</span><span class="sc">:&gt;15}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'Upper Bound'</span><span class="sc">:&gt;15}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'Width'</span><span class="sc">:&gt;15}</span><span class="ss">"</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> conf <span class="kw">in</span> conf_levels:</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    alpha <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> conf</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    t_crit <span class="op">=</span> stats.t.ppf(<span class="dv">1</span> <span class="op">-</span> alpha<span class="op">/</span><span class="dv">2</span>, n <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    ci_lower <span class="op">=</span> mean_earnings <span class="op">-</span> t_crit <span class="op">*</span> se_earnings</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    ci_upper <span class="op">=</span> mean_earnings <span class="op">+</span> t_crit <span class="op">*</span> se_earnings</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    width <span class="op">=</span> ci_upper <span class="op">-</span> ci_lower</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>conf<span class="op">*</span><span class="dv">100</span><span class="sc">:.0f}</span><span class="ss">%</span><span class="sc">{</span>ci_lower<span class="sc">:</span><span class="op">&gt;</span><span class="dv">18</span><span class="sc">,</span><span class="fl">.2</span><span class="er">f</span><span class="sc">}{</span>ci_upper<span class="sc">:</span><span class="op">&gt;</span><span class="dv">18</span><span class="sc">,</span><span class="fl">.2</span><span class="er">f</span><span class="sc">}{</span>width<span class="sc">:</span><span class="op">&gt;</span><span class="dv">18</span><span class="sc">,</span><span class="fl">.2</span><span class="er">f</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">üìä Notice: Higher confidence ‚Üí wider interval ‚Üí less precision"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
CONFIDENCE INTERVALS AT DIFFERENT LEVELS
======================================================================
Level          Lower Bound     Upper Bound           Width
----------------------------------------------------------------------
90%         38,184.17         44,641.21          6,457.03
95%         37,559.21         45,266.17          7,706.97
99%         36,327.35         46,498.03         10,170.68

üìä Notice: Higher confidence ‚Üí wider interval ‚Üí less precision</code></pre>
</div>
</div>
<p><em>Now that we understand confidence intervals, let‚Äôs formalize the process of testing specific hypotheses about the population mean.</em></p>
</section>
</section>
<section id="two-sided-hypothesis-tests" class="level2">
<h2 class="anchored" data-anchor-id="two-sided-hypothesis-tests">4.4 Two-Sided Hypothesis Tests</h2>
<p>A <strong>hypothesis test</strong> evaluates whether a specific claim about Œº is plausible given our sample data.</p>
<p><strong>Structure of a hypothesis test:</strong></p>
<ul>
<li><strong>Null hypothesis</strong> H‚ÇÄ: The claim we‚Äôre testing (e.g., Œº = $40,000)</li>
<li><strong>Alternative hypothesis</strong> H‚Çê: What we conclude if we reject H‚ÇÄ (e.g., Œº ‚â† $40,000)</li>
<li><strong>Significance level</strong> Œ±: Maximum probability of Type I error we‚Äôll tolerate (typically 0.05)</li>
</ul>
<p><strong>Test statistic:</strong> <span class="math display">\[t = \frac{\bar{x} - \mu_0}{\text{se}(\bar{x})}\]</span></p>
<p>Where Œº‚ÇÄ is the hypothesized value.</p>
<p><strong>Two ways to make a decision:</strong></p>
<ol type="1">
<li><strong>p-value approach:</strong>
<ul>
<li>p-value = probability of observing a t-statistic at least as extreme as ours, assuming H‚ÇÄ is true</li>
<li>Reject H‚ÇÄ if p-value &lt; Œ±</li>
</ul></li>
<li><strong>Critical value approach:</strong>
<ul>
<li>Critical value c = <span class="math inline">\(t_{n-1, \alpha/2}\)</span></li>
<li>Reject H‚ÇÄ if |t| &gt; c</li>
</ul></li>
</ol>
<p>Both methods always give the same conclusion.</p>
<p><strong>Example:</strong> Test whether population mean earnings equal $40,000.</p>
<blockquote class="blockquote">
<p><strong>Key Concept 4.4: Hypothesis Testing Framework</strong></p>
<p>A hypothesis test evaluates whether data provide sufficient evidence to reject a specific claim (H‚ÇÄ) about a parameter. The t-statistic measures how many standard errors the estimate is from the hypothesized value. The p-value is the probability of observing a result at least as extreme as ours, assuming H‚ÇÄ is true. Small p-values (&lt; Œ±, typically 0.05) provide evidence against H‚ÇÄ, leading us to reject it.</p>
</blockquote>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Two-sided hypothesis test: H0: Œº = $40,000 vs Ha: Œº ‚â† $40,000</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>mu0 <span class="op">=</span> <span class="dv">40000</span>  <span class="co"># Hypothesized value</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>t_stat <span class="op">=</span> (mean_earnings <span class="op">-</span> mu0) <span class="op">/</span> se_earnings</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>p_value <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> stats.t.cdf(<span class="bu">abs</span>(t_stat), n <span class="op">-</span> <span class="dv">1</span>))  <span class="co"># Two-sided p-value</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>t_crit_95 <span class="op">=</span> stats.t.ppf(<span class="fl">0.975</span>, n <span class="op">-</span> <span class="dv">1</span>)  <span class="co"># Critical value for Œ± = 0.05</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"TWO-SIDED HYPOTHESIS TEST"</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"H‚ÇÄ: Œº = $</span><span class="sc">{</span>mu0<span class="sc">:,}</span><span class="ss">"</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"H‚Çê: Œº ‚â† $</span><span class="sc">{</span>mu0<span class="sc">:,}</span><span class="ss">"</span>)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Significance level Œ± = 0.05"</span>)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Sample Statistics:"</span>)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Sample mean:      $</span><span class="sc">{</span>mean_earnings<span class="sc">:,</span><span class="fl">.2</span><span class="er">f</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Standard error:   $</span><span class="sc">{</span>se_earnings<span class="sc">:,</span><span class="fl">.2</span><span class="er">f</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Test Results:"</span>)</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  t-statistic:       </span><span class="sc">{</span>t_stat<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  p-value:           </span><span class="sc">{</span>p_value<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Critical value:    ¬±</span><span class="sc">{</span>t_crit_95<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Decision:"</span>)</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  p-value approach:  </span><span class="sc">{</span>p_value<span class="sc">:.4f}</span><span class="ss"> &gt; 0.05 ‚Üí Do not reject H‚ÇÄ"</span>)</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Critical approach: |</span><span class="sc">{</span>t_stat<span class="sc">:.4f}</span><span class="ss">| &lt; </span><span class="sc">{</span>t_crit_95<span class="sc">:.4f}</span><span class="ss"> ‚Üí Do not reject H‚ÇÄ"</span>)</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Conclusion: We do not have sufficient evidence to reject the claim"</span>)</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"that population mean earnings equal $</span><span class="sc">{</span>mu0<span class="sc">:,}</span><span class="ss">."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
TWO-SIDED HYPOTHESIS TEST
======================================================================
H‚ÇÄ: Œº = $40,000
H‚Çê: Œº ‚â† $40,000
Significance level Œ± = 0.05

Sample Statistics:
  Sample mean:      $41,412.69
  Standard error:   $1,952.10

Test Results:
  t-statistic:       0.7237
  p-value:           0.4703
  Critical value:    ¬±1.9740

Decision:
  p-value approach:  0.4703 &gt; 0.05 ‚Üí Do not reject H‚ÇÄ
  Critical approach: |0.7237| &lt; 1.9740 ‚Üí Do not reject H‚ÇÄ

Conclusion: We do not have sufficient evidence to reject the claim
that population mean earnings equal $40,000.</code></pre>
</div>
</div>
<p><strong>Test Results: H‚ÇÄ: Œº = $40,000 vs H‚Çê: Œº ‚â† $40,000</strong></p>
<ul>
<li>t-statistic: 0.7237</li>
<li>p-value: 0.4703</li>
<li>Critical value: ¬±1.9740</li>
<li>Decision: Do NOT reject H‚ÇÄ</li>
</ul>
<p><strong>What does this mean?</strong></p>
<p>We tested whether the population mean earnings equal $40,000. Based on our sample data (mean = $41,413), we do NOT have sufficient evidence to reject this claim.</p>
<p><strong>Understanding the p-value (0.4703):</strong></p>
<p>The p-value answers: ‚ÄúIf the true population mean really is $40,000, what‚Äôs the probability of observing a sample mean at least as far from $40,000 as ours ($41,413)?‚Äù</p>
<ul>
<li>p-value = 0.4703 = 47.03%</li>
<li>This is quite HIGH ‚Üí the data are consistent with H‚ÇÄ</li>
<li>Interpretation: If Œº truly equals $40,000, we‚Äôd see a sample mean this extreme about 47% of the time just due to random sampling</li>
</ul>
<p><strong>Two equivalent decision rules:</strong></p>
<ol type="1">
<li><strong>p-value approach:</strong>
<ul>
<li>p-value (0.4703) &gt; Œ± (0.05) ‚Üí Do not reject H‚ÇÄ</li>
<li>The evidence against H‚ÇÄ is weak</li>
</ul></li>
<li><strong>Critical value approach:</strong>
<ul>
<li>|t-statistic| = |0.7237| &lt; 1.9740 ‚Üí Do not reject H‚ÇÄ</li>
<li>Our t-statistic falls in the ‚Äúnon-rejection region‚Äù</li>
</ul></li>
</ol>
<p><strong>Why did we fail to reject?</strong></p>
<ul>
<li>Our sample mean ($41,413) is only $1,413 above the hypothesized value ($40,000)</li>
<li>Given the standard error ($1,952), this difference is less than 1 SE away</li>
<li>This is well within the range of normal sampling variation</li>
<li>The difference is NOT statistically significant at Œ± = 0.05</li>
</ul>
<p><strong>Does this prove Œº = $40,000?</strong></p>
<p>NO! We never ‚Äúprove‚Äù or ‚Äúaccept‚Äù the null hypothesis. We simply say:</p>
<ul>
<li>The data are consistent with Œº = $40,000</li>
<li>We lack sufficient evidence to conclude otherwise</li>
<li>Other values (e.g., $41,000, $42,000) are also consistent with our data</li>
</ul>
<p><strong>Connection to confidence interval:</strong></p>
<p>Notice that $40,000 IS inside our 95% CI [$37,559, $45,266]. This is no coincidence:</p>
<ul>
<li>Any value inside the 95% CI will NOT be rejected at Œ± = 0.05 (two-sided test)</li>
<li>Any value outside the 95% CI WILL be rejected at Œ± = 0.05</li>
</ul>
<section id="visualizing-the-two-sided-hypothesis-test" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-the-two-sided-hypothesis-test">Visualizing the two-sided hypothesis test</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize two-sided hypothesis test</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">500</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> stats.t.pdf(x, n <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the t-distribution</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>ax.plot(x, y, <span class="st">'b-'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="ss">f't(</span><span class="sc">{</span>n<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">) distribution'</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Mark the observed t-statistic</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>ax.axvline(x<span class="op">=</span>t_stat, color<span class="op">=</span><span class="st">'red'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, linestyle<span class="op">=</span><span class="st">'--'</span>,</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>           label<span class="op">=</span><span class="ss">f'Observed t = </span><span class="sc">{</span>t_stat<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Mark critical values</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>ax.axvline(x<span class="op">=</span>t_crit_95, color<span class="op">=</span><span class="st">'green'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>, linestyle<span class="op">=</span><span class="st">':'</span>,</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>           label<span class="op">=</span><span class="ss">f'Critical values = ¬±</span><span class="sc">{</span>t_crit_95<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>ax.axvline(x<span class="op">=-</span>t_crit_95, color<span class="op">=</span><span class="st">'green'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>, linestyle<span class="op">=</span><span class="st">':'</span>)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Shade rejection regions (both tails)</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>x_reject_lower <span class="op">=</span> x[x <span class="op">&lt;</span> <span class="op">-</span>t_crit_95]</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>x_reject_upper <span class="op">=</span> x[x <span class="op">&gt;</span> t_crit_95]</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>ax.fill_between(x_reject_lower, <span class="dv">0</span>, stats.t.pdf(x_reject_lower, n<span class="op">-</span><span class="dv">1</span>),</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>                alpha<span class="op">=</span><span class="fl">0.3</span>, color<span class="op">=</span><span class="st">'red'</span>, label<span class="op">=</span><span class="st">'Rejection region (Œ±/2 = 0.025 each tail)'</span>)</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>ax.fill_between(x_reject_upper, <span class="dv">0</span>, stats.t.pdf(x_reject_upper, n<span class="op">-</span><span class="dv">1</span>),</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>                alpha<span class="op">=</span><span class="fl">0.3</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'t-statistic'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Density'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Two-Sided Hypothesis Test Visualization'</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>ax.legend(fontsize<span class="op">=</span><span class="dv">9</span>, loc<span class="op">=</span><span class="st">'upper right'</span>)</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">üìä Interpretation:"</span>)</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   Our t-statistic (</span><span class="sc">{</span>t_stat<span class="sc">:.2f}</span><span class="ss">) falls INSIDE the critical region,"</span>)</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   so we do NOT reject H‚ÇÄ. The data are consistent with Œº = $</span><span class="sc">{</span>mu0<span class="sc">:,}</span><span class="ss">."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="type-i-error-type-ii-error-and-statistical-power" class="level3">
<h3 class="anchored" data-anchor-id="type-i-error-type-ii-error-and-statistical-power">Type I Error, Type II Error, and Statistical Power</h3>
<p><strong>The Four Possible Outcomes of a Hypothesis Test:</strong></p>
<p>When we conduct a hypothesis test, there are four possible scenarios:</p>
<table class="table">
<colgroup>
<col style="width: 30%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>H‚ÇÄ is TRUE</strong> (in reality)</th>
<th><strong>H‚ÇÄ is FALSE</strong> (in reality)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Reject H‚ÇÄ</strong> (decision)</td>
<td>Type I Error (Œ±)</td>
<td>Correct Decision (Power)</td>
</tr>
<tr class="even">
<td><strong>Do not reject H‚ÇÄ</strong></td>
<td>Correct Decision (1-Œ±)</td>
<td>Type II Error (Œ≤)</td>
</tr>
</tbody>
</table>
<p><strong>Type I Error (False Positive):</strong></p>
<ul>
<li>Definition: Rejecting H‚ÇÄ when it‚Äôs actually true</li>
<li>Probability: Œ± (significance level)</li>
<li>In our earnings example: Concluding Œº ‚â† $40,000 when it actually equals $40,000</li>
<li>We control this: By setting Œ± = 0.05, we accept a 5% chance of Type I error</li>
<li>Consequence: ‚ÄúCrying wolf‚Äù ‚Äî claiming an effect that doesn‚Äôt exist</li>
</ul>
<p><strong>Type II Error (False Negative):</strong></p>
<ul>
<li>Definition: Failing to reject H‚ÇÄ when it‚Äôs actually false</li>
<li>Probability: Œ≤ (depends on sample size, effect size, and Œ±)</li>
<li>In our earnings example: Concluding Œº = $40,000 when it actually differs</li>
<li>Harder to control directly</li>
<li>Consequence: Missing a real effect</li>
</ul>
<p><strong>Statistical Power:</strong></p>
<ul>
<li>Definition: Power = 1 - Œ≤ = Probability of correctly rejecting false H‚ÇÄ</li>
<li>Interpretation: Probability of detecting a real effect when it exists</li>
<li>Typical target: 80% power (Œ≤ = 0.20)</li>
<li>Higher power ‚Üí lower chance of Type II error</li>
</ul>
<p><strong>The Trade-off Between Type I and Type II Errors:</strong></p>
<p>You cannot minimize both simultaneously:</p>
<ul>
<li><p><strong>Decrease Œ±</strong> (e.g., from 0.05 to 0.01):</p></li>
<li><p>Lower chance of Type I error (false positive)</p></li>
<li><p>Higher chance of Type II error (false negative)</p></li>
<li><p>Lower statistical power</p></li>
<li><p><strong>Increase Œ±</strong> (e.g., from 0.05 to 0.10):</p></li>
<li><p>Higher statistical power</p></li>
<li><p>Lower chance of Type II error</p></li>
<li><p>Higher chance of Type I error</p></li>
</ul>
<p><strong>How to improve power WITHOUT increasing Type I error:</strong></p>
<ol type="1">
<li><strong>Increase sample size:</strong></li>
</ol>
<ul>
<li>Larger n ‚Üí smaller SE ‚Üí easier to detect real effects</li>
<li>Our earnings data: n = 171, SE = $1,952</li>
<li>If n = 684 (4√ó larger): SE = $976 (half as large)</li>
<li>Same effect size would yield t-statistic twice as large</li>
</ul>
<ol start="2" type="1">
<li><strong>Study larger effects:</strong></li>
</ol>
<ul>
<li>Easier to detect large differences than small ones</li>
<li>Testing Œº = $30,000 vs Œº = $41,413 would have higher power</li>
<li>Testing Œº = $40,000 vs Œº = $41,413 has lower power</li>
</ul>
<ol start="3" type="1">
<li><strong>Use one-sided tests (when appropriate):</strong></li>
</ol>
<ul>
<li>Concentrates Œ± in one tail ‚Üí higher power in that direction</li>
<li>But: Cannot detect effects in the opposite direction</li>
</ul>
<p><strong>In our examples:</strong></p>
<ol type="1">
<li><strong>Earnings test (non-significant):</strong></li>
</ol>
<ul>
<li>Could be: Œº truly equals $40,000 (correct decision)</li>
<li>Or could be: Type II error (Œº differs but we didn‚Äôt detect it)</li>
<li>With more data, we might detect the difference</li>
</ul>
<ol start="2" type="1">
<li><strong>Gas price test (significant):</strong></li>
</ol>
<ul>
<li>High power due to small SE ($0.0267) and reasonable sample size (n=32)</li>
<li>Successfully detected a real difference</li>
<li>Low probability this is a Type I error (p &lt; 0.0001)</li>
</ul>
<p><strong>Practical advice:</strong></p>
<ul>
<li><strong>Planning stage:</strong> Calculate required sample size for desired power</li>
<li><strong>Design stage:</strong> Set Œ± based on consequences of Type I vs Type II errors</li>
<li>Medical trials: Type I error very costly ‚Üí use Œ± = 0.01</li>
<li>Exploratory research: Type II error costly ‚Üí use Œ± = 0.10</li>
<li><strong>Interpretation stage:</strong> Non-significant results don‚Äôt prove H‚ÇÄ is true (could be Type II error)</li>
</ul>
</section>
</section>
<section id="hypothesis-test-examples" class="level2">
<h2 class="anchored" data-anchor-id="hypothesis-test-examples">4.5 Hypothesis Test Examples</h2>
<p>Let‚Äôs apply hypothesis testing to three real-world economic questions.</p>
<section id="example-1-gasoline-prices" class="level3">
<h3 class="anchored" data-anchor-id="example-1-gasoline-prices">Example 1: Gasoline Prices</h3>
<p><strong>Question:</strong> Are gasoline prices in Yolo County different from the California state average?</p>
<ul>
<li>California average: $3.81/gallon</li>
<li>Sample: 32 gas stations in Yolo County</li>
<li>Test: H‚ÇÄ: Œº = 3.81 vs H‚Çê: Œº ‚â† 3.81</li>
</ul>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load and test gasoline price data</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>data_gasprice <span class="op">=</span> pd.read_stata(GITHUB_DATA_URL <span class="op">+</span> <span class="st">'AED_GASPRICE.DTA'</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>price <span class="op">=</span> data_gasprice[<span class="st">'price'</span>]</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>mean_price <span class="op">=</span> price.mean()</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>std_price <span class="op">=</span> price.std(ddof<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>n_price <span class="op">=</span> <span class="bu">len</span>(price)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>se_price <span class="op">=</span> std_price <span class="op">/</span> np.sqrt(n_price)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>mu0_price <span class="op">=</span> <span class="fl">3.81</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>t_stat_price <span class="op">=</span> (mean_price <span class="op">-</span> mu0_price) <span class="op">/</span> se_price</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>p_value_price <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> stats.t.cdf(<span class="bu">abs</span>(t_stat_price), n_price <span class="op">-</span> <span class="dv">1</span>))</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"EXAMPLE 1: GASOLINE PRICES"</span>)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"H‚ÇÄ: Œº = $</span><span class="sc">{</span>mu0_price<span class="sc">:.2f}</span><span class="ss"> (CA state average)"</span>)</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"H‚Çê: Œº ‚â† $</span><span class="sc">{</span>mu0_price<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Sample size:       </span><span class="sc">{</span>n_price<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sample mean:      $</span><span class="sc">{</span>mean_price<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Std error:        $</span><span class="sc">{</span>se_price<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"t-statistic:       </span><span class="sc">{</span>t_stat_price<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"p-value:           </span><span class="sc">{</span>p_value_price<span class="sc">:.6f}</span><span class="ss">"</span>)</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Decision: p-value &lt; 0.05 ‚Üí </span><span class="sc">{</span><span class="st">'REJECT H‚ÇÄ'</span> <span class="cf">if</span> p_value_price <span class="op">&lt;</span> <span class="fl">0.05</span> <span class="cf">else</span> <span class="st">'Do not reject H‚ÇÄ'</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Conclusion: Yolo County gas prices ARE </span><span class="sc">{</span><span class="st">'significantly '</span> <span class="cf">if</span> p_value_price <span class="op">&lt;</span> <span class="fl">0.05</span> <span class="cf">else</span> <span class="st">'NOT significantly '</span><span class="sc">}</span><span class="ss">different from CA average."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
EXAMPLE 1: GASOLINE PRICES
======================================================================
H‚ÇÄ: Œº = $3.81 (CA state average)
H‚Çê: Œº ‚â† $3.81

Sample size:       32
Sample mean:      $3.6697
Std error:        $0.0267
t-statistic:       -5.2577
p-value:           0.000010

Decision: p-value &lt; 0.05 ‚Üí REJECT H‚ÇÄ

Conclusion: Yolo County gas prices ARE significantly different from CA average.</code></pre>
</div>
</div>
<p><strong>Test Results: H‚ÇÄ: Œº = $3.81 vs H‚Çê: Œº ‚â† $3.81</strong></p>
<ul>
<li>Sample mean: $3.6697</li>
<li>t-statistic: -5.2577</li>
<li>p-value: 0.0000 (actually &lt; 0.0001)</li>
<li>Decision: REJECT H‚ÇÄ at Œ± = 0.05</li>
</ul>
<p><strong>This is a STATISTICALLY SIGNIFICANT result!</strong></p>
<p>Unlike our earnings example, here we have strong evidence that Yolo County gas prices differ from the California state average of $3.81.</p>
<p><strong>Understanding the strong evidence:</strong></p>
<ol type="1">
<li><strong>Large t-statistic (-5.26):</strong>
<ul>
<li>The sample mean ($3.67) is 5.26 standard errors below the hypothesized value ($3.81)</li>
<li>This is far beyond the critical value (¬±2.04)</li>
<li>Such extreme values rarely occur by chance alone</li>
</ul></li>
<li><strong>Tiny p-value (&lt; 0.0001):</strong>
<ul>
<li>If Œº truly equaled $3.81, the probability of observing a sample mean this extreme is less than 0.01%</li>
<li>This is MUCH smaller than Œ± = 0.05 (5%)</li>
<li>Strong evidence against H‚ÇÄ</li>
</ul></li>
<li><strong>Direction matters:</strong>
<ul>
<li>The negative t-statistic tells us Yolo County prices are LOWER than the state average</li>
<li>Difference: $3.81 - $3.67 = $0.14 per gallon cheaper</li>
</ul></li>
</ol>
<p><strong>Statistical vs Practical Significance:</strong></p>
<ul>
<li><strong>Statistical significance:</strong> Yes, we can confidently say Yolo County prices differ from $3.81 (p &lt; 0.0001)</li>
<li><strong>Practical significance:</strong> Is 14 cents per gallon meaningful?
<ul>
<li>For a 15-gallon tank: $2.10 savings</li>
<li>Over a year (52 fill-ups): $109 savings</li>
<li>This IS economically meaningful for consumers!</li>
</ul></li>
</ul>
<p><strong>Why is this result so strong compared to the earnings test?</strong></p>
<ul>
<li>The standard error is very small ($0.0267) relative to the difference we‚Äôre testing</li>
<li>This gives us high <strong>statistical power</strong> to detect the difference</li>
<li>Even though the dollar difference is small ($0.14), it‚Äôs precisely estimated</li>
</ul>
<p><strong>Type I vs Type II Errors in this context:</strong></p>
<ul>
<li><strong>Type I Error:</strong> Concluding Yolo County prices differ when they actually don‚Äôt
<ul>
<li>Probability = Œ± = 0.05 (5% chance if we reject)</li>
<li>But our p-value is &lt; 0.0001, so we‚Äôre very confident we‚Äôre not making this error</li>
</ul></li>
<li><strong>Type II Error:</strong> Concluding prices don‚Äôt differ when they actually do
<ul>
<li>Not relevant here since we rejected H‚ÇÄ</li>
<li>This test had high power to detect real differences</li>
</ul></li>
</ul>
<blockquote class="blockquote">
<p><strong>Key Concept 4.5: Statistical Significance vs.&nbsp;Sample Size</strong></p>
<p>Even small practical differences can be statistically significant with large samples (n=53 gas stations). The gasoline price difference of $0.14 might seem trivial, but: - The <strong>standard error is small</strong> ($0.0267), giving precise estimates - The <strong>t-statistic is large</strong> (-5.26), indicating the difference is many standard errors from zero - This demonstrates <strong>high statistical power</strong>‚Äîthe ability to detect even small real effects</p>
<p>Statistical significance answers ‚ÄúIs there a difference?‚Äù while practical significance asks ‚ÄúDoes the difference matter?‚Äù Both questions are important in econometrics.</p>
</blockquote>
</section>
<section id="example-2-male-earnings" class="level3">
<h3 class="anchored" data-anchor-id="example-2-male-earnings">Example 2: Male Earnings</h3>
<p><strong>Question:</strong> Do 30-year-old men earn more than $50,000 on average?</p>
<ul>
<li>Claim: Œº &gt; $50,000 (set as alternative hypothesis)</li>
<li>Sample: 191 men</li>
<li>Test: H‚ÇÄ: Œº ‚â§ 50,000 vs H‚Çê: Œº &gt; 50,000 (one-sided, covered in section 4.6)</li>
</ul>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load and test male earnings data</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>data_male <span class="op">=</span> pd.read_stata(GITHUB_DATA_URL <span class="op">+</span> <span class="st">'AED_EARNINGSMALE.DTA'</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>earnings_male <span class="op">=</span> data_male[<span class="st">'earnings'</span>]</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>mean_male <span class="op">=</span> earnings_male.mean()</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>std_male <span class="op">=</span> earnings_male.std(ddof<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>n_male <span class="op">=</span> <span class="bu">len</span>(earnings_male)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>se_male <span class="op">=</span> std_male <span class="op">/</span> np.sqrt(n_male)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>mu0_male <span class="op">=</span> <span class="dv">50000</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>t_stat_male <span class="op">=</span> (mean_male <span class="op">-</span> mu0_male) <span class="op">/</span> se_male</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>p_value_male <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> stats.t.cdf(<span class="bu">abs</span>(t_stat_male), n_male <span class="op">-</span> <span class="dv">1</span>))  <span class="co"># Two-sided for now</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"EXAMPLE 2: MALE EARNINGS (Two-sided test shown)"</span>)</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"H‚ÇÄ: Œº = $</span><span class="sc">{</span>mu0_male<span class="sc">:,}</span><span class="ss">"</span>)</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"H‚Çê: Œº ‚â† $</span><span class="sc">{</span>mu0_male<span class="sc">:,}</span><span class="ss">"</span>)</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Sample size:       </span><span class="sc">{</span>n_male<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sample mean:      $</span><span class="sc">{</span>mean_male<span class="sc">:,</span><span class="fl">.2</span><span class="er">f</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Std error:        $</span><span class="sc">{</span>se_male<span class="sc">:,</span><span class="fl">.2</span><span class="er">f</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"t-statistic:       </span><span class="sc">{</span>t_stat_male<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"p-value:           </span><span class="sc">{</span>p_value_male<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Decision: p-value &gt; 0.05 ‚Üí Do not reject H‚ÇÄ"</span>)</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Note: A one-sided test is more appropriate here (see section 4.6)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
EXAMPLE 2: MALE EARNINGS (Two-sided test shown)
======================================================================
H‚ÇÄ: Œº = $50,000
H‚Çê: Œº ‚â† $50,000

Sample size:       191
Sample mean:      $52,353.93
Std error:        $4,705.75
t-statistic:       0.5002
p-value:           0.6175

Decision: p-value &gt; 0.05 ‚Üí Do not reject H‚ÇÄ

Note: A one-sided test is more appropriate here (see section 4.6)</code></pre>
</div>
</div>
<p><strong>Test Results: H‚ÇÄ: Œº = $50,000 vs H‚Çê: Œº ‚â† $50,000</strong></p>
<ul>
<li>Sample mean: (actual value from code output)</li>
<li>t-statistic: (actual value from code output)</li>
<li>p-value: &gt; 0.05 (not statistically significant)</li>
<li>Decision: DO NOT REJECT H‚ÇÄ at Œ± = 0.05</li>
</ul>
<p><strong>This is NOT a statistically significant result.</strong></p>
<p>We do not have sufficient evidence to conclude that 30-year-old men earn differently than $50,000 on average. This does NOT mean they earn exactly $50,000‚Äîit means our data are consistent with that value.</p>
<p><strong>Understanding the lack of significance:</strong></p>
<ol type="1">
<li><strong>Moderate t-statistic:</strong>
<ul>
<li>The sample mean is not far enough from $50,000 (in standard error units) to confidently reject H‚ÇÄ</li>
<li>The observed difference could plausibly arise from random sampling variation alone</li>
</ul></li>
<li><strong>Large p-value (&gt; 0.05):</strong>
<ul>
<li>If Œº truly equaled $50,000, observing a sample mean like ours is quite probable</li>
<li>We don‚Äôt have strong evidence against H‚ÇÄ</li>
<li>p &gt; Œ±, so we fail to reject</li>
</ul></li>
<li><strong>What ‚Äúfail to reject‚Äù means:</strong>
<ul>
<li>We‚Äôre NOT proving Œº = $50,000</li>
<li>We‚Äôre saying the data don‚Äôt provide convincing evidence that Œº ‚â† $50,000</li>
<li>Absence of evidence is not evidence of absence</li>
</ul></li>
</ol>
<p><strong>Statistical vs Practical Significance:</strong></p>
<ul>
<li><strong>Statistical significance:</strong> No, we cannot confidently say mean earnings differ from $50,000 (p &gt; 0.05)</li>
<li><strong>Practical considerations:</strong>
<ul>
<li>The sample mean might be close to $50,000 anyway</li>
<li>Or the sample size (n=191) might not provide enough precision to detect a modest difference</li>
<li>Or there‚Äôs genuine variability in the population making the effect hard to pin down</li>
</ul></li>
</ul>
<p><strong>Why might we fail to reject H‚ÇÄ?</strong></p>
<p>Three possible explanations:</p>
<ol type="1">
<li><strong>H‚ÇÄ is actually true:</strong> Mean earnings truly are around $50,000</li>
<li><strong>Insufficient power:</strong> Real difference exists, but our sample size is too small to detect it</li>
<li><strong>High variability:</strong> Earnings have large standard deviation, making precise inference difficult</li>
</ol>
<p><strong>Note on directional hypothesis:</strong></p>
<p>The question asks ‚ÄúDo men earn MORE than $50,000?‚Äù which suggests a <strong>one-sided test</strong> (H‚ÇÄ: Œº ‚â§ 50,000 vs H‚Çê: Œº &gt; 50,000). The code note mentions this will be covered in section 4.6. One-sided tests have more power to detect effects in a specific direction.</p>
<blockquote class="blockquote">
<p><strong>Key Concept 4.6: ‚ÄúFail to Reject‚Äù Does Not Mean ‚ÄúAccept‚Äù</strong></p>
<p>When p &gt; Œ±, we <strong>fail to reject H‚ÇÄ</strong>, but this does NOT mean we ‚Äúaccept H‚ÇÄ‚Äù or prove it‚Äôs true. Three key reasons:</p>
<ol type="1">
<li><strong>Limited evidence:</strong> Our sample might simply lack the power to detect a real difference</li>
<li><strong>Type II error risk:</strong> We might be making a Type II error (failing to reject a false H‚ÇÄ)</li>
<li><strong>Confidence intervals are more informative:</strong> A 95% CI tells us the plausible range for Œº, not just ‚Äúdifferent or not different‚Äù</li>
</ol>
<p>In econometrics, ‚Äúfail to reject‚Äù means ‚Äúthe data are consistent with H‚ÇÄ, but we can‚Äôt rule out alternatives.‚Äù Always interpret non-significant results with appropriate caution.</p>
</blockquote>
</section>
<section id="example-3-gdp-growth" class="level3">
<h3 class="anchored" data-anchor-id="example-3-gdp-growth">Example 3: GDP Growth</h3>
<p><strong>Question:</strong> Did real GDP per capita grow at 2.0% per year on average from 1960-2020?</p>
<ul>
<li>Historical claim: 2.0% annual growth</li>
<li>Sample: 241 year-to-year growth rates</li>
<li>Test: H‚ÇÄ: Œº = 2.0 vs H‚Çê: Œº ‚â† 2.0</li>
</ul>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load and test GDP growth data</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>data_gdp <span class="op">=</span> pd.read_stata(GITHUB_DATA_URL <span class="op">+</span> <span class="st">'AED_REALGDPPC.DTA'</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>growth <span class="op">=</span> data_gdp[<span class="st">'growth'</span>]</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>mean_growth <span class="op">=</span> growth.mean()</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>std_growth <span class="op">=</span> growth.std(ddof<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>n_growth <span class="op">=</span> <span class="bu">len</span>(growth)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>se_growth <span class="op">=</span> std_growth <span class="op">/</span> np.sqrt(n_growth)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>mu0_growth <span class="op">=</span> <span class="fl">2.0</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>t_stat_growth <span class="op">=</span> (mean_growth <span class="op">-</span> mu0_growth) <span class="op">/</span> se_growth</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>p_value_growth <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> stats.t.cdf(<span class="bu">abs</span>(t_stat_growth), n_growth <span class="op">-</span> <span class="dv">1</span>))</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"EXAMPLE 3: REAL GDP PER CAPITA GROWTH"</span>)</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"H‚ÇÄ: Œº = </span><span class="sc">{</span>mu0_growth<span class="sc">:.1f}</span><span class="ss">%"</span>)</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"H‚Çê: Œº ‚â† </span><span class="sc">{</span>mu0_growth<span class="sc">:.1f}</span><span class="ss">%"</span>)</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Sample size:       </span><span class="sc">{</span>n_growth<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sample mean:       </span><span class="sc">{</span>mean_growth<span class="sc">:.4f}</span><span class="ss">%"</span>)</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Std error:         </span><span class="sc">{</span>se_growth<span class="sc">:.4f}</span><span class="ss">%"</span>)</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"t-statistic:       </span><span class="sc">{</span>t_stat_growth<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"p-value:           </span><span class="sc">{</span>p_value_growth<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Decision: p-value &gt; 0.05 ‚Üí Do not reject H‚ÇÄ"</span>)</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Conclusion: The data are consistent with 2.0% average annual growth."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
EXAMPLE 3: REAL GDP PER CAPITA GROWTH
======================================================================
H‚ÇÄ: Œº = 2.0%
H‚Çê: Œº ‚â† 2.0%

Sample size:       245
Sample mean:       1.9905%
Std error:         0.1392%
t-statistic:       -0.0686
p-value:           0.9454

Decision: p-value &gt; 0.05 ‚Üí Do not reject H‚ÇÄ

Conclusion: The data are consistent with 2.0% average annual growth.</code></pre>
</div>
</div>
<p><strong>Test Results: H‚ÇÄ: Œº = 2.0% vs H‚Çê: Œº ‚â† 2.0%</strong></p>
<ul>
<li>Sample mean: (actual value from code output)</li>
<li>t-statistic: (actual value from code output)</li>
<li>p-value: &gt; 0.05 (not statistically significant)</li>
<li>Decision: DO NOT REJECT H‚ÇÄ at Œ± = 0.05</li>
</ul>
<p><strong>The data are consistent with 2.0% average annual growth.</strong></p>
<p>We cannot reject the hypothesis that real GDP per capita grew at 2.0% per year on average from 1960-2020. This historical benchmark appears supported by the data.</p>
<p><strong>Understanding the result:</strong></p>
<ol type="1">
<li><strong>What does ‚Äúconsistent with 2.0%‚Äù mean?</strong>
<ul>
<li>The sample mean growth rate is close enough to 2.0% that random variation could explain the difference</li>
<li>We don‚Äôt have strong evidence that the true mean differs from 2.0%</li>
<li>The p-value &gt; 0.05 indicates this result is plausible under H‚ÇÄ</li>
</ul></li>
<li><strong>Large sample size (n=241 years):</strong>
<ul>
<li>With 241 year-to-year growth rates, we have substantial data</li>
<li>Large samples typically have smaller standard errors and more statistical power</li>
<li>Yet we still fail to reject H‚ÇÄ‚Äîthis suggests the true mean is genuinely close to 2.0%</li>
</ul></li>
<li><strong>Economic interpretation:</strong>
<ul>
<li>The 2.0% benchmark is a common reference point in growth economics</li>
<li>Our data support this conventional wisdom</li>
<li>Long-run economic growth appears remarkably stable around this rate</li>
</ul></li>
</ol>
<p><strong>Statistical vs Practical Significance:</strong></p>
<ul>
<li><strong>Statistical significance:</strong> No, we cannot confidently say mean growth differs from 2.0% (p &gt; 0.05)</li>
<li><strong>Economic significance:</strong>
<ul>
<li>Even small deviations from 2.0% compound dramatically over 60 years</li>
<li>But our data suggest the historical average is indeed close to 2.0%</li>
<li>This consistency validates the use of 2.0% as a benchmark for policy discussions</li>
</ul></li>
</ul>
<p><strong>Why is this result interesting despite being ‚Äúnon-significant‚Äù?</strong></p>
<ol type="1">
<li><strong>Validates a benchmark:</strong> Economic theory often assumes ~2% long-run growth; our data support this</li>
<li><strong>Large sample confidence:</strong> With 241 observations, we can be confident the mean is near 2.0%</li>
<li><strong>Demonstrates stability:</strong> Despite recessions and booms, average growth centers around 2.0%</li>
</ol>
<p><strong>Time series considerations:</strong></p>
<p>GDP growth data are <strong>time series</strong>‚Äîobservations ordered chronologically with potential autocorrelation. Our standard t-test assumes independent observations, which might not fully hold for year-to-year growth rates. Advanced time series methods (Chapter 17) address these dependencies.</p>
<blockquote class="blockquote">
<p><strong>Key Concept 4.7: Context and Consistency in Hypothesis Testing</strong></p>
<p>Statistical results gain meaning only through economic context ‚Äì a statistically significant coefficient matters because of what it implies for policy, behavior, or theory. The hypothesis testing pattern (set up hypotheses, compute test statistic, compare to critical value or p-value) is consistent across diverse applications, from wage analysis to macroeconomic growth.</p>
</blockquote>
<p><em>Having mastered two-sided hypothesis tests, let‚Äôs now consider situations where we have a directional prediction.</em></p>
</section>
</section>
<section id="one-sided-directional-hypothesis-tests" class="level2">
<h2 class="anchored" data-anchor-id="one-sided-directional-hypothesis-tests">4.6 One-Sided Directional Hypothesis Tests</h2>
<p>Sometimes we want to test a <strong>directional</strong> claim:</p>
<ul>
<li>‚ÄúDoes Œº <strong>exceed</strong> a certain value?‚Äù (upper-tailed test)</li>
<li>‚ÄúIs Œº <strong>less than</strong> a certain value?‚Äù (lower-tailed test)</li>
</ul>
<p><strong>Structure:</strong></p>
<ul>
<li><strong>Upper-tailed test:</strong> H‚ÇÄ: Œº ‚â§ Œº* vs H‚Çê: Œº &gt; Œº*</li>
<li><strong>Lower-tailed test:</strong> H‚ÇÄ: Œº ‚â• Œº* vs H‚Çê: Œº &lt; Œº*</li>
</ul>
<p><strong>Key difference from two-sided tests:</strong></p>
<ul>
<li>Rejection region is only in <strong>one tail</strong> of the distribution</li>
<li>p-value calculation uses one tail instead of two</li>
<li>For upper-tailed: p-value = Pr[T ‚â• t]</li>
<li>For lower-tailed: p-value = Pr[T ‚â§ t]</li>
</ul>
<p><strong>Example:</strong> Test whether mean earnings <strong>exceed</strong> $40,000.</p>
<ul>
<li>Claim to be tested: Œº &gt; 40,000 (set as H‚Çê)</li>
<li>Test: H‚ÇÄ: Œº ‚â§ 40,000 vs H‚Çê: Œº &gt; 40,000</li>
</ul>
<blockquote class="blockquote">
<p><strong>Key Concept 4.8: One-Sided Tests</strong></p>
<p>One-sided tests concentrate the rejection region in ONE tail of the distribution, making them more powerful for detecting effects in the specified direction. Use when theory predicts a specific direction. The p-value for a one-sided test is exactly half the two-sided p-value (when the effect is in the predicted direction). Critical values are smaller for one-sided tests (e.g., 1.65 vs ¬±1.96 for Œ±=0.05).</p>
</blockquote>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># One-sided (upper-tailed) test: H0: Œº ‚â§ $40,000 vs Ha: Œº &gt; $40,000</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>mu0 <span class="op">=</span> <span class="dv">40000</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>t_stat <span class="op">=</span> (mean_earnings <span class="op">-</span> mu0) <span class="op">/</span> se_earnings</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>p_value_upper <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> stats.t.cdf(t_stat, n <span class="op">-</span> <span class="dv">1</span>)  <span class="co"># Upper tail only</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>t_crit_upper <span class="op">=</span> stats.t.ppf(<span class="fl">0.95</span>, n <span class="op">-</span> <span class="dv">1</span>)  <span class="co"># One-sided critical value</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"ONE-SIDED HYPOTHESIS TEST (Upper-tailed)"</span>)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"H‚ÇÄ: Œº ‚â§ $</span><span class="sc">{</span>mu0<span class="sc">:,}</span><span class="ss">"</span>)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"H‚Çê: Œº &gt; $</span><span class="sc">{</span>mu0<span class="sc">:,}</span><span class="ss"> (the claim we're testing)"</span>)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Significance level Œ± = 0.05"</span>)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Test Results:"</span>)</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  t-statistic:       </span><span class="sc">{</span>t_stat<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  p-value (upper):   </span><span class="sc">{</span>p_value_upper<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Critical value:    </span><span class="sc">{</span>t_crit_upper<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Decision:"</span>)</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  p-value approach:  </span><span class="sc">{</span>p_value_upper<span class="sc">:.4f}</span><span class="ss"> &gt; 0.05 ‚Üí Do not reject H‚ÇÄ"</span>)</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Critical approach: </span><span class="sc">{</span>t_stat<span class="sc">:.4f}</span><span class="ss"> &lt; </span><span class="sc">{</span>t_crit_upper<span class="sc">:.4f}</span><span class="ss"> ‚Üí Do not reject H‚ÇÄ"</span>)</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Conclusion: We do not have sufficient evidence to support the claim"</span>)</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"that mean earnings exceed $</span><span class="sc">{</span>mu0<span class="sc">:,}</span><span class="ss">."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
ONE-SIDED HYPOTHESIS TEST (Upper-tailed)
======================================================================
H‚ÇÄ: Œº ‚â§ $40,000
H‚Çê: Œº &gt; $40,000 (the claim we're testing)
Significance level Œ± = 0.05

Test Results:
  t-statistic:       0.7237
  p-value (upper):   0.2351
  Critical value:    1.6539

Decision:
  p-value approach:  0.2351 &gt; 0.05 ‚Üí Do not reject H‚ÇÄ
  Critical approach: 0.7237 &lt; 1.6539 ‚Üí Do not reject H‚ÇÄ

Conclusion: We do not have sufficient evidence to support the claim
that mean earnings exceed $40,000.</code></pre>
</div>
</div>
<section id="visualizing-one-sided-test" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-one-sided-test">Visualizing One-Sided Test</h3>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize one-sided hypothesis test</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">500</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> stats.t.pdf(x, n <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the t-distribution</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>ax.plot(x, y, <span class="st">'b-'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="ss">f't(</span><span class="sc">{</span>n<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">) distribution'</span>)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Mark the observed t-statistic</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>ax.axvline(x<span class="op">=</span>t_stat, color<span class="op">=</span><span class="st">'red'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, linestyle<span class="op">=</span><span class="st">'--'</span>,</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>           label<span class="op">=</span><span class="ss">f'Observed t = </span><span class="sc">{</span>t_stat<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Mark critical value (upper tail only)</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>ax.axvline(x<span class="op">=</span>t_crit_upper, color<span class="op">=</span><span class="st">'green'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>, linestyle<span class="op">=</span><span class="st">':'</span>,</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>           label<span class="op">=</span><span class="ss">f'Critical value = </span><span class="sc">{</span>t_crit_upper<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Shade rejection region (upper tail only)</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>x_reject <span class="op">=</span> x[x <span class="op">&gt;</span> t_crit_upper]</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>ax.fill_between(x_reject, <span class="dv">0</span>, stats.t.pdf(x_reject, n<span class="op">-</span><span class="dv">1</span>),</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>                alpha<span class="op">=</span><span class="fl">0.3</span>, color<span class="op">=</span><span class="st">'red'</span>, label<span class="op">=</span><span class="st">'Rejection region (Œ± = 0.05)'</span>)</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'t-statistic'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Density'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'One-Sided Hypothesis Test (Upper-tailed) Visualization'</span>,</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>ax.legend(fontsize<span class="op">=</span><span class="dv">9</span>, loc<span class="op">=</span><span class="st">'upper left'</span>)</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">üìä Interpretation:"</span>)</span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   For an upper-tailed test, we only reject H‚ÇÄ if t is large and POSITIVE."</span>)</span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   Our t-statistic (</span><span class="sc">{</span>t_stat<span class="sc">:.2f}</span><span class="ss">) is below the critical value, so we do not reject."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="ch04_Statistical_Inference_for_the_Mean_files/figure-html/cell-13-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
üìä Interpretation:
   For an upper-tailed test, we only reject H‚ÇÄ if t is large and POSITIVE.
   Our t-statistic (0.72) is below the critical value, so we do not reject.</code></pre>
</div>
</div>
<p><strong>One-Sided Test Results: H‚ÇÄ: Œº ‚â§ $40,000 vs H‚Çê: Œº &gt; $40,000</strong></p>
<ul>
<li>t-statistic: 0.7237 (same as two-sided test)</li>
<li>p-value (one-sided): 0.2351</li>
<li>p-value (two-sided): 0.4703</li>
<li>Critical value (one-sided, Œ±=0.05): 1.6539</li>
<li>Decision: Do NOT reject H‚ÇÄ</li>
</ul>
<p><strong>Key differences from two-sided test:</strong></p>
<ol type="1">
<li><strong>p-value is exactly half:</strong>
<ul>
<li>Two-sided p-value: 0.4703</li>
<li>One-sided p-value: 0.2351 = 0.4703/2</li>
<li>Why? We only count probability in ONE tail (upper tail)</li>
</ul></li>
<li><strong>Critical value is smaller:</strong>
<ul>
<li>Two-sided critical value: ¬±1.9740 (5% split across two tails)</li>
<li>One-sided critical value: 1.6539 (5% all in one tail)</li>
<li>One-sided tests reject H‚ÇÄ more easily in the specified direction</li>
</ul></li>
<li><strong>Directional claim:</strong>
<ul>
<li>Two-sided: ‚ÄúŒº is different from $40,000‚Äù (could be higher OR lower)</li>
<li>One-sided: ‚ÄúŒº exceeds $40,000‚Äù (specifically higher)</li>
</ul></li>
</ol>
<p><strong>When to use one-sided tests?</strong></p>
<p>Use one-sided tests when:</p>
<ul>
<li>Theory or prior research specifies a direction</li>
<li>Example: Testing if a new drug is better (not just different) than placebo</li>
<li>Example: Testing if a policy increases (not just changes) income</li>
</ul>
<p><strong>When NOT to use one-sided tests:</strong></p>
<p>Avoid one-sided tests when:</p>
<ul>
<li>You‚Äôre genuinely interested in detecting differences in either direction</li>
<li>You might want to detect unexpected effects</li>
<li>The field convention is two-sided (economics typically uses two-sided)</li>
</ul>
<p><strong>Warning about one-sided test abuse:</strong></p>
<p>Researchers sometimes use one-sided tests to get ‚Äúsignificant‚Äù results when two-sided tests fail. This is questionable practice:</p>
<ul>
<li>If p (two-sided) = 0.08 ‚Üí not significant at Œ± = 0.05</li>
<li>If p (one-sided) = 0.04 ‚Üí significant at Œ± = 0.05</li>
<li>Switching to one-sided AFTER seeing the data is ‚Äúp-hacking‚Äù</li>
<li>The choice between one-sided and two-sided should be made BEFORE collecting data</li>
</ul>
<p><strong>In our example:</strong></p>
<ul>
<li>Sample mean ($41,413) is above $40,000, consistent with H‚Çê: Œº &gt; $40,000</li>
<li>But p-value (0.2351) &gt; 0.05, so still not significant</li>
<li>The effect is too small relative to sampling variability</li>
<li>We cannot conclude that mean earnings exceed $40,000</li>
</ul>
<p><strong>Power consideration:</strong></p>
<p>One advantage of one-sided tests: greater statistical power in the specified direction</p>
<ul>
<li>If you‚Äôre only interested in detecting Œº &gt; $40,000, the one-sided test is more powerful</li>
<li>Trade-off: Cannot detect effects in the opposite direction</li>
</ul>
</section>
</section>
<section id="proportions-data" class="level2">
<h2 class="anchored" data-anchor-id="proportions-data">4.7 Proportions Data</h2>
<p>The methods extend naturally to <strong>proportions</strong> (binary data).</p>
<p><strong>Example:</strong> Survey data where respondents answer yes (1) or no (0).- Sample proportion: <span class="math inline">\(\hat{p} = \bar{x}\)</span> = fraction of ‚Äúyes‚Äù responses- Standard error: se(<span class="math inline">\(\hat{p}\)</span>) = ‚àö[<span class="math inline">\(\hat{p}\)</span>(1 - <span class="math inline">\(\hat{p}\)</span>)/n]</p>
<p><strong>Confidence interval for population proportion p:</strong><span class="math display">\[\hat{p} \pm z_{\alpha/2} \times \sqrt{\frac{\hat{p}(1-\hat{p})}{n}}\]</span><strong>Note:</strong> For proportions with large n, we use the <strong>normal distribution</strong> (z) instead of t. <strong>Example:</strong> In a sample of 921 voters, 480 intend to vote Democrat. Is this different from 50%?</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportions example</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>n_total <span class="op">=</span> <span class="dv">921</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>n_success <span class="op">=</span> <span class="dv">480</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>p_hat <span class="op">=</span> n_success <span class="op">/</span> n_total</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>se_prop <span class="op">=</span> np.sqrt(p_hat <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> p_hat) <span class="op">/</span> n_total)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 95% Confidence interval</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>z_crit <span class="op">=</span> <span class="fl">1.96</span>  <span class="co"># For 95% CI (normal approximation)</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>ci_lower_prop <span class="op">=</span> p_hat <span class="op">-</span> z_crit <span class="op">*</span> se_prop</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>ci_upper_prop <span class="op">=</span> p_hat <span class="op">+</span> z_crit <span class="op">*</span> se_prop</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"INFERENCE FOR PROPORTIONS"</span>)</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sample size:           </span><span class="sc">{</span>n_total<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Number voting Democrat: </span><span class="sc">{</span>n_success<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sample proportion:     </span><span class="sc">{</span>p_hat<span class="sc">:.4f}</span><span class="ss"> (</span><span class="sc">{</span>p_hat<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%)"</span>)</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Standard error:        </span><span class="sc">{</span>se_prop<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"95% CI:                [</span><span class="sc">{</span>ci_lower_prop<span class="sc">:.4f}</span><span class="ss">, </span><span class="sc">{</span>ci_upper_prop<span class="sc">:.4f}</span><span class="ss">]"</span>)</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"                        [</span><span class="sc">{</span>ci_lower_prop<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%, </span><span class="sc">{</span>ci_upper_prop<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%]"</span>)</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Hypothesis test: H0: p = 0.50</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>p0 <span class="op">=</span> <span class="fl">0.50</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>se_under_h0 <span class="op">=</span> np.sqrt(p0 <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> p0) <span class="op">/</span> n_total)</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>z_stat <span class="op">=</span> (p_hat <span class="op">-</span> p0) <span class="op">/</span> se_under_h0</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>p_value_prop <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> stats.norm.cdf(<span class="bu">abs</span>(z_stat)))</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Hypothesis Test: H‚ÇÄ: p = </span><span class="sc">{</span>p0<span class="sc">:.2f}</span><span class="ss"> (50-50 split)"</span>)</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  z-statistic:       </span><span class="sc">{</span>z_stat<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  p-value:           </span><span class="sc">{</span>p_value_prop<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Decision:          </span><span class="sc">{</span><span class="st">'Reject H‚ÇÄ'</span> <span class="cf">if</span> <span class="bu">abs</span>(z_stat) <span class="op">&gt;</span> <span class="fl">1.96</span> <span class="cf">else</span> <span class="st">'Do not reject H‚ÇÄ'</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Conclusion: The proportion is </span><span class="sc">{</span><span class="st">'significantly'</span> <span class="cf">if</span> <span class="bu">abs</span>(z_stat) <span class="op">&gt;</span> <span class="fl">1.96</span> <span class="cf">else</span> <span class="st">'NOT significantly'</span><span class="sc">}</span><span class="ss"> different from 50%."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
INFERENCE FOR PROPORTIONS
======================================================================
Sample size:           921
Number voting Democrat: 480
Sample proportion:     0.5212 (52.12%)
Standard error:        0.0165
95% CI:                [0.4889, 0.5534]
                        [48.89%, 55.34%]

Hypothesis Test: H‚ÇÄ: p = 0.50 (50-50 split)
  z-statistic:       1.2851
  p-value:           0.1988
  Decision:          Do not reject H‚ÇÄ

Conclusion: The proportion is NOT significantly different from 50%.</code></pre>
</div>
</div>
<p><strong>Proportion Results: 480 out of 921 voters intend to vote Democrat</strong></p>
<ul>
<li>Sample proportion: pÃÇ = 0.5212 (52.12%)</li>
<li>Standard error: 0.0165</li>
<li>95% CI: [0.4889, 0.5534] or [48.89%, 55.34%]</li>
<li>z-statistic (testing H‚ÇÄ: p = 0.50): 1.2851</li>
<li>p-value: 0.1988</li>
<li>Decision: Do NOT reject H‚ÇÄ</li>
</ul>
<p><strong>What this tells us:</strong></p>
<p>We have a sample where 52.12% intend to vote Democrat. The question is: does this provide evidence that the population proportion differs from 50% (a tied race)?</p>
<p><strong>Understanding the confidence interval:</strong></p>
<p>The 95% CI [48.89%, 55.34%] suggests:</p>
<ul>
<li>We‚Äôre 95% confident the true population proportion is in this range</li>
<li>The interval INCLUDES 50%, indicating 50-50 is plausible</li>
<li>The interval is fairly wide (6.45 percentage points), indicating some uncertainty</li>
</ul>
<p><strong>Understanding the hypothesis test:</strong></p>
<p>Testing H‚ÇÄ: p = 0.50 (tied race) vs H‚Çê: p ‚â† 0.50 (one candidate ahead)</p>
<ul>
<li>z-statistic: 1.29 (only 1.29 standard errors above 50%)</li>
<li>p-value: 0.1988 (about 20% chance of seeing this result if truly 50-50)</li>
<li>Conclusion: We cannot reject the null hypothesis of a tied race</li>
</ul>
<p><strong>Why use z-statistic (normal) instead of t-statistic?</strong></p>
<p>For proportions with large samples (n = 921):</p>
<ul>
<li>The sampling distribution of pÃÇ is approximately normal</li>
<li>We know the exact standard error formula: ‚àö[pÃÇ(1-pÃÇ)/n]</li>
<li>No need to estimate anything with t-distribution</li>
<li>Rule of thumb: Use normal approximation when np ‚â• 10 and n(1-p) ‚â• 10</li>
<li>Here: 921(0.52) = 479 and 921(0.48) = 442, both &gt;&gt; 10</li>
</ul>
<p><strong>Practical interpretation for election forecasting:</strong></p>
<p>This sample shows 52% support for Democrats, but:</p>
<ul>
<li>This is NOT statistically significant evidence of a Democratic lead (p = 0.20)</li>
<li>The confidence interval includes 50%, so the race could be tied</li>
<li>Margin of error: ¬±3.2 percentage points (1.96 √ó 0.0165 = 0.032)</li>
<li>To call the race, we‚Äôd want the CI to exclude 50% entirely</li>
</ul>
<p><strong>How would a larger sample change things?</strong></p>
<p>If we had the same proportion (52%) but with 2,500 voters instead of 921:</p>
<ul>
<li>Standard error would shrink: ‚àö[0.52(0.48)/2500] = 0.010</li>
<li>95% CI would be narrower: [50.0%, 54.0%]</li>
<li>z-statistic would be larger: (0.52 - 0.50)/0.010 = 2.00</li>
<li>p-value would be smaller: 0.045 &lt; 0.05 ‚Üí significant!</li>
<li>Conclusion: Same proportion, but with more data, we could detect the difference</li>
</ul>
<p><strong>Key insight about proportions:</strong></p>
<p>Proportions are just means of binary (0/1) data:</p>
<ul>
<li>Each voter is coded as 1 (Democrat) or 0 (not Democrat)</li>
<li>Sample proportion = sample mean of these 0/1 values</li>
<li>All inference principles (SE, CI, hypothesis tests) apply identically</li>
</ul>
<blockquote class="blockquote">
<p><strong>Key Concept 4.9: Inference for Proportions</strong></p>
<p>Proportions data (like employment rates, approval ratings, or market shares) are binary variables coded as 0 or 1. All inference methods for means‚Äîconfidence intervals, hypothesis tests, standard errors‚Äîextend naturally to proportions. The sample proportion <span class="math inline">\(\bar{p}\)</span> is simply the sample mean of binary data, and the standard error formula <span class="math inline">\(se(\bar{p}) = \sqrt{\bar{p}(1-\bar{p})/n}\)</span> follows from the variance formula for binary variables.</p>
</blockquote>
</section>
<section id="key-takeaways" class="level2">
<h2 class="anchored" data-anchor-id="key-takeaways">Key Takeaways</h2>
<section id="core-concepts" class="level3">
<h3 class="anchored" data-anchor-id="core-concepts">Core Concepts</h3>
<ol type="1">
<li><p><strong>Statistical inference</strong> lets us extrapolate from sample statistics to population parameters with quantified uncertainty.</p></li>
<li><p><strong>Standard error</strong> <span class="math inline">\(\text{se}(\bar{x}) = \frac{s}{\sqrt{n}}\)</span> measures the precision of the sample mean as an estimate of the population mean.</p></li>
<li><p><strong>t-distribution</strong> is used (instead of normal) when we estimate the population standard deviation from the sample</p></li>
</ol>
<ul>
<li>Fatter tails than normal (accounts for extra uncertainty)</li>
<li>Converges to normal as <span class="math inline">\(n\)</span> increases</li>
</ul>
<ol start="4" type="1">
<li><strong>Confidence intervals</strong> provide a range of plausible values</li>
</ol>
<ul>
<li>Formula: estimate <span class="math inline">\(\pm\)</span> critical value <span class="math inline">\(\times\)</span> standard error</li>
<li>95% CI: <span class="math inline">\(\bar{x} \pm t_{n-1, 0.025} \times \text{se}(\bar{x}) \approx \bar{x} \pm 2 \times \text{se}(\bar{x})\)</span></li>
<li>Interpretation: ‚ÄúWe are 95% confident <span class="math inline">\(\mu\)</span> lies in this interval‚Äù</li>
</ul>
<ol start="5" type="1">
<li><strong>Hypothesis tests</strong> evaluate specific claims about parameters</li>
</ol>
<ul>
<li>Set up <span class="math inline">\(H_0\)</span> (null) and <span class="math inline">\(H_a\)</span> (alternative)</li>
<li>Calculate <span class="math inline">\(t\text{-statistic} = \frac{\text{estimate} - \text{hypothesized value}}{\text{standard error}}\)</span></li>
<li>Make decision using p-value or critical value approach</li>
</ul>
<ol start="6" type="1">
<li><strong>Two-sided tests</strong> (<span class="math inline">\(H_0: \mu = \mu^*\)</span> vs <span class="math inline">\(H_a: \mu \neq \mu^*\)</span>)</li>
</ol>
<ul>
<li>Rejection region in both tails</li>
<li><span class="math inline">\(\text{p-value} = 2 \times \Pr[T \geq |t|]\)</span></li>
</ul>
<ol start="7" type="1">
<li><strong>One-sided tests</strong> (<span class="math inline">\(H_0: \mu \leq \mu^*\)</span> vs <span class="math inline">\(H_a: \mu &gt; \mu^*\)</span>, or vice versa)</li>
</ol>
<ul>
<li>Rejection region in one tail only</li>
<li>Use when testing a directional claim</li>
</ul>
<ol start="8" type="1">
<li><strong>p-value interpretation</strong></li>
</ol>
<ul>
<li>Probability of observing data at least as extreme as ours, assuming <span class="math inline">\(H_0\)</span> is true</li>
<li>Small p-value (<span class="math inline">\(&lt; \alpha\)</span>) ‚Üí reject <span class="math inline">\(H_0\)</span></li>
<li>Common significance level: <span class="math inline">\(\alpha = 0.05\)</span></li>
</ul>
<ol start="9" type="1">
<li><strong>Methods generalize</strong> to other parameters (regression coefficients, differences in means, etc.) and proportions data</li>
</ol>
</section>
<section id="what-you-learned" class="level3">
<h3 class="anchored" data-anchor-id="what-you-learned">What You Learned</h3>
<p><strong>Statistical Concepts Covered:</strong></p>
<ul>
<li>Standard error and sampling distribution</li>
<li>t-distribution vs normal distribution</li>
<li>Confidence intervals (90%, 95%, 99%)</li>
<li>Hypothesis testing (two-sided and one-sided)</li>
<li>p-values and critical values</li>
<li>Type I error and significance level</li>
<li>Inference for proportions</li>
</ul>
<p><strong>Python Tools Used:</strong></p>
<ul>
<li><code>scipy.stats.t</code>: t-distribution (pdf, cdf, ppf)</li>
<li><code>scipy.stats.norm</code>: Normal distribution (for proportions)</li>
<li><code>pandas</code>: Data manipulation</li>
<li><code>matplotlib</code>: Visualization of hypothesis tests</li>
</ul>
</section>
<section id="next-steps" class="level3">
<h3 class="anchored" data-anchor-id="next-steps">Next Steps</h3>
<ul>
<li><strong>Chapter 5:</strong> Bivariate data summary (relationships between two variables)</li>
<li><strong>Chapter 6:</strong> Least squares estimator (regression foundation)</li>
<li><strong>Chapter 7:</strong> Inference for regression coefficients</li>
</ul>
</section>
<section id="congratulations" class="level3">
<h3 class="anchored" data-anchor-id="congratulations">Congratulations!</h3>
<p>You now understand the foundations of statistical inference:</p>
<ul>
<li>How to quantify uncertainty using confidence intervals</li>
<li>How to test claims about population parameters</li>
<li>The difference between statistical and practical significance</li>
<li>When to use one-sided vs two-sided tests</li>
</ul>
<p>These tools are fundamental to all empirical research in economics and beyond!</p>
</section>
</section>
<section id="practice-exercises" class="level2">
<h2 class="anchored" data-anchor-id="practice-exercises">Practice Exercises</h2>
<p>Test your understanding of statistical inference:</p>
<section id="exercise-1-confidence-interval-interpretation" class="level3">
<h3 class="anchored" data-anchor-id="exercise-1-confidence-interval-interpretation">Exercise 1: Confidence Interval Interpretation</h3>
<p>A 95% CI for mean household income is [$48,000, $56,000]</p>
<ol type="a">
<li><p>What is the point estimate (sample mean)?</p></li>
<li><p>What is the margin of error?</p></li>
<li><p>TRUE or FALSE: ‚ÄúThere is a 95% probability that the true mean is in this interval‚Äù</p></li>
<li><p>TRUE or FALSE: ‚ÄúIf we repeated sampling, 95% of CIs would contain the true mean‚Äù</p></li>
</ol>
</section>
<section id="exercise-2-standard-error-calculation" class="level3">
<h3 class="anchored" data-anchor-id="exercise-2-standard-error-calculation">Exercise 2: Standard Error Calculation</h3>
<p>Sample of <span class="math inline">\(n=64\)</span> observations with mean <span class="math inline">\(\$45,000\)</span> and standard deviation <span class="math inline">\(s=\$16,000\)</span></p>
<ol type="a">
<li><p>Calculate the standard error</p></li>
<li><p>What sample size would halve the standard error?</p></li>
<li><p>Construct an approximate 95% CI using the ‚Äúmean <span class="math inline">\(\pm\)</span> 2SE‚Äù rule</p></li>
</ol>
</section>
<section id="exercise-3-t-vs-z-distribution" class="level3">
<h3 class="anchored" data-anchor-id="exercise-3-t-vs-z-distribution">Exercise 3: t vs z Distribution</h3>
<ol type="a">
<li><p>Why do we use the t-distribution instead of the normal distribution?</p></li>
<li><p>For <span class="math inline">\(n=10\)</span>, find the critical value for a 95% CI</p></li>
<li><p>For <span class="math inline">\(n=100\)</span>, find the critical value for a 95% CI</p></li>
<li><p>Compare these to <span class="math inline">\(z=1.96\)</span>. What do you notice?</p></li>
</ol>
</section>
<section id="exercise-4-hypothesis-test-mechanics" class="level3">
<h3 class="anchored" data-anchor-id="exercise-4-hypothesis-test-mechanics">Exercise 4: Hypothesis Test Mechanics</h3>
<p>Test <span class="math inline">\(H_0: \mu = 100\)</span> vs <span class="math inline">\(H_a: \mu \neq 100\)</span> with sample mean <span class="math inline">\(= 105\)</span>, SE <span class="math inline">\(= 3\)</span>, <span class="math inline">\(n = 49\)</span></p>
<ol type="a">
<li><p>Calculate the t-statistic</p></li>
<li><p>Find the p-value (use t-table or Python)</p></li>
<li><p>Make a decision at <span class="math inline">\(\alpha=0.05\)</span></p></li>
<li><p>Would your decision change if <span class="math inline">\(\alpha=0.01\)</span>?</p></li>
</ol>
</section>
<section id="exercise-5-one-sided-vs-two-sided-tests" class="level3">
<h3 class="anchored" data-anchor-id="exercise-5-one-sided-vs-two-sided-tests">Exercise 5: One-Sided vs Two-Sided Tests</h3>
<p>Sample: <span class="math inline">\(n=36\)</span>, mean <span class="math inline">\(=72\)</span>, <span class="math inline">\(s=18\)</span></p>
<ol type="a">
<li><p>Test <span class="math inline">\(H_0: \mu = 75\)</span> vs <span class="math inline">\(H_a: \mu \neq 75\)</span> (two-sided, <span class="math inline">\(\alpha=0.05\)</span>)</p></li>
<li><p>Test <span class="math inline">\(H_0: \mu \geq 75\)</span> vs <span class="math inline">\(H_a: \mu &lt; 75\)</span> (one-sided, <span class="math inline">\(\alpha=0.05\)</span>)</p></li>
<li><p>Compare the p-values. What is the relationship?</p></li>
<li><p>In which case is the evidence against <span class="math inline">\(H_0\)</span> stronger?</p></li>
</ol>
</section>
<section id="exercise-6-type-i-and-type-ii-errors" class="level3">
<h3 class="anchored" data-anchor-id="exercise-6-type-i-and-type-ii-errors">Exercise 6: Type I and Type II Errors</h3>
<ol type="a">
<li><p>Define Type I error and give an example in the earnings context</p></li>
<li><p>Define Type II error and give an example</p></li>
<li><p>If we decrease <span class="math inline">\(\alpha\)</span> from 0.05 to 0.01, what happens to the probability of Type II error?</p></li>
<li><p>How can we reduce both types of error simultaneously?</p></li>
</ol>
</section>
<section id="exercise-7-proportions-inference" class="level3">
<h3 class="anchored" data-anchor-id="exercise-7-proportions-inference">Exercise 7: Proportions Inference</h3>
<p>Survey of 500 people: 275 support a policy</p>
<ol type="a">
<li><p>Calculate the sample proportion and standard error</p></li>
<li><p>Construct a 95% CI for the population proportion</p></li>
<li><p>Test <span class="math inline">\(H_0: p = 0.50\)</span> vs <span class="math inline">\(H_a: p \neq 0.50\)</span></p></li>
<li><p>Is the result statistically significant?</p></li>
</ol>
</section>
<section id="exercise-8-python-practice" class="level3">
<h3 class="anchored" data-anchor-id="exercise-8-python-practice">Exercise 8: Python Practice</h3>
<p>Generate a random sample of 100 observations from <span class="math inline">\(N(50, 100)\)</span></p>
<ol type="a">
<li><p>Calculate the 95% CI for the mean</p></li>
<li><p>Does the CI contain the true mean (50)?</p></li>
<li><p>Repeat 1000 times. What fraction of CIs contain 50?</p></li>
<li><p>Test <span class="math inline">\(H_0: \mu = 55\)</span>. What proportion of tests reject (should be <span class="math inline">\(\approx 0.05\)</span>)?</p></li>
</ol>
<hr>
</section>
</section>
<section id="case-studies" class="level2">
<h2 class="anchored" data-anchor-id="case-studies">Case Studies</h2>
<section id="case-study-1-statistical-inference-for-labor-productivity" class="level3">
<h3 class="anchored" data-anchor-id="case-study-1-statistical-inference-for-labor-productivity">Case Study 1: Statistical Inference for Labor Productivity</h3>
<p><strong>Research Question:</strong> ‚ÄúHas global labor productivity changed significantly over time, and do productivity levels differ significantly across regions?‚Äù</p>
<p>This case study applies all the statistical inference methods from Chapter 4 to analyze real economic data on labor productivity across 108 countries over 25 years (1990-2014). You‚Äôll practice:</p>
<ul>
<li>Constructing and interpreting <strong>confidence intervals</strong> for population means</li>
<li>Conducting <strong>two-sided hypothesis tests</strong> to compare time periods</li>
<li>Performing <strong>one-sided directional tests</strong> for benchmark comparisons</li>
<li>Applying <strong>proportions inference</strong> to binary economic outcomes</li>
<li>Comparing productivity levels across <strong>regional subgroups</strong></li>
<li>Interpreting results in economic context (development economics, convergence theory)</li>
</ul>
<p>The Mendez convergence clubs dataset provides panel data on labor productivity, GDP, capital, human capital, and total factor productivity for 108 countries from 1990 to 2014.</p>
<section id="economic-context-testing-convergence-hypotheses" class="level4">
<h4 class="anchored" data-anchor-id="economic-context-testing-convergence-hypotheses">Economic Context: Testing Convergence Hypotheses</h4>
<p>In development economics, the <strong>convergence hypothesis</strong> suggests that poorer countries should grow faster than richer ones, leading to a narrowing of productivity gaps over time. Statistical inference allows us to test whether observed changes in productivity are:</p>
<ul>
<li><strong>Statistically significant</strong> (unlikely due to random sampling variation)</li>
<li><strong>Economically meaningful</strong> (large enough to matter for policy)</li>
</ul>
<p>By applying Chapter 4‚Äôs methods to this dataset, you‚Äôll answer questions like:</p>
<ol type="1">
<li>Has mean global productivity increased significantly from 1990 to 2014?</li>
<li>Are regional productivity gaps (e.g., Africa vs.&nbsp;Europe) statistically significant?</li>
<li>What proportion of countries experienced positive productivity growth?</li>
<li>Can we reject specific hypotheses about productivity benchmarks?</li>
</ol>
<p>These are real questions that economists and policymakers care about when designing development strategies.</p>
<blockquote class="blockquote">
<p><strong>Key Concept 4.10: Why Statistical Inference Matters in Economics</strong></p>
<p>When analyzing economic data, we rarely observe entire populations. Instead, we work with <strong>samples</strong> (like 108 countries from all countries in the world, or 25 years from a longer historical period). Statistical inference lets us:</p>
<ol type="1">
<li><strong>Quantify uncertainty</strong> - Confidence intervals tell us the range of plausible values for population parameters</li>
<li><strong>Test theories</strong> - Hypothesis tests evaluate whether data support or contradict economic theories</li>
<li><strong>Compare groups</strong> - We can determine if differences between regions/periods are real or just noise</li>
<li><strong>Inform policy</strong> - Statistical significance helps separate meaningful patterns from random fluctuations</li>
</ol>
<p>Without inference methods, we couldn‚Äôt distinguish between: - A real productivity increase vs.&nbsp;random year-to-year variation - Genuine regional gaps vs.&nbsp;sampling artifacts - Policy-relevant changes vs.&nbsp;statistical noise</p>
</blockquote>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load convergence clubs dataset</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/quarcs-lab/mendez2020-convergence-clubs-code-data/master/assets/dat.csv"</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(url)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Set multi-index (country, year)</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.set_index([<span class="st">'country'</span>, <span class="st">'year'</span>])</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Display dataset information</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Dataset Overview:"</span>)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Total observations: </span><span class="sc">{</span><span class="bu">len</span>(df)<span class="sc">:,}</span><span class="ss">"</span>)</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Countries: </span><span class="sc">{</span>df<span class="sc">.</span>index<span class="sc">.</span>get_level_values(<span class="st">'country'</span>)<span class="sc">.</span>nunique()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Years: </span><span class="sc">{</span>df<span class="sc">.</span>index<span class="sc">.</span>get_level_values(<span class="st">'year'</span>)<span class="sc">.</span><span class="bu">min</span>()<span class="sc">}</span><span class="ss">-</span><span class="sc">{</span>df<span class="sc">.</span>index<span class="sc">.</span>get_level_values(<span class="st">'year'</span>)<span class="sc">.</span><span class="bu">max</span>()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Variables: </span><span class="sc">{</span><span class="bu">list</span>(df.columns)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract labor productivity for key years</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>lp_1990 <span class="op">=</span> df.loc[df.index.get_level_values(<span class="st">'year'</span>) <span class="op">==</span> <span class="dv">1990</span>, <span class="st">'lp'</span>]</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>lp_2014 <span class="op">=</span> df.loc[df.index.get_level_values(<span class="st">'year'</span>) <span class="op">==</span> <span class="dv">2014</span>, <span class="st">'lp'</span>]</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Labor productivity samples:"</span>)</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"1990: n=</span><span class="sc">{</span><span class="bu">len</span>(lp_1990)<span class="sc">}</span><span class="ss">, mean=$</span><span class="sc">{</span>lp_1990<span class="sc">.</span>mean()<span class="op">/</span><span class="dv">1000</span><span class="sc">:.1f}</span><span class="ss">k, std=$</span><span class="sc">{</span>lp_1990<span class="sc">.</span>std()<span class="op">/</span><span class="dv">1000</span><span class="sc">:.1f}</span><span class="ss">k"</span>)</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"2014: n=</span><span class="sc">{</span><span class="bu">len</span>(lp_2014)<span class="sc">}</span><span class="ss">, mean=$</span><span class="sc">{</span>lp_2014<span class="sc">.</span>mean()<span class="op">/</span><span class="dv">1000</span><span class="sc">:.1f}</span><span class="ss">k, std=$</span><span class="sc">{</span>lp_2014<span class="sc">.</span>std()<span class="op">/</span><span class="dv">1000</span><span class="sc">:.1f}</span><span class="ss">k"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Dataset Overview:
Total observations: 2,700
Countries: 108
Years: 1990-2014

Variables: ['id', 'Y', 'K', 'pop', 'L', 's', 'alpha_it', 'GDPpc', 'lp', 'h', 'kl', 'kp', 'ky', 'TFP', 'log_GDPpc_raw', 'log_lp_raw', 'log_ky_raw', 'log_h_raw', 'log_tfp_raw', 'log_GDPpc', 'log_lp', 'log_ky', 'log_h', 'log_tfp', 'isocode', 'hi1990', 'region']

Labor productivity samples:
1990: n=108, mean=$23.2k, std=$20.1k
2014: n=108, mean=$41.0k, std=$33.9k</code></pre>
</div>
</div>
</section>
<section id="how-to-use-these-tasks" class="level4">
<h4 class="anchored" data-anchor-id="how-to-use-these-tasks">How to Use These Tasks</h4>
<p><strong>Task structure:</strong> The 6 tasks below progress from <strong>guided</strong> (fill-in-the-blank code) to <strong>independent</strong> (design your own analysis).</p>
<p><strong>Working approach:</strong></p>
<ol type="1">
<li><strong>Read the task description</strong> - Understand the economic question and learning goal</li>
<li><strong>Study the code template</strong> - Early tasks provide partial code with blanks (<code>_____</code>)</li>
<li><strong>Insert a new code cell</strong> below each task</li>
<li><strong>Complete the code</strong> - Fill in blanks or write from scratch (depending on task level)</li>
<li><strong>Run and interpret</strong> - Execute your code and interpret results economically</li>
<li><strong>Check your understanding</strong> - Does your answer make economic sense?</li>
</ol>
<p><strong>Tips:</strong></p>
<ul>
<li>Reference Section 4.1-4.7 for formulas and methods</li>
<li>Use <code>scipy.stats</code> functions: <code>t.ppf()</code>, <code>ttest_ind()</code>, <code>ttest_1samp()</code></li>
<li>Always interpret p-values: ‚ÄúWe reject/fail to reject H‚ÇÄ at Œ±=0.05 because‚Ä¶‚Äù</li>
<li>Connect statistical results to economic meaning: ‚ÄúThis suggests that‚Ä¶‚Äù</li>
</ul>
<p><strong>Progressive difficulty:</strong></p>
<ul>
<li><strong>Tasks 1-2:</strong> GUIDED (fill 4-8 blanks in provided code)</li>
<li><strong>Tasks 3-4:</strong> SEMI-GUIDED (complete partial structure)</li>
<li><strong>Tasks 5-6:</strong> INDEPENDENT (design full implementation)</li>
</ul>
</section>
<section id="task-1-confidence-intervals-for-mean-productivity-guided" class="level4">
<h4 class="anchored" data-anchor-id="task-1-confidence-intervals-for-mean-productivity-guided">Task 1: Confidence Intervals for Mean Productivity (GUIDED)</h4>
<p><strong>Learning Goal:</strong> Apply Section 4.3 methods to calculate and interpret confidence intervals</p>
<p><strong>Economic Question:</strong> ‚ÄúCan we be 95% confident about the range of global mean labor productivity in 2014?‚Äù</p>
<p><strong>Your task:</strong></p>
<ol type="1">
<li>Calculate a 95% confidence interval for mean productivity in 2014</li>
<li>Calculate a 99% confidence interval for comparison</li>
<li>Interpret the difference in interval widths</li>
<li>Compare with a 95% CI for 1990 data</li>
</ol>
<p><strong>Code template (fill in the 6 blanks):</strong></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 2014 data: Calculate 95% CI</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>n_2014 <span class="op">=</span> <span class="bu">len</span>(lp_2014)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>mean_2014 <span class="op">=</span> _____  <span class="co"># Calculate sample mean</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>std_2014 <span class="op">=</span> _____   <span class="co"># Calculate sample standard deviation</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>se_2014 <span class="op">=</span> std_2014 <span class="op">/</span> np.sqrt(n_2014)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Get t-critical value for 95% CI (two-tailed, df = n-1)</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>alpha_95 <span class="op">=</span> <span class="fl">0.05</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>t_crit_95 <span class="op">=</span> stats.t.ppf(<span class="dv">1</span> <span class="op">-</span> alpha_95<span class="op">/</span><span class="dv">2</span>, df<span class="op">=</span>_____)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate margin of error and CI bounds</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>me_95 <span class="op">=</span> t_crit_95 <span class="op">*</span> se_2014</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>ci_95_lower <span class="op">=</span> _____</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>ci_95_upper <span class="op">=</span> _____</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"2014 Labor Productivity:"</span>)</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sample mean: $</span><span class="sc">{</span>mean_2014<span class="sc">:,</span><span class="fl">.0</span><span class="er">f</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"95% CI: [$</span><span class="sc">{</span>ci_95_lower<span class="sc">:,</span><span class="fl">.0</span><span class="er">f</span><span class="sc">}</span><span class="ss">, $</span><span class="sc">{</span>ci_95_upper<span class="sc">:,</span><span class="fl">.0</span><span class="er">f</span><span class="sc">}</span><span class="ss">]"</span>)</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Margin of error: $</span><span class="sc">{</span>me_95<span class="sc">:,</span><span class="fl">.0</span><span class="er">f</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate 99% CI for comparison</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>alpha_99 <span class="op">=</span> <span class="fl">0.01</span></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>t_crit_99 <span class="op">=</span> stats.t.ppf(<span class="dv">1</span> <span class="op">-</span> alpha_99<span class="op">/</span><span class="dv">2</span>, df<span class="op">=</span>n_2014<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>me_99 <span class="op">=</span> t_crit_99 <span class="op">*</span> se_2014</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>ci_99_lower <span class="op">=</span> mean_2014 <span class="op">-</span> me_99</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>ci_99_upper <span class="op">=</span> mean_2014 <span class="op">+</span> me_99</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">99% CI: [$</span><span class="sc">{</span>ci_99_lower<span class="sc">:,</span><span class="fl">.0</span><span class="er">f</span><span class="sc">}</span><span class="ss">, $</span><span class="sc">{</span>ci_99_upper<span class="sc">:,</span><span class="fl">.0</span><span class="er">f</span><span class="sc">}</span><span class="ss">]"</span>)</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Margin of error: $</span><span class="sc">{</span>me_99<span class="sc">:,</span><span class="fl">.0</span><span class="er">f</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Interpretation: The 99% CI is _____ than the 95% CI"</span>)  <span class="co"># Fill in: "wider" or "narrower"</span></span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"because we need more certainty, which requires a larger interval."</span>)</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare with 1990</span></span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>mean_1990 <span class="op">=</span> lp_1990.mean()</span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>std_1990 <span class="op">=</span> lp_1990.std()</span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>se_1990 <span class="op">=</span> std_1990 <span class="op">/</span> np.sqrt(<span class="bu">len</span>(lp_1990))</span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>me_1990 <span class="op">=</span> stats.t.ppf(<span class="fl">0.975</span>, df<span class="op">=</span><span class="bu">len</span>(lp_1990)<span class="op">-</span><span class="dv">1</span>) <span class="op">*</span> se_1990</span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">1990 mean: $</span><span class="sc">{</span>mean_1990<span class="sc">:,</span><span class="fl">.0</span><span class="er">f</span><span class="sc">}</span><span class="ss">, 95% CI width: $</span><span class="sc">{</span><span class="dv">2</span><span class="op">*</span>me_1990<span class="sc">:,</span><span class="fl">.0</span><span class="er">f</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"2014 mean: $</span><span class="sc">{</span>mean_2014<span class="sc">:,</span><span class="fl">.0</span><span class="er">f</span><span class="sc">}</span><span class="ss">, 95% CI width: $</span><span class="sc">{</span><span class="dv">2</span><span class="op">*</span>me_95<span class="sc">:,</span><span class="fl">.0</span><span class="er">f</span><span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Questions to consider:</strong></p>
<ul>
<li>Why is the 99% CI wider than the 95% CI?</li>
<li>Did the mean productivity increase from 1990 to 2014?</li>
<li>Which year has more variability in productivity across countries?</li>
</ul>
</section>
<section id="task-2-testing-productivity-change-over-time-semi-guided" class="level4">
<h4 class="anchored" data-anchor-id="task-2-testing-productivity-change-over-time-semi-guided">Task 2: Testing Productivity Change Over Time (SEMI-GUIDED)</h4>
<p><strong>Learning Goal:</strong> Apply Section 4.4 (two-sided tests) to compare time periods</p>
<p><strong>Economic Question:</strong> ‚ÄúHas global mean labor productivity changed significantly from 1990 to 2014?‚Äù</p>
<p><strong>Your task:</strong></p>
<ol type="1">
<li>State null and alternative hypotheses</li>
<li>Conduct a two-sample t-test (independent samples)</li>
<li>Calculate the test statistic manually</li>
<li>Compare with <code>scipy.stats.ttest_ind()</code> result</li>
<li>Interpret the p-value at Œ± = 0.05</li>
</ol>
<p><strong>Code template (fill in the 8 blanks):</strong></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># State hypotheses</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"H‚ÇÄ: Œº‚ÇÅ‚Çâ‚Çâ‚ÇÄ = Œº‚ÇÇ‚ÇÄ‚ÇÅ‚ÇÑ  (no change in mean productivity)"</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"H‚Çê: Œº‚ÇÅ‚Çâ‚Çâ‚ÇÄ ‚â† Œº‚ÇÇ‚ÇÄ‚ÇÅ‚ÇÑ  (mean productivity changed)"</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Significance level: Œ± = 0.05</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Manual calculation</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>mean_1990 <span class="op">=</span> lp_1990.mean()</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>mean_2014 <span class="op">=</span> lp_2014.mean()</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>se_1990 <span class="op">=</span> lp_1990.std() <span class="op">/</span> np.sqrt(<span class="bu">len</span>(lp_1990))</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>se_2014 <span class="op">=</span> lp_2014.std() <span class="op">/</span> np.sqrt(<span class="bu">len</span>(lp_2014))</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate pooled standard error for difference in means</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>se_diff <span class="op">=</span> np.sqrt(_____<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> _____<span class="op">**</span><span class="dv">2</span>)  <span class="co"># Fill in: se_1990 and se_2014</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate t-statistic</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>t_stat <span class="op">=</span> (_____ <span class="op">-</span> _____) <span class="op">/</span> se_diff  <span class="co"># Fill in: mean_2014 and mean_1990</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Degrees of freedom (Welch approximation)</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>n1, n2 <span class="op">=</span> <span class="bu">len</span>(lp_1990), <span class="bu">len</span>(lp_2014)</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>s1, s2 <span class="op">=</span> lp_1990.std(), lp_2014.std()</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> ((s1<span class="op">**</span><span class="dv">2</span><span class="op">/</span>n1 <span class="op">+</span> s2<span class="op">**</span><span class="dv">2</span><span class="op">/</span>n2)<span class="op">**</span><span class="dv">2</span>) <span class="op">/</span> ((s1<span class="op">**</span><span class="dv">2</span><span class="op">/</span>n1)<span class="op">**</span><span class="dv">2</span><span class="op">/</span>(n1<span class="op">-</span><span class="dv">1</span>) <span class="op">+</span> (s2<span class="op">**</span><span class="dv">2</span><span class="op">/</span>n2)<span class="op">**</span><span class="dv">2</span><span class="op">/</span>(n2<span class="op">-</span><span class="dv">1</span>))</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate two-sided p-value</span></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>p_value_manual <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> stats.t.cdf(<span class="bu">abs</span>(t_stat), df<span class="op">=</span>df))</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Manual calculation:"</span>)</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Difference in means: $</span><span class="sc">{</span>mean_2014 <span class="op">-</span> mean_1990<span class="sc">:,</span><span class="fl">.0</span><span class="er">f</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"SE of difference: $</span><span class="sc">{</span>se_diff<span class="sc">:,</span><span class="fl">.0</span><span class="er">f</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"t-statistic: </span><span class="sc">{</span>t_stat<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Degrees of freedom: </span><span class="sc">{</span>df<span class="sc">:.1f}</span><span class="ss">"</span>)</span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"p-value (two-sided): </span><span class="sc">{</span>p_value_manual<span class="sc">:.4f}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify with scipy</span></span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>t_stat_scipy, p_value_scipy <span class="op">=</span> stats.ttest_ind(_____, _____, equal_var<span class="op">=</span><span class="va">False</span>)  <span class="co"># Fill in: lp_2014, lp_1990</span></span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"scipy.stats.ttest_ind() result:"</span>)</span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"t-statistic: </span><span class="sc">{</span>t_stat_scipy<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"p-value: </span><span class="sc">{</span>p_value_scipy<span class="sc">:.4f}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Decision</span></span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> p_value_scipy <span class="op">&lt;</span> <span class="fl">0.05</span>:</span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Decision: _____ H‚ÇÄ at Œ±=0.05"</span>)  <span class="co"># Fill in: "Reject" or "Fail to reject"</span></span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Interpretation: Mean productivity _____ significantly from 1990 to 2014."</span>)  <span class="co"># Fill in: "changed" or "did not change"</span></span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Decision: Fail to reject H‚ÇÄ at Œ±=0.05"</span>)</span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Interpretation: Insufficient evidence that mean productivity changed."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Questions to consider:</strong></p>
<ul>
<li>What does the p-value tell you about the likelihood of observing this difference by chance?</li>
<li>Is the change economically meaningful (not just statistically significant)?</li>
<li>What assumptions does the two-sample t-test make?</li>
</ul>
</section>
<section id="task-3-comparing-regional-productivity-levels-semi-guided" class="level4">
<h4 class="anchored" data-anchor-id="task-3-comparing-regional-productivity-levels-semi-guided">Task 3: Comparing Regional Productivity Levels (SEMI-GUIDED)</h4>
<p><strong>Learning Goal:</strong> Apply hypothesis testing to compare subgroups</p>
<p><strong>Economic Question:</strong> ‚ÄúDo African countries have significantly lower productivity than European countries (2014 data)?‚Äù</p>
<p><strong>Your task:</strong></p>
<ol type="1">
<li>Filter 2014 data by region (use <code>region</code> column in dataset)</li>
<li>Test H‚ÇÄ: Œº_Africa = Œº_Europe vs H‚Çê: Œº_Africa ‚â† Œº_Europe</li>
<li>Calculate 95% CI for the difference in means</li>
<li>Visualize distributions with side-by-side box plots</li>
</ol>
<p><strong>Code structure (complete the analysis):</strong></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter 2014 data by region</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>df_2014 <span class="op">=</span> df.loc[df.index.get_level_values(<span class="st">'year'</span>) <span class="op">==</span> <span class="dv">2014</span>]</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract productivity for Africa and Europe</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>lp_africa <span class="op">=</span> df_2014.loc[df_2014[<span class="st">'region'</span>] <span class="op">==</span> <span class="st">'Africa'</span>, <span class="st">'lp'</span>]</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>lp_europe <span class="op">=</span> df_2014.loc[df_2014[<span class="st">'region'</span>] <span class="op">==</span> <span class="st">'Europe'</span>, <span class="st">'lp'</span>]</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sample sizes: Africa n=</span><span class="sc">{</span><span class="bu">len</span>(lp_africa)<span class="sc">}</span><span class="ss">, Europe n=</span><span class="sc">{</span><span class="bu">len</span>(lp_europe)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Africa mean: $</span><span class="sc">{</span>lp_africa<span class="sc">.</span>mean()<span class="sc">:,</span><span class="fl">.0</span><span class="er">f</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Europe mean: $</span><span class="sc">{</span>lp_europe<span class="sc">.</span>mean()<span class="sc">:,</span><span class="fl">.0</span><span class="er">f</span><span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Conduct two-sample t-test</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="co"># YOUR CODE HERE: Use stats.ttest_ind() to test if means differ</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate and print: t-statistic, p-value, decision at Œ±=0.05</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate 95% CI for difference in means</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a><span class="co"># YOUR CODE HERE: </span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Calculate difference in means</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Calculate SE of difference</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Get t-critical value</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Construct CI: (difference - ME, difference + ME)</span></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize distributions</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>ax.boxplot([lp_africa, lp_europe], labels<span class="op">=</span>[<span class="st">'Africa'</span>, <span class="st">'Europe'</span>])</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Labor Productivity ($)'</span>)</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Labor Productivity Distribution by Region (2014)'</span>)</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>ax.grid(axis<span class="op">=</span><span class="st">'y'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Questions to consider:</strong></p>
<ul>
<li>Is the difference statistically significant?</li>
<li>How large is the productivity gap in dollar terms?</li>
<li>What does the box plot reveal about within-region variation?</li>
<li>Does the CI for the difference include zero? What does that mean?</li>
</ul>
<blockquote class="blockquote">
<p><strong>Key Concept 4.11: Economic vs Statistical Significance</strong></p>
<p>A result can be <strong>statistically significant</strong> (p &lt; 0.05) but <strong>economically trivial</strong>, or vice versa:</p>
<p><strong>Statistical significance</strong> answers: ‚ÄúIs this difference unlikely to be due to chance?‚Äù - Depends on sample size: larger samples detect smaller differences - Measured by p-value: probability of observing this result if H‚ÇÄ is true - Standard: p &lt; 0.05 means &lt;5% chance of Type I error</p>
<p><strong>Economic significance</strong> answers: ‚ÄúIs this difference large enough to matter?‚Äù - Depends on context: a $1,000 productivity gap might be huge for low-income countries but trivial for high-income countries - Measured by effect size: actual magnitude of the difference - Judgment call: requires domain expertise</p>
<p><strong>Example:</strong> - With n=10,000 countries, a $100 productivity difference might be statistically significant (p&lt;0.001) but economically meaningless - With n=10 countries, a $10,000 difference might not be statistically significant (p=0.08) but could be economically important</p>
<p><strong>Best practice:</strong> Always report BOTH: 1. Statistical result: ‚ÄúWe reject H‚ÇÄ at Œ±=0.05 (p=0.003)‚Äù 2. Economic interpretation: ‚ÄúThe $15,000 productivity gap represents a 35% difference, which is economically substantial for development policy‚Äù</p>
</blockquote>
</section>
<section id="task-4-one-sided-test-for-growth-more-independent" class="level4">
<h4 class="anchored" data-anchor-id="task-4-one-sided-test-for-growth-more-independent">Task 4: One-Sided Test for Growth (MORE INDEPENDENT)</h4>
<p><strong>Learning Goal:</strong> Apply Section 4.6 (one-sided tests) to directional hypotheses</p>
<p><strong>Economic Question:</strong> ‚ÄúCan we conclude that mean global productivity in 2014 exceeds $50,000 (a policy benchmark)?‚Äù</p>
<p><strong>Your task:</strong></p>
<ol type="1">
<li>Test H‚ÇÄ: Œº ‚â§ 50,000 vs H‚Çê: Œº &gt; 50,000</li>
<li>Use <code>scipy.stats.ttest_1samp()</code> with <code>alternative='greater'</code></li>
<li>Compare one-sided vs two-sided p-values</li>
<li>Discuss Type I error: what does Œ±=0.05 mean in this context?</li>
</ol>
<p><strong>Outline (write your own code):</strong></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: State hypotheses clearly</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co"># H‚ÇÄ: Œº ‚â§ 50,000 (productivity does not exceed benchmark)</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co"># H‚Çê: Œº &gt; 50,000 (productivity exceeds benchmark)</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Conduct one-sided t-test</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Use: stats.ttest_1samp(lp_2014, popmean=50000, alternative='greater')</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Calculate two-sided p-value for comparison</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Use: stats.ttest_1samp(lp_2014, popmean=50000, alternative='two-sided')</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Report results</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="co"># - Sample mean</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="co"># - t-statistic</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="co"># - One-sided p-value</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a><span class="co"># - Two-sided p-value</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a><span class="co"># - Decision at Œ±=0.05</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Interpret Type I error</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a><span class="co"># If we reject H‚ÇÄ, what is the probability we made a mistake?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Hint:</strong> Remember that for one-sided tests:</p>
<ul>
<li>If H‚Çê: Œº &gt; Œº‚ÇÄ, use <code>alternative='greater'</code></li>
<li>The one-sided p-value is half the two-sided p-value (when t-stat has correct sign)</li>
<li>Type I error = rejecting H‚ÇÄ when it‚Äôs actually true</li>
</ul>
<p><strong>Questions to consider:</strong></p>
<ul>
<li>Why is the one-sided p-value smaller than the two-sided p-value?</li>
<li>When is a one-sided test appropriate vs a two-sided test?</li>
<li>What are the policy implications if we reject H‚ÇÄ?</li>
</ul>
</section>
<section id="task-5-proportions-analysis---growth-winners-independent" class="level4">
<h4 class="anchored" data-anchor-id="task-5-proportions-analysis---growth-winners-independent">Task 5: Proportions Analysis - Growth Winners (INDEPENDENT)</h4>
<p><strong>Learning Goal:</strong> Apply Section 4.7 (proportions) to binary outcomes</p>
<p><strong>Economic Question:</strong> ‚ÄúWhat proportion of countries experienced productivity growth from 1990 to 2014, and can we conclude that more than half experienced growth?‚Äù</p>
<p><strong>Your task:</strong></p>
<ol type="1">
<li>Create country-level dataset with productivity in both 1990 and 2014</li>
<li>Create binary variable: <code>growth = 1</code> if productivity increased, <code>0</code> otherwise</li>
<li>Calculate sample proportion of ‚Äúgrowth winners‚Äù</li>
<li>Construct 95% CI for population proportion using normal approximation</li>
<li>Test H‚ÇÄ: p = 0.50 vs H‚Çê: p ‚â† 0.50 (are half growth winners?)</li>
</ol>
<p><strong>Hints:</strong></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Hint 1: Reshape data to country-level</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co"># df_1990 = df.loc[df.index.get_level_values('year') == 1990, ['lp']]</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co"># df_2014 = df.loc[df.index.get_level_values('year') == 2014, ['lp']]</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge on country index</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Hint 2: Create binary growth indicator</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co"># growth = (lp_2014 &gt; lp_1990).astype(int)</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Hint 3: Proportions formulas from Section 4.7</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="co"># p_hat = np.mean(growth)</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="co"># se_p = np.sqrt(p_hat * (1 - p_hat) / n)</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="co"># CI: p_hat ¬± z_crit * se_p</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="co"># For 95% CI: z_crit = 1.96</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Hint 4: Test statistic for proportions</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a><span class="co"># z = (p_hat - p0) / np.sqrt(p0 * (1 - p0) / n)</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a><span class="co"># where p0 = 0.50 under H‚ÇÄ</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Questions to consider:</strong></p>
<ul>
<li>What proportion of countries experienced growth?</li>
<li>Does the 95% CI include 0.50? What does that mean?</li>
<li>Is there evidence that the proportion differs from 50%?</li>
<li>Which countries did NOT experience growth? (Bonus: investigate why)</li>
</ul>
</section>
<section id="task-6-multi-regional-hypothesis-testing-independent" class="level4">
<h4 class="anchored" data-anchor-id="task-6-multi-regional-hypothesis-testing-independent">Task 6: Multi-Regional Hypothesis Testing (INDEPENDENT)</h4>
<p><strong>Learning Goal:</strong> Integrate multiple inference methods in comprehensive analysis</p>
<p><strong>Economic Question:</strong> ‚ÄúWhich regional pairs show statistically significant productivity gaps in 2014?‚Äù</p>
<p><strong>Your task:</strong></p>
<ol type="1">
<li>Identify all regions in the dataset (use <code>df_2014['region'].unique()</code>)</li>
<li>Calculate 95% CIs for mean productivity in each region</li>
<li>Conduct pairwise t-tests (Africa vs Europe, Africa vs Asia, Africa vs Americas, etc.)</li>
<li>Create a visualization showing CIs for all regions (error bar plot)</li>
<li>Discuss the <strong>multiple testing problem</strong>: when conducting many tests, what happens to Type I error?</li>
</ol>
<p><strong>Challenge goals (minimal guidance):</strong></p>
<ul>
<li>Design your own analysis structure</li>
<li>Use loops to avoid repetitive code</li>
<li>Create professional visualizations</li>
<li>Write clear economic interpretations</li>
</ul>
<p><strong>Suggested approach:</strong></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Get all regions and calculate summary stats</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co"># For each region: mean, std, se, 95% CI</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Store in a DataFrame or dictionary</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Conduct all pairwise tests</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Use itertools.combinations() to generate pairs</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co"># For each pair: run ttest_ind(), store t-stat and p-value</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Visualize CIs</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create error bar plot: plt.errorbar()</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Or bar plot with CI whiskers</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Report significant differences</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Which pairs have p &lt; 0.05?</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a><span class="co"># What is the magnitude of differences?</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Discuss multiple testing</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a><span class="co"># If you run 10 tests at Œ±=0.05, what's the probability of at least one false positive?</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Consider Bonferroni correction: Œ±_adjusted = 0.05 / number_of_tests</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Questions to consider:</strong></p>
<ul>
<li>Which region has the highest mean productivity? Lowest?</li>
<li>Are all pairwise differences statistically significant?</li>
<li>How does the multiple testing problem affect your conclusions?</li>
<li>What economic factors might explain regional productivity gaps?</li>
</ul>
</section>
<section id="what-youve-learned" class="level4">
<h4 class="anchored" data-anchor-id="what-youve-learned">What You‚Äôve Learned</h4>
<p>By completing this case study, you‚Äôve practiced <strong>all the major skills from Chapter 4</strong>:</p>
<p><strong>Statistical Methods:</strong></p>
<ul>
<li>Constructed confidence intervals (90%, 95%, 99%) for population means</li>
<li>Conducted two-sided hypothesis tests to compare groups and time periods</li>
<li>Performed one-sided directional tests for benchmark comparisons</li>
<li>Applied proportions inference to binary economic outcomes</li>
<li>Calculated and interpreted t-statistics, p-values, and margins of error</li>
<li>Used both manual calculations and <code>scipy.stats</code> functions</li>
</ul>
<p><strong>Economic Applications:</strong></p>
<ul>
<li>Tested convergence hypotheses (did productivity gaps narrow over time?)</li>
<li>Compared regional development levels (Africa, Europe, Asia, Americas)</li>
<li>Evaluated policy benchmarks (does productivity exceed thresholds?)</li>
<li>Identified ‚Äúgrowth winners‚Äù and ‚Äúgrowth losers‚Äù among countries</li>
<li>Distinguished between statistical and economic significance</li>
</ul>
<p><strong>Programming Skills:</strong></p>
<ul>
<li>Filtered and reshaped panel data (multi-index DataFrames)</li>
<li>Implemented statistical tests with <code>scipy.stats</code></li>
<li>Created informative visualizations (box plots, error bars)</li>
<li>Wrote clear, reproducible analysis code</li>
</ul>
<p><strong>Critical Thinking:</strong></p>
<ul>
<li>Formulated null and alternative hypotheses from economic questions</li>
<li>Interpreted p-values in context (not just ‚Äúsignificant‚Äù vs ‚Äúnot significant‚Äù)</li>
<li>Connected statistical results to economic meaning and policy implications</li>
<li>Recognized limitations (Type I/II errors, multiple testing problem)</li>
</ul>
<hr>
<p><strong>Next steps:</strong></p>
<p>These skills form the foundation for more advanced methods in later chapters:</p>
<ul>
<li><strong>Chapter 5:</strong> Regression analysis (relationship between two variables)</li>
<li><strong>Chapter 6:</strong> Multiple regression (controlling for confounders)</li>
<li><strong>Chapter 7:</strong> Hypothesis tests in regression models</li>
</ul>
<p>Statistical inference is everywhere in empirical economics. You‚Äôve now mastered the core toolkit for:</p>
<ul>
<li>Quantifying uncertainty</li>
<li>Testing economic theories</li>
<li>Making data-driven decisions</li>
<li>Communicating results with precision</li>
</ul>
<p><strong>Well done!</strong></p>
</section>
</section>
<section id="case-study-2-is-bolivias-development-equal-testing-differences-across-departments" class="level3">
<h3 class="anchored" data-anchor-id="case-study-2-is-bolivias-development-equal-testing-differences-across-departments">Case Study 2: Is Bolivia‚Äôs Development Equal? Testing Differences Across Departments</h3>
<p><strong>Research Question</strong>: Are there statistically significant differences in development levels across Bolivia‚Äôs nine departments?</p>
<p>In Chapter 1, we introduced the DS4Bolivia project and explored satellite-development relationships across Bolivia‚Äôs 339 municipalities. In this case study, we apply Chapter 4‚Äôs statistical inference tools‚Äîconfidence intervals and hypothesis tests‚Äîto test whether development levels differ significantly across Bolivia‚Äôs departments.</p>
<p><strong>The Data</strong>: Cross-sectional dataset covering 339 Bolivian municipalities from the <a href="https://github.com/quarcs-lab/ds4bolivia">DS4Bolivia Project</a>, including:</p>
<ul>
<li><strong>Development outcomes</strong>: Municipal Sustainable Development Index (IMDS, 0-100 composite)</li>
<li><strong>Satellite data</strong>: Log nighttime lights per capita (2017)</li>
<li><strong>Demographics</strong>: Population (2017), municipality and department names</li>
</ul>
<p><strong>Your Task</strong>: Use confidence intervals, one-sample tests, two-sample tests, and one-sided tests to evaluate whether Bolivia‚Äôs departments differ significantly in development‚Äîand whether those differences are large enough to matter for policy.</p>
<section id="load-the-ds4bolivia-data" class="level4">
<h4 class="anchored" data-anchor-id="load-the-ds4bolivia-data">Load the DS4Bolivia Data</h4>
<p>Let‚Äôs load the DS4Bolivia dataset and prepare the key variables for statistical inference.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the DS4Bolivia dataset</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>url_bol <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/quarcs-lab/ds4bolivia/master/ds4bolivia_v20250523.csv"</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>bol <span class="op">=</span> pd.read_csv(url_bol)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Select key variables for this case study</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>key_vars <span class="op">=</span> [<span class="st">'mun'</span>, <span class="st">'dep'</span>, <span class="st">'imds'</span>, <span class="st">'ln_NTLpc2017'</span>, <span class="st">'pop2017'</span>]</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>bol_key <span class="op">=</span> bol[key_vars].dropna().copy()</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"DS4BOLIVIA DATASET ‚Äî STATISTICAL INFERENCE CASE STUDY"</span>)</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Municipalities: </span><span class="sc">{</span><span class="bu">len</span>(bol_key)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Departments:    </span><span class="sc">{</span>bol_key[<span class="st">'dep'</span>]<span class="sc">.</span>nunique()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">IMDS summary:"</span>)</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(bol_key[<span class="st">'imds'</span>].describe().<span class="bu">round</span>(<span class="dv">2</span>))</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Municipalities per department:"</span>)</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(bol_key[<span class="st">'dep'</span>].value_counts().sort_index())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="task-1-confidence-interval-for-mean-imds-guided" class="level4">
<h4 class="anchored" data-anchor-id="task-1-confidence-interval-for-mean-imds-guided">Task 1: Confidence Interval for Mean IMDS (Guided)</h4>
<p><strong>Learning Goal</strong>: Apply Section 4.3 methods to calculate and interpret a confidence interval for a population mean.</p>
<p><strong>Economic Question</strong>: ‚ÄúWhat is the true average development level across all Bolivian municipalities?‚Äù</p>
<p><strong>Instructions</strong>:</p>
<ol type="1">
<li>Calculate the sample mean and standard error of <code>imds</code></li>
<li>Construct a 95% confidence interval using <code>scipy.stats.t.interval()</code></li>
<li>Print the sample mean, standard error, and CI bounds</li>
<li>Interpret the result: ‚ÄúWe are 95% confident that the true mean municipal development index lies between X and Y.‚Äù</li>
</ol>
<p><strong>Apply what you learned in Section 4.3</strong>: The formula is <span class="math inline">\(\bar{x} \pm t_{\alpha/2} \times SE\)</span>, where <span class="math inline">\(SE = s/\sqrt{n}\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Your code here: 95% Confidence Interval for national mean IMDS</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate sample statistics</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="bu">len</span>(bol_key[<span class="st">'imds'</span>])</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>x_bar <span class="op">=</span> bol_key[<span class="st">'imds'</span>].mean()</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>se <span class="op">=</span> bol_key[<span class="st">'imds'</span>].std() <span class="op">/</span> np.sqrt(n)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 95% confidence interval using t-distribution</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>ci_low, ci_high <span class="op">=</span> stats.t.interval(<span class="fl">0.95</span>, df<span class="op">=</span>n<span class="op">-</span><span class="dv">1</span>, loc<span class="op">=</span>x_bar, scale<span class="op">=</span>se)</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"95% CONFIDENCE INTERVAL FOR MEAN IMDS"</span>)</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sample size (n):       </span><span class="sc">{</span>n<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sample mean:           </span><span class="sc">{</span>x_bar<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Standard error:        </span><span class="sc">{</span>se<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"95% CI:                [</span><span class="sc">{</span>ci_low<span class="sc">:.4f}</span><span class="ss">, </span><span class="sc">{</span>ci_high<span class="sc">:.4f}</span><span class="ss">]"</span>)</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Interpretation: We are 95% confident that the true mean"</span>)</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"municipal development index lies between </span><span class="sc">{</span>ci_low<span class="sc">:.2f}</span><span class="ss"> and </span><span class="sc">{</span>ci_high<span class="sc">:.2f}</span><span class="ss">."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="task-2-hypothesis-test-national-development-target-guided" class="level4">
<h4 class="anchored" data-anchor-id="task-2-hypothesis-test-national-development-target-guided">Task 2: Hypothesis Test ‚Äî National Development Target (Guided)</h4>
<p><strong>Learning Goal</strong>: Apply Section 4.4 (two-sided test) to test a hypothesis about a population mean.</p>
<p><strong>Economic Question</strong>: ‚ÄúIs the average municipality at the midpoint of the development scale?‚Äù</p>
<p>A natural benchmark for the IMDS (which ranges from 0 to 100) is the midpoint of 50. If Bolivia‚Äôs municipalities were, on average, at this midpoint, we would expect <span class="math inline">\(\mu_{IMDS} = 50\)</span>.</p>
<p><strong>Instructions</strong>:</p>
<ol type="1">
<li>State the hypotheses: <span class="math inline">\(H_0: \mu = 50\)</span> vs <span class="math inline">\(H_1: \mu \neq 50\)</span></li>
<li>Use <code>scipy.stats.ttest_1samp()</code> to conduct the test</li>
<li>Report the t-statistic and p-value</li>
<li>State your conclusion at <span class="math inline">\(\alpha = 0.05\)</span></li>
<li>Discuss: Is the average municipality at the midpoint of the development scale?</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Your code here: One-sample t-test ‚Äî is mean IMDS = 50?</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Hypothesis test: H0: mu = 50 vs H1: mu != 50</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>t_stat, p_value <span class="op">=</span> stats.ttest_1samp(bol_key[<span class="st">'imds'</span>], popmean<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"HYPOTHESIS TEST: IS MEAN IMDS = 50?"</span>)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"H‚ÇÄ: Œº = 50  vs  H‚ÇÅ: Œº ‚â† 50"</span>)</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Sample mean:   </span><span class="sc">{</span>bol_key[<span class="st">'imds'</span>]<span class="sc">.</span>mean()<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"t-statistic:   </span><span class="sc">{</span>t_stat<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"p-value:       </span><span class="sc">{</span>p_value<span class="sc">:.6f}</span><span class="ss">"</span>)</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Conclusion at Œ± = 0.05:"</span>)</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> p_value <span class="op">&lt;</span> <span class="fl">0.05</span>:</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  Reject H‚ÇÄ (p = </span><span class="sc">{</span>p_value<span class="sc">:.6f}</span><span class="ss"> &lt; 0.05)"</span>)</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  The average IMDS is significantly different from 50."</span>)</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  Fail to reject H‚ÇÄ (p = </span><span class="sc">{</span>p_value<span class="sc">:.6f}</span><span class="ss"> ‚â• 0.05)"</span>)</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  No significant evidence that mean IMDS differs from 50."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p><strong>Key Concept 4.12: Statistical Significance in Development</strong></p>
<p>A statistically significant difference between departments does not automatically imply a <strong>policy-relevant</strong> gap. With 339 municipalities providing large sample sizes, even small differences can achieve statistical significance. Policy makers must evaluate the <strong>magnitude</strong> of differences alongside p-values. A 2-point difference in IMDS may be statistically significant but practically negligible for resource allocation decisions.</p>
</blockquote>
</section>
<section id="task-3-department-level-inference-semi-guided" class="level4">
<h4 class="anchored" data-anchor-id="task-3-department-level-inference-semi-guided">Task 3: Department-Level Inference (Semi-guided)</h4>
<p><strong>Learning Goal</strong>: Apply confidence intervals to compare subgroups.</p>
<p><strong>Economic Question</strong>: ‚ÄúWhich departments have significantly different development levels from one another?‚Äù</p>
<p><strong>Instructions</strong>:</p>
<ol type="1">
<li>Calculate the 95% confidence interval for mean <code>imds</code> in each of Bolivia‚Äôs 9 departments</li>
<li>Create a <strong>forest plot</strong> (horizontal error bars) showing the CI for each department</li>
<li>Identify which departments‚Äô CIs overlap (suggesting no significant difference) and which don‚Äôt</li>
<li>Discuss what the pattern reveals about regional inequality</li>
</ol>
<p><strong>Hint</strong>: Use <code>groupby('dep')</code> to calculate department-level statistics, then <code>plt.errorbar()</code> or <code>plt.barh()</code> with error bars for the forest plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Your code here: Department-level 95% CIs and forest plot</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate department-level statistics</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>dept_stats <span class="op">=</span> bol_key.groupby(<span class="st">'dep'</span>)[<span class="st">'imds'</span>].agg([<span class="st">'mean'</span>, <span class="st">'std'</span>, <span class="st">'count'</span>]).sort_values(<span class="st">'mean'</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>dept_stats[<span class="st">'se'</span>] <span class="op">=</span> dept_stats[<span class="st">'std'</span>] <span class="op">/</span> np.sqrt(dept_stats[<span class="st">'count'</span>])</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>dept_stats[<span class="st">'ci_low'</span>] <span class="op">=</span> dept_stats[<span class="st">'mean'</span>] <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> dept_stats[<span class="st">'se'</span>]</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>dept_stats[<span class="st">'ci_high'</span>] <span class="op">=</span> dept_stats[<span class="st">'mean'</span>] <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> dept_stats[<span class="st">'se'</span>]</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"95% CONFIDENCE INTERVALS FOR MEAN IMDS BY DEPARTMENT"</span>)</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dept_stats[[<span class="st">'mean'</span>, <span class="st">'se'</span>, <span class="st">'ci_low'</span>, <span class="st">'ci_high'</span>, <span class="st">'count'</span>]].<span class="bu">round</span>(<span class="dv">2</span>).to_string())</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Forest plot</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>departments <span class="op">=</span> dept_stats.index</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>y_pos <span class="op">=</span> <span class="bu">range</span>(<span class="bu">len</span>(departments))</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>ax.errorbar(dept_stats[<span class="st">'mean'</span>], y_pos,</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>            xerr<span class="op">=</span><span class="fl">1.96</span> <span class="op">*</span> dept_stats[<span class="st">'se'</span>],</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>            fmt<span class="op">=</span><span class="st">'o'</span>, color<span class="op">=</span><span class="st">'navy'</span>, capsize<span class="op">=</span><span class="dv">5</span>, capthick<span class="op">=</span><span class="fl">1.5</span>, markersize<span class="op">=</span><span class="dv">6</span>)</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>ax.set_yticks(y_pos)</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>ax.set_yticklabels(departments)</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Mean IMDS (with 95% CI)'</span>)</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Forest Plot: Municipal Development by Department'</span>)</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>ax.axvline(x<span class="op">=</span>bol_key[<span class="st">'imds'</span>].mean(), color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, label<span class="op">=</span><span class="st">'National mean'</span>)</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>ax.grid(axis<span class="op">=</span><span class="st">'x'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="task-4-one-sided-test-is-the-capital-department-more-developed-semi-guided" class="level4">
<h4 class="anchored" data-anchor-id="task-4-one-sided-test-is-the-capital-department-more-developed-semi-guided">Task 4: One-Sided Test ‚Äî Is the Capital Department More Developed? (Semi-guided)</h4>
<p><strong>Learning Goal</strong>: Apply Section 4.6 (one-sided tests) to a directional hypothesis.</p>
<p><strong>Economic Question</strong>: ‚ÄúIs La Paz department‚Äôs mean IMDS significantly greater than the national mean?‚Äù</p>
<p><strong>Instructions</strong>:</p>
<ol type="1">
<li>Extract IMDS values for La Paz department</li>
<li>Test <span class="math inline">\(H_0: \mu_{LP} \leq \mu_{national}\)</span> vs <span class="math inline">\(H_1: \mu_{LP} &gt; \mu_{national}\)</span> using a one-sided t-test</li>
<li>Calculate the one-sided p-value (divide the two-sided p-value by 2, checking direction)</li>
<li>Report and interpret the result at <span class="math inline">\(\alpha = 0.05\)</span></li>
<li>Discuss: Is the capital department significantly more developed?</li>
</ol>
<p><strong>Hint</strong>: Use <code>scipy.stats.ttest_1samp()</code> with the national mean as the test value, then adjust for a one-sided test.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Your code here: One-sided t-test for La Paz department</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract La Paz IMDS values</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>la_paz <span class="op">=</span> bol_key[bol_key[<span class="st">'dep'</span>] <span class="op">==</span> <span class="st">'La Paz'</span>][<span class="st">'imds'</span>]</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>national_mean <span class="op">=</span> bol_key[<span class="st">'imds'</span>].mean()</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Two-sided test first</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>t_stat_lp, p_two <span class="op">=</span> stats.ttest_1samp(la_paz, popmean<span class="op">=</span>national_mean)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="co"># One-sided p-value: H1: mu_LP &gt; national_mean</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="co"># If t &gt; 0, one-sided p = p_two / 2; if t &lt; 0, one-sided p = 1 - p_two / 2</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>p_one <span class="op">=</span> p_two <span class="op">/</span> <span class="dv">2</span> <span class="cf">if</span> t_stat_lp <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="dv">1</span> <span class="op">-</span> p_two <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"ONE-SIDED TEST: LA PAZ &gt; NATIONAL MEAN?"</span>)</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"H‚ÇÄ: Œº_LaPaz ‚â§ </span><span class="sc">{</span>national_mean<span class="sc">:.2f}</span><span class="ss">  vs  H‚ÇÅ: Œº_LaPaz &gt; </span><span class="sc">{</span>national_mean<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">La Paz municipalities:  </span><span class="sc">{</span><span class="bu">len</span>(la_paz)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"La Paz mean IMDS:       </span><span class="sc">{</span>la_paz<span class="sc">.</span>mean()<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"National mean IMDS:     </span><span class="sc">{</span>national_mean<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"t-statistic:            </span><span class="sc">{</span>t_stat_lp<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"One-sided p-value:      </span><span class="sc">{</span>p_one<span class="sc">:.6f}</span><span class="ss">"</span>)</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Conclusion at Œ± = 0.05:"</span>)</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> p_one <span class="op">&lt;</span> <span class="fl">0.05</span>:</span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  Reject H‚ÇÄ (p = </span><span class="sc">{</span>p_one<span class="sc">:.6f}</span><span class="ss"> &lt; 0.05)"</span>)</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  La Paz's mean IMDS is significantly greater than the national mean."</span>)</span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  Fail to reject H‚ÇÄ (p = </span><span class="sc">{</span>p_one<span class="sc">:.6f}</span><span class="ss"> ‚â• 0.05)"</span>)</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  No significant evidence that La Paz exceeds the national mean."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p><strong>Key Concept 4.13: Subnational Inference Challenges</strong></p>
<p>When testing hypotheses about departmental means, each department contains a different number of municipalities (ranging from ~10 to ~50+). Departments with fewer municipalities have <strong>wider confidence intervals</strong> and less statistical power. This means we may fail to detect real differences for smaller departments‚Äînot because the differences don‚Äôt exist, but because we lack sufficient data to establish them conclusively.</p>
</blockquote>
</section>
<section id="task-5-comparing-two-departments-independent" class="level4">
<h4 class="anchored" data-anchor-id="task-5-comparing-two-departments-independent">Task 5: Comparing Two Departments (Independent)</h4>
<p><strong>Learning Goal</strong>: Apply two-sample t-tests to compare group means.</p>
<p><strong>Economic Question</strong>: ‚ÄúIs the development gap between the most and least developed departments statistically significant?‚Äù</p>
<p><strong>Instructions</strong>:</p>
<ol type="1">
<li>Identify the departments with the highest and lowest mean IMDS (from Task 3 results)</li>
<li>Use <code>scipy.stats.ttest_ind()</code> to perform a two-sample t-test comparing these departments</li>
<li>Report the t-statistic and p-value</li>
<li>Discuss both <strong>statistical significance</strong> (p-value) and <strong>practical significance</strong> (magnitude of the gap)</li>
<li>What does this tell us about regional inequality in Bolivia?</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Your code here: Two-sample t-test ‚Äî highest vs lowest IMDS department</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify highest and lowest departments</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>dept_means <span class="op">=</span> bol_key.groupby(<span class="st">'dep'</span>)[<span class="st">'imds'</span>].mean()</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>top_dept <span class="op">=</span> dept_means.idxmax()</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>bot_dept <span class="op">=</span> dept_means.idxmin()</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract IMDS values for each</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>top_values <span class="op">=</span> bol_key[bol_key[<span class="st">'dep'</span>] <span class="op">==</span> top_dept][<span class="st">'imds'</span>]</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>bot_values <span class="op">=</span> bol_key[bol_key[<span class="st">'dep'</span>] <span class="op">==</span> bot_dept][<span class="st">'imds'</span>]</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Two-sample t-test</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>t_stat_2s, p_value_2s <span class="op">=</span> stats.ttest_ind(top_values, bot_values)</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"TWO-SAMPLE T-TEST: </span><span class="sc">{</span>top_dept<span class="sc">.</span>upper()<span class="sc">}</span><span class="ss"> vs </span><span class="sc">{</span>bot_dept<span class="sc">.</span>upper()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Highest IMDS department: </span><span class="sc">{</span>top_dept<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Mean IMDS:   </span><span class="sc">{</span>top_values<span class="sc">.</span>mean()<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  N:           </span><span class="sc">{</span><span class="bu">len</span>(top_values)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Lowest IMDS department:  </span><span class="sc">{</span>bot_dept<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Mean IMDS:   </span><span class="sc">{</span>bot_values<span class="sc">.</span>mean()<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  N:           </span><span class="sc">{</span><span class="bu">len</span>(bot_values)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Difference in means:    </span><span class="sc">{</span>top_values<span class="sc">.</span>mean() <span class="op">-</span> bot_values<span class="sc">.</span>mean()<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"t-statistic:            </span><span class="sc">{</span>t_stat_2s<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"p-value:                </span><span class="sc">{</span>p_value_2s<span class="sc">:.6f}</span><span class="ss">"</span>)</span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Conclusion at Œ± = 0.05:"</span>)</span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> p_value_2s <span class="op">&lt;</span> <span class="fl">0.05</span>:</span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  Reject H‚ÇÄ (p = </span><span class="sc">{</span>p_value_2s<span class="sc">:.6f}</span><span class="ss"> &lt; 0.05)"</span>)</span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  The development gap of </span><span class="sc">{</span>top_values<span class="sc">.</span>mean() <span class="op">-</span> bot_values<span class="sc">.</span>mean()<span class="sc">:.2f}</span><span class="ss"> points is statistically significant."</span>)</span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  Fail to reject H‚ÇÄ (p = </span><span class="sc">{</span>p_value_2s<span class="sc">:.6f}</span><span class="ss"> ‚â• 0.05)"</span>)</span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  No significant evidence of a development gap."</span>)</span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Practical significance: A gap of </span><span class="sc">{</span>top_values<span class="sc">.</span>mean() <span class="op">-</span> bot_values<span class="sc">.</span>mean()<span class="sc">:.2f}</span><span class="ss"> points on a 0-100 scale"</span>)</span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"represents a </span><span class="sc">{</span><span class="st">'substantial'</span> <span class="cf">if</span> <span class="bu">abs</span>(top_values.mean() <span class="op">-</span> bot_values.mean()) <span class="op">&gt;</span> <span class="dv">10</span> <span class="cf">else</span> <span class="st">'modest'</span><span class="sc">}</span><span class="ss"> difference in development outcomes."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="task-6-policy-brief-on-regional-inequality-independent" class="level4">
<h4 class="anchored" data-anchor-id="task-6-policy-brief-on-regional-inequality-independent">Task 6: Policy Brief on Regional Inequality (Independent)</h4>
<p><strong>Objective</strong>: Write a 200-300 word policy brief summarizing your statistical findings.</p>
<p><strong>Your brief should address</strong>:</p>
<ol type="1">
<li><strong>Are departmental differences statistically significant?</strong> Summarize results from Tasks 3-5.</li>
<li><strong>Which departments need the most attention?</strong> Use the forest plot and CI analysis to identify lagging regions.</li>
<li><strong>How confident are we in these conclusions?</strong> Discuss the confidence levels and what the CIs tell us.</li>
<li><strong>What are the limitations of these tests?</strong> Consider sample sizes, assumptions, and what the tests cannot tell us.</li>
</ol>
<p><strong>Format</strong>: Write your brief in the markdown cell below. Support your arguments with specific numbers from your analysis (means, CIs, p-values).</p>
<p><strong>Tip</strong>: Remember Key Concepts 4.12 and 4.13‚Äîdistinguish between statistical significance and policy relevance, and consider how unequal sample sizes affect your conclusions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Your code here: Additional analysis to support your policy brief</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Suggestions:</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Create a summary table of all department CIs and test results</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Calculate effect sizes (Cohen's d) for the two-sample comparison</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Visualize the national IMDS distribution with department means marked</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: Summary statistics for the policy brief</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"SUMMARY TABLE FOR POLICY BRIEF"</span>)</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>dept_summary <span class="op">=</span> bol_key.groupby(<span class="st">'dep'</span>)[<span class="st">'imds'</span>].agg([<span class="st">'mean'</span>, <span class="st">'std'</span>, <span class="st">'count'</span>]).sort_values(<span class="st">'mean'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>dept_summary[<span class="st">'se'</span>] <span class="op">=</span> dept_summary[<span class="st">'std'</span>] <span class="op">/</span> np.sqrt(dept_summary[<span class="st">'count'</span>])</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>dept_summary[<span class="st">'ci_95'</span>] <span class="op">=</span> dept_summary.<span class="bu">apply</span>(</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">lambda</span> r: <span class="ss">f"[</span><span class="sc">{</span>r[<span class="st">'mean'</span>] <span class="op">-</span> <span class="fl">1.96</span><span class="op">*</span>r[<span class="st">'se'</span>]<span class="sc">:.1f}</span><span class="ss">, </span><span class="sc">{</span>r[<span class="st">'mean'</span>] <span class="op">+</span> <span class="fl">1.96</span><span class="op">*</span>r[<span class="st">'se'</span>]<span class="sc">:.1f}</span><span class="ss">]"</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dept_summary[[<span class="st">'mean'</span>, <span class="st">'std'</span>, <span class="st">'count'</span>, <span class="st">'ci_95'</span>]].<span class="bu">round</span>(<span class="dv">2</span>).to_string())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="what-youve-learned-from-this-case-study" class="level4">
<h4 class="anchored" data-anchor-id="what-youve-learned-from-this-case-study">What You‚Äôve Learned from This Case Study</h4>
<p>Through this analysis of subnational development in Bolivia, you‚Äôve applied the full Chapter 4 statistical inference toolkit:</p>
<ul>
<li><strong>Confidence intervals</strong> for mean development levels</li>
<li><strong>One-sample and two-sample hypothesis tests</strong> to evaluate development benchmarks and compare groups</li>
<li><strong>One-sided tests</strong> for directional hypotheses about specific departments</li>
<li><strong>Forest plots</strong> for comparing group CIs visually</li>
<li><strong>Statistical vs practical significance</strong> in a policy context</li>
<li><strong>Critical thinking</strong> about sample size, statistical power, and inference limitations</li>
</ul>
<p><strong>Connection to research</strong>: The DS4Bolivia project uses these same statistical tools to evaluate whether satellite-predicted development indicators are significantly different from survey-based measures, providing evidence for the reliability of remote sensing approaches to SDG monitoring.</p>
<p><strong>Looking ahead</strong>: In Chapter 5, we‚Äôll move beyond testing means to exploring <em>bivariate relationships</em>‚Äîhow nighttime lights relate to specific development outcomes across Bolivia‚Äôs municipalities.</p>
<hr>
<p><strong>Well done!</strong> You‚Äôve now tested development hypotheses for both cross-country convergence and Bolivian regional inequality using the tools of statistical inference.</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'alternate';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          // default icon
          link.classList.add("external");
      }
    }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../notebooks_colab/ch03_The_Sample_Mean.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">3. The Sample Mean</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../notebooks_colab/ch05_Bivariate_Data_Summary.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-title">5. Bivariate Data Summary</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  var tocNav = document.getElementById('TOC');
  if (tocNav) {
    var coverDiv = document.createElement('div');
    coverDiv.id = 'toc-cover-image';
    var img = document.createElement('img');
    var path = window.location.pathname;
    if (path.indexOf('/notebooks_colab/') !== -1) {
      img.src = '../images/book1cover.jpg';
    } else {
      img.src = 'images/book1cover.jpg';
    }
    img.alt = 'Econometrics Powered by AI';
    coverDiv.appendChild(img);
    tocNav.parentNode.insertBefore(coverDiv, tocNav);
  }
});
</script>



<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>