<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>13. Case Studies for Multiple Regression ‚Äì Econometrics Powered by AI</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../notebooks_colab/ch14_Regression_with_Indicator_Variables.html" rel="next">
<link href="../notebooks_colab/ch12_Further_Topics_in_Multiple_Regression.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-8b4baf804e461d9b72633f0de59a0cac.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-f1aadacce99040138bbb613f9330654f.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-0da87e08732b0aad79cc276a1be62fe2.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-c77ee8f8b07d41e0e364fbf0a2ddebb9.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../custom.css">
</head>

<body class="nav-sidebar floating quarto-dark"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = true;
    const darkModeDefault = authorPrefersDark;
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../notebooks_colab/ch10_Data_Summary_for_Multiple_Regression.html">Multiple Regression</a></li><li class="breadcrumb-item"><a href="../notebooks_colab/ch13_Case_Studies_for_Multiple_Regression.html"><span class="chapter-title">13. Case Studies for Multiple Regression</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Econometrics Powered by AI</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Statistical Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch01_Analysis_of_Economics_Data.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">1. Analysis of Economics Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch02_Univariate_Data_Summary.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">2. Univariate Data Summary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch03_The_Sample_Mean.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">3. The Sample Mean</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch04_Statistical_Inference_for_the_Mean.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">4. Statistical Inference for the Mean</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Bivariate Regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch05_Bivariate_Data_Summary.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">5. Bivariate Data Summary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch06_The_Least_Squares_Estimator.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">6. The Least Squares Estimator</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch07_Statistical_Inference_for_Bivariate_Regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">7. Statistical Inference for Bivariate Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch08_Case_Studies_for_Bivariate_Regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">8. Case Studies for Bivariate Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch09_Models_with_Natural_Logarithms.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">9. Models with Natural Logarithms</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Multiple Regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch10_Data_Summary_for_Multiple_Regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">10. Data Summary for Multiple Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch11_Statistical_Inference_for_Multiple_Regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">11. Statistical Inference for Multiple Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch12_Further_Topics_in_Multiple_Regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">12. Further Topics in Multiple Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch13_Case_Studies_for_Multiple_Regression.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">13. Case Studies for Multiple Regression</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Advanced Topics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch14_Regression_with_Indicator_Variables.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">14. Regression with Indicator Variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch15_Regression_with_Transformed_Variables.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">15. Regression with Transformed Variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch16_Checking_the_Model_and_Data.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">16. Checking the Model and Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch17_Panel_Data_Time_Series_Data_Causation.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">17. Panel Data, Time Series Data, Causation</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul class="collapse">
  <li><a href="#chapter-overview" id="toc-chapter-overview" class="nav-link active" data-scroll-target="#chapter-overview">Chapter Overview</a></li>
  <li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#school-academic-performance-index" id="toc-school-academic-performance-index" class="nav-link" data-scroll-target="#school-academic-performance-index">13.1 School Academic Performance Index</a></li>
  <li><a href="#cobb-douglas-production-function" id="toc-cobb-douglas-production-function" class="nav-link" data-scroll-target="#cobb-douglas-production-function">13.2 Cobb-Douglas Production Function</a></li>
  <li><a href="#phillips-curve-and-omitted-variables-bias" id="toc-phillips-curve-and-omitted-variables-bias" class="nav-link" data-scroll-target="#phillips-curve-and-omitted-variables-bias">13.3 Phillips Curve and Omitted Variables Bias</a></li>
  <li><a href="#automobile-fuel-efficiency" id="toc-automobile-fuel-efficiency" class="nav-link" data-scroll-target="#automobile-fuel-efficiency">13.4 Automobile Fuel Efficiency</a></li>
  <li><a href="#rand-health-insurance-experiment-rct" id="toc-rand-health-insurance-experiment-rct" class="nav-link" data-scroll-target="#rand-health-insurance-experiment-rct">13.5 Rand Health Insurance Experiment (RCT)</a></li>
  <li><a href="#health-care-access-difference-in-differences" id="toc-health-care-access-difference-in-differences" class="nav-link" data-scroll-target="#health-care-access-difference-in-differences">13.6 Health Care Access (Difference-in-Differences)</a></li>
  <li><a href="#political-incumbency-regression-discontinuity" id="toc-political-incumbency-regression-discontinuity" class="nav-link" data-scroll-target="#political-incumbency-regression-discontinuity">13.7 Political Incumbency (Regression Discontinuity)</a></li>
  <li><a href="#institutions-and-gdp-instrumental-variables" id="toc-institutions-and-gdp-instrumental-variables" class="nav-link" data-scroll-target="#institutions-and-gdp-instrumental-variables">13.8 Institutions and GDP (Instrumental Variables)</a></li>
  <li><a href="#from-raw-data-to-final-data" id="toc-from-raw-data-to-final-data" class="nav-link" data-scroll-target="#from-raw-data-to-final-data">13.9 From Raw Data to Final Data</a></li>
  <li><a href="#key-takeaways" id="toc-key-takeaways" class="nav-link" data-scroll-target="#key-takeaways">Key Takeaways</a></li>
  <li><a href="#practice-exercises" id="toc-practice-exercises" class="nav-link" data-scroll-target="#practice-exercises">Practice Exercises</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<div id="google_translate_element" style="padding: 8px 0;"></div>
<script type="text/javascript">
function googleTranslateElementInit() {
  new google.translate.TranslateElement({
    pageLanguage: 'en',
    layout: google.translate.TranslateElement.InlineLayout.HORIZONTAL
  }, 'google_translate_element');
}
</script>
<script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../notebooks_colab/ch10_Data_Summary_for_Multiple_Regression.html">Multiple Regression</a></li><li class="breadcrumb-item"><a href="../notebooks_colab/ch13_Case_Studies_for_Multiple_Regression.html"><span class="chapter-title">13. Case Studies for Multiple Regression</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-title">13. Case Studies for Multiple Regression</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><strong>metricsAI: An Introduction to Econometrics with Python and AI in the Cloud</strong></p>
<p><em><a href="https://carlos-mendez.org">Carlos Mendez</a></em></p>
<p><img src="https://raw.githubusercontent.com/quarcs-lab/metricsai/main/images/ch13_visual_summary.jpg" alt="Chapter 13 Visual Summary" width="65%"></p>
<p>This notebook presents comprehensive case studies applying multiple regression to real-world economic problems.</p>
<a href="https://colab.research.google.com/github/quarcs-lab/metricsai/blob/main/notebooks_colab/ch13_Case_Studies_for_Multiple_Regression.ipynb"><img src="https://colab.research.google.com/assets/colab-badge.svg" class="img-fluid" alt="Open In Colab"></a>
<div class="chapter-resources">
<p><a href="https://www.youtube.com/watch?v=auS4yrgbAQA" target="_blank" class="resource-btn">üé¨ AI Video</a> <a href="https://carlos-mendez.my.canva.site/s13-case-studies-for-multiple-regression-pdf" target="_blank" class="resource-btn">‚ú® AI Slides</a> <a href="https://cameron.econ.ucdavis.edu/aed/traedv1_13" target="_blank" class="resource-btn">üìä Cameron Slides</a> <a href="https://app.edcafe.ai/quizzes/697869f02f5d08069e04c94f" target="_blank" class="resource-btn">‚úèÔ∏è Quiz</a> <a href="https://app.edcafe.ai/chatbots/6978a2122f5d08069e071d09" target="_blank" class="resource-btn">ü§ñ AI Tutor</a></p>
</div>
<section id="chapter-overview" class="level2">
<h2 class="anchored" data-anchor-id="chapter-overview">Chapter Overview</h2>
<p>This chapter presents <strong>nine comprehensive case studies</strong> that apply multiple regression techniques to real-world economic questions. From analyzing school performance to estimating production functions to testing causal relationships, these case studies demonstrate the breadth and power of regression analysis.</p>
<p><strong>Design Note:</strong> This chapter uses an integrated case study structure where sections 13.1‚Äì13.9 ARE the case studies, each demonstrating different regression techniques and applications.</p>
<section id="what-youll-learn" class="level3">
<h3 class="anchored" data-anchor-id="what-youll-learn">What You‚Äôll Learn</h3>
<p>By the end of this chapter, you will be able to:</p>
<ol type="1">
<li>Apply multiple regression to analyze school performance and socioeconomic factors</li>
<li>Use logarithmic transformations to estimate production functions</li>
<li>Understand and test for constant returns to scale</li>
<li>Identify and correct for omitted variables bias</li>
<li>Apply cluster-robust standard errors for grouped data</li>
<li>Understand randomized control trials and difference-in-differences methods</li>
<li>Apply regression discontinuity design to causal questions</li>
<li>Use instrumental variables to estimate causal effects</li>
<li>Navigate the data cleaning and preparation process</li>
</ol>
</section>
<section id="chapter-outline" class="level3">
<h3 class="anchored" data-anchor-id="chapter-outline">Chapter Outline</h3>
<ul>
<li><strong>13.1</strong> School Academic Performance Index</li>
<li><strong>13.2</strong> Cobb-Douglas Production Function</li>
<li><strong>13.3</strong> Phillips Curve and Omitted Variables Bias</li>
<li><strong>13.4</strong> Automobile Fuel Efficiency</li>
<li><strong>13.5</strong> RAND Health Insurance Experiment (RCT)</li>
<li><strong>13.6</strong> Health Care Access (Difference-in-Differences)</li>
<li><strong>13.7</strong> Political Incumbency (Regression Discontinuity)</li>
<li><strong>13.8</strong> Institutions and GDP (Instrumental Variables)</li>
<li><strong>13.9</strong> From Raw Data to Final Data</li>
<li><strong>Key Takeaways</strong> ‚Äî Chapter review and consolidated lessons</li>
<li><strong>Practice Exercises</strong> ‚Äî Reinforce your understanding</li>
</ul>
<p><strong>Datasets used:</strong></p>
<ul>
<li><strong>AED_API99.DTA</strong>: 807 California high schools, Academic Performance Index (1999) ‚Äî Case Study 13.1</li>
<li><strong>AED_CobbDouglas.DTA</strong>: 24 years of U.S. manufacturing data (1899‚Äì1922) ‚Äî Case Study 13.2</li>
<li><strong>AED_PhillipsCurve.DTA</strong>: 66 years of U.S. macroeconomic data (1949‚Äì2014) ‚Äî Case Study 13.3</li>
<li><strong>AED_AutoEfficiency.DTA</strong>: 26,995 vehicles, fuel efficiency data (1980‚Äì2006) ‚Äî Case Study 13.4</li>
<li><strong>AED_RandHealthInsurance.DTA</strong>: RAND health insurance experiment (RCT) ‚Äî Case Study 13.5</li>
<li><strong>AED_SouthAfricaHealth.DTA</strong>: South Africa cross-sectional health data (DiD) ‚Äî Case Study 13.6</li>
<li><strong>AED_SenateIncumbency.DTA</strong>: U.S. Senate election results (RD) ‚Äî Case Study 13.7</li>
<li><strong>AED_InstitutionsGDP.DTA</strong>: Cross-country institutions and GDP data (IV) ‚Äî Case Study 13.8</li>
</ul>
<p><strong>Estimated time:</strong> 120‚Äì150 minutes</p>
</section>
</section>
<section id="setup" class="level2">
<h2 class="anchored" data-anchor-id="setup">Setup</h2>
<div id="cell-3" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:52.648939Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:52.648709Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:55.018037Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:55.017431Z&quot;}}" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.formula.api <span class="im">import</span> ols</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.stats.diagnostic <span class="im">import</span> het_breuschpagan</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.stats.outliers_influence <span class="im">import</span> variance_inflation_factor</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">'ignore'</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Random seed</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Data URL</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>GITHUB_DATA_URL <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/quarcs-lab/data-open/master/AED/"</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Set plotting style (dark theme matching book design)</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>plt.style.use(<span class="st">'dark_background'</span>)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>sns.set_style(<span class="st">"darkgrid"</span>)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>plt.rcParams.update({</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">'axes.facecolor'</span>: <span class="st">'#1a2235'</span>,</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">'figure.facecolor'</span>: <span class="st">'#12162c'</span>,</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">'grid.color'</span>: <span class="st">'#3a4a6b'</span>,</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">'figure.figsize'</span>: (<span class="dv">10</span>, <span class="dv">6</span>),</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">'text.color'</span>: <span class="st">'white'</span>,</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">'axes.labelcolor'</span>: <span class="st">'white'</span>,</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">'xtick.color'</span>: <span class="st">'white'</span>,</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ytick.color'</span>: <span class="st">'white'</span>,</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">'axes.edgecolor'</span>: <span class="st">'#1a2235'</span>,</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"‚úì Setup complete!"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>‚úì Setup complete!</code></pre>
</div>
</div>
</section>
<section id="school-academic-performance-index" class="level2">
<h2 class="anchored" data-anchor-id="school-academic-performance-index">13.1 School Academic Performance Index</h2>
<p>Analyzing factors that determine school test scores in California.</p>
<div id="cell-5" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:55.052883Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:55.052266Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:55.388492Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:55.387857Z&quot;}}" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load API data</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>data_api <span class="op">=</span> pd.read_stata(GITHUB_DATA_URL <span class="op">+</span> <span class="st">'AED_API99.DTA'</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Loaded </span><span class="sc">{</span><span class="bu">len</span>(data_api)<span class="sc">}</span><span class="ss"> California high schools"</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Variables: </span><span class="sc">{</span><span class="bu">list</span>(data_api.columns)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>data_api.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Loaded 807 California high schools
Variables: ['sch_code', 'api99', 'edparent', 'meals', 'englearn', 'yearround', 'credteach', 'emerteach', 'avg_ed_raw', 'pct_af_am', 'pct_am_ind', 'pct_asian', 'pct_fil', 'pct_hisp', 'pct_pac', 'pct_white', 'mobility']</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">sch_code</th>
<th data-quarto-table-cell-role="th">api99</th>
<th data-quarto-table-cell-role="th">edparent</th>
<th data-quarto-table-cell-role="th">meals</th>
<th data-quarto-table-cell-role="th">englearn</th>
<th data-quarto-table-cell-role="th">yearround</th>
<th data-quarto-table-cell-role="th">credteach</th>
<th data-quarto-table-cell-role="th">emerteach</th>
<th data-quarto-table-cell-role="th">avg_ed_raw</th>
<th data-quarto-table-cell-role="th">pct_af_am</th>
<th data-quarto-table-cell-role="th">pct_am_ind</th>
<th data-quarto-table-cell-role="th">pct_asian</th>
<th data-quarto-table-cell-role="th">pct_fil</th>
<th data-quarto-table-cell-role="th">pct_hisp</th>
<th data-quarto-table-cell-role="th">pct_pac</th>
<th data-quarto-table-cell-role="th">pct_white</th>
<th data-quarto-table-cell-role="th">mobility</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>130054</td>
<td>633</td>
<td>12.78</td>
<td>21</td>
<td>6</td>
<td>0</td>
<td>88</td>
<td>13</td>
<td>2.89</td>
<td>6</td>
<td>1</td>
<td>12</td>
<td>9</td>
<td>30</td>
<td>3</td>
<td>39</td>
<td>0.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>130062</td>
<td>646</td>
<td>13.42</td>
<td>16</td>
<td>17</td>
<td>0</td>
<td>86</td>
<td>24</td>
<td>3.21</td>
<td>5</td>
<td>1</td>
<td>27</td>
<td>6</td>
<td>17</td>
<td>1</td>
<td>43</td>
<td>12.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>130096</td>
<td>797</td>
<td>14.90</td>
<td>1</td>
<td>2</td>
<td>0</td>
<td>100</td>
<td>4</td>
<td>3.95</td>
<td>1</td>
<td>1</td>
<td>9</td>
<td>2</td>
<td>5</td>
<td>0</td>
<td>81</td>
<td>0.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>130229</td>
<td>693</td>
<td>13.66</td>
<td>0</td>
<td>18</td>
<td>0</td>
<td>93</td>
<td>7</td>
<td>3.33</td>
<td>5</td>
<td>1</td>
<td>33</td>
<td>7</td>
<td>10</td>
<td>1</td>
<td>38</td>
<td>7.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>130450</td>
<td>773</td>
<td>14.94</td>
<td>0</td>
<td>9</td>
<td>0</td>
<td>98</td>
<td>7</td>
<td>3.97</td>
<td>8</td>
<td>0</td>
<td>28</td>
<td>1</td>
<td>9</td>
<td>1</td>
<td>46</td>
<td>0.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<section id="about-the-dataset" class="level3">
<h3 class="anchored" data-anchor-id="about-the-dataset"><strong>About the Dataset</strong></h3>
<p>This dataset contains information on <strong>807 California high schools</strong> from 1999. The Academic Performance Index (API) is a score from 200-1000 that measures school performance based on standardized test results.</p>
<p><strong>Key Variables:</strong></p>
<ul>
<li><code>api99</code>: Academic Performance Index (outcome variable)</li>
<li><code>edparent</code>: Average parental education level (1-5 scale)</li>
<li><code>mealpct</code>: Percent of students eligible for free/reduced meals (poverty proxy)</li>
<li><code>elpct</code>: Percent of English language learners</li>
<li><code>yrs_teach</code>: Average teacher experience in years</li>
<li><code>totcredpc</code>: Per-pupil total credentials</li>
<li><code>emrpct</code>: Percent of emergency credential teachers</li>
</ul>
<p><strong>Economic Question:</strong> What factors determine school performance? Is it resources (teachers, funding) or student demographics (poverty, language, parental education)?</p>
<div id="cell-7" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:55.391774Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:55.391504Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:55.407736Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:55.407144Z&quot;}}" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"SUMMARY STATISTICS"</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>vars_api <span class="op">=</span> [<span class="st">'api99'</span>, <span class="st">'edparent'</span>, <span class="st">'meals'</span>, <span class="st">'englearn'</span>, <span class="st">'yearround'</span>, <span class="st">'credteach'</span>, <span class="st">'emerteach'</span>]</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data_api[vars_api].describe())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
SUMMARY STATISTICS
======================================================================
            api99    edparent       meals    englearn   yearround   credteach  \
count  807.000000  807.000000  807.000000  807.000000  807.000000  807.000000   
mean   620.944238   12.841289   21.918216   14.003717    0.023544   89.836431   
std    107.440771    1.234461   23.667952   12.786517    0.151717    8.437510   
min    355.000000    9.620000    0.000000    0.000000    0.000000   33.000000   
25%    542.000000   12.020000    0.000000    4.000000    0.000000   85.000000   
50%    620.000000   12.880000   14.000000   10.000000    0.000000   92.000000   
75%    695.000000   13.680000   36.500000   21.000000    0.000000   96.000000   
max    966.000000   16.000000   98.000000   66.000000    1.000000  100.000000   

        emerteach  
count  807.000000  
mean    10.464684  
std      8.214762  
min      0.000000  
25%      4.000000  
50%      9.000000  
75%     15.000000  
max     56.000000  </code></pre>
</div>
</div>
<div id="cell-8" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:55.410521Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:55.410273Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:55.736430Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:55.735844Z&quot;}}" data-execution_count="4">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram of API scores</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>plt.hist(data_api[<span class="st">'api99'</span>], bins<span class="op">=</span><span class="dv">30</span>, color<span class="op">=</span><span class="st">'steelblue'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, edgecolor<span class="op">=</span><span class="st">'#3a4a6b'</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>plt.axvline(data_api[<span class="st">'api99'</span>].mean(), color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span><span class="ss">f'Mean = </span><span class="sc">{</span>data_api[<span class="st">"api99"</span>]<span class="sc">.</span>mean()<span class="sc">:.1f}</span><span class="ss">'</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>plt.axvline(<span class="dv">800</span>, color<span class="op">=</span><span class="st">'green'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">'Target = 800'</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Academic Performance Index (API)'</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Number of Schools'</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Figure 13.1: Distribution of API Scores'</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="ch13_Case_Studies_for_Multiple_Regression_files/figure-html/cell-5-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-9" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:55.739169Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:55.738913Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:55.755683Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:55.754887Z&quot;}}" data-execution_count="5">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bivariate regression: API ~ Edparent</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>model_api_biv <span class="op">=</span> ols(<span class="st">'api99 ~ edparent'</span>, data<span class="op">=</span>data_api).fit(cov_type<span class="op">=</span><span class="st">'HC1'</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"BIVARIATE REGRESSION: API ~ EDPARENT"</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model_api_biv.summary())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
BIVARIATE REGRESSION: API ~ EDPARENT
======================================================================
                            OLS Regression Results                            
==============================================================================
Dep. Variable:                  api99   R-squared:                       0.835
Model:                            OLS   Adj. R-squared:                  0.835
Method:                 Least Squares   F-statistic:                     4257.
Date:                Tue, 17 Feb 2026   Prob (F-statistic):          9.88e-324
Time:                        22:12:55   Log-Likelihood:                -4191.9
No. Observations:                 807   AIC:                             8388.
Df Residuals:                     805   BIC:                             8397.
Df Model:                           1                                         
Covariance Type:                  HC1                                         
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept   -400.3137     15.993    -25.030      0.000    -431.660    -368.967
edparent      79.5292      1.219     65.247      0.000      77.140      81.918
==============================================================================
Omnibus:                       64.750   Durbin-Watson:                   1.710
Prob(Omnibus):                  0.000   Jarque-Bera (JB):              280.858
Skew:                           0.202   Prob(JB):                     1.03e-61
Kurtosis:                       5.862   Cond. No.                         136.
==============================================================================

Notes:
[1] Standard Errors are heteroscedasticity robust (HC1)</code></pre>
</div>
</div>
<div id="cell-10" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:55.758670Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:55.758404Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:56.019208Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:56.018576Z&quot;}}" data-execution_count="6">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot with regression line</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>plt.scatter(data_api[<span class="st">'edparent'</span>], data_api[<span class="st">'api99'</span>], alpha<span class="op">=</span><span class="fl">0.5</span>, s<span class="op">=</span><span class="dv">30</span>, color<span class="op">=</span><span class="st">'#22d3ee'</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>plt.plot(data_api[<span class="st">'edparent'</span>], model_api_biv.fittedvalues, color<span class="op">=</span><span class="st">'#c084fc'</span>, linewidth<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>         label<span class="op">=</span><span class="st">'Fitted line'</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Average Years of Parent Education'</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Academic Performance Index (API)'</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Figure 13.2: API vs Parent Education'</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="ch13_Case_Studies_for_Multiple_Regression_files/figure-html/cell-7-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-11" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:56.022587Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:56.022176Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:56.436049Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:56.435401Z&quot;}}" data-execution_count="7">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation matrix</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>corr_matrix <span class="op">=</span> data_api[vars_api].corr()</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"CORRELATION MATRIX"</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(corr_matrix.<span class="bu">round</span>(<span class="dv">2</span>))</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Heatmap</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">8</span>))</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>sns.heatmap(corr_matrix, annot<span class="op">=</span><span class="va">True</span>, fmt<span class="op">=</span><span class="st">'.2f'</span>, cmap<span class="op">=</span><span class="st">'coolwarm'</span>, center<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>            square<span class="op">=</span><span class="va">True</span>, linewidths<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Figure 13.3: Correlation Matrix'</span>)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
CORRELATION MATRIX
======================================================================
           api99  edparent  meals  englearn  yearround  credteach  emerteach
api99       1.00      0.91  -0.54     -0.66      -0.19       0.46      -0.45
edparent    0.91      1.00  -0.60     -0.71      -0.25       0.40      -0.37
meals      -0.54     -0.60   1.00      0.56       0.29      -0.27       0.21
englearn   -0.66     -0.71   0.56      1.00       0.22      -0.26       0.20
yearround  -0.19     -0.25   0.29      0.22       1.00      -0.18       0.09
credteach   0.46      0.40  -0.27     -0.26      -0.18       1.00      -0.82
emerteach  -0.45     -0.37   0.21      0.20       0.09      -0.82       1.00</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="ch13_Case_Studies_for_Multiple_Regression_files/figure-html/cell-8-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="what-the-correlation-matrix-reveals" class="level3">
<h3 class="anchored" data-anchor-id="what-the-correlation-matrix-reveals"><strong>What the Correlation Matrix Reveals</strong></h3>
<p>The correlation matrix shows the <strong>linear relationships</strong> between all variables:</p>
<p><strong>Strong negative correlations</strong> (darker blues):</p>
<ul>
<li><code>api99</code> and <code>mealpct</code> (-0.90): Schools with more poverty have much lower test scores</li>
<li><code>api99</code> and <code>elpct</code> (-0.76): More English learners ‚Üí lower scores</li>
<li>These suggest <strong>socioeconomic factors strongly predict performance</strong></li>
</ul>
<p><strong>Positive correlations</strong> (reds):</p>
<ul>
<li><code>api99</code> and <code>edparent</code> (0.76): Parental education strongly predicts scores</li>
<li>Teacher experience and credentials show weaker correlations</li>
</ul>
<p><strong>Multicollinearity concerns:</strong></p>
<ul>
<li><code>mealpct</code> and <code>edparent</code> are highly correlated (-0.79)</li>
<li>This makes it difficult to separate their individual effects</li>
<li>Standard errors may be inflated in multiple regression</li>
</ul>
<div id="cell-13" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:56.439774Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:56.439284Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:56.464527Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:56.464025Z&quot;}}" data-execution_count="8">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiple regression</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>model_api_mult <span class="op">=</span> ols(<span class="st">'api99 ~ edparent + meals + englearn + yearround + credteach + emerteach'</span>,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                      data<span class="op">=</span>data_api).fit()</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"MULTIPLE REGRESSION"</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model_api_mult.summary())</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficient table</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>coef_df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Coefficient'</span>: model_api_mult.params,</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Std Error'</span>: model_api_mult.bse,</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'t-stat'</span>: model_api_mult.tvalues,</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'p-value'</span>: model_api_mult.pvalues</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>}).<span class="bu">round</span>(<span class="dv">3</span>)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>, coef_df)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
MULTIPLE REGRESSION
======================================================================
                            OLS Regression Results                            
==============================================================================
Dep. Variable:                  api99   R-squared:                       0.853
Model:                            OLS   Adj. R-squared:                  0.852
Method:                 Least Squares   F-statistic:                     771.4
Date:                Tue, 17 Feb 2026   Prob (F-statistic):               0.00
Time:                        22:12:56   Log-Likelihood:                -4146.3
No. Observations:                 807   AIC:                             8307.
Df Residuals:                     800   BIC:                             8339.
Df Model:                           6                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept   -345.3278     39.954     -8.643      0.000    -423.755    -266.900
edparent      73.9421      1.883     39.273      0.000      70.246      77.638
meals          0.0793      0.081      0.980      0.327      -0.079       0.238
englearn      -0.3578      0.167     -2.145      0.032      -0.685      -0.030
yearround     25.9559     10.185      2.548      0.011       5.963      45.949
credteach      0.3875      0.311      1.247      0.213      -0.222       0.997
emerteach     -1.4704      0.315     -4.672      0.000      -2.088      -0.853
==============================================================================
Omnibus:                       71.318   Durbin-Watson:                   1.766
Prob(Omnibus):                  0.000   Jarque-Bera (JB):              272.754
Skew:                           0.326   Prob(JB):                     5.92e-60
Kurtosis:                       5.772   Cond. No.                     2.62e+03
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The condition number is large, 2.62e+03. This might indicate that there are
strong multicollinearity or other numerical problems.

            Coefficient  Std Error  t-stat  p-value
Intercept     -345.328     39.954  -8.643    0.000
edparent        73.942      1.883  39.273    0.000
meals            0.079      0.081   0.980    0.327
englearn        -0.358      0.167  -2.145    0.032
yearround       25.956     10.185   2.548    0.011
credteach        0.387      0.311   1.247    0.213
emerteach       -1.470      0.315  -4.672    0.000</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p><strong>Key Concept 13.1: Multiple Regression and Socioeconomic Determinants</strong></p>
<p>In multiple regression, the coefficient for parent education remains strong (~74 points) even after controlling for meals, English learners, year-round schools, and teacher quality. The high correlation among socioeconomic variables makes it difficult to isolate their separate effects ‚Äî a common challenge in observational studies.</p>
</blockquote>
</section>
</section>
<section id="cobb-douglas-production-function" class="level2">
<h2 class="anchored" data-anchor-id="cobb-douglas-production-function">13.2 Cobb-Douglas Production Function</h2>
<p>Estimating returns to scale using log transformations.</p>
<section id="the-cobb-douglas-production-function" class="level3">
<h3 class="anchored" data-anchor-id="the-cobb-douglas-production-function"><strong>The Cobb-Douglas Production Function</strong></h3>
<p>The <strong>Cobb-Douglas production function</strong> is one of the most famous models in economics. It describes how inputs (capital K and labor L) combine to produce output Q:</p>
<p><span class="math display">\[Q = \alpha K^{\beta_2} L^{\beta_3}\]</span></p>
<p><strong>Parameters:</strong></p>
<ul>
<li><span class="math inline">\(\alpha\)</span>: Total factor productivity (technology level)</li>
<li><span class="math inline">\(\beta_2\)</span>: Output elasticity of capital (% change in Q from 1% change in K)</li>
<li><span class="math inline">\(\beta_3\)</span>: Output elasticity of labor (% change in Q from 1% change in L)</li>
</ul>
<p><strong>Returns to Scale:</strong></p>
<ul>
<li>If <span class="math inline">\(\beta_2 + \beta_3 = 1\)</span>: <strong>Constant returns</strong> (doubling inputs doubles output)</li>
<li>If <span class="math inline">\(\beta_2 + \beta_3 &gt; 1\)</span>: <strong>Increasing returns</strong> (doubling inputs more than doubles output)</li>
<li>If <span class="math inline">\(\beta_2 + \beta_3 &lt; 1\)</span>: <strong>Decreasing returns</strong> (doubling inputs less than doubles output)</li>
</ul>
<p><strong>Why Log-Transform?</strong></p>
<p>Taking natural logs of both sides converts the <strong>multiplicative model</strong> into a <strong>linear model</strong>:</p>
<p><span class="math display">\[\ln(Q) = \beta_1 + \beta_2 \ln(K) + \beta_3 \ln(L) + u\]</span></p>
<p>where <span class="math inline">\(\beta_1 = \ln(\alpha)\)</span>. Now we can use <strong>ordinary least squares (OLS)</strong> regression!</p>
<p><strong>Dataset:</strong> Douglas (1976) used U.S. manufacturing data from <strong>1899-1922</strong> (24 years) to estimate this function.</p>
<div id="cell-17" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:56.467414Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:56.467181Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:56.736815Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:56.736242Z&quot;}}" data-execution_count="9">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Cobb-Douglas data</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>data_cobb <span class="op">=</span> pd.read_stata(GITHUB_DATA_URL <span class="op">+</span> <span class="st">'AED_COBBDOUGLAS.DTA'</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Loaded </span><span class="sc">{</span><span class="bu">len</span>(data_cobb)<span class="sc">}</span><span class="ss"> years of US manufacturing data (1899-1922)"</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Variables: </span><span class="sc">{</span><span class="bu">list</span>(data_cobb.columns)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>data_cobb.head(<span class="dv">12</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Loaded 24 years of US manufacturing data (1899-1922)
Variables: ['year', 'q', 'k', 'l', 'lnq', 'lnk', 'lnl']</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">q</th>
<th data-quarto-table-cell-role="th">k</th>
<th data-quarto-table-cell-role="th">l</th>
<th data-quarto-table-cell-role="th">lnq</th>
<th data-quarto-table-cell-role="th">lnk</th>
<th data-quarto-table-cell-role="th">lnl</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>1899</td>
<td>100</td>
<td>100</td>
<td>100</td>
<td>4.605170</td>
<td>4.605170</td>
<td>4.605170</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>1900</td>
<td>101</td>
<td>107</td>
<td>105</td>
<td>4.615120</td>
<td>4.672829</td>
<td>4.653960</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>1901</td>
<td>112</td>
<td>114</td>
<td>110</td>
<td>4.718499</td>
<td>4.736198</td>
<td>4.700480</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>1902</td>
<td>122</td>
<td>122</td>
<td>118</td>
<td>4.804021</td>
<td>4.804021</td>
<td>4.770685</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>1903</td>
<td>124</td>
<td>131</td>
<td>123</td>
<td>4.820282</td>
<td>4.875197</td>
<td>4.812184</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">5</th>
<td>1904</td>
<td>122</td>
<td>138</td>
<td>116</td>
<td>4.804021</td>
<td>4.927254</td>
<td>4.753590</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">6</th>
<td>1905</td>
<td>143</td>
<td>149</td>
<td>125</td>
<td>4.962845</td>
<td>5.003946</td>
<td>4.828314</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">7</th>
<td>1906</td>
<td>152</td>
<td>163</td>
<td>133</td>
<td>5.023880</td>
<td>5.093750</td>
<td>4.890349</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">8</th>
<td>1907</td>
<td>151</td>
<td>176</td>
<td>138</td>
<td>5.017280</td>
<td>5.170484</td>
<td>4.927254</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">9</th>
<td>1908</td>
<td>126</td>
<td>185</td>
<td>121</td>
<td>4.836282</td>
<td>5.220356</td>
<td>4.795791</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">10</th>
<td>1909</td>
<td>155</td>
<td>198</td>
<td>140</td>
<td>5.043425</td>
<td>5.288267</td>
<td>4.941642</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">11</th>
<td>1910</td>
<td>159</td>
<td>208</td>
<td>144</td>
<td>5.068904</td>
<td>5.337538</td>
<td>4.969813</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-18" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:56.740743Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:56.740370Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:56.754842Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:56.754292Z&quot;}}" data-execution_count="10">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create log transformations</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>data_cobb[<span class="st">'lnq'</span>] <span class="op">=</span> np.log(data_cobb[<span class="st">'q'</span>])</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>data_cobb[<span class="st">'lnk'</span>] <span class="op">=</span> np.log(data_cobb[<span class="st">'k'</span>])</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>data_cobb[<span class="st">'lnl'</span>] <span class="op">=</span> np.log(data_cobb[<span class="st">'l'</span>])</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Summary statistics (original and log-transformed):"</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data_cobb[[<span class="st">'q'</span>, <span class="st">'k'</span>, <span class="st">'l'</span>, <span class="st">'lnq'</span>, <span class="st">'lnk'</span>, <span class="st">'lnl'</span>]].describe())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Summary statistics (original and log-transformed):
                q           k           l        lnq        lnk        lnl
count   24.000000   24.000000   24.000000  24.000000  24.000000  24.000000
mean   165.916667  234.166667  145.791667   5.077336   5.356483   4.962723
std     43.753178  106.266550   29.616357   0.269234   0.459178   0.201077
min    100.000000  100.000000  100.000000   4.605170   4.605170   4.605170
25%    125.500000  146.250000  122.500000   4.832282   4.984773   4.808086
50%    157.000000  212.000000  144.500000   5.056165   5.356408   4.973274
75%    196.250000  307.250000  155.750000   5.277434   5.726353   5.048065
max    240.000000  431.000000  200.000000   5.480639   6.066108   5.298317</code></pre>
</div>
</div>
<div id="cell-19" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:56.758277Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:56.758010Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:56.775772Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:56.775142Z&quot;}}" data-execution_count="11">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate Cobb-Douglas with HAC standard errors</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>model_cobb <span class="op">=</span> ols(<span class="st">'lnq ~ lnk + lnl'</span>, data<span class="op">=</span>data_cobb).fit(cov_type<span class="op">=</span><span class="st">'HAC'</span>, cov_kwds<span class="op">=</span>{<span class="st">'maxlags'</span>: <span class="dv">3</span>})</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"COBB-DOUGLAS REGRESSION: ln(Q) ~ ln(K) + ln(L)"</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model_cobb.summary())</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>beta_k <span class="op">=</span> model_cobb.params[<span class="st">'lnk'</span>]</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>beta_l <span class="op">=</span> model_cobb.params[<span class="st">'lnl'</span>]</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Sum of coefficients: </span><span class="sc">{</span>beta_k<span class="sc">:.3f}</span><span class="ss"> + </span><span class="sc">{</span>beta_l<span class="sc">:.3f}</span><span class="ss"> = </span><span class="sc">{</span>beta_k <span class="op">+</span> beta_l<span class="sc">:.3f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
COBB-DOUGLAS REGRESSION: ln(Q) ~ ln(K) + ln(L)
======================================================================
                            OLS Regression Results                            
==============================================================================
Dep. Variable:                    lnq   R-squared:                       0.957
Model:                            OLS   Adj. R-squared:                  0.953
Method:                 Least Squares   F-statistic:                     246.2
Date:                Tue, 17 Feb 2026   Prob (F-statistic):           2.65e-15
Time:                        22:12:56   Log-Likelihood:                 35.826
No. Observations:                  24   AIC:                            -65.65
Df Residuals:                      21   BIC:                            -62.12
Df Model:                           2                                         
Covariance Type:                  HAC                                         
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept     -0.1773      0.372     -0.476      0.634      -0.907       0.552
lnk            0.2331      0.059      3.977      0.000       0.118       0.348
lnl            0.8073      0.126      6.409      0.000       0.560       1.054
==============================================================================
Omnibus:                        2.133   Durbin-Watson:                   1.523
Prob(Omnibus):                  0.344   Jarque-Bera (JB):                1.361
Skew:                           0.583   Prob(JB):                        0.506
Kurtosis:                       2.992   Cond. No.                         285.
==============================================================================

Notes:
[1] Standard Errors are heteroscedasticity and autocorrelation robust (HAC) using 3 lags and without small sample correction

Sum of coefficients: 0.233 + 0.807 = 1.040</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p><strong>Key Concept 13.2: Logarithmic Transformation of Production Functions</strong></p>
<p>Taking natural logarithms of the Cobb-Douglas production function <span class="math inline">\(Q = AK^\alpha L^\beta\)</span> transforms it into the linear model <span class="math inline">\(\ln Q = \ln A + \alpha \ln K + \beta \ln L\)</span>, suitable for OLS estimation. The resulting coefficients are <strong>elasticities</strong> ‚Äî directly interpretable as percentage changes.</p>
</blockquote>
</section>
<section id="understanding-the-results" class="level3">
<h3 class="anchored" data-anchor-id="understanding-the-results"><strong>Understanding the Results</strong></h3>
<p><strong>Estimated Coefficients:</strong></p>
<ul>
<li><span class="math inline">\(\hat{\beta}_2\)</span> (capital) ‚âà 0.23: A 1% increase in capital raises output by 0.23%</li>
<li><span class="math inline">\(\hat{\beta}_3\)</span> (labor) ‚âà 0.81: A 1% increase in labor raises output by 0.81%</li>
<li>Sum: 0.23 + 0.81 ‚âà <strong>1.04</strong> ‚Üí Very close to constant returns to scale!</li>
</ul>
<p><strong>Why HAC Standard Errors?</strong></p>
<p>This is <strong>time series data</strong> (24 consecutive years). Two problems arise:</p>
<ol type="1">
<li><strong>Autocorrelation</strong>: Output in year t is correlated with output in year t-1</li>
</ol>
<ul>
<li>Recessions/booms span multiple years</li>
<li>Technology shocks persist over time</li>
</ul>
<ol start="2" type="1">
<li><strong>Heteroskedasticity</strong>: Variance of errors may change over time</li>
</ol>
<ul>
<li>Economy was more volatile in early 1900s</li>
<li>Structural changes during WWI</li>
</ul>
<p><strong>HAC (Heteroskedasticity and Autocorrelation Consistent)</strong> standard errors correct for both problems. We use <strong>maxlags=3</strong>, allowing correlations up to 3 years apart.</p>
<p><strong>Comparison:</strong></p>
<ul>
<li>Default SEs: Assume errors are uncorrelated and homoskedastic (WRONG here!)</li>
<li>Robust (HC1) SEs: Fix heteroskedasticity but ignore autocorrelation</li>
<li>HAC SEs: Fix BOTH problems (correct choice for time series)</li>
</ul>
<p><strong>Economic Interpretation:</strong></p>
<p>Labor‚Äôs output elasticity (0.81) is <strong>much larger</strong> than capital‚Äôs (0.23). This suggests that in early 20th century U.S. manufacturing:</p>
<ul>
<li>Labor was the dominant input</li>
<li>Capital was relatively less important</li>
<li>Consistent with labor-intensive production before automation</li>
</ul>
<div id="cell-22" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:56.779271Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:56.779032Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:56.789669Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:56.788591Z&quot;}}" data-execution_count="12">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test constant returns to scale</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># H0: beta_k + beta_l = 1</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>sum_betas <span class="op">=</span> beta_k <span class="op">+</span> beta_l</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Testing constant returns to scale:"</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"H0: beta_capital + beta_labor = 1"</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Estimated sum: </span><span class="sc">{</span>sum_betas<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Restricted model: ln(Q/L) ~ ln(K/L)</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>data_cobb[<span class="st">'lnq_per_l'</span>] <span class="op">=</span> data_cobb[<span class="st">'lnq'</span>] <span class="op">-</span> data_cobb[<span class="st">'lnl'</span>]</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>data_cobb[<span class="st">'lnk_per_l'</span>] <span class="op">=</span> data_cobb[<span class="st">'lnk'</span>] <span class="op">-</span> data_cobb[<span class="st">'lnl'</span>]</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>model_restricted <span class="op">=</span> ols(<span class="st">'lnq_per_l ~ lnk_per_l'</span>, data<span class="op">=</span>data_cobb).fit()</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co"># F-test</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>rss_unr <span class="op">=</span> model_cobb.ssr</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>rss_r <span class="op">=</span> model_restricted.ssr</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>f_stat <span class="op">=</span> ((rss_r <span class="op">-</span> rss_unr) <span class="op">/</span> <span class="dv">1</span>) <span class="op">/</span> (rss_unr <span class="op">/</span> model_cobb.df_resid)</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>p_value <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> stats.f.cdf(f_stat, <span class="dv">1</span>, model_cobb.df_resid)</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"F-statistic: </span><span class="sc">{</span>f_stat<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"p-value: </span><span class="sc">{</span>p_value<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Conclusion: </span><span class="sc">{</span><span class="st">'Reject'</span> <span class="cf">if</span> p_value <span class="op">&lt;</span> <span class="fl">0.05</span> <span class="cf">else</span> <span class="st">'Fail to reject'</span><span class="sc">}</span><span class="ss"> H0 at 5% level"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Testing constant returns to scale:
H0: beta_capital + beta_labor = 1
Estimated sum: 1.040
F-statistic: 0.20
p-value: 0.663
Conclusion: Fail to reject H0 at 5% level</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p><strong>Key Concept 13.3: Testing Constant Returns to Scale</strong></p>
<p>Constant returns to scale implies <span class="math inline">\(\alpha + \beta = 1\)</span>: doubling all inputs exactly doubles output. The estimated sum of 1.040 is not significantly different from 1 (F-test p = 0.636), consistent with the theoretical prediction for competitive markets. This is a <strong>joint hypothesis test</strong> on the coefficients.</p>
</blockquote>
<div id="cell-24" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:56.793022Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:56.792762Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:57.027902Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:57.027350Z&quot;}}" data-execution_count="13">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicted output with bias correction</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>se <span class="op">=</span> np.sqrt(model_cobb.scale)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>bias_correction <span class="op">=</span> np.exp(se<span class="op">**</span><span class="dv">2</span> <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>data_cobb[<span class="st">'q_pred'</span>] <span class="op">=</span> bias_correction <span class="op">*</span> np.exp(model_cobb.fittedvalues)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot actual vs predicted</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>plt.plot(data_cobb[<span class="st">'year'</span>], data_cobb[<span class="st">'q'</span>], <span class="st">'o-'</span>, color<span class="op">=</span><span class="st">'#22d3ee'</span>, linewidth<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>         markersize<span class="op">=</span><span class="dv">6</span>, label<span class="op">=</span><span class="st">'Actual Q'</span>)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>plt.plot(data_cobb[<span class="st">'year'</span>], data_cobb[<span class="st">'q_pred'</span>], <span class="st">'s--'</span>, color<span class="op">=</span><span class="st">'#c084fc'</span>, linewidth<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>         markersize<span class="op">=</span><span class="dv">5</span>, label<span class="op">=</span><span class="st">'Predicted Q'</span>)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Year'</span>)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Output Index'</span>)</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Figure 13.4: Actual vs Predicted Output (1899-1922)'</span>)</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="ch13_Case_Studies_for_Multiple_Regression_files/figure-html/cell-14-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="phillips-curve-and-omitted-variables-bias" class="level2">
<h2 class="anchored" data-anchor-id="phillips-curve-and-omitted-variables-bias">13.3 Phillips Curve and Omitted Variables Bias</h2>
<p>Demonstrating omitted variables bias through the breakdown of the Phillips curve.</p>
<section id="the-phillips-curve-and-its-breakdown" class="level3">
<h3 class="anchored" data-anchor-id="the-phillips-curve-and-its-breakdown"><strong>The Phillips Curve and Its Breakdown</strong></h3>
<p>The <strong>Phillips Curve</strong> describes a <strong>negative relationship</strong> between unemployment and inflation:</p>
<ul>
<li>When unemployment is low ‚Üí workers demand higher wages ‚Üí prices rise ‚Üí inflation increases</li>
<li>When unemployment is high ‚Üí workers accept lower wages ‚Üí prices fall ‚Üí inflation decreases</li>
</ul>
<p><strong>Historical Context:</strong></p>
<p>A.W. Phillips (1958) found this negative relationship in UK data from 1861-1957. It became a cornerstone of macroeconomic policy:</p>
<ul>
<li>Governments believed they could ‚Äútrade off‚Äù unemployment for inflation</li>
<li>Want lower unemployment? Accept higher inflation</li>
<li>Want lower inflation? Accept higher unemployment</li>
</ul>
<p><strong>The 1970s Crisis:</strong></p>
<p>The relationship <strong>broke down</strong> in the 1970s! Economies experienced <strong>stagflation</strong> (high unemployment AND high inflation simultaneously). This was a major crisis in economic theory.</p>
<p><strong>The Solution: Expected Inflation</strong></p>
<p>Milton Friedman and Edmund Phelps showed the original Phillips curve suffered from <strong>omitted variables bias</strong>. The correct model includes <strong>expected inflation</strong>:</p>
<p><span class="math display">\[\text{Inflation}_t = \beta_1 + \beta_2 \text{Urate}_t + \beta_3 \text{Expected Inflation}_t + u_t\]</span></p>
<p>We‚Äôll demonstrate this using U.S. data from <strong>1949-2014</strong> (66 years).</p>
<div id="cell-27" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:57.030888Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:57.030632Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:57.304564Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:57.304012Z&quot;}}" data-execution_count="14">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Phillips curve data</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>data_phillips <span class="op">=</span> pd.read_stata(GITHUB_DATA_URL <span class="op">+</span> <span class="st">'AED_PHILLIPS.DTA'</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Loaded </span><span class="sc">{</span><span class="bu">len</span>(data_phillips)<span class="sc">}</span><span class="ss"> years of US data (1949-2014)"</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Variables: </span><span class="sc">{</span><span class="bu">list</span>(data_phillips.columns)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>data_phillips.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Loaded 66 years of US data (1949-2014)
Variables: ['year', 'urate', 'gdpdef', 'inflgdp', 'pastinflgdp', 'inflgdp1yr', 'cpi', 'inflcpi', 'pastinflcpi', 'infcpi1yr', 'infcpi10yr', 'mich', 'date', 'daten']</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">urate</th>
<th data-quarto-table-cell-role="th">gdpdef</th>
<th data-quarto-table-cell-role="th">inflgdp</th>
<th data-quarto-table-cell-role="th">pastinflgdp</th>
<th data-quarto-table-cell-role="th">inflgdp1yr</th>
<th data-quarto-table-cell-role="th">cpi</th>
<th data-quarto-table-cell-role="th">inflcpi</th>
<th data-quarto-table-cell-role="th">pastinflcpi</th>
<th data-quarto-table-cell-role="th">infcpi1yr</th>
<th data-quarto-table-cell-role="th">infcpi10yr</th>
<th data-quarto-table-cell-role="th">mich</th>
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">daten</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>1949.0</td>
<td>6.6</td>
<td>13.518</td>
<td>-1.965335</td>
<td>NaN</td>
<td>NaN</td>
<td>23.6</td>
<td>-2.074689</td>
<td>7.698837</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1949-10-01</td>
<td>1949-10-01</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>1950.0</td>
<td>4.3</td>
<td>14.090</td>
<td>4.231395</td>
<td>NaN</td>
<td>NaN</td>
<td>25.0</td>
<td>5.932203</td>
<td>3.648189</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1950-10-01</td>
<td>1950-10-01</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>1951.0</td>
<td>3.1</td>
<td>14.869</td>
<td>5.528744</td>
<td>NaN</td>
<td>NaN</td>
<td>26.5</td>
<td>6.000000</td>
<td>3.232486</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1951-10-01</td>
<td>1951-10-01</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>1952.0</td>
<td>2.7</td>
<td>15.091</td>
<td>1.493039</td>
<td>3.474261</td>
<td>NaN</td>
<td>26.7</td>
<td>0.754717</td>
<td>4.063869</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1952-10-01</td>
<td>1952-10-01</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>1953.0</td>
<td>4.5</td>
<td>15.219</td>
<td>0.848188</td>
<td>2.905584</td>
<td>NaN</td>
<td>26.9</td>
<td>0.749064</td>
<td>3.080858</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1953-10-01</td>
<td>1953-10-01</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-28" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:57.308052Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:57.307792Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:57.322531Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:57.321675Z&quot;}}" data-execution_count="15">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pre-1970 regression</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>data_pre1970 <span class="op">=</span> data_phillips[data_phillips[<span class="st">'year'</span>] <span class="op">&lt;</span> <span class="dv">1970</span>]</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>model_pre <span class="op">=</span> ols(<span class="st">'inflgdp ~ urate'</span>, data<span class="op">=</span>data_pre1970).fit(cov_type<span class="op">=</span><span class="st">'HAC'</span>, cov_kwds<span class="op">=</span>{<span class="st">'maxlags'</span>: <span class="dv">3</span>})</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"PHILLIPS CURVE PRE-1970 (1949-1969)"</span>)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model_pre.summary())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
PHILLIPS CURVE PRE-1970 (1949-1969)
======================================================================
                            OLS Regression Results                            
==============================================================================
Dep. Variable:                inflgdp   R-squared:                       0.454
Model:                            OLS   Adj. R-squared:                  0.425
Method:                 Least Squares   F-statistic:                     11.09
Date:                Tue, 17 Feb 2026   Prob (F-statistic):            0.00352
Time:                        22:12:57   Log-Likelihood:                -34.492
No. Observations:                  21   AIC:                             72.98
Df Residuals:                      19   BIC:                             75.07
Df Model:                           1                                         
Covariance Type:                  HAC                                         
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept      7.1057      1.504      4.724      0.000       4.157      10.054
urate         -1.0300      0.309     -3.330      0.001      -1.636      -0.424
==============================================================================
Omnibus:                        1.242   Durbin-Watson:                   1.536
Prob(Omnibus):                  0.538   Jarque-Bera (JB):                1.025
Skew:                          -0.499   Prob(JB):                        0.599
Kurtosis:                       2.581   Cond. No.                         21.8
==============================================================================

Notes:
[1] Standard Errors are heteroscedasticity and autocorrelation robust (HAC) using 3 lags and without small sample correction</code></pre>
</div>
</div>
</section>
<section id="pre-1970-phillips-curve-works" class="level3">
<h3 class="anchored" data-anchor-id="pre-1970-phillips-curve-works"><strong>Pre-1970: Phillips Curve Works!</strong></h3>
<p><strong>Results:</strong></p>
<ul>
<li>Coefficient on unemployment ‚âà <strong>-0.89</strong></li>
<li><strong>Negative</strong> relationship (as theory predicts!)</li>
<li>Statistically significant</li>
<li>1% increase in unemployment ‚Üí 0.89% decrease in inflation</li>
</ul>
<p>The scatter plot shows a clear downward slope. This is the classic Phillips curve that policymakers relied on in the 1950s-60s.</p>
<p><strong>Why did it work?</strong></p>
<p>In the 1950s-60s, expected inflation was <strong>stable and low</strong> (around 2-3%). Since it didn‚Äôt vary much, omitting it from the regression didn‚Äôt cause serious bias.</p>
<div id="cell-30" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:57.325913Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:57.325586Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:57.570717Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:57.570053Z&quot;}}" data-execution_count="16">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot pre-1970</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>plt.scatter(data_pre1970[<span class="st">'urate'</span>], data_pre1970[<span class="st">'inflgdp'</span>], alpha<span class="op">=</span><span class="fl">0.7</span>, s<span class="op">=</span><span class="dv">50</span>, color<span class="op">=</span><span class="st">'#22d3ee'</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>plt.plot(data_pre1970[<span class="st">'urate'</span>], model_pre.fittedvalues, color<span class="op">=</span><span class="st">'#c084fc'</span>, linewidth<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>         label<span class="op">=</span><span class="st">'Fitted line'</span>)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Unemployment Rate (%)'</span>)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Inflation Rate (%)'</span>)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Figure 13.5: Phillips Curve Pre-1970 (Negative Relationship)'</span>)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="ch13_Case_Studies_for_Multiple_Regression_files/figure-html/cell-17-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-31" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:57.575120Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:57.574718Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:57.590512Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:57.589768Z&quot;}}" data-execution_count="17">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Post-1970 regression</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>data_post1970 <span class="op">=</span> data_phillips[data_phillips[<span class="st">'year'</span>] <span class="op">&gt;=</span> <span class="dv">1970</span>]</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>model_post <span class="op">=</span> ols(<span class="st">'inflgdp ~ urate'</span>, data<span class="op">=</span>data_post1970).fit(cov_type<span class="op">=</span><span class="st">'HAC'</span>, cov_kwds<span class="op">=</span>{<span class="st">'maxlags'</span>: <span class="dv">5</span>})</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"PHILLIPS CURVE POST-1970 (1970-2014)"</span>)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model_post.summary())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
PHILLIPS CURVE POST-1970 (1970-2014)
======================================================================
                            OLS Regression Results                            
==============================================================================
Dep. Variable:                inflgdp   R-squared:                       0.028
Model:                            OLS   Adj. R-squared:                  0.005
Method:                 Least Squares   F-statistic:                    0.6928
Date:                Tue, 17 Feb 2026   Prob (F-statistic):              0.410
Time:                        22:12:57   Log-Likelihood:                -103.01
No. Observations:                  45   AIC:                             210.0
Df Residuals:                      43   BIC:                             213.6
Df Model:                           1                                         
Covariance Type:                  HAC                                         
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept      1.9279      1.826      1.056      0.291      -1.651       5.507
urate          0.2653      0.319      0.832      0.405      -0.359       0.890
==============================================================================
Omnibus:                        9.911   Durbin-Watson:                   0.294
Prob(Omnibus):                  0.007   Jarque-Bera (JB):                9.497
Skew:                           1.090   Prob(JB):                      0.00866
Kurtosis:                       3.563   Cond. No.                         29.3
==============================================================================

Notes:
[1] Standard Errors are heteroscedasticity and autocorrelation robust (HAC) using 5 lags and without small sample correction</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p><strong>Key Concept 13.4: The Phillips Curve Breakdown</strong></p>
<p>Pre-1970, higher unemployment was associated with lower inflation (the classic Phillips curve trade-off). Post-1970, this relationship <strong>reversed</strong> ‚Äî suggesting the simple bivariate model was misspecified. The breakdown motivated the <strong>expectations-augmented Phillips curve</strong>, which includes expected inflation as a regressor.</p>
</blockquote>
</section>
<section id="post-1970-phillips-curve-breaks-down" class="level3">
<h3 class="anchored" data-anchor-id="post-1970-phillips-curve-breaks-down"><strong>Post-1970: Phillips Curve Breaks Down!</strong></h3>
<p><strong>Results:</strong></p>
<ul>
<li>Coefficient on unemployment ‚âà <strong>+0.27</strong></li>
<li><strong>Positive</strong> relationship (opposite of theory!)</li>
<li>The sign reversed!</li>
</ul>
<p>The scatter plot shows an upward slope - higher unemployment is associated with higher inflation. This is <strong>stagflation</strong>.</p>
<p><strong>What went wrong?</strong></p>
<p>In the 1970s, expected inflation became:</p>
<ul>
<li>Much higher (reached 10%+ during oil shocks)</li>
<li>Much more variable (changed frequently)</li>
<li>Correlated with unemployment (both rose together)</li>
</ul>
<p>Omitting expected inflation now causes <strong>severe omitted variables bias</strong> that reverses the sign of the unemployment coefficient!</p>
<div id="cell-34" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:57.593421Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:57.593197Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:57.849798Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:57.849320Z&quot;}}" data-execution_count="18">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot post-1970</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>plt.scatter(data_post1970[<span class="st">'urate'</span>], data_post1970[<span class="st">'inflgdp'</span>], alpha<span class="op">=</span><span class="fl">0.7</span>, s<span class="op">=</span><span class="dv">50</span>, color<span class="op">=</span><span class="st">'#22d3ee'</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>plt.plot(data_post1970[<span class="st">'urate'</span>], model_post.fittedvalues, color<span class="op">=</span><span class="st">'red'</span>, linewidth<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>         label<span class="op">=</span><span class="st">'Fitted line'</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Unemployment Rate (%)'</span>)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Inflation Rate (%)'</span>)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Figure 13.6: Phillips Curve Post-1970 (Positive Relationship - Breakdown!)'</span>)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="ch13_Case_Studies_for_Multiple_Regression_files/figure-html/cell-19-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-35" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:57.852408Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:57.852182Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:57.869621Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:57.868961Z&quot;}}" data-execution_count="19">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Augmented Phillips curve (adding expected inflation)</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>data_post1970_exp <span class="op">=</span> data_post1970.dropna(subset<span class="op">=</span>[<span class="st">'inflgdp1yr'</span>])</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>model_augmented <span class="op">=</span> ols(<span class="st">'inflgdp ~ urate + inflgdp1yr'</span>, data<span class="op">=</span>data_post1970_exp).fit(</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    cov_type<span class="op">=</span><span class="st">'HAC'</span>, cov_kwds<span class="op">=</span>{<span class="st">'maxlags'</span>: <span class="dv">5</span>})</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"AUGMENTED PHILLIPS CURVE POST-1970"</span>)</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model_augmented.summary())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
AUGMENTED PHILLIPS CURVE POST-1970
======================================================================
                            OLS Regression Results                            
==============================================================================
Dep. Variable:                inflgdp   R-squared:                       0.881
Model:                            OLS   Adj. R-squared:                  0.875
Method:                 Least Squares   F-statistic:                     97.73
Date:                Tue, 17 Feb 2026   Prob (F-statistic):           1.59e-16
Time:                        22:12:57   Log-Likelihood:                -55.722
No. Observations:                  45   AIC:                             117.4
Df Residuals:                      42   BIC:                             122.9
Df Model:                           2                                         
Covariance Type:                  HAC                                         
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept      0.2701      0.612      0.441      0.659      -0.930       1.470
urate         -0.1278      0.078     -1.630      0.103      -0.281       0.026
inflgdp1yr     1.1463      0.082     13.953      0.000       0.985       1.307
==============================================================================
Omnibus:                        2.284   Durbin-Watson:                   0.736
Prob(Omnibus):                  0.319   Jarque-Bera (JB):                1.308
Skew:                           0.288   Prob(JB):                        0.520
Kurtosis:                       3.605   Cond. No.                         34.1
==============================================================================

Notes:
[1] Standard Errors are heteroscedasticity and autocorrelation robust (HAC) using 5 lags and without small sample correction</code></pre>
</div>
</div>
<div id="cell-36" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:57.873460Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:57.873148Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:57.882961Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:57.882449Z&quot;}}" data-execution_count="20">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Demonstrate omitted variables bias</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Bivariate regression of Expinflation on Urate</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>model_aux <span class="op">=</span> ols(<span class="st">'inflgdp1yr ~ urate'</span>, data<span class="op">=</span>data_post1970_exp).fit()</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>gamma <span class="op">=</span> model_aux.params[<span class="st">'urate'</span>]</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>beta3 <span class="op">=</span> model_augmented.params[<span class="st">'inflgdp1yr'</span>]</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>beta2 <span class="op">=</span> model_augmented.params[<span class="st">'urate'</span>]</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"OMITTED VARIABLES BIAS CALCULATION"</span>)</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"True model: Inflation = Œ≤1 + Œ≤2*Urate + Œ≤3*Expinflation"</span>)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Omitted model: Inflation = b1 + b2*Urate"</span>)</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Omitted variables bias formula: E[b2] = Œ≤2 + Œ≤3*Œ≥"</span>)</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"where Œ≥ = coefficient from Expinflation ~ Urate regression"</span>)</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Œ≥ (from auxiliary regression): </span><span class="sc">{</span>gamma<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Œ≤3 (from full model): </span><span class="sc">{</span>beta3<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Œ≤2 (from full model): </span><span class="sc">{</span>beta2<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f"</span><span class="ch">\n</span><span class="ss">Predicted E[b2] = </span><span class="sc">{</span>beta2<span class="sc">:.3f}</span><span class="ss"> + </span><span class="sc">{</span>beta3<span class="sc">:.3f}</span><span class="ss"> * </span><span class="sc">{</span>gamma<span class="sc">:.3f}</span><span class="ss"> "</span></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f"= </span><span class="sc">{</span>beta2 <span class="op">+</span> beta3 <span class="op">*</span> gamma<span class="sc">:.3f}</span><span class="ss">"</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Actual b2 (from bivariate): </span><span class="sc">{</span>model_post<span class="sc">.</span>params[<span class="st">'urate'</span>]<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">‚úì Omitted variables bias explains the sign reversal!"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
OMITTED VARIABLES BIAS CALCULATION
======================================================================
True model: Inflation = Œ≤1 + Œ≤2*Urate + Œ≤3*Expinflation
Omitted model: Inflation = b1 + b2*Urate

Omitted variables bias formula: E[b2] = Œ≤2 + Œ≤3*Œ≥
where Œ≥ = coefficient from Expinflation ~ Urate regression

Œ≥ (from auxiliary regression): 0.343
Œ≤3 (from full model): 1.146
Œ≤2 (from full model): -0.128

Predicted E[b2] = -0.128 + 1.146 * 0.343 = 0.265
Actual b2 (from bivariate): 0.265

‚úì Omitted variables bias explains the sign reversal!</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p><strong>Key Concept 13.5: Omitted Variables Bias</strong></p>
<p>When a relevant variable (expected inflation) is omitted from the regression, its effect gets absorbed into the included variable‚Äôs coefficient. The <strong>OVB formula</strong> shows that the bias equals the omitted variable‚Äôs coefficient times its correlation with the included regressor. In the Phillips curve, this bias reversed the sign of the unemployment coefficient.</p>
</blockquote>
</section>
<section id="understanding-omitted-variables-bias" class="level3">
<h3 class="anchored" data-anchor-id="understanding-omitted-variables-bias"><strong>Understanding Omitted Variables Bias</strong></h3>
<p>The <strong>omitted variables bias formula</strong> tells us how the coefficient in the bivariate (wrong) model relates to the true coefficients:</p>
<p><span class="math display">\[E[b_2] = \beta_2 + \beta_3 \gamma\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(b_2\)</span>: coefficient on Urate in <strong>bivariate model</strong> (omits expected inflation)</li>
<li><span class="math inline">\(\beta_2\)</span>: true coefficient on Urate in <strong>full model</strong></li>
<li><span class="math inline">\(\beta_3\)</span>: true coefficient on expected inflation in <strong>full model</strong></li>
<li><span class="math inline">\(\gamma\)</span>: coefficient from regressing expected inflation on Urate (<strong>auxiliary regression</strong>)</li>
</ul>
<p><strong>What we found:</strong></p>
<ul>
<li><span class="math inline">\(\beta_2 \approx -1.15\)</span> (true negative effect of unemployment)</li>
<li><span class="math inline">\(\beta_3 \approx +1.15\)</span> (expected inflation has 1-to-1 effect on actual inflation)</li>
<li><span class="math inline">\(\gamma \approx +0.34\)</span> (when unemployment rises, expected inflation also rises in 1970s!)</li>
</ul>
<p><strong>Predicted bias:</strong> <span class="math display">\[E[b_2] = -1.15 + 1.15 \times 0.34 \approx +0.26\]</span></p>
<p><strong>Actual <span class="math inline">\(b_2\)</span> from bivariate model:</strong> +0.27</p>
<p><strong>Perfect match!</strong> The omitted variables bias formula <strong>exactly explains</strong> why the sign reversed.</p>
<p><strong>Economic Interpretation:</strong></p>
<p>In the 1970s:</p>
<ol type="1">
<li>Oil shocks raised unemployment (supply shocks)</li>
<li>Same oil shocks raised expected inflation (cost-push)</li>
<li>Unemployment and expected inflation moved <strong>together</strong></li>
<li>Omitting expected inflation makes unemployment look like it <strong>causes</strong> inflation</li>
<li>But really, both are caused by the same underlying shocks</li>
</ol>
<p><strong>The Lesson:</strong></p>
<p>The Phillips curve didn‚Äôt ‚Äúdisappear‚Äù - it was always conditional on expected inflation. Once we control for expectations, the negative relationship returns. This revolutionized central bank policy: to fight inflation, must manage expectations!</p>
<p><em>Having explored detailed case studies with full estimation and testing, we now survey additional applications demonstrating advanced econometric methods.</em></p>
</section>
</section>
<section id="automobile-fuel-efficiency" class="level2">
<h2 class="anchored" data-anchor-id="automobile-fuel-efficiency">13.4 Automobile Fuel Efficiency</h2>
<p>Large dataset analysis with cluster-robust standard errors.</p>
<section id="case-study-automobile-fuel-efficiency-1980-2006" class="level3">
<h3 class="anchored" data-anchor-id="case-study-automobile-fuel-efficiency-1980-2006"><strong>Case Study: Automobile Fuel Efficiency (1980-2006)</strong></h3>
<p><strong>The Policy Question</strong>: What determines vehicle fuel efficiency, and why didn‚Äôt MPG improve more despite technological advances?</p>
<p><strong>Economic Context:</strong></p>
<p>From 1980-2006, the U.S. auto industry faced:</p>
<ul>
<li><strong>1970s oil shocks</strong>: Created demand for fuel efficiency</li>
<li><strong>CAFE standards</strong>: Government regulations on average MPG</li>
<li><strong>Consumer preferences</strong>: Growing demand for SUVs and trucks</li>
<li><strong>Technological progress</strong>: Better engines, materials, aerodynamics</li>
</ul>
<p>Yet average fuel economy <strong>stagnated</strong>. Why?</p>
<p><strong>The Data</strong>: 26,995 vehicles sold in the U.S. market (1980-2006)</p>
<p><strong>Key Variables</strong>:</p>
<ul>
<li><code>mpg</code>: Miles per gallon (fuel efficiency)</li>
<li><code>curbwt</code>: Vehicle weight in pounds</li>
<li><code>hp</code>: Horsepower (engine power)</li>
<li><code>torque</code>: Engine torque (pulling power)</li>
<li><code>year</code>: Model year (captures technology trends)</li>
<li><code>mfr</code>: Manufacturer (for clustering)</li>
</ul>
<p><strong>The Research Question:</strong></p>
<p>How much does each factor contribute to fuel efficiency?</p>
<ul>
<li>Weight vs power vs technology</li>
<li>Are efficiency gains ‚Äúspent‚Äù on other attributes?</li>
</ul>
<p><strong>Methodological Challenge</strong>:</p>
<p>Vehicles from the same manufacturer share:</p>
<ul>
<li>Common technology platforms</li>
<li>Similar design philosophy</li>
<li>Shared engineering teams</li>
</ul>
<p>This creates <strong>clustered errors</strong> ‚Üí need cluster-robust standard errors!</p>
<p><strong>Method</strong>: Log-log regression with cluster-robust SEs (by manufacturer)</p>
<div id="cell-42" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:57.886069Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:57.885831Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:58.986453Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:58.985928Z&quot;}}" data-execution_count="21">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load automobile data</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>data_auto <span class="op">=</span> pd.read_stata(GITHUB_DATA_URL <span class="op">+</span> <span class="st">'AED_AUTOSMPG.DTA'</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Loaded </span><span class="sc">{</span><span class="bu">len</span>(data_auto)<span class="sc">}</span><span class="ss"> vehicle observations (1980-2006)"</span>)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Key variables: </span><span class="sc">{</span>[<span class="st">'year'</span>, <span class="st">'mfr'</span>, <span class="st">'mpg'</span>, <span class="st">'curbwt'</span>, <span class="st">'hp'</span>, <span class="st">'torque'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Note: Dataset has pre-computed log transformations (lmpg, lcurbwt, lhp, ltorque)"</span>)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data_auto[[<span class="st">'year'</span>, <span class="st">'mfr'</span>, <span class="st">'mpg'</span>, <span class="st">'curbwt'</span>, <span class="st">'hp'</span>, <span class="st">'torque'</span>]].head())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Loaded 26995 vehicle observations (1980-2006)

Key variables: ['year', 'mfr', 'mpg', 'curbwt', 'hp', 'torque']

Note: Dataset has pre-computed log transformations (lmpg, lcurbwt, lhp, ltorque)
     year   mfr        mpg  curbwt   hp      torque
0  1980.0  FIAT  21.700001    2455  111  149.199997
1  1980.0   AMC  22.400000    2807   90  176.300003
2  1980.0   AMC  24.600000    2767   90  176.300003
3  1980.0   AMC  20.400000    2856  110  284.799988
4  1980.0   AMC  20.500000    2816  110  284.799988</code></pre>
</div>
</div>
<div id="cell-43" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:58.989798Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:58.989457Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:59.007033Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:59.006397Z&quot;}}" data-execution_count="22">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>key_vars <span class="op">=</span> [<span class="st">'mpg'</span>, <span class="st">'curbwt'</span>, <span class="st">'hp'</span>, <span class="st">'torque'</span>, <span class="st">'year'</span>]</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"SUMMARY STATISTICS"</span>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data_auto[key_vars].describe())</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Manufacturer distribution</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"TOP 10 MANUFACTURERS BY OBSERVATIONS"</span>)</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data_auto[<span class="st">'mfr'</span>].value_counts().head(<span class="dv">10</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
SUMMARY STATISTICS
======================================================================
                mpg        curbwt            hp        torque          year
count  26995.000000  26995.000000  26995.000000  26995.000000  26995.000000
mean      24.564611   3429.140396    158.517837    265.476135   1992.124512
std        6.707278    814.258673     67.215409    102.785034      8.043656
min        8.700000   1450.000000     48.000000     69.400002   1980.000000
25%       19.700001   2815.000000    112.000000    181.699997   1985.000000
50%       23.900000   3325.000000    147.000000    258.000000   1991.000000
75%       28.100000   3975.000000    190.000000    326.399994   1999.000000
max       76.400002   6700.000000    660.000000   1001.000000   2006.000000

======================================================================
TOP 10 MANUFACTURERS BY OBSERVATIONS
======================================================================
mfr
GMC           7979
CHRYSLER      4172
FORD          3709
TOYOTA        1554
NISSAN        1079
VOLKSWAGEN     831
HONDA          743
BMW            740
MITSUBISHI     685
MAZDA          612
Name: count, dtype: int64</code></pre>
</div>
</div>
<p><strong>Key Observations from Summary Statistics:</strong></p>
<ul>
<li><strong>Sample size</strong>: 26,995 vehicles (1980-2006)</li>
<li><strong>Time span</strong>: 27 years of data</li>
<li><strong>MPG range</strong>: 8.7 to 76.4 (huge variation!)</li>
<li><strong>Weight</strong>: 1,450 to 6,700 lbs (compact cars to large trucks)</li>
</ul>
<p><strong>Top manufacturers</strong>: General Motors, Ford, Chrysler dominate (this is U.S. market data)</p>
<p><strong>Why log-log specification?</strong></p>
<p>We use logs of both outcome (MPG) and predictors (weight, HP, torque) because:</p>
<ol type="1">
<li><strong>Elasticity interpretation</strong>: Coefficients = percentage changes
<ul>
<li>Œ≤ = -0.5 means: 1% ‚Üë in weight ‚Üí 0.5% ‚Üì in MPG</li>
</ul></li>
<li><strong>Nonlinear relationships</strong>: MPG doesn‚Äôt change linearly with weight
<ul>
<li>Going from 2,000‚Üí2,100 lbs has different effect than 4,000‚Üí4,100 lbs</li>
<li>Logs capture this naturally</li>
</ul></li>
<li><strong>Reduces heteroskedasticity</strong>: Log transformation stabilizes variance</li>
</ol>
<div id="cell-45" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:59.009967Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:59.009699Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:59.073843Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:59.072932Z&quot;}}" data-execution_count="23">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Log-log regression with cluster-robust standard errors</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Use pre-computed log variables</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>model_auto <span class="op">=</span> ols(<span class="st">'lmpg ~ lhp + lcurbwt + ltorque + year'</span>, data<span class="op">=</span>data_auto).fit(</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    cov_type<span class="op">=</span><span class="st">'cluster'</span>,</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    cov_kwds<span class="op">=</span>{<span class="st">'groups'</span>: data_auto[<span class="st">'mfr'</span>]}</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"LOG-LOG REGRESSION: FUEL EFFICIENCY"</span>)</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model_auto.summary())</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Interpretation</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"ELASTICITY INTERPRETATION"</span>)</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Horsepower elasticity: </span><span class="sc">{</span>model_auto<span class="sc">.</span>params[<span class="st">'lhp'</span>]<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  ‚Üí 1% increase in HP ‚Üí </span><span class="sc">{</span>model_auto<span class="sc">.</span>params[<span class="st">'lhp'</span>]<span class="sc">:.2f}</span><span class="ss">% change in MPG"</span>)</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Weight elasticity: </span><span class="sc">{</span>model_auto<span class="sc">.</span>params[<span class="st">'lcurbwt'</span>]<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  ‚Üí 1% increase in weight ‚Üí </span><span class="sc">{</span>model_auto<span class="sc">.</span>params[<span class="st">'lcurbwt'</span>]<span class="sc">:.2f}</span><span class="ss">% change in MPG"</span>)</span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Torque elasticity: </span><span class="sc">{</span>model_auto<span class="sc">.</span>params[<span class="st">'ltorque'</span>]<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  ‚Üí 1% increase in torque ‚Üí </span><span class="sc">{</span>model_auto<span class="sc">.</span>params[<span class="st">'ltorque'</span>]<span class="sc">:.2f}</span><span class="ss">% change in MPG"</span>)</span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Year trend: </span><span class="sc">{</span>model_auto<span class="sc">.</span>params[<span class="st">'year'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  ‚Üí Efficiency improves </span><span class="sc">{</span>model_auto<span class="sc">.</span>params[<span class="st">'year'</span>]<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">% per year"</span>)</span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"CLUSTER-ROBUST STANDARD ERRORS"</span>)</span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Clustered by manufacturer (mfr)"</span>)</span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Number of clusters: </span><span class="sc">{</span>data_auto[<span class="st">'mfr'</span>]<span class="sc">.</span>nunique()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Average observations per cluster: </span><span class="sc">{</span><span class="bu">len</span>(data_auto)<span class="op">/</span>data_auto[<span class="st">'mfr'</span>]<span class="sc">.</span>nunique()<span class="sc">:.0f}</span><span class="ss">"</span>)</span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Why cluster? Vehicles from same manufacturer likely have correlated errors"</span>)</span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"due to common technology, design philosophy, and engineering teams."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
LOG-LOG REGRESSION: FUEL EFFICIENCY
======================================================================
                            OLS Regression Results                            
==============================================================================
Dep. Variable:                   lmpg   R-squared:                       0.777
Model:                            OLS   Adj. R-squared:                  0.777
Method:                 Least Squares   F-statistic:                     296.9
Date:                Tue, 17 Feb 2026   Prob (F-statistic):           4.21e-28
Time:                        22:12:59   Log-Likelihood:                 17857.
No. Observations:               26995   AIC:                        -3.570e+04
Df Residuals:                   26990   BIC:                        -3.566e+04
Df Model:                           4                                         
Covariance Type:              cluster                                         
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept    -20.8429      1.988    -10.484      0.000     -24.740     -16.946
lhp           -0.1813      0.065     -2.786      0.005      -0.309      -0.054
lcurbwt       -0.5624      0.057     -9.938      0.000      -0.673      -0.452
ltorque       -0.1415      0.064     -2.211      0.027      -0.267      -0.016
year           0.0152      0.001     13.840      0.000       0.013       0.017
==============================================================================
Omnibus:                     1290.146   Durbin-Watson:                   0.877
Prob(Omnibus):                  0.000   Jarque-Bera (JB):             4011.194
Skew:                           0.180   Prob(JB):                         0.00
Kurtosis:                       4.854   Cond. No.                     7.29e+05
==============================================================================

Notes:
[1] Standard Errors are robust to cluster correlation (cluster)
[2] The condition number is large, 7.29e+05. This might indicate that there are
strong multicollinearity or other numerical problems.

======================================================================
ELASTICITY INTERPRETATION
======================================================================
Horsepower elasticity: -0.181
  ‚Üí 1% increase in HP ‚Üí -0.18% change in MPG

Weight elasticity: -0.562
  ‚Üí 1% increase in weight ‚Üí -0.56% change in MPG

Torque elasticity: -0.141
  ‚Üí 1% increase in torque ‚Üí -0.14% change in MPG

Year trend: 0.0152
  ‚Üí Efficiency improves 1.52% per year

======================================================================
CLUSTER-ROBUST STANDARD ERRORS
======================================================================
Clustered by manufacturer (mfr)
Number of clusters: 39
Average observations per cluster: 692

Why cluster? Vehicles from same manufacturer likely have correlated errors
due to common technology, design philosophy, and engineering teams.</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p><strong>Key Concept 13.6: Cluster-Robust Standard Errors for Grouped Data</strong></p>
<p>When observations are grouped (e.g., vehicles by manufacturer), errors within groups may be correlated. <strong>Cluster-robust standard errors</strong> account for this within-group correlation. Using default SEs when clustering exists <strong>understates uncertainty</strong>, leading to false rejections of the null hypothesis.</p>
</blockquote>
</section>
<section id="interpreting-the-results" class="level3">
<h3 class="anchored" data-anchor-id="interpreting-the-results"><strong>Interpreting the Results</strong></h3>
<p><strong>Key Findings:</strong></p>
<ol type="1">
<li><strong>Weight Elasticity</strong>: ‚âà -0.56</li>
</ol>
<ul>
<li>1% increase in vehicle weight ‚Üí 0.56% decrease in MPG</li>
<li><strong>Largest effect</strong> among all variables</li>
<li>Heavier vehicles are substantially less efficient</li>
</ul>
<ol start="2" type="1">
<li><strong>Horsepower Elasticity</strong>: ‚âà -0.30 to -0.35</li>
</ol>
<ul>
<li>1% increase in HP ‚Üí ~0.3% decrease in MPG</li>
<li>More powerful engines burn more fuel</li>
</ul>
<ol start="3" type="1">
<li><strong>Torque Elasticity</strong>: ‚âà -0.10 to -0.15</li>
</ol>
<ul>
<li>Smaller effect than weight or HP</li>
<li>Torque affects efficiency but less than other factors</li>
</ul>
<ol start="4" type="1">
<li><strong>Year Trend</strong>: ‚âà +0.01 to +0.02</li>
</ol>
<ul>
<li>Technology improves efficiency ~1-2% per year</li>
<li>But this is <strong>offset</strong> by increasing weight!</li>
</ul>
<p><strong>The Weight Paradox:</strong></p>
<p>Despite technological improvements:</p>
<ul>
<li>Vehicles got <strong>heavier</strong> (better safety, more features)</li>
<li>Average MPG didn‚Äôt improve much from 1980-2005</li>
<li>Efficiency gains were ‚Äúspent‚Äù on weight/power instead of MPG</li>
</ul>
<p><strong>Why Cluster-Robust Standard Errors?</strong></p>
<p>We cluster by manufacturer because:</p>
<ul>
<li>Ford vehicles share common technology</li>
<li>Toyota vehicles share design philosophy</li>
<li>Errors within manufacturer are <strong>correlated</strong></li>
</ul>
<p><strong>Number of clusters</strong>: 40+ manufacturers <strong>Average per cluster</strong>: ~600 vehicles</p>
<p>Clustering increases SEs ‚Üí more conservative inference</p>
<p><strong>Policy Implications:</strong></p>
<ol type="1">
<li><strong>CAFE Standards</strong>: Corporate Average Fuel Economy regulations</li>
</ol>
<ul>
<li>Weight matters more than technology</li>
<li>Encouraging lighter vehicles could have large impact</li>
</ul>
<ol start="2" type="1">
<li><strong>Consumer Trade-offs</strong>:</li>
</ol>
<ul>
<li>Safety (heavier) vs Efficiency (lighter)</li>
<li>Power (higher HP) vs MPG (lower HP)</li>
<li>Consumers chose weight/power over efficiency</li>
</ul>
<ol start="3" type="1">
<li><strong>Recent Trends</strong> (post-2005, not in data):</li>
</ol>
<ul>
<li>Hybrid/electric technology</li>
<li>Lightweight materials (aluminum, carbon fiber)</li>
<li>Smaller turbocharged engines</li>
</ul>
<p><strong>Model Quality:</strong></p>
<p>R¬≤ ‚âà 0.78 means the model explains 78% of MPG variation</p>
<ul>
<li>Excellent fit!</li>
<li>Weight, HP, torque are key predictors</li>
<li>But 22% remains unexplained (aerodynamics, transmission, etc.)</li>
</ul>
</section>
</section>
<section id="rand-health-insurance-experiment-rct" class="level2">
<h2 class="anchored" data-anchor-id="rand-health-insurance-experiment-rct">13.5 Rand Health Insurance Experiment (RCT)</h2>
<p>Randomized control trial for causal inference.</p>
<section id="case-study-the-rand-health-insurance-experiment-randomized-control-trial" class="level3">
<h3 class="anchored" data-anchor-id="case-study-the-rand-health-insurance-experiment-randomized-control-trial"><strong>Case Study: The RAND Health Insurance Experiment (Randomized Control Trial)</strong></h3>
<p><strong>The Gold Standard for Causal Inference</strong>: Randomized Control Trials (RCTs)</p>
<p><strong>The Policy Question</strong>: Does health insurance coverage affect medical spending?</p>
<p><strong>Why This Matters</strong>:</p>
<p>This is the <strong>moral hazard</strong> question in health economics:</p>
<ul>
<li>If insurance is free, do people overuse healthcare?</li>
<li>Should insurance have cost-sharing (deductibles, co-pays)?</li>
<li>What‚Äôs the right balance between access and efficiency?</li>
</ul>
<p><strong>The Challenge</strong>:</p>
<p>Observational studies are biased because:</p>
<ul>
<li>People who buy insurance are different (sicker? richer?)</li>
<li>Can‚Äôt separate insurance effect from selection effect</li>
<li>Reverse causation: health affects insurance choice</li>
</ul>
<p><strong>The RCT Solution:</strong></p>
<p><strong>The RAND Health Insurance Experiment (1974-1982):</strong></p>
<ul>
<li>Randomly assigned 5,809 individuals to different insurance plans</li>
<li>Plans varied in cost-sharing: 0%, 25%, 50%, 95%, individual deductible</li>
<li>Followed families for 3-5 years</li>
<li>Measured healthcare utilization and spending</li>
</ul>
<p><strong>Why Randomization Enables Causal Inference:</strong></p>
<pre><code>Random Assignment ‚Üí Insurance Plan ‚Üí Medical Spending</code></pre>
<p>Because assignment is random:</p>
<ul>
<li>Treatment and control groups are identical in expectation</li>
<li>No confounding variables</li>
<li>Any difference in outcomes is caused by insurance</li>
<li><strong>Selection bias eliminated!</strong></li>
</ul>
<p><strong>Data</strong>: Year 1 data (5,639 observations)</p>
<p><strong>Variables</strong>:</p>
<ul>
<li><code>spending</code>: Total medical expenditure</li>
<li><code>plan</code>: Insurance plan assignment</li>
<li>Plan indicators: <code>coins0</code> (free care), <code>coins25</code>, <code>coins50</code>, <code>coins95</code>, <code>coinsmixed</code>, <code>coinsindiv</code></li>
</ul>
<p><strong>Method</strong>: Regression with cluster-robust SEs (by family)</p>
<div id="cell-50" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:59.079041Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:59.078698Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:12:59.745072Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:12:59.744226Z&quot;}}" data-execution_count="24">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load health insurance experiment data</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>data_health <span class="op">=</span> pd.read_stata(GITHUB_DATA_URL <span class="op">+</span> <span class="st">'AED_HEALTHINSEXP.DTA'</span>)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Use first year data only (as per textbook)</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>data_health_y1 <span class="op">=</span> data_health[data_health[<span class="st">'year'</span>] <span class="op">==</span> <span class="dv">1</span>]</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Loaded </span><span class="sc">{</span><span class="bu">len</span>(data_health)<span class="sc">}</span><span class="ss"> total observations"</span>)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Using Year 1 only: </span><span class="sc">{</span><span class="bu">len</span>(data_health_y1)<span class="sc">}</span><span class="ss"> observations"</span>)</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Insurance plans: </span><span class="sc">{</span><span class="bu">sorted</span>(data_health_y1[<span class="st">'plan'</span>].unique())<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Key variables:"</span>)</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - plan: Insurance plan assignment (randomized)"</span>)</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - spending: Total medical spending"</span>)</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - Plan indicators: coins0, coins25, coins50, coins95, coinsmixed, coinsindiv"</span>)</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics by plan</span></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"MEAN SPENDING BY INSURANCE PLAN"</span>)</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>spending_by_plan <span class="op">=</span> data_health_y1.groupby(<span class="st">'plan'</span>)[<span class="st">'spending'</span>].agg([<span class="st">'mean'</span>, <span class="st">'std'</span>, <span class="st">'count'</span>])</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(spending_by_plan)</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Regression with plan indicators</span></span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>model_rct <span class="op">=</span> ols(<span class="st">'spending ~ coins25 + coins50 + coins95 + coinsmixed + coinsindiv'</span>,</span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>                data<span class="op">=</span>data_health_y1).fit(</span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>    cov_type<span class="op">=</span><span class="st">'cluster'</span>,</span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>    cov_kwds<span class="op">=</span>{<span class="st">'groups'</span>: data_health_y1[<span class="st">'idfamily'</span>]}</span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"RCT REGRESSION: SPENDING ON INSURANCE PLANS"</span>)</span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Omitted category: Free Care (coins0)"</span>)</span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model_rct.summary())</span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a><span class="co"># F-test for joint significance</span></span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"JOINT F-TEST: DO PLANS MATTER?"</span>)</span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb43-39"><a href="#cb43-39" aria-hidden="true" tabindex="-1"></a>hypotheses <span class="op">=</span> <span class="st">'coins25 = coins50 = coins95 = coinsmixed = coinsindiv = 0'</span></span>
<span id="cb43-40"><a href="#cb43-40" aria-hidden="true" tabindex="-1"></a>ftest <span class="op">=</span> model_rct.f_test(hypotheses)</span>
<span id="cb43-41"><a href="#cb43-41" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"H0: All plan coefficients = 0"</span>)</span>
<span id="cb43-42"><a href="#cb43-42" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"F-statistic: </span><span class="sc">{</span>ftest<span class="sc">.</span>fvalue<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb43-43"><a href="#cb43-43" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"p-value: </span><span class="sc">{</span>ftest<span class="sc">.</span>pvalue<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb43-44"><a href="#cb43-44" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Conclusion: </span><span class="sc">{</span><span class="st">'Reject H0'</span> <span class="cf">if</span> ftest<span class="sc">.</span>pvalue <span class="op">&lt;</span> <span class="fl">0.05</span> <span class="cf">else</span> <span class="st">'Fail to reject H0'</span><span class="sc">}</span><span class="ss"> at 5% level"</span>)</span>
<span id="cb43-45"><a href="#cb43-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-46"><a href="#cb43-46" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb43-47"><a href="#cb43-47" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"CAUSAL INTERPRETATION"</span>)</span>
<span id="cb43-48"><a href="#cb43-48" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb43-49"><a href="#cb43-49" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"‚úì Randomized Control Trial enables causal inference"</span>)</span>
<span id="cb43-50"><a href="#cb43-50" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"‚úì Random assignment eliminates selection bias"</span>)</span>
<span id="cb43-51"><a href="#cb43-51" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"‚úì Free care ‚Üí highest spending (omitted baseline)"</span>)</span>
<span id="cb43-52"><a href="#cb43-52" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"‚úì Higher cost-sharing ‚Üí lower spending"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Loaded 20203 total observations
Using Year 1 only: 5639 observations

Insurance plans: ['25% Coins', '50% Coins', '95%/100% Coins', 'Free Care', 'Indv Deduct', 'Mixed Coins']

Key variables:
  - plan: Insurance plan assignment (randomized)
  - spending: Total medical spending
  - Plan indicators: coins0, coins25, coins50, coins95, coinsmixed, coinsindiv

======================================================================
MEAN SPENDING BY INSURANCE PLAN
======================================================================
                       mean           std  count
plan                                            
Free Care       2153.570365   4959.743126   1873
25% Coins       1396.663070   3458.960029    639
Mixed Coins     1701.874211   4328.165674    480
50% Coins       1785.845449  11643.607841    374
95%/100% Coins  1045.820283   2634.823581   1057
Indv Deduct     1607.071473   3815.953001   1216

======================================================================
RCT REGRESSION: SPENDING ON INSURANCE PLANS
======================================================================
Omitted category: Free Care (coins0)
                            OLS Regression Results                            
==============================================================================
Dep. Variable:               spending   R-squared:                       0.007
Model:                            OLS   Adj. R-squared:                  0.006
Method:                 Least Squares   F-statistic:                     11.39
Date:                Tue, 17 Feb 2026   Prob (F-statistic):           7.46e-11
Time:                        22:12:59   Log-Likelihood:                -55975.
No. Observations:                5639   AIC:                         1.120e+05
Df Residuals:                    5633   BIC:                         1.120e+05
Df Model:                           5                                         
Covariance Type:              cluster                                         
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept   2153.5704    118.315     18.202      0.000    1921.678    2385.463
coins25     -756.9073    190.041     -3.983      0.000   -1129.381    -384.433
coins50     -367.7249    618.044     -0.595      0.552   -1579.069     843.619
coins95    -1107.7501    150.366     -7.367      0.000   -1402.462    -813.038
coinsmixed  -451.6962    239.424     -1.887      0.059    -920.959      17.567
coinsindiv  -546.4989    162.151     -3.370      0.001    -864.308    -228.690
==============================================================================
Omnibus:                    11610.083   Durbin-Watson:                   2.017
Prob(Omnibus):                  0.000   Jarque-Bera (JB):         52697192.093
Skew:                          17.125   Prob(JB):                         0.00
Kurtosis:                     475.345   Cond. No.                         5.48
==============================================================================

Notes:
[1] Standard Errors are robust to cluster correlation (cluster)

======================================================================
JOINT F-TEST: DO PLANS MATTER?
======================================================================
H0: All plan coefficients = 0
F-statistic: 11.39
p-value: 0.0000
Conclusion: Reject H0 at 5% level

======================================================================
CAUSAL INTERPRETATION
======================================================================
‚úì Randomized Control Trial enables causal inference
‚úì Random assignment eliminates selection bias
‚úì Free care ‚Üí highest spending (omitted baseline)
‚úì Higher cost-sharing ‚Üí lower spending</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p><strong>Key Concept 13.7: Randomized Control Trials as the Gold Standard</strong></p>
<p>In a <strong>randomized control trial (RCT)</strong>, subjects are randomly assigned to treatment and control groups. Random assignment ensures the groups are comparable on both observed and unobserved characteristics, eliminating selection bias and omitted variable concerns. The RAND experiment showed that better insurance coverage increases healthcare utilization.</p>
</blockquote>
</section>
<section id="interpreting-the-rct-results" class="level3">
<h3 class="anchored" data-anchor-id="interpreting-the-rct-results"><strong>Interpreting the RCT Results</strong></h3>
<p><strong>Key Findings:</strong></p>
<ol type="1">
<li><strong>Insurance Plans Matter</strong>: F-test strongly rejects H‚ÇÄ (F = 11.39, p &lt; 0.001)</li>
</ol>
<ul>
<li>Different insurance plans lead to significantly different spending</li>
<li>Cost-sharing reduces medical utilization</li>
</ul>
<ol start="2" type="1">
<li><strong>Spending by Plan</strong> (relative to Free Care):</li>
</ol>
<p>Free Care (baseline): Highest spending</p>
<ul>
<li>People use more healthcare when it‚Äôs free</li>
</ul>
<p>Cost-sharing plans (25%, 50%, 95%): Lower spending</p>
<ul>
<li>Higher cost-sharing ‚Üí less utilization</li>
<li>This is <strong>moral hazard</strong>: insurance affects behavior</li>
</ul>
<ol start="3" type="1">
<li><strong>Why This is Causal</strong>:</li>
</ol>
<p><strong>Randomization</strong>: Families randomly assigned to plans</p>
<ul>
<li>No selection bias (unlike observational studies)</li>
<li>Treated and control groups are balanced on all characteristics</li>
</ul>
<p><strong>Experimental control</strong>: RAND ensured compliance</p>
<p><strong>Large sample</strong>: 5,639 person-years in first year</p>
<ol start="4" type="1">
<li><strong>R¬≤ is Low (0.007)</strong> - This is Actually Good!</li>
</ol>
<ul>
<li>Most variation in spending is random (health shocks)</li>
<li>Insurance explains small fraction (as expected)</li>
<li>But effects are <strong>statistically significant</strong> and <strong>policy-relevant</strong></li>
</ul>
<p><strong>Policy Implications:</strong></p>
<p><strong>Trade-offs in health insurance design:</strong></p>
<p><strong>Free care</strong>:</p>
<ul>
<li>More utilization</li>
<li>Better access for poor</li>
<li>But: higher costs, potential overuse</li>
</ul>
<p><strong>Cost-sharing</strong>:</p>
<ul>
<li>Lower spending</li>
<li>Reduced ‚Äúunnecessary‚Äù care</li>
<li>But: may also reduce necessary care (problematic!)</li>
</ul>
<p><strong>The RAND Health Insurance Experiment (HIE) Legacy:</strong></p>
<p>This 1970s experiment fundamentally shaped U.S. health policy:</p>
<ul>
<li>Informed Medicare/Medicaid design</li>
<li>Influenced Affordable Care Act</li>
<li>Demonstrated feasibility of large-scale RCTs</li>
<li>Showed moral hazard exists but is moderate</li>
</ul>
<p><strong>Limitations:</strong></p>
<p>1970s data (healthcare has changed) Selected sites (may not generalize) Ethical concerns (denying some families full coverage)</p>
<p><strong>Modern Relevance:</strong></p>
<p>The fundamental trade-off remains:</p>
<ul>
<li>Universal free care (equity) vs</li>
<li>Cost-sharing (efficiency)</li>
</ul>
<p><em>Now that we‚Äôve seen experimental data in the RAND study, let‚Äôs explore quasi-experimental methods for causal inference.</em></p>
</section>
</section>
<section id="health-care-access-difference-in-differences" class="level2">
<h2 class="anchored" data-anchor-id="health-care-access-difference-in-differences">13.6 Health Care Access (Difference-in-Differences)</h2>
<p>Causal inference using DiD methodology.</p>
<section id="case-study-health-care-access-and-child-nutrition-difference-in-differences" class="level3">
<h3 class="anchored" data-anchor-id="case-study-health-care-access-and-child-nutrition-difference-in-differences"><strong>Case Study: Health Care Access and Child Nutrition (Difference-in-Differences)</strong></h3>
<p><strong>The Policy Question</strong>: Does building health clinics improve child health outcomes?</p>
<p><strong>The Setting</strong>: Rural South Africa, 1990s</p>
<p>After apartheid ended (1994), the new government built primary health care clinics in underserved rural areas. Some communities got many new clinics (high treatment), others got few (low treatment).</p>
<p><strong>The Challenge</strong>: Simple before/after comparison is biased because:</p>
<ul>
<li>Child health was improving nationally due to many factors</li>
<li>Communities that got clinics may have been different</li>
<li>Cannot separate clinic effect from other trends</li>
</ul>
<p><strong>The Difference-in-Differences Solution:</strong></p>
<p><strong>Key Idea</strong>: Compare change in treated communities to change in control communities</p>
<p><span class="math display">\[\text{DiD} = (\text{Treated}_{after} - \text{Treated}_{before}) - (\text{Control}_{after} - \text{Control}_{before})\]</span></p>
<p><strong>Why This Works:</strong></p>
<p>The first difference removes:</p>
<ul>
<li>Permanent differences between communities</li>
<li>Baseline health levels</li>
</ul>
<p>The second difference removes:</p>
<ul>
<li>Common time trends</li>
<li>National-level changes</li>
</ul>
<p><strong>What remains</strong>: The differential impact of clinic access!</p>
<p><strong>The Design:</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Group</th>
<th>1993 (Pre)</th>
<th>1998 (Post)</th>
<th>Change</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>High Treatment</td>
<td><span class="math inline">\(\bar{Y}_{T,0}\)</span></td>
<td><span class="math inline">\(\bar{Y}_{T,1}\)</span></td>
<td><span class="math inline">\(\Delta_T\)</span></td>
</tr>
<tr class="even">
<td>Low Treatment</td>
<td><span class="math inline">\(\bar{Y}_{C,0}\)</span></td>
<td><span class="math inline">\(\bar{Y}_{C,1}\)</span></td>
<td><span class="math inline">\(\Delta_C\)</span></td>
</tr>
</tbody>
</table>
<p>DiD = <span class="math inline">\(\Delta_T - \Delta_C\)</span></p>
<p><strong>Data</strong>: 1,071 children aged 0-4 in rural KwaZulu-Natal</p>
<p><strong>Outcome</strong>: <code>waz</code> (weight-for-age z-score, measure of nutrition)</p>
<p><strong>Method</strong>: DiD regression with cluster-robust SEs (by community)</p>
<div id="cell-56" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:59.749482Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:59.749164Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:13:00.138294Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:13:00.137583Z&quot;}}" data-execution_count="25">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load health care access data (South Africa)</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>data_access <span class="op">=</span> pd.read_stata(GITHUB_DATA_URL <span class="op">+</span> <span class="st">'AED_HEALTHACCESS.DTA'</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Loaded </span><span class="sc">{</span><span class="bu">len</span>(data_access)<span class="sc">}</span><span class="ss"> observations (South African children 0-4)"</span>)</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Difference-in-Differences Setup:"</span>)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - Treatment: High treatment communities (hightreat=1)"</span>)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - Control: Low treatment communities (hightreat=0)"</span>)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - Pre period: 1993 (post=0)"</span>)</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - Post period: 1998 (post=1)"</span>)</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - Outcome: waz (weight-for-age z-score)"</span>)</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics by treatment and time</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"MEAN WEIGHT-FOR-AGE Z-SCORE (WAZ)"</span>)</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>did_table <span class="op">=</span> data_access.groupby([<span class="st">'hightreat'</span>, <span class="st">'post'</span>])[<span class="st">'waz'</span>].agg([<span class="st">'mean'</span>, <span class="st">'count'</span>])</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(did_table)</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate DiD manually</span></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>pre_control <span class="op">=</span> data_access[(data_access[<span class="st">'hightreat'</span>]<span class="op">==</span><span class="dv">0</span>) <span class="op">&amp;</span> (data_access[<span class="st">'post'</span>]<span class="op">==</span><span class="dv">0</span>)][<span class="st">'waz'</span>].mean()</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>post_control <span class="op">=</span> data_access[(data_access[<span class="st">'hightreat'</span>]<span class="op">==</span><span class="dv">0</span>) <span class="op">&amp;</span> (data_access[<span class="st">'post'</span>]<span class="op">==</span><span class="dv">1</span>)][<span class="st">'waz'</span>].mean()</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>pre_treat <span class="op">=</span> data_access[(data_access[<span class="st">'hightreat'</span>]<span class="op">==</span><span class="dv">1</span>) <span class="op">&amp;</span> (data_access[<span class="st">'post'</span>]<span class="op">==</span><span class="dv">0</span>)][<span class="st">'waz'</span>].mean()</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>post_treat <span class="op">=</span> data_access[(data_access[<span class="st">'hightreat'</span>]<span class="op">==</span><span class="dv">1</span>) <span class="op">&amp;</span> (data_access[<span class="st">'post'</span>]<span class="op">==</span><span class="dv">1</span>)][<span class="st">'waz'</span>].mean()</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>did_estimate <span class="op">=</span> (post_treat <span class="op">-</span> pre_treat) <span class="op">-</span> (post_control <span class="op">-</span> pre_control)</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Manual DiD calculation:"</span>)</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Control change: </span><span class="sc">{</span>post_control<span class="sc">:.3f}</span><span class="ss"> - </span><span class="sc">{</span>pre_control<span class="sc">:.3f}</span><span class="ss"> = </span><span class="sc">{</span>post_control <span class="op">-</span> pre_control<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Treated change: </span><span class="sc">{</span>post_treat<span class="sc">:.3f}</span><span class="ss"> - </span><span class="sc">{</span>pre_treat<span class="sc">:.3f}</span><span class="ss"> = </span><span class="sc">{</span>post_treat <span class="op">-</span> pre_treat<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  DiD estimate: (</span><span class="sc">{</span>post_treat<span class="sc">:.3f}</span><span class="ss"> - </span><span class="sc">{</span>pre_treat<span class="sc">:.3f}</span><span class="ss">) - (</span><span class="sc">{</span>post_control<span class="sc">:.3f}</span><span class="ss"> - </span><span class="sc">{</span>pre_control<span class="sc">:.3f}</span><span class="ss">) = </span><span class="sc">{</span>did_estimate<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a><span class="co"># DiD regression</span></span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>model_did <span class="op">=</span> ols(<span class="st">'waz ~ hightreat + post + postXhigh'</span>, data<span class="op">=</span>data_access).fit(</span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>    cov_type<span class="op">=</span><span class="st">'cluster'</span>,</span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>    cov_kwds<span class="op">=</span>{<span class="st">'groups'</span>: data_access[<span class="st">'idcommunity'</span>]}</span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"DiD REGRESSION"</span>)</span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model_did.summary())</span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"INTERPRETATION"</span>)</span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"DiD coefficient (postXhigh): </span><span class="sc">{</span>model_did<span class="sc">.</span>params[<span class="st">'postXhigh'</span>]<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Matches manual calculation: </span><span class="sc">{</span>did_estimate<span class="sc">:.3f}</span><span class="ss"> ‚úì"</span>)</span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Causal interpretation:"</span>)</span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Clinic access improved child nutrition by </span><span class="sc">{</span>model_did<span class="sc">.</span>params[<span class="st">'postXhigh'</span>]<span class="sc">:.2f}</span><span class="ss"> standard deviations"</span>)</span>
<span id="cb45-50"><a href="#cb45-50" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"This is a </span><span class="sc">{</span><span class="st">'statistically significant'</span> <span class="cf">if</span> model_did<span class="sc">.</span>pvalues[<span class="st">'postXhigh'</span>] <span class="op">&lt;</span> <span class="fl">0.05</span> <span class="cf">else</span> <span class="st">'not significant'</span><span class="sc">}</span><span class="ss"> effect"</span>)</span>
<span id="cb45-51"><a href="#cb45-51" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Cluster-robust SEs by community account for within-community correlation"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Loaded 1071 observations (South African children 0-4)

Difference-in-Differences Setup:
  - Treatment: High treatment communities (hightreat=1)
  - Control: Low treatment communities (hightreat=0)
  - Pre period: 1993 (post=0)
  - Post period: 1998 (post=1)
  - Outcome: waz (weight-for-age z-score)

======================================================================
MEAN WEIGHT-FOR-AGE Z-SCORE (WAZ)
======================================================================
                    mean  count
hightreat post                 
0.0       0.0  -0.414185    325
          1.0  -0.069097    288
1.0       0.0  -0.545244    246
          1.0   0.321462    212

Manual DiD calculation:
  Control change: -0.069 - -0.414 = 0.345
  Treated change: 0.321 - -0.545 = 0.867
  DiD estimate: (0.321 - -0.545) - (-0.069 - -0.414) = 0.522

======================================================================
DiD REGRESSION
======================================================================
                            OLS Regression Results                            
==============================================================================
Dep. Variable:                    waz   R-squared:                       0.040
Model:                            OLS   Adj. R-squared:                  0.037
Method:                 Least Squares   F-statistic:                     9.090
Date:                Tue, 17 Feb 2026   Prob (F-statistic):           5.93e-05
Time:                        22:13:00   Log-Likelihood:                -1992.5
No. Observations:                1071   AIC:                             3993.
Df Residuals:                    1067   BIC:                             4013.
Df Model:                           3                                         
Covariance Type:              cluster                                         
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept     -0.4142      0.115     -3.597      0.000      -0.640      -0.189
hightreat     -0.1311      0.197     -0.666      0.505      -0.517       0.255
post           0.3451      0.137      2.517      0.012       0.076       0.614
postXhigh      0.5216      0.235      2.217      0.027       0.060       0.983
==============================================================================
Omnibus:                       27.248   Durbin-Watson:                   1.855
Prob(Omnibus):                  0.000   Jarque-Bera (JB):               31.523
Skew:                           0.328   Prob(JB):                     1.43e-07
Kurtosis:                       3.524   Cond. No.                         6.32
==============================================================================

Notes:
[1] Standard Errors are robust to cluster correlation (cluster)

======================================================================
INTERPRETATION
======================================================================
DiD coefficient (postXhigh): 0.522
Matches manual calculation: 0.522 ‚úì

Causal interpretation:
Clinic access improved child nutrition by 0.52 standard deviations
This is a statistically significant effect

Cluster-robust SEs by community account for within-community correlation</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p><strong>Key Concept 13.8: Difference-in-Differences for Causal Inference</strong></p>
<p><strong>Difference-in-differences (DiD)</strong> compares changes over time between treatment and control groups. The key assumption is <strong>parallel trends</strong>: both groups would have followed the same trajectory absent treatment. DiD removes time-invariant confounders and common time effects, isolating the treatment effect.</p>
</blockquote>
</section>
<section id="interpreting-the-did-results" class="level3">
<h3 class="anchored" data-anchor-id="interpreting-the-did-results"><strong>Interpreting the DiD Results</strong></h3>
<p><strong>Key Findings:</strong></p>
<ol type="1">
<li><strong>Treatment Effect</strong>: DiD coefficient ‚âà 0.52 standard deviations</li>
</ol>
<ul>
<li>Clinic access improved child weight-for-age by 0.52 SD</li>
<li><strong>Statistically significant</strong> (p = 0.027 &lt; 0.05)</li>
<li>Large and meaningful effect size</li>
</ul>
<ol start="2" type="1">
<li><strong>Verification</strong>: Manual calculation matches regression</li>
</ol>
<ul>
<li>This confirms our DiD estimate is correct</li>
<li>The interaction term <code>postXhigh</code> captures the treatment effect</li>
</ul>
<ol start="3" type="1">
<li><strong>Effect Size Interpretation</strong>:</li>
</ol>
<p>0.52 SD improvement means:</p>
<ul>
<li>Moving from 25th percentile ‚Üí 45th percentile in weight distribution</li>
<li>Substantial reduction in malnutrition</li>
<li>Comparable to 6-12 months of normal growth</li>
</ul>
<p><strong>Why This is Causal (Under Assumptions):</strong></p>
<p>The DiD design requires <strong>parallel trends assumption</strong>:</p>
<ul>
<li>Without treatment, treated and control groups would have followed parallel trends</li>
<li>Treatment assignment (clinic placement) is exogenous</li>
<li>No other interventions differentially affected treated communities</li>
</ul>
<p><strong>Evidence for validity:</strong></p>
<ul>
<li>Communities were similar at baseline</li>
<li>Clinic placement based on need, not outcomes</li>
<li>No other major health programs during this period</li>
</ul>
<p><strong>Policy Implications:</strong></p>
<p><strong>Primary health care access works</strong>: Even basic clinics improve child health</p>
<p><strong>Targeting matters</strong>: High-treatment communities saw larger benefits</p>
<p><strong>Cost-effective</strong>: Clinic construction is relatively inexpensive</p>
<p><strong>External Validity:</strong></p>
<p>These results from rural South Africa likely generalize to other:</p>
<ul>
<li>Low-income settings</li>
<li>Areas with limited health infrastructure</li>
<li>Populations with high baseline malnutrition</li>
</ul>
<p><strong>Limitations:</strong></p>
<p>Short-term effects (1998 vs 1993) Self-reported data (possible measurement error) Cluster-level treatment (less statistical power)</p>
</section>
</section>
<section id="political-incumbency-regression-discontinuity" class="level2">
<h2 class="anchored" data-anchor-id="political-incumbency-regression-discontinuity">13.7 Political Incumbency (Regression Discontinuity)</h2>
<p>Causal inference using RD design.</p>
<section id="case-study-the-incumbency-advantage-in-u.s.-senate-elections" class="level3">
<h3 class="anchored" data-anchor-id="case-study-the-incumbency-advantage-in-u.s.-senate-elections"><strong>Case Study: The Incumbency Advantage in U.S. Senate Elections</strong></h3>
<p><strong>The Question</strong>: Does being an incumbent senator give you an advantage in the next election?</p>
<p><strong>The Challenge</strong>: Simple comparison of incumbents vs challengers is biased because:</p>
<ul>
<li>Incumbents are generally stronger candidates (that‚Äôs why they won before!)</li>
<li>Districts that elect incumbents may be different</li>
<li>Selection bias confounds the causal effect</li>
</ul>
<p><strong>The Regression Discontinuity Solution:</strong></p>
<p><strong>Key Insight</strong>: Compare candidates who <strong>barely won</strong> to those who <strong>barely lost</strong>.</p>
<p>At the threshold (vote margin ‚âà 0):</p>
<ul>
<li>Winners and losers are essentially identical in quality</li>
<li>Only difference: winners become incumbents</li>
<li>This creates <strong>quasi-random assignment</strong> to incumbency status</li>
</ul>
<p><strong>The Design:</strong></p>
<pre><code>Running variable: margin (vote share in election t - 50%)
Threshold: margin = 0
Treatment: win = 1 if margin &gt; 0

Outcome: vote (vote share in election t+1)</code></pre>
<p><strong>Visual Intuition:</strong></p>
<p>If there‚Äôs an incumbency advantage, we should see a <strong>jump</strong> in next-election vote share exactly at margin = 0:</p>
<pre><code>Next Vote % ‚ñ≤
 ‚îÇ
 60‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§ ‚Ä¢
 ‚îÇ ‚Ä¢ ‚Üê Jump = incumbency advantage
 50‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§ ‚Ä¢
 ‚îÇ ‚Ä¢
 40‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§‚Ä¢
 ‚îÇ
 ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚Üí
 -10 0 +10
 Lost ‚îÇ Won
 Margin</code></pre>
<p><strong>Data</strong>: 1,390 U.S. Senate elections (1914-2010)</p>
<p><strong>Method</strong>: RD with linear control for margin</p>
<div id="cell-61" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:13:00.142348Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:13:00.142059Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:13:00.454340Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:13:00.453725Z&quot;}}" data-execution_count="26">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load incumbency data (U.S. Senate elections)</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>data_incumb <span class="op">=</span> pd.read_stata(GITHUB_DATA_URL <span class="op">+</span> <span class="st">'AED_INCUMBENCY.DTA'</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Loaded </span><span class="sc">{</span><span class="bu">len</span>(data_incumb)<span class="sc">}</span><span class="ss"> Senate elections (1914-2010)"</span>)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Regression Discontinuity Setup:"</span>)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - Running variable: margin (vote margin in election t)"</span>)</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - Threshold: margin = 0 (barely won vs barely lost)"</span>)</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - Outcome: vote (vote share in election t+1)"</span>)</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - win: Indicator for margin &gt; 0"</span>)</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"SUMMARY STATISTICS"</span>)</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data_incumb[[<span class="st">'vote'</span>, <span class="st">'margin'</span>, <span class="st">'win'</span>]].describe())</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep only elections with non-missing vote in t+1</span></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>data_rd <span class="op">=</span> data_incumb[data_incumb[<span class="st">'vote'</span>].notna()].copy()</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Observations with outcome data: </span><span class="sc">{</span><span class="bu">len</span>(data_rd)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a><span class="co"># RD regression (linear)</span></span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>model_rd <span class="op">=</span> ols(<span class="st">'vote ~ win + margin'</span>, data<span class="op">=</span>data_rd).fit(cov_type<span class="op">=</span><span class="st">'HC1'</span>)</span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"REGRESSION DISCONTINUITY ESTIMATION"</span>)</span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model_rd.summary())</span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"INCUMBENCY ADVANTAGE"</span>)</span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb49-32"><a href="#cb49-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"RD estimate (win coefficient): </span><span class="sc">{</span>model_rd<span class="sc">.</span>params[<span class="st">'win'</span>]<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb49-33"><a href="#cb49-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"95% CI: [</span><span class="sc">{</span>model_rd<span class="sc">.</span>conf_int()<span class="sc">.</span>loc[<span class="st">'win'</span>, <span class="dv">0</span>]<span class="sc">:.3f}</span><span class="ss">, </span><span class="sc">{</span>model_rd<span class="sc">.</span>conf_int()<span class="sc">.</span>loc[<span class="st">'win'</span>, <span class="dv">1</span>]<span class="sc">:.3f}</span><span class="ss">]"</span>)</span>
<span id="cb49-34"><a href="#cb49-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Interpretation:"</span>)</span>
<span id="cb49-35"><a href="#cb49-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Barely winning vs barely losing increases vote share in next election by </span><span class="sc">{</span>model_rd<span class="sc">.</span>params[<span class="st">'win'</span>]<span class="sc">:.1f}</span><span class="ss">%"</span>)</span>
<span id="cb49-36"><a href="#cb49-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"This is the causal effect of incumbency"</span>)</span>
<span id="cb49-37"><a href="#cb49-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Why causal? At the threshold (margin‚âà0), winning is quasi-random"</span>)</span>
<span id="cb49-38"><a href="#cb49-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Candidates just above/below threshold are similar in all respects except incumbency status"</span>)</span>
<span id="cb49-39"><a href="#cb49-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-40"><a href="#cb49-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization note</span></span>
<span id="cb49-41"><a href="#cb49-41" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb49-42"><a href="#cb49-42" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"RD PLOT"</span>)</span>
<span id="cb49-43"><a href="#cb49-43" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb49-44"><a href="#cb49-44" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"To visualize discontinuity:"</span>)</span>
<span id="cb49-45"><a href="#cb49-45" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  - Bin observations by margin"</span>)</span>
<span id="cb49-46"><a href="#cb49-46" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  - Plot mean vote in next election vs margin"</span>)</span>
<span id="cb49-47"><a href="#cb49-47" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  - Should see jump at margin=0"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Loaded 1390 Senate elections (1914-2010)

Regression Discontinuity Setup:
  - Running variable: margin (vote margin in election t)
  - Threshold: margin = 0 (barely won vs barely lost)
  - Outcome: vote (vote share in election t+1)
  - win: Indicator for margin &gt; 0

======================================================================
SUMMARY STATISTICS
======================================================================
              vote       margin          win
count  1297.000000  1390.000000  1390.000000
mean     52.666275     7.171158     0.539568
std      18.122194    34.324886     0.498611
min       0.000000  -100.000000     0.000000
25%      42.671333   -12.205826     0.000000
50%      50.547523     2.165648     1.000000
75%      61.348957    22.766067     1.000000
max     100.000000   100.000000     1.000000

Observations with outcome data: 1297

======================================================================
REGRESSION DISCONTINUITY ESTIMATION
======================================================================
                            OLS Regression Results                            
==============================================================================
Dep. Variable:                   vote   R-squared:                       0.578
Model:                            OLS   Adj. R-squared:                  0.577
Method:                 Least Squares   F-statistic:                     591.4
Date:                Tue, 17 Feb 2026   Prob (F-statistic):          3.71e-183
Time:                        22:13:00   Log-Likelihood:                -5037.8
No. Observations:                1297   AIC:                         1.008e+04
Df Residuals:                    1294   BIC:                         1.010e+04
Df Model:                           2                                         
Covariance Type:                  HC1                                         
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept     47.3308      0.526     89.945      0.000      46.299      48.362
win            4.7846      0.860      5.565      0.000       3.099       6.470
margin         0.3481      0.017     20.422      0.000       0.315       0.381
==============================================================================
Omnibus:                       69.616   Durbin-Watson:                   1.821
Prob(Omnibus):                  0.000   Jarque-Bera (JB):              164.216
Skew:                          -0.304   Prob(JB):                     2.19e-36
Kurtosis:                       4.634   Cond. No.                         111.
==============================================================================

Notes:
[1] Standard Errors are heteroscedasticity robust (HC1)

======================================================================
INCUMBENCY ADVANTAGE
======================================================================
RD estimate (win coefficient): 4.785
95% CI: [3.099, 6.470]

Interpretation:
Barely winning vs barely losing increases vote share in next election by 4.8%
This is the causal effect of incumbency

Why causal? At the threshold (margin‚âà0), winning is quasi-random
Candidates just above/below threshold are similar in all respects except incumbency status

======================================================================
RD PLOT
======================================================================
To visualize discontinuity:
  - Bin observations by margin
  - Plot mean vote in next election vs margin
  - Should see jump at margin=0</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p><strong>Key Concept 13.9: Regression Discontinuity Design</strong></p>
<p><strong>Regression discontinuity (RD)</strong> exploits sharp cutoffs in treatment assignment. Units just above and below the threshold are nearly identical in all respects except treatment status, creating a <strong>quasi-experiment</strong>. In U.S. Senate elections, barely winning provides an incumbency advantage of approximately 5‚Äì7 percentage points.</p>
</blockquote>
</section>
<section id="interpreting-the-rd-results" class="level3">
<h3 class="anchored" data-anchor-id="interpreting-the-rd-results"><strong>Interpreting the RD Results</strong></h3>
<p><strong>Key Findings:</strong></p>
<ol type="1">
<li><strong>Incumbency Advantage</strong>: ‚âà 4.8 percentage points</li>
</ol>
<ul>
<li>Barely winning vs barely losing increases vote share by ~4.8% in next election</li>
<li>This is <strong>highly statistically significant</strong> (p &lt; 0.001)</li>
<li>Robust across different specifications</li>
</ul>
<ol start="2" type="1">
<li><strong>Why This is Causal</strong>:</li>
</ol>
<p>At the threshold (margin ‚âà 0), winning is <strong>quasi-random</strong>:</p>
<ul>
<li>Candidates just above and below 50% are nearly identical</li>
<li>Only difference is incumbency status</li>
<li>No selection bias (unlike comparing all winners vs all losers)</li>
</ul>
<ol start="3" type="1">
<li><strong>Magnitude in Context</strong>:</li>
</ol>
<ul>
<li>4.8% advantage is <strong>substantial</strong> in close elections</li>
<li>Many Senate races decided by &lt; 5%</li>
<li>Could explain why incumbents rarely lose</li>
</ul>
<p><strong>What Drives the Incumbency Advantage?</strong></p>
<p>Possible mechanisms:</p>
<ul>
<li><strong>Name recognition</strong>: Incumbents are well-known</li>
<li><strong>Fundraising</strong>: Easier to raise money as incumbent</li>
<li><strong>Media coverage</strong>: Senators get more press</li>
<li><strong>Constituent services</strong>: Can deliver benefits to voters</li>
<li><strong>Experience</strong>: Learn how to campaign effectively</li>
</ul>
<p><strong>Policy Implications:</strong></p>
<ul>
<li>Incumbency advantage creates barriers to electoral competition</li>
<li>May reduce democratic accountability</li>
<li>Term limits could level the playing field</li>
<li>Campaign finance reform might reduce fundraising advantage</li>
</ul>
<p><strong>RD Design Advantages:</strong></p>
<p>No need to control for other variables (identification at threshold) Transparent and credible Robust to model specification</p>
<p><strong>Limitations:</strong></p>
<p>Local estimate (only applies near threshold) May not generalize to landslide winners/losers Assumes no manipulation of vote margin (reasonable for U.S. Senate)</p>
</section>
</section>
<section id="institutions-and-gdp-instrumental-variables" class="level2">
<h2 class="anchored" data-anchor-id="institutions-and-gdp-instrumental-variables">13.8 Institutions and GDP (Instrumental Variables)</h2>
<p>Causal inference using IV/2SLS.</p>
<section id="case-study-do-institutions-cause-economic-growth" class="level3">
<h3 class="anchored" data-anchor-id="case-study-do-institutions-cause-economic-growth"><strong>Case Study: Do Institutions Cause Economic Growth?</strong></h3>
<p><strong>The Fundamental Question</strong>: Why are some countries rich and others poor?</p>
<p><strong>The Endogeneity Problem:</strong></p>
<p>If we simply regress GDP on institutions quality, we get:</p>
<ul>
<li><strong>Reverse causation</strong>: Rich countries can afford better institutions</li>
<li><strong>Omitted variables</strong>: Culture, geography, history all affect both</li>
<li><strong>Measurement error</strong>: How do we measure ‚Äúinstitutions quality‚Äù?</li>
</ul>
<p>All of these bias OLS estimates, making causal inference impossible.</p>
<p><strong>The Instrumental Variables Solution:</strong></p>
<p>Acemoglu, Johnson, and Robinson (2001) use <strong>settler mortality</strong> as an instrument:</p>
<p><strong>The Historical Argument:</strong></p>
<ol type="1">
<li>In the 1600s-1800s, European colonizers faced different disease environments</li>
<li>High mortality areas (Africa, tropical Americas) ‚Üí extractive institutions</li>
</ol>
<ul>
<li>Europeans didn‚Äôt settle permanently</li>
<li>Built institutions to extract resources (slavery, forced labor)</li>
</ul>
<ol start="3" type="1">
<li>Low mortality areas (North America, Australia) ‚Üí settler institutions</li>
</ol>
<ul>
<li>Europeans settled permanently</li>
<li>Built institutions to protect their own property rights</li>
</ul>
<p><strong>Why This Works as an Instrument:</strong></p>
<p><strong>Relevant</strong>: Settler mortality strongly predicts colonial institutions <strong>Exogenous</strong>: Malaria in 1700s doesn‚Äôt directly affect GDP in 2000s</p>
<p><strong>Data</strong>: 64 former colonies</p>
<p><strong>Variables</strong>:</p>
<ul>
<li><code>logpgp95</code>: Log GDP per capita 1995 (outcome)</li>
<li><code>avexpr</code>: Protection against expropriation (institutions quality, 0-10)</li>
<li><code>logem4</code>: Log settler mortality rate (instrument)</li>
</ul>
<p><strong>Method</strong>: Two-Stage Least Squares (2SLS/IV)</p>
<div id="cell-66" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:13:00.458396Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:13:00.458109Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:13:00.810505Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:13:00.809941Z&quot;}}" data-execution_count="27">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load institutions data (cross-country)</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>data_inst <span class="op">=</span> pd.read_stata(GITHUB_DATA_URL <span class="op">+</span> <span class="st">'AED_INSTITUTIONS.DTA'</span>)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Loaded </span><span class="sc">{</span><span class="bu">len</span>(data_inst)<span class="sc">}</span><span class="ss"> countries"</span>)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Instrumental Variables Setup:"</span>)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - Outcome: logpgp95 (log GDP per capita 1995)"</span>)</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - Endogenous regressor: avexpr (institutions quality)"</span>)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - Instrument: logem4 (log settler mortality)"</span>)</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Key idea: Settler mortality affected colonial institutions,"</span>)</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"which persist to affect GDP today, but mortality doesn't"</span>)</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"directly affect modern GDP"</span>)</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"SUMMARY STATISTICS"</span>)</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data_inst[[<span class="st">'logpgp95'</span>, <span class="st">'avexpr'</span>, <span class="st">'logem4'</span>]].describe())</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a><span class="co"># OLS (biased - endogeneity problem)</span></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>model_ols <span class="op">=</span> ols(<span class="st">'logpgp95 ~ avexpr'</span>, data<span class="op">=</span>data_inst).fit(cov_type<span class="op">=</span><span class="st">'HC1'</span>)</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"OLS REGRESSION (BIASED)"</span>)</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model_ols.summary())</span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">OLS coefficient: </span><span class="sc">{</span>model_ols<span class="sc">.</span>params[<span class="st">'avexpr'</span>]<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"‚ö†Ô∏è This is biased due to endogeneity (omitted variables, reverse causation)"</span>)</span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a><span class="co"># First stage</span></span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a>model_first <span class="op">=</span> ols(<span class="st">'avexpr ~ logem4'</span>, data<span class="op">=</span>data_inst).fit(cov_type<span class="op">=</span><span class="st">'HC1'</span>)</span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"FIRST STAGE: INSTITUTIONS ~ SETTLER MORTALITY"</span>)</span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model_first.summary())</span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">First stage F-statistic: </span><span class="sc">{</span>model_first<span class="sc">.</span>fvalue<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Rule of thumb: F &gt; 10 for strong instrument"</span>)</span>
<span id="cb51-38"><a href="#cb51-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Instrument strength: </span><span class="sc">{</span><span class="st">'Strong ‚úì'</span> <span class="cf">if</span> model_first<span class="sc">.</span>fvalue <span class="op">&gt;</span> <span class="dv">10</span> <span class="cf">else</span> <span class="st">'Weak ‚ö†Ô∏è'</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb51-39"><a href="#cb51-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-40"><a href="#cb51-40" aria-hidden="true" tabindex="-1"></a><span class="co"># 2SLS manually (for pedagogy)</span></span>
<span id="cb51-41"><a href="#cb51-41" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb51-42"><a href="#cb51-42" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"TWO-STAGE LEAST SQUARES (2SLS)"</span>)</span>
<span id="cb51-43"><a href="#cb51-43" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb51-44"><a href="#cb51-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-45"><a href="#cb51-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicted institutions from first stage</span></span>
<span id="cb51-46"><a href="#cb51-46" aria-hidden="true" tabindex="-1"></a>data_inst[<span class="st">'avexpr_hat'</span>] <span class="op">=</span> model_first.fittedvalues</span>
<span id="cb51-47"><a href="#cb51-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-48"><a href="#cb51-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Second stage (using predicted values)</span></span>
<span id="cb51-49"><a href="#cb51-49" aria-hidden="true" tabindex="-1"></a>model_second <span class="op">=</span> ols(<span class="st">'logpgp95 ~ avexpr_hat'</span>, data<span class="op">=</span>data_inst).fit(cov_type<span class="op">=</span><span class="st">'HC1'</span>)</span>
<span id="cb51-50"><a href="#cb51-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-51"><a href="#cb51-51" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Second stage:"</span>)</span>
<span id="cb51-52"><a href="#cb51-52" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model_second.summary())</span>
<span id="cb51-53"><a href="#cb51-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-54"><a href="#cb51-54" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb51-55"><a href="#cb51-55" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"COMPARISON: OLS vs IV"</span>)</span>
<span id="cb51-56"><a href="#cb51-56" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb51-57"><a href="#cb51-57" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"OLS coefficient: </span><span class="sc">{</span>model_ols<span class="sc">.</span>params[<span class="st">'avexpr'</span>]<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb51-58"><a href="#cb51-58" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"IV/2SLS coefficient: </span><span class="sc">{</span>model_second<span class="sc">.</span>params[<span class="st">'avexpr_hat'</span>]<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb51-59"><a href="#cb51-59" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Difference: </span><span class="sc">{</span>model_second<span class="sc">.</span>params[<span class="st">'avexpr_hat'</span>] <span class="op">-</span> model_ols<span class="sc">.</span>params[<span class="st">'avexpr'</span>]<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb51-60"><a href="#cb51-60" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">IV estimate is larger ‚Üí OLS has attenuation bias"</span>)</span>
<span id="cb51-61"><a href="#cb51-61" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"(measurement error and omitted variables bias OLS toward zero)"</span>)</span>
<span id="cb51-62"><a href="#cb51-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-63"><a href="#cb51-63" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb51-64"><a href="#cb51-64" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"CAUSAL INTERPRETATION"</span>)</span>
<span id="cb51-65"><a href="#cb51-65" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb51-66"><a href="#cb51-66" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"1-unit improvement in institutions ‚Üí </span><span class="sc">{</span>model_second<span class="sc">.</span>params[<span class="st">'avexpr_hat'</span>]<span class="sc">:.2f}</span><span class="ss"> increase in log GDP"</span>)</span>
<span id="cb51-67"><a href="#cb51-67" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Exponentiating: </span><span class="sc">{</span>np<span class="sc">.</span>exp(model_second.params[<span class="st">'avexpr_hat'</span>])<span class="sc">:.2f}</span><span class="ss">x increase in GDP level"</span>)</span>
<span id="cb51-68"><a href="#cb51-68" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">‚úì This is a causal estimate (under IV assumptions)"</span>)</span>
<span id="cb51-69"><a href="#cb51-69" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"‚úì Instrument (settler mortality) is:"</span>)</span>
<span id="cb51-70"><a href="#cb51-70" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - Relevant: Strong first stage (F = </span><span class="sc">{</span>model_first<span class="sc">.</span>fvalue<span class="sc">:.1f}</span><span class="ss">)"</span>)</span>
<span id="cb51-71"><a href="#cb51-71" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - Exogenous: Mortality in 1700s doesn't directly affect modern GDP"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Loaded 64 countries

Instrumental Variables Setup:
  - Outcome: logpgp95 (log GDP per capita 1995)
  - Endogenous regressor: avexpr (institutions quality)
  - Instrument: logem4 (log settler mortality)

Key idea: Settler mortality affected colonial institutions,
which persist to affect GDP today, but mortality doesn't
directly affect modern GDP

======================================================================
SUMMARY STATISTICS
======================================================================
        logpgp95     avexpr     logem4
count  64.000000  64.000000  64.000000
mean    8.062237   6.515625   4.657031
std     1.043359   1.468647   1.257984
min     6.109248   3.500000   2.145931
25%     7.299728   5.613636   4.232656
50%     7.949796   6.477273   4.358630
75%     8.848779   7.352273   5.519177
max    10.215740  10.000000   7.986165

======================================================================
OLS REGRESSION (BIASED)
======================================================================
                            OLS Regression Results                            
==============================================================================
Dep. Variable:               logpgp95   R-squared:                       0.540
Model:                            OLS   Adj. R-squared:                  0.533
Method:                 Least Squares   F-statistic:                     109.4
Date:                Tue, 17 Feb 2026   Prob (F-statistic):           2.57e-15
Time:                        22:13:00   Log-Likelihood:                -68.168
No. Observations:                  64   AIC:                             140.3
Df Residuals:                      62   BIC:                             144.7
Df Model:                           1                                         
Covariance Type:                  HC1                                         
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept      4.6604      0.320     14.558      0.000       4.033       5.288
avexpr         0.5221      0.050     10.458      0.000       0.424       0.620
==============================================================================
Omnibus:                        7.098   Durbin-Watson:                   2.064
Prob(Omnibus):                  0.029   Jarque-Bera (JB):                6.657
Skew:                          -0.781   Prob(JB):                       0.0358
Kurtosis:                       3.234   Cond. No.                         31.2
==============================================================================

Notes:
[1] Standard Errors are heteroscedasticity robust (HC1)

OLS coefficient: 0.522
‚ö†Ô∏è This is biased due to endogeneity (omitted variables, reverse causation)

======================================================================
FIRST STAGE: INSTITUTIONS ~ SETTLER MORTALITY
======================================================================
                            OLS Regression Results                            
==============================================================================
Dep. Variable:                 avexpr   R-squared:                       0.270
Model:                            OLS   Adj. R-squared:                  0.258
Method:                 Least Squares   F-statistic:                     16.32
Date:                Tue, 17 Feb 2026   Prob (F-statistic):           0.000150
Time:                        22:13:00   Log-Likelihood:                -104.83
No. Observations:                  64   AIC:                             213.7
Df Residuals:                      62   BIC:                             218.0
Df Model:                           1                                         
Covariance Type:                  HC1                                         
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept      9.3414      0.704     13.264      0.000       7.961      10.722
logem4        -0.6068      0.150     -4.040      0.000      -0.901      -0.312
==============================================================================
Omnibus:                        0.035   Durbin-Watson:                   2.003
Prob(Omnibus):                  0.983   Jarque-Bera (JB):                0.172
Skew:                           0.045   Prob(JB):                        0.918
Kurtosis:                       2.763   Cond. No.                         19.4
==============================================================================

Notes:
[1] Standard Errors are heteroscedasticity robust (HC1)

First stage F-statistic: 16.32
Rule of thumb: F &gt; 10 for strong instrument
Instrument strength: Strong ‚úì

======================================================================
TWO-STAGE LEAST SQUARES (2SLS)
======================================================================

Second stage:
                            OLS Regression Results                            
==============================================================================
Dep. Variable:               logpgp95   R-squared:                       0.477
Model:                            OLS   Adj. R-squared:                  0.469
Method:                 Least Squares   F-statistic:                     61.66
Date:                Tue, 17 Feb 2026   Prob (F-statistic):           7.14e-11
Time:                        22:13:00   Log-Likelihood:                -72.268
No. Observations:                  64   AIC:                             148.5
Df Residuals:                      62   BIC:                             152.9
Df Model:                           1                                         
Covariance Type:                  HC1                                         
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept      1.9097      0.757      2.523      0.012       0.426       3.393
avexpr_hat     0.9443      0.120      7.852      0.000       0.709       1.180
==============================================================================
Omnibus:                       10.547   Durbin-Watson:                   2.137
Prob(Omnibus):                  0.005   Jarque-Bera (JB):               11.010
Skew:                          -0.790   Prob(JB):                      0.00407
Kurtosis:                       4.277   Cond. No.                         58.1
==============================================================================

Notes:
[1] Standard Errors are heteroscedasticity robust (HC1)

======================================================================
COMPARISON: OLS vs IV
======================================================================
OLS coefficient: 0.522
IV/2SLS coefficient: 0.944

Difference: 0.422

IV estimate is larger ‚Üí OLS has attenuation bias
(measurement error and omitted variables bias OLS toward zero)

======================================================================
CAUSAL INTERPRETATION
======================================================================
1-unit improvement in institutions ‚Üí 0.94 increase in log GDP
Exponentiating: 2.57x increase in GDP level

‚úì This is a causal estimate (under IV assumptions)
‚úì Instrument (settler mortality) is:
  - Relevant: Strong first stage (F = 16.3)
  - Exogenous: Mortality in 1700s doesn't directly affect modern GDP</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p><strong>Key Concept 13.10: Instrumental Variables and Two-Stage Least Squares</strong></p>
<p>When a regressor is <strong>endogenous</strong> (correlated with the error term), OLS is biased. <strong>Instrumental variables (IV)</strong> use an instrument that is correlated with the endogenous regressor but not directly with the outcome. Two-stage least squares (2SLS) first predicts the endogenous variable, then uses these predictions in the second-stage regression.</p>
</blockquote>
</section>
<section id="interpreting-the-iv-results" class="level3">
<h3 class="anchored" data-anchor-id="interpreting-the-iv-results"><strong>Interpreting the IV Results</strong></h3>
<p><strong>Key Findings:</strong></p>
<ol type="1">
<li><strong>OLS vs IV Comparison</strong>:</li>
</ol>
<ul>
<li>OLS coefficient: ‚âà 0.52 (biased downward)</li>
<li>IV coefficient: ‚âà 0.94 (causal estimate)</li>
<li>IV estimate is <strong>80% larger</strong> than OLS!</li>
</ul>
<ol start="2" type="1">
<li><strong>Why the Difference?</strong></li>
</ol>
<p><strong>Attenuation bias</strong>: OLS is biased toward zero due to:</p>
<ul>
<li>Measurement error in institutions quality</li>
<li>Omitted variables (culture, geography)</li>
<li>Reverse causation (rich countries build better institutions)</li>
</ul>
<ol start="3" type="1">
<li><strong>Economic Interpretation</strong>:</li>
</ol>
<ul>
<li>1-unit improvement in institutions ‚Üí 0.94 increase in log GDP</li>
<li>Exponentiating: <span class="math inline">\(e^{0.94} \approx 2.56\)</span> ‚Üí <strong>156% increase in GDP level</strong></li>
<li>This is a <strong>massive effect</strong>!</li>
</ul>
<ol start="4" type="1">
<li><strong>Instrument Validity</strong>:</li>
</ol>
<p><strong>Relevance</strong>: First stage F = 16.3 &gt; 10 (strong instrument)</p>
<p><strong>Exogeneity</strong>: Settler mortality in 1700s doesn‚Äôt directly affect modern GDP</p>
<p>The instrument works through this channel: <code>Settler mortality ‚Üí Colonial institutions ‚Üí Modern institutions ‚Üí GDP</code></p>
<p>High mortality areas got ‚Äúextractive‚Äù institutions (exploitation). Low mortality areas got ‚Äúsettler‚Äù institutions (property rights, democracy).</p>
<p><strong>Policy Implications:</strong></p>
<p>Institutions are not just correlated with prosperity‚Äîthey <strong>cause</strong> it. Countries can escape poverty by:</p>
<ul>
<li>Strengthening property rights</li>
<li>Reducing corruption</li>
<li>Improving rule of law</li>
<li>Building democratic accountability</li>
</ul>
<p><strong>Caveat</strong>: These results apply to former colonies. Institutional change is slow and difficult.</p>
<p><em>Having applied multiple causal inference strategies, we now turn to the practical foundation of any analysis ‚Äî data preparation and cleaning.</em></p>
</section>
</section>
<section id="from-raw-data-to-final-data" class="level2">
<h2 class="anchored" data-anchor-id="from-raw-data-to-final-data">13.9 From Raw Data to Final Data</h2>
<p>Best practices for data preparation and cleaning.</p>
<section id="why-data-wrangling-matters" class="level3">
<h3 class="anchored" data-anchor-id="why-data-wrangling-matters"><strong>Why Data Wrangling Matters</strong></h3>
<p>Real-world econometric analysis spends <strong>60-80% of time</strong> on data preparation:</p>
<ul>
<li>Reading data from various sources</li>
<li>Merging multiple datasets</li>
<li>Cleaning errors and outliers</li>
<li>Transforming variables</li>
<li>Creating new variables</li>
</ul>
<p><strong>Common Data Challenges:</strong></p>
<ol type="1">
<li><strong>Missing values</strong>: How to handle? Drop, impute, or model explicitly?</li>
<li><strong>Outliers</strong>: Real extreme values or data errors?</li>
<li><strong>Inconsistent units</strong>: Converting currencies, adjusting for inflation</li>
<li><strong>Different time frequencies</strong>: Monthly data merged with quarterly</li>
<li><strong>Measurement error</strong>: Misreported values, typos</li>
</ol>
<p><strong>Best Practices:</strong></p>
<ul>
<li><strong>Document everything</strong>: Keep track of all cleaning steps</li>
<li><strong>Preserve raw data</strong>: Never overwrite original files</li>
<li><strong>Reproducibility</strong>: Write scripts (not manual Excel edits!)</li>
<li><strong>Validation</strong>: Check summary statistics before and after cleaning</li>
<li><strong>Transparency</strong>: Report how many observations dropped and why</li>
</ul>
<div id="cell-72" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:13:00.813552Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:13:00.813305Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:13:00.826060Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:13:00.825484Z&quot;}}" data-execution_count="28">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Demonstrate reading different file formats</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"DATA READING EXAMPLES"</span>)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Stata files</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">1. Reading Stata files (.dta):"</span>)</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   data = pd.read_stata('file.dta')"</span>)</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="co"># CSV files</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">2. Reading CSV files:"</span>)</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   data = pd.read_csv('file.csv')"</span>)</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Excel files</span></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">3. Reading Excel files:"</span>)</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   data = pd.read_excel('file.xlsx')"</span>)</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: merge operations</span></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"DATA MERGING EXAMPLE"</span>)</span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> pd.DataFrame({<span class="st">'id'</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], <span class="st">'value_a'</span>: [<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>]})</span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> pd.DataFrame({<span class="st">'id'</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>], <span class="st">'value_b'</span>: [<span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">400</span>]})</span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">DataFrame 1:"</span>)</span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df1)</span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">DataFrame 2:"</span>)</span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df2)</span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a>merged <span class="op">=</span> pd.merge(df1, df2, on<span class="op">=</span><span class="st">'id'</span>, how<span class="op">=</span><span class="st">'inner'</span>)</span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Merged (inner join):"</span>)</span>
<span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(merged)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
DATA READING EXAMPLES
======================================================================

1. Reading Stata files (.dta):
   data = pd.read_stata('file.dta')

2. Reading CSV files:
   data = pd.read_csv('file.csv')

3. Reading Excel files:
   data = pd.read_excel('file.xlsx')

======================================================================
DATA MERGING EXAMPLE
======================================================================

DataFrame 1:
   id  value_a
0   1       10
1   2       20
2   3       30

DataFrame 2:
   id  value_b
0   1      100
1   2      200
2   4      400

Merged (inner join):
   id  value_a  value_b
0   1       10      100
1   2       20      200</code></pre>
</div>
</div>
<div id="cell-73" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:13:00.828745Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:13:00.828508Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:13:00.838976Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:13:00.838183Z&quot;}}" data-execution_count="29">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data cleaning examples</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"DATA CLEANING EXAMPLES"</span>)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Example dataset</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>df_dirty <span class="op">=</span> pd.DataFrame({</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'age'</span>: [<span class="dv">25</span>, <span class="dv">30</span>, <span class="op">-</span><span class="dv">5</span>, <span class="dv">200</span>, <span class="dv">35</span>],</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'income'</span>: [<span class="dv">50000</span>, <span class="dv">60000</span>, <span class="va">None</span>, <span class="dv">75000</span>, <span class="dv">80000</span>],</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'gender'</span>: [<span class="st">'M'</span>, <span class="st">'F'</span>, <span class="st">'m'</span>, <span class="st">'Female'</span>, <span class="st">'M'</span>]</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Original data (with errors):"</span>)</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_dirty)</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean age (remove impossible values)</span></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>df_clean <span class="op">=</span> df_dirty.copy()</span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>df_clean.loc[df_clean[<span class="st">'age'</span>] <span class="op">&lt;</span> <span class="dv">0</span>, <span class="st">'age'</span>] <span class="op">=</span> np.nan</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>df_clean.loc[df_clean[<span class="st">'age'</span>] <span class="op">&gt;</span> <span class="dv">120</span>, <span class="st">'age'</span>] <span class="op">=</span> np.nan</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Fill missing income with median</span></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>df_clean[<span class="st">'income'</span>].fillna(df_clean[<span class="st">'income'</span>].median(), inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardize gender coding</span></span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a>df_clean[<span class="st">'gender'</span>] <span class="op">=</span> df_clean[<span class="st">'gender'</span>].<span class="bu">str</span>.upper().<span class="bu">str</span>[<span class="dv">0</span>]</span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Cleaned data:"</span>)</span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_clean)</span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">‚úì Key cleaning steps:"</span>)</span>
<span id="cb55-31"><a href="#cb55-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  1. Detect and handle impossible values (age &lt; 0, age &gt; 120)"</span>)</span>
<span id="cb55-32"><a href="#cb55-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  2. Impute missing values (median for income)"</span>)</span>
<span id="cb55-33"><a href="#cb55-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  3. Standardize categorical variables (gender)"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
DATA CLEANING EXAMPLES
======================================================================

Original data (with errors):
   age   income  gender
0   25  50000.0       M
1   30  60000.0       F
2   -5      NaN       m
3  200  75000.0  Female
4   35  80000.0       M

Cleaned data:
    age   income gender
0  25.0  50000.0      M
1  30.0  60000.0      F
2   NaN  67500.0      M
3   NaN  75000.0      F
4  35.0  80000.0      M

‚úì Key cleaning steps:
  1. Detect and handle impossible values (age &lt; 0, age &gt; 120)
  2. Impute missing values (median for income)
  3. Standardize categorical variables (gender)</code></pre>
</div>
</div>
</section>
</section>
<section id="key-takeaways" class="level2">
<h2 class="anchored" data-anchor-id="key-takeaways">Key Takeaways</h2>
<section id="school-performance-and-socioeconomic-factors-case-study-13.1" class="level3">
<h3 class="anchored" data-anchor-id="school-performance-and-socioeconomic-factors-case-study-13.1">School Performance and Socioeconomic Factors (Case Study 13.1)</h3>
<ul>
<li>School performance (API) is strongly associated with socioeconomic factors, particularly <strong>parent education</strong></li>
<li>Bivariate analysis shows ~80 API points per year of parent education</li>
<li>Multiple regression maintains a strong effect (~74 points) after controlling for meals, English learners, year-round schools, and teacher quality</li>
<li>High correlations among socioeconomic variables make it difficult to isolate individual effects</li>
<li>California‚Äôs ‚Äúsimilar schools‚Äù index controls for socioeconomic characteristics</li>
</ul>
</section>
<section id="cobb-douglas-production-function-and-returns-to-scale-case-study-13.2" class="level3">
<h3 class="anchored" data-anchor-id="cobb-douglas-production-function-and-returns-to-scale-case-study-13.2">Cobb-Douglas Production Function and Returns to Scale (Case Study 13.2)</h3>
<ul>
<li>Natural logarithm transformation converts the nonlinear Cobb-Douglas model into a linear OLS form</li>
<li>Estimated <strong>capital elasticity ‚âà 0.23</strong> and <strong>labor elasticity ‚âà 0.81</strong></li>
<li>Data support <strong>constant returns to scale</strong> (elasticities sum to 1.040, F-test p = 0.636)</li>
<li>HAC-robust standard errors account for time series autocorrelation</li>
<li>Predictions require retransformation bias correction when using log models</li>
</ul>
</section>
<section id="phillips-curve-and-omitted-variables-bias-case-study-13.3" class="level3">
<h3 class="anchored" data-anchor-id="phillips-curve-and-omitted-variables-bias-case-study-13.3">Phillips Curve and Omitted Variables Bias (Case Study 13.3)</h3>
<ul>
<li>Original Phillips curve showed a negative unemployment‚Äìinflation trade-off pre-1970</li>
<li>The relationship <strong>broke down post-1970</strong> ‚Äî a classic example of model misspecification</li>
<li><strong>Augmented Phillips curve</strong> adding expected inflation resolves the breakdown (coefficient ‚âà 1)</li>
<li>The sign reversal demonstrates <strong>omitted variables bias</strong>: excluding a correlated variable biases coefficients</li>
<li>Policy implication: limited long-run unemployment‚Äìinflation trade-off</li>
</ul>
</section>
<section id="advanced-causal-methods-case-studies-13.413.8" class="level3">
<h3 class="anchored" data-anchor-id="advanced-causal-methods-case-studies-13.413.8">Advanced Causal Methods (Case Studies 13.4‚Äì13.8)</h3>
<ul>
<li><strong>Log-log models and cluster-robust SEs (13.4):</strong> Automobile efficiency gains offset by larger vehicles; clustering by manufacturer accounts for within-group correlation</li>
<li><strong>Randomized control trials (13.5):</strong> RAND experiment shows better insurance increases healthcare spending; random assignment eliminates selection bias</li>
<li><strong>Difference-in-differences (13.6):</strong> South Africa clinic access improved child health; key assumption is parallel trends</li>
<li><strong>Regression discontinuity (13.7):</strong> Political incumbency provides ~5‚Äì7% vote share advantage; exploits sharp cutoffs</li>
<li><strong>Instrumental variables (13.8):</strong> Better institutions causally increase GDP; instruments address endogeneity</li>
</ul>
</section>
<section id="data-preparation-and-practical-workflow-case-study-13.9" class="level3">
<h3 class="anchored" data-anchor-id="data-preparation-and-practical-workflow-case-study-13.9">Data Preparation and Practical Workflow (Case Study 13.9)</h3>
<ul>
<li>Real data analysis requires extensive data carpentry ‚Äî often 60‚Äì80% of project time</li>
<li>Reading data from multiple formats: <code>.csv</code>, <code>.xlsx</code>, <code>.dta</code>, <code>.sav</code></li>
<li>Merging, recoding, cleaning, and validation are essential before regression analysis</li>
</ul>
</section>
<section id="general-lessons-from-multiple-regression-case-studies" class="level3">
<h3 class="anchored" data-anchor-id="general-lessons-from-multiple-regression-case-studies">General Lessons from Multiple Regression Case Studies</h3>
<ul>
<li>Multiple regression isolates <strong>partial effects</strong> while controlling for other variables</li>
<li>Choice of standard errors is critical: HC1 (cross-section), cluster-robust (grouped), HAC (time series)</li>
<li>Log transformations enable estimation of <strong>elasticities</strong> and nonlinear relationships</li>
<li>Omitted variables bias can <strong>reverse coefficient signs</strong> and lead to incorrect conclusions</li>
<li>Causal inference requires additional identification strategies beyond OLS</li>
</ul>
<hr>
</section>
<section id="python-tools-used-in-this-chapter" class="level3">
<h3 class="anchored" data-anchor-id="python-tools-used-in-this-chapter">Python Tools Used in This Chapter</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Regression estimation</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>statsmodels.formula.api.ols()        <span class="co"># OLS regression</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>model.fit(cov_type<span class="op">=</span><span class="st">'HC1'</span>)            <span class="co"># Heteroskedastic-robust SEs</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>model.fit(cov_type<span class="op">=</span><span class="st">'HAC'</span>)            <span class="co"># HAC SEs for time series</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>model.fit(cov_type<span class="op">=</span><span class="st">'cluster'</span>)        <span class="co"># Cluster-robust SEs</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Data handling</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>pd.read_stata(), pd.read_csv()       <span class="co"># Read data files</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>pd.merge()                           <span class="co"># Combine datasets</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>np.log()                             <span class="co"># Log transformations</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Hypothesis testing</span></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>model.f_test()                       <span class="co"># F-test for restrictions</span></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>model.t_test()                       <span class="co"># t-test for coefficients</span></span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>matplotlib, seaborn                  <span class="co"># Plotting libraries</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
<p><strong>Next Steps:</strong></p>
<ul>
<li><strong>Chapter 14:</strong> Regression with Indicator Variables</li>
<li><strong>Chapter 15:</strong> Regression with Transformed Variables</li>
</ul>
<hr>
<p><strong>Congratulations!</strong> You‚Äôve completed nine comprehensive case studies demonstrating the breadth and power of multiple regression analysis ‚Äî from school performance to macroeconomic policy to causal inference!</p>
</section>
</section>
<section id="practice-exercises" class="level2">
<h2 class="anchored" data-anchor-id="practice-exercises">Practice Exercises</h2>
<p><strong>Exercise 1: Interpreting Multiple Regression Coefficients</strong></p>
<p>A regression of school test scores on parent education yields a coefficient of 80. When meals (% free lunch), English learners, and teacher quality are added, the parent education coefficient drops to 74.</p>
<p><strong>(a)</strong> Why does the coefficient change when additional variables are included?</p>
<p><strong>(b)</strong> Does the change mean parent education is less important than initially thought? Explain.</p>
<p><strong>(c)</strong> What does the remaining coefficient of 74 represent in terms of partial effects?</p>
<hr>
<p><strong>Exercise 2: Log Transformation and Elasticities</strong></p>
<p>A Cobb-Douglas production function is estimated as: <span class="math inline">\(\ln Q = 1.45 + 0.23 \ln K + 0.81 \ln L\)</span></p>
<p><strong>(a)</strong> Interpret the coefficient 0.23 in terms of percentage changes.</p>
<p><strong>(b)</strong> Interpret the coefficient 0.81 in terms of percentage changes.</p>
<p><strong>(c)</strong> Do these results suggest constant, increasing, or decreasing returns to scale? Conduct a formal test.</p>
<hr>
<p><strong>Exercise 3: Omitted Variables Bias</strong></p>
<p>A researcher estimates the effect of unemployment on inflation and finds a positive coefficient. When expected inflation is added, the unemployment coefficient becomes negative.</p>
<p><strong>(a)</strong> Using the OVB formula, explain why the coefficient changed sign.</p>
<p><strong>(b)</strong> What are the two conditions required for omitted variables bias to occur?</p>
<p><strong>(c)</strong> Is the augmented model more reliable? Why or why not?</p>
<hr>
<p><strong>Exercise 4: Choosing Standard Error Types</strong></p>
<p>For each scenario, identify the appropriate type of standard errors and explain why:</p>
<p><strong>(a)</strong> Cross-sectional data on 500 firms with varying sizes (potential heteroskedasticity)</p>
<p><strong>(b)</strong> Panel data with 50 schools observed over 10 years (observations clustered by school)</p>
<p><strong>(c)</strong> Time series data on quarterly GDP growth for 30 years (potential serial correlation)</p>
<hr>
<p><strong>Exercise 5: Matching Causal Inference Methods</strong></p>
<p>Match each research scenario with the most appropriate causal inference method (RCT, DiD, RD, IV) and state the key identifying assumption:</p>
<p><strong>(a)</strong> A new drug is tested by randomly assigning patients to treatment and placebo groups</p>
<p><strong>(b)</strong> A scholarship is awarded to students scoring above 80 on an entrance exam</p>
<p><strong>(c)</strong> A new minimum wage law is implemented in one state but not its neighbor</p>
<p><strong>(d)</strong> Historical settler mortality is used to explain current institutional quality</p>
<hr>
<p><strong>Exercise 6: Data Preparation Checklist</strong></p>
<p>You receive a dataset containing country-level GDP, population, and education data from three different sources in <code>.csv</code>, <code>.xlsx</code>, and <code>.dta</code> formats.</p>
<p><strong>(a)</strong> List the steps you would take to prepare this data for regression analysis.</p>
<p><strong>(b)</strong> What potential issues should you check for when merging datasets from different sources?</p>
<p><strong>(c)</strong> Why is data validation important before running regressions?</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "Óßã";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../notebooks_colab/ch12_Further_Topics_in_Multiple_Regression.html" class="pagination-link" aria-label="12. Further Topics in Multiple Regression">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">12. Further Topics in Multiple Regression</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../notebooks_colab/ch14_Regression_with_Indicator_Variables.html" class="pagination-link" aria-label="14. Regression with Indicator Variables">
        <span class="nav-page-text"><span class="chapter-title">14. Regression with Indicator Variables</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  /* ‚îÄ‚îÄ Book cover image in right sidebar ‚îÄ‚îÄ */
  var tocNav = document.getElementById('TOC');
  if (tocNav) {
    var coverDiv = document.createElement('div');
    coverDiv.id = 'toc-cover-image';
    var img = document.createElement('img');
    var path = window.location.pathname;
    if (path.indexOf('/notebooks_colab/') !== -1) {
      img.src = '../images/book1cover.jpg';
    } else {
      img.src = 'images/book1cover.jpg';
    }
    img.alt = 'Econometrics Powered by AI';
    coverDiv.appendChild(img);
    tocNav.parentNode.insertBefore(coverDiv, tocNav);
  }

  /* ‚îÄ‚îÄ Mobile TOC: nav bar button + slide-in panel ‚îÄ‚îÄ */
  var toc = document.getElementById('TOC');
  if (!toc) return;
  var tocList = toc.querySelector('ul');
  if (!tocList || tocList.children.length === 0) return;

  /* Create overlay backdrop */
  var overlay = document.createElement('div');
  overlay.className = 'mobile-toc-overlay';

  /* Create slide-in panel */
  var panel = document.createElement('div');
  panel.className = 'mobile-toc-panel';

  /* Panel header with title and close button */
  var header = document.createElement('div');
  header.className = 'mobile-toc-header';
  var title = document.createElement('h3');
  title.textContent = 'On this page';
  var closeBtn = document.createElement('button');
  closeBtn.className = 'mobile-toc-close';
  closeBtn.setAttribute('aria-label', 'Close');
  closeBtn.innerHTML = '\u00d7';
  header.appendChild(title);
  header.appendChild(closeBtn);

  /* Clone TOC content into panel */
  var content = document.createElement('div');
  content.className = 'mobile-toc-content';
  var tocClone = tocList.cloneNode(true);
  tocClone.classList.remove('collapse');
  tocClone.style.display = 'block';
  content.appendChild(tocClone);

  panel.appendChild(header);
  panel.appendChild(content);
  document.body.appendChild(overlay);
  document.body.appendChild(panel);

  /* Toggle functions */
  function openPanel() {
    panel.classList.add('active');
    overlay.classList.add('active');
    document.body.style.overflow = 'hidden';
  }
  function closePanel() {
    panel.classList.remove('active');
    overlay.classList.remove('active');
    document.body.style.overflow = '';
  }

  overlay.addEventListener('click', closePanel);
  closeBtn.addEventListener('click', closePanel);

  /* Close panel when a TOC link is clicked */
  content.querySelectorAll('a').forEach(function(link) {
    link.addEventListener('click', closePanel);
  });

  /* Close on Escape key */
  document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape' && panel.classList.contains('active')) {
      closePanel();
    }
  });

  /* Add TOC button to Quarto's secondary nav bar (visible on mobile) */
  var secondaryNav = document.querySelector('.quarto-secondary-nav .container-fluid');
  if (secondaryNav) {
    var tocBtn = document.createElement('button');
    tocBtn.type = 'button';
    tocBtn.className = 'quarto-btn-toggle btn mobile-toc-nav-btn';
    tocBtn.setAttribute('aria-label', 'Table of contents');
    tocBtn.title = 'On this page';
    tocBtn.innerHTML = '<i class="bi bi-list-nested"></i>';
    tocBtn.addEventListener('click', openPanel);
    var sidebarToggle = secondaryNav.querySelector('.quarto-btn-toggle');
    if (sidebarToggle) {
      sidebarToggle.parentNode.insertBefore(tocBtn, sidebarToggle.nextSibling);
    }
  }

  /* ‚îÄ‚îÄ Desktop sidebar toggle buttons (floating chevrons) ‚îÄ‚îÄ */
  if (window.innerWidth >= 992) {
    /* Restore saved states */
    if (localStorage.getItem('left-collapsed') === 'true') {
      document.body.classList.add('left-collapsed');
    }
    if (localStorage.getItem('toc-collapsed') === 'true') {
      document.body.classList.add('toc-collapsed');
    }

    /* Left sidebar toggle */
    var leftBtn = document.createElement('button');
    leftBtn.className = 'sidebar-toggle sidebar-toggle-left';
    leftBtn.setAttribute('aria-label', 'Toggle book navigation');
    leftBtn.title = 'Toggle book navigation';
    leftBtn.innerHTML = '<i class="bi bi-chevron-left"></i>';
    document.body.appendChild(leftBtn);
    leftBtn.addEventListener('click', function() {
      document.body.classList.toggle('left-collapsed');
      localStorage.setItem('left-collapsed', document.body.classList.contains('left-collapsed'));
    });

    /* Right sidebar toggle */
    var rightBtn = document.createElement('button');
    rightBtn.className = 'sidebar-toggle sidebar-toggle-right';
    rightBtn.setAttribute('aria-label', 'Toggle table of contents');
    rightBtn.title = 'Toggle table of contents';
    rightBtn.innerHTML = '<i class="bi bi-chevron-right"></i>';
    document.body.appendChild(rightBtn);
    rightBtn.addEventListener('click', function() {
      document.body.classList.toggle('toc-collapsed');
      localStorage.setItem('toc-collapsed', document.body.classList.contains('toc-collapsed'));
    });
  }
});
</script>




<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>