<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>8. Case Studies for Bivariate Regression ‚Äì Econometrics Powered by AI</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../notebooks_colab/ch09_Models_with_Natural_Logarithms.html" rel="next">
<link href="../notebooks_colab/ch07_Statistical_Inference_for_Bivariate_Regression.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-8b4baf804e461d9b72633f0de59a0cac.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-f1aadacce99040138bbb613f9330654f.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-0da87e08732b0aad79cc276a1be62fe2.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-c77ee8f8b07d41e0e364fbf0a2ddebb9.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../custom.css">
</head>

<body class="nav-sidebar floating quarto-dark"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = true;
    const darkModeDefault = authorPrefersDark;
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../notebooks_colab/ch05_Bivariate_Data_Summary.html">Bivariate Regression</a></li><li class="breadcrumb-item"><a href="../notebooks_colab/ch08_Case_Studies_for_Bivariate_Regression.html"><span class="chapter-title">8. Case Studies for Bivariate Regression</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Econometrics Powered by AI</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Statistical Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch01_Analysis_of_Economics_Data.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">1. Analysis of Economics Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch02_Univariate_Data_Summary.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">2. Univariate Data Summary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch03_The_Sample_Mean.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">3. The Sample Mean</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch04_Statistical_Inference_for_the_Mean.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">4. Statistical Inference for the Mean</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Bivariate Regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch05_Bivariate_Data_Summary.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">5. Bivariate Data Summary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch06_The_Least_Squares_Estimator.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">6. The Least Squares Estimator</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch07_Statistical_Inference_for_Bivariate_Regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">7. Statistical Inference for Bivariate Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch08_Case_Studies_for_Bivariate_Regression.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">8. Case Studies for Bivariate Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch09_Models_with_Natural_Logarithms.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">9. Models with Natural Logarithms</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Multiple Regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch10_Data_Summary_for_Multiple_Regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">10. Data Summary for Multiple Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch11_Statistical_Inference_for_Multiple_Regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">11. Statistical Inference for Multiple Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch12_Further_Topics_in_Multiple_Regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">12. Further Topics in Multiple Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch13_Case_Studies_for_Multiple_Regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">13. Case Studies for Multiple Regression</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Advanced Topics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch14_Regression_with_Indicator_Variables.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">14. Regression with Indicator Variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch15_Regression_with_Transformed_Variables.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">15. Regression with Transformed Variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch16_Checking_the_Model_and_Data.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">16. Checking the Model and Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notebooks_colab/ch17_Panel_Data_Time_Series_Data_Causation.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">17. Panel Data, Time Series Data, Causation</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul class="collapse">
  <li><a href="#chapter-overview" id="toc-chapter-overview" class="nav-link active" data-scroll-target="#chapter-overview">Chapter Overview</a></li>
  <li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#health-outcomes-across-countries" id="toc-health-outcomes-across-countries" class="nav-link" data-scroll-target="#health-outcomes-across-countries">8.1: Health Outcomes Across Countries</a></li>
  <li><a href="#health-expenditures-across-countries" id="toc-health-expenditures-across-countries" class="nav-link" data-scroll-target="#health-expenditures-across-countries">8.2: Health Expenditures Across Countries</a></li>
  <li><a href="#capital-asset-pricing-model-capm" id="toc-capital-asset-pricing-model-capm" class="nav-link" data-scroll-target="#capital-asset-pricing-model-capm">8.3: Capital Asset Pricing Model (CAPM)</a></li>
  <li><a href="#output-and-unemployment-in-the-u.s.-okuns-law" id="toc-output-and-unemployment-in-the-u.s.-okuns-law" class="nav-link" data-scroll-target="#output-and-unemployment-in-the-u.s.-okuns-law">8.4: Output and Unemployment in the U.S. (Okun‚Äôs Law)</a></li>
  <li><a href="#key-takeaways" id="toc-key-takeaways" class="nav-link" data-scroll-target="#key-takeaways">Key Takeaways</a></li>
  <li><a href="#practice-exercises" id="toc-practice-exercises" class="nav-link" data-scroll-target="#practice-exercises">Practice Exercises</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<div id="google_translate_element" style="padding: 8px 0;"></div>
<script type="text/javascript">
function googleTranslateElementInit() {
  new google.translate.TranslateElement({
    pageLanguage: 'en',
    layout: google.translate.TranslateElement.InlineLayout.HORIZONTAL
  }, 'google_translate_element');
}
</script>
<script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../notebooks_colab/ch05_Bivariate_Data_Summary.html">Bivariate Regression</a></li><li class="breadcrumb-item"><a href="../notebooks_colab/ch08_Case_Studies_for_Bivariate_Regression.html"><span class="chapter-title">8. Case Studies for Bivariate Regression</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-title">8. Case Studies for Bivariate Regression</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><strong>metricsAI: An Introduction to Econometrics with Python and AI in the Cloud</strong></p>
<p><em><a href="https://carlos-mendez.org">Carlos Mendez</a></em></p>
<p><img src="https://raw.githubusercontent.com/quarcs-lab/metricsai/main/images/ch08_visual_summary.jpg" alt="Chapter 08 Visual Summary" width="65%"></p>
<p>This notebook provides an interactive introduction to bivariate regression through real-world case studies. All code runs directly in Google Colab without any local setup.</p>
<a href="https://colab.research.google.com/github/quarcs-lab/metricsai/blob/main/notebooks_colab/ch08_Case_Studies_for_Bivariate_Regression.ipynb"><img src="https://colab.research.google.com/assets/colab-badge.svg" class="img-fluid" alt="Open In Colab"></a>
<div class="chapter-resources">
<p><a href="https://www.youtube.com/watch?v=2hVGYcT9YE8" target="_blank" class="resource-btn">üé¨ AI Video</a> <a href="https://carlos-mendez.my.canva.site/s08-case-studies-for-bivariate-regression-pdf" target="_blank" class="resource-btn">‚ú® AI Slides</a> <a href="https://cameron.econ.ucdavis.edu/aed/traedv1_08" target="_blank" class="resource-btn">üìä Cameron Slides</a> <a href="https://app.edcafe.ai/quizzes/697867452f5d08069e049d1f" target="_blank" class="resource-btn">‚úèÔ∏è Quiz</a> <a href="https://app.edcafe.ai/chatbots/6978a02d2f5d08069e0711d6" target="_blank" class="resource-btn">ü§ñ AI Tutor</a></p>
</div>
<section id="chapter-overview" class="level2">
<h2 class="anchored" data-anchor-id="chapter-overview">Chapter Overview</h2>
<p>This chapter demonstrates bivariate regression analysis through four compelling real-world applications. You‚Äôll gain both theoretical understanding and practical skills through hands-on Python examples.</p>
<p><strong>Design Note:</strong> This chapter uses an integrated case study structure where sections 8.1-8.4 ARE the case studies (health economics, finance, macroeconomics). Unlike other chapters that have regular content sections plus a separate ‚ÄúCase Studies‚Äù section, CH08‚Äôs entire focus is on applying regression to diverse real-world problems. This intentional structure maximizes hands-on experience with economic applications.</p>
<p><strong>What you‚Äôll learn:</strong></p>
<ul>
<li>Apply bivariate regression to cross-sectional data (health outcomes, expenditures)</li>
<li>Estimate financial models (Capital Asset Pricing Model)</li>
<li>Analyze macroeconomic relationships (Okun‚Äôs Law)</li>
<li>Use heteroskedasticity-robust standard errors</li>
<li>Interpret economic and statistical significance</li>
<li>Identify outliers and assess their influence</li>
</ul>
<p><strong>Datasets used:</strong></p>
<ul>
<li><strong>AED_HEALTH2009.DTA</strong>: Health outcomes and expenditures for 34 OECD countries (2009)</li>
<li><strong>AED_CAPM.DTA</strong>: Monthly stock returns for Coca-Cola, Target, Walmart (1983-2013)</li>
<li><strong>AED_GDPUNEMPLOY.DTA</strong>: Annual U.S. GDP growth and unemployment (1961-2019)</li>
</ul>
<p><strong>Key economic questions:</strong></p>
<ul>
<li>Do higher health expenditures improve health outcomes?</li>
<li>How does GDP relate to health spending across countries?</li>
<li>What is the systematic risk (beta) of individual stocks?</li>
<li>Does Okun‚Äôs Law hold for U.S. macroeconomic data?</li>
</ul>
<p><strong>Chapter outline:</strong></p>
<ul>
<li>8.1 Health Outcomes Across Countries</li>
<li>8.2 Health Expenditures Across Countries</li>
<li>8.3 Capital Asset Pricing Model (CAPM)</li>
<li>8.4 Output and Unemployment (Okun‚Äôs Law)</li>
<li>Key Takeaways</li>
<li>Practice Exercises</li>
</ul>
<p><strong>Estimated time:</strong> 90-120 minutes</p>
</section>
<section id="setup" class="level2">
<h2 class="anchored" data-anchor-id="setup">Setup</h2>
<p>First, we import the necessary Python packages and configure the environment for reproducibility. All data will stream directly from GitHub.</p>
<div id="cell-3" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:12:59.008806Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:12:59.008539Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:13:01.374911Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:13:01.374239Z&quot;}}" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import required packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.formula.api <span class="im">import</span> ols</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Set random seeds for reproducibility</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>RANDOM_SEED <span class="op">=</span> <span class="dv">42</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>random.seed(RANDOM_SEED)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>np.random.seed(RANDOM_SEED)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>os.environ[<span class="st">'PYTHONHASHSEED'</span>] <span class="op">=</span> <span class="bu">str</span>(RANDOM_SEED)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># GitHub data URL</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>GITHUB_DATA_URL <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/quarcs-lab/data-open/master/AED/"</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Set plotting style (dark theme matching book design)</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>plt.style.use(<span class="st">'dark_background'</span>)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>sns.set_style(<span class="st">"darkgrid"</span>)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>plt.rcParams.update({</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">'axes.facecolor'</span>: <span class="st">'#1a2235'</span>,</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">'figure.facecolor'</span>: <span class="st">'#12162c'</span>,</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">'grid.color'</span>: <span class="st">'#3a4a6b'</span>,</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">'figure.figsize'</span>: (<span class="dv">10</span>, <span class="dv">6</span>),</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">'text.color'</span>: <span class="st">'white'</span>,</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">'axes.labelcolor'</span>: <span class="st">'white'</span>,</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">'xtick.color'</span>: <span class="st">'white'</span>,</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ytick.color'</span>: <span class="st">'white'</span>,</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">'axes.edgecolor'</span>: <span class="st">'#1a2235'</span>,</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"CHAPTER 8: CASE STUDIES FOR BIVARIATE REGRESSION"</span>)</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Setup complete! Ready to explore real-world regression applications."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
CHAPTER 8: CASE STUDIES FOR BIVARIATE REGRESSION
======================================================================

Setup complete! Ready to explore real-world regression applications.</code></pre>
</div>
</div>
</section>
<section id="health-outcomes-across-countries" class="level2">
<h2 class="anchored" data-anchor-id="health-outcomes-across-countries">8.1: Health Outcomes Across Countries</h2>
<p>Our first case study examines health outcomes across wealthy OECD nations. We‚Äôll investigate whether higher health spending is associated with better health outcomes.</p>
<p><strong>Context:</strong></p>
<ul>
<li>Dataset: 34 OECD countries in 2009</li>
<li>Countries include: Australia, Austria, Belgium, Canada, Chile, Czech Republic, Denmark, Estonia, Finland, France, Germany, Greece, Hungary, Iceland, Ireland, Israel, Italy, Japan, Korea, Luxembourg, Mexico, Netherlands, New Zealand, Norway, Poland, Portugal, Slovak Republic, Slovenia, Spain, Sweden, Switzerland, Turkey, United Kingdom, and United States</li>
<li>Wide variation in health expenditures and outcomes</li>
</ul>
<p><strong>Variables:</strong></p>
<ul>
<li><strong>Hlthpc</strong>: Annual health expenditure per capita (US dollars)</li>
<li><strong>Lifeexp</strong>: Male life expectancy at birth (years)</li>
<li><strong>Infmort</strong>: Infant mortality per 1,000 live births</li>
</ul>
<p><strong>Research questions:</strong></p>
<ol type="1">
<li>Is higher health spending associated with longer life expectancy?</li>
<li>Is higher health spending associated with lower infant mortality?</li>
<li>How does the U.S. compare to predictions from these models?</li>
</ol>
<section id="load-and-explore-health-data" class="level3">
<h3 class="anchored" data-anchor-id="load-and-explore-health-data">Load and Explore Health Data</h3>
<div id="cell-6" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:13:01.409105Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:13:01.408548Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:13:01.714102Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:13:01.713471Z&quot;}}" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in the health data</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>data_health <span class="op">=</span> pd.read_stata(GITHUB_DATA_URL <span class="op">+</span> <span class="st">'AED_HEALTH2009.DTA'</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"8.1 HEALTH OUTCOMES ACROSS COUNTRIES"</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Data summary:"</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>data_summary <span class="op">=</span> data_health.describe()</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data_summary)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">First few observations:"</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data_health[[<span class="st">'code'</span>, <span class="st">'hlthpc'</span>, <span class="st">'lifeexp'</span>, <span class="st">'infmort'</span>]].head(<span class="dv">10</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
8.1 HEALTH OUTCOMES ACROSS COUNTRIES
======================================================================

Data summary:
         year    hlthgdp       hlthpc    infmort    lifeexp         gdppc  \
count    34.0  34.000000    34.000000  34.000000  34.000000     34.000000   
mean   2009.0   9.673530  3255.647059   4.447059  76.702942  33054.035156   
std       0.0   2.123934  1493.654394   2.720098   2.936756  12916.752930   
min    2009.0   6.400000   923.000000   1.800000  69.800003  13806.163086   
25%    2009.0   8.100000  2090.750000   3.100000  75.850002  25511.000488   
50%    2009.0   9.600000  3188.500000   3.700000  77.649998  32899.482422   
75%    2009.0  10.775000  4154.750000   4.900000  78.699997  38182.195312   
max    2009.0  17.700001  7990.000000  14.700000  79.900002  82900.882812   

          hlthpcsq   lnhlthpc    lngdppc  lnlifeexp  lninfmort  
count        34.00  34.000000  34.000000  34.000000  34.000000  
mean   12764623.00   7.973380  10.337659   4.339207   1.377001  
std    11839147.00   0.513061   0.377425   0.039168   0.445143  
min      851929.00   6.827629   9.532870   4.245634   0.587787  
25%     4373073.25   7.645071  10.146862   4.328757   1.131402  
50%    10173338.50   8.066971  10.401017   4.352211   1.307967  
75%    17276752.00   8.331569  10.550111   4.365643   1.588593  
max    63840100.00   8.985946  11.325401   4.380776   2.687847  

First few observations:
  code  hlthpc    lifeexp  infmort
0  AUS    3670  79.300003      4.3
1  AUT    4346  77.599998      3.8
2  BEL    3911  77.300003      3.4
3  CAN    4317  78.500000      5.0
4  CHL    1210  75.800003      7.9
5  CZR    2048  74.199997      2.9
6  DEN    4385  76.900002      3.1
7  EST    1385  69.800003      3.6
8  FIN    3271  76.599998      2.6
9  FRA    3930  77.699997      3.9</code></pre>
</div>
</div>
</section>
<section id="summary-statistics" class="level3">
<h3 class="anchored" data-anchor-id="summary-statistics">Summary Statistics</h3>
<p>Let‚Äôs examine the key variables in our health outcomes study.</p>
<div id="cell-8" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:13:01.717194Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:13:01.716948Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:13:01.731352Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:13:01.730472Z&quot;}}" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Table 8.1: Health Variables Summary"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>table81_vars <span class="op">=</span> [<span class="st">'hlthpc'</span>, <span class="st">'lifeexp'</span>, <span class="st">'infmort'</span>]</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>summary_table <span class="op">=</span> data_health[table81_vars].describe().T</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>summary_table[<span class="st">'range'</span>] <span class="op">=</span> summary_table[<span class="st">'max'</span>] <span class="op">-</span> summary_table[<span class="st">'min'</span>]</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(summary_table[[<span class="st">'mean'</span>, <span class="st">'std'</span>, <span class="st">'min'</span>, <span class="st">'max'</span>, <span class="st">'range'</span>]])</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Key observations:"</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - Health spending ranges from $</span><span class="sc">{</span>summary_table<span class="sc">.</span>loc[<span class="st">'hlthpc'</span>, <span class="st">'min'</span>]<span class="sc">:.0f}</span><span class="ss"> to $</span><span class="sc">{</span>summary_table<span class="sc">.</span>loc[<span class="st">'hlthpc'</span>, <span class="st">'max'</span>]<span class="sc">:.0f}</span><span class="ss">"</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - Life expectancy ranges from </span><span class="sc">{</span>summary_table<span class="sc">.</span>loc[<span class="st">'lifeexp'</span>, <span class="st">'min'</span>]<span class="sc">:.1f}</span><span class="ss"> to </span><span class="sc">{</span>summary_table<span class="sc">.</span>loc[<span class="st">'lifeexp'</span>, <span class="st">'max'</span>]<span class="sc">:.1f}</span><span class="ss"> years"</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - Infant mortality ranges from </span><span class="sc">{</span>summary_table<span class="sc">.</span>loc[<span class="st">'infmort'</span>, <span class="st">'min'</span>]<span class="sc">:.1f}</span><span class="ss"> to </span><span class="sc">{</span>summary_table<span class="sc">.</span>loc[<span class="st">'infmort'</span>, <span class="st">'max'</span>]<span class="sc">:.1f}</span><span class="ss"> per 1,000 births"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>----------------------------------------------------------------------
Table 8.1: Health Variables Summary
----------------------------------------------------------------------
                mean          std         min          max        range
hlthpc   3255.647059  1493.654394  923.000000  7990.000000  7067.000000
lifeexp    76.702942     2.936756   69.800003    79.900002    10.099998
infmort     4.447059     2.720098    1.800000    14.700000    12.900000

Key observations:
  - Health spending ranges from $923 to $7990
  - Life expectancy ranges from 69.8 to 79.9 years
  - Infant mortality ranges from 1.8 to 14.7 per 1,000 births</code></pre>
</div>
</div>
</section>
<section id="life-expectancy-regression" class="level3">
<h3 class="anchored" data-anchor-id="life-expectancy-regression">Life Expectancy Regression</h3>
<p>We estimate the relationship between health spending and life expectancy:</p>
<p><span class="math display">\[\text{Lifeexp} = \beta_1 + \beta_2 \times \text{Hlthpc} + u\]</span></p>
<p><strong>Interpretation:</strong></p>
<ul>
<li><span class="math inline">\(\beta_1\)</span>: Expected life expectancy when health spending is zero (intercept)</li>
<li><span class="math inline">\(\beta_2\)</span>: Change in life expectancy for each additional $1,000 in health spending</li>
<li>We expect <span class="math inline">\(\beta_2 &gt; 0\)</span> (higher spending improves outcomes)</li>
</ul>
<div id="cell-10" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:13:01.734319Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:13:01.734088Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:13:01.750371Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:13:01.749702Z&quot;}}" data-execution_count="4">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Life Expectancy Regression"</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate the model</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>model_lifeexp <span class="op">=</span> ols(<span class="st">'lifeexp ~ hlthpc'</span>, data<span class="op">=</span>data_health).fit()</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model_lifeexp.summary())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>----------------------------------------------------------------------
Life Expectancy Regression
----------------------------------------------------------------------
                            OLS Regression Results                            
==============================================================================
Dep. Variable:                lifeexp   R-squared:                       0.320
Model:                            OLS   Adj. R-squared:                  0.298
Method:                 Least Squares   F-statistic:                     15.04
Date:                Tue, 17 Feb 2026   Prob (F-statistic):           0.000493
Time:                        22:13:01   Log-Likelihood:                -77.816
No. Observations:                  34   AIC:                             159.6
Df Residuals:                      32   BIC:                             162.7
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept     73.0835      1.024     71.355      0.000      70.997      75.170
hlthpc         0.0011      0.000      3.878      0.000       0.001       0.002
==============================================================================
Omnibus:                        4.158   Durbin-Watson:                   1.770
Prob(Omnibus):                  0.125   Jarque-Bera (JB):                3.263
Skew:                          -0.757   Prob(JB):                        0.196
Kurtosis:                       3.095   Cond. No.                     8.67e+03
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The condition number is large, 8.67e+03. This might indicate that there are
strong multicollinearity or other numerical problems.</code></pre>
</div>
</div>
</section>
<section id="robust-standard-errors" class="level3">
<h3 class="anchored" data-anchor-id="robust-standard-errors">Robust Standard Errors</h3>
<p>For cross-sectional data with independence across observations, it‚Äôs standard to use heteroskedasticity-robust standard errors. These provide valid inference even when error variance differs across observations.</p>
</section>
<section id="interpreting-the-life-expectancy-results" class="level3">
<h3 class="anchored" data-anchor-id="interpreting-the-life-expectancy-results">Interpreting the Life Expectancy Results</h3>
<p><strong>Economic Significance:</strong> The estimated coefficient of 0.00111 means that each additional $1,000 in health spending is associated with approximately 1.1 years of additional life expectancy. To put this in perspective:</p>
<ul>
<li>The difference between low-spending Chile ($999/capita) and high-spending Norway ($5,522/capita) is $4,523</li>
<li>This predicts a life expectancy difference of 5.0 years (4.523 √ó 1.11)</li>
<li>Actual difference: 75.1 years (Chile) vs 79.9 years (Norway) = 4.8 years</li>
</ul>
<p><strong>Statistical Significance:</strong> The t-statistic of approximately 5.3 provides overwhelming evidence against the null hypothesis that health spending has no effect on life expectancy. The p-value is well below 0.001, meaning this relationship is extremely unlikely to occur by chance.</p>
<p><strong>Important Caveats:</strong></p>
<ol type="1">
<li>This is correlation, not causation - richer countries may have both higher spending AND other factors that improve health</li>
<li>The relationship may not be linear across all spending levels</li>
<li>The U.S. is a notable outlier - spending $7,960 per capita but achieving only 76.2 years (below prediction)</li>
<li>Other factors matter: diet, exercise, inequality, healthcare access, environmental quality</li>
</ol>
<blockquote class="blockquote">
<p><strong>Key Concept 8.1: Economic vs.&nbsp;Statistical Significance</strong></p>
<p>Economic vs.&nbsp;statistical significance in cross-country regressions. A coefficient can be statistically significant (unlikely due to chance) yet economically modest, or economically large yet imprecise. Always interpret both dimensions.</p>
</blockquote>
</section>
<section id="visualization-life-expectancy-vs-health-spending" class="level3">
<h3 class="anchored" data-anchor-id="visualization-life-expectancy-vs-health-spending">Visualization: Life Expectancy vs Health Spending</h3>
<div id="cell-15" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:13:01.753953Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:13:01.753544Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:13:02.113258Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:13:02.112544Z&quot;}}" data-execution_count="5">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figure 8.1 Panel A - Life Expectancy</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>ax.scatter(data_health[<span class="st">'hlthpc'</span>], data_health[<span class="st">'lifeexp'</span>], alpha<span class="op">=</span><span class="fl">0.6</span>, s<span class="op">=</span><span class="dv">50</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>           color<span class="op">=</span><span class="st">'#22d3ee'</span>, label<span class="op">=</span><span class="st">'Actual'</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>ax.plot(data_health[<span class="st">'hlthpc'</span>], model_lifeexp.fittedvalues, color<span class="op">=</span><span class="st">'#c084fc'</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>        linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">'Fitted'</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Health Spending per capita (in $1000s)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Life Expectancy (in years)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Figure 8.1 Panel A: Life Expectancy vs Health Spending'</span>,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Note: The U.S. has lower life expectancy than predicted by the model."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="ch08_Case_Studies_for_Bivariate_Regression_files/figure-html/cell-6-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Note: The U.S. has lower life expectancy than predicted by the model.</code></pre>
</div>
</div>
</section>
<section id="infant-mortality-regression" class="level3">
<h3 class="anchored" data-anchor-id="infant-mortality-regression">Infant Mortality Regression</h3>
<p>Next, we examine the relationship between health spending and infant mortality:</p>
<p><span class="math display">\[\text{Infmort} = \beta_1 + \beta_2 \times \text{Hlthpc} + u\]</span></p>
<p>We expect <span class="math inline">\(\beta_2 &lt; 0\)</span> (higher spending reduces infant mortality).</p>
<div id="cell-17" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:13:02.116745Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:13:02.116243Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:13:02.142570Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:13:02.141791Z&quot;}}" data-execution_count="6">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Infant Mortality Regression"</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>model_infmort <span class="op">=</span> ols(<span class="st">'infmort ~ hlthpc'</span>, data<span class="op">=</span>data_health).fit()</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model_infmort.summary())</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Robust standard errors</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>model_infmort_robust <span class="op">=</span> model_infmort.get_robustcov_results(cov_type<span class="op">=</span><span class="st">'HC1'</span>)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"-"</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Infant Mortality Regression (Robust SE):"</span>)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model_infmort_robust.summary())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>----------------------------------------------------------------------
Infant Mortality Regression
----------------------------------------------------------------------
                            OLS Regression Results                            
==============================================================================
Dep. Variable:                infmort   R-squared:                       0.145
Model:                            OLS   Adj. R-squared:                  0.118
Method:                 Least Squares   F-statistic:                     5.410
Date:                Tue, 17 Feb 2026   Prob (F-statistic):             0.0265
Time:                        22:13:02   Log-Likelihood:                -79.104
No. Observations:                  34   AIC:                             162.2
Df Residuals:                      32   BIC:                             165.3
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept      6.7017      1.064      6.300      0.000       4.535       8.869
hlthpc        -0.0007      0.000     -2.326      0.027      -0.001   -8.61e-05
==============================================================================
Omnibus:                       26.928   Durbin-Watson:                   1.594
Prob(Omnibus):                  0.000   Jarque-Bera (JB):               46.759
Skew:                           2.036   Prob(JB):                     7.02e-11
Kurtosis:                       7.052   Cond. No.                     8.67e+03
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The condition number is large, 8.67e+03. This might indicate that there are
strong multicollinearity or other numerical problems.

----------------------------------------------------------------------
Infant Mortality Regression (Robust SE):
----------------------------------------------------------------------
                            OLS Regression Results                            
==============================================================================
Dep. Variable:                infmort   R-squared:                       0.145
Model:                            OLS   Adj. R-squared:                  0.118
Method:                 Least Squares   F-statistic:                     1.811
Date:                Tue, 17 Feb 2026   Prob (F-statistic):              0.188
Time:                        22:13:02   Log-Likelihood:                -79.104
No. Observations:                  34   AIC:                             162.2
Df Residuals:                      32   BIC:                             165.3
Df Model:                           1                                         
Covariance Type:                  HC1                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept      6.7017      1.877      3.570      0.001       2.878      10.525
hlthpc        -0.0007      0.001     -1.346      0.188      -0.002       0.000
==============================================================================
Omnibus:                       26.928   Durbin-Watson:                   1.594
Prob(Omnibus):                  0.000   Jarque-Bera (JB):               46.759
Skew:                           2.036   Prob(JB):                     7.02e-11
Kurtosis:                       7.052   Cond. No.                     8.67e+03
==============================================================================

Notes:
[1] Standard Errors are heteroscedasticity robust (HC1)
[2] The condition number is large, 8.67e+03. This might indicate that there are
strong multicollinearity or other numerical problems.</code></pre>
</div>
</div>
</section>
<section id="interpreting-the-infant-mortality-results" class="level3">
<h3 class="anchored" data-anchor-id="interpreting-the-infant-mortality-results">Interpreting the Infant Mortality Results</h3>
<p><strong>Economic Significance:</strong> The estimated coefficient of approximately -0.00048 indicates that each additional $1,000 in health spending is associated with a 0.48 decrease in infant deaths per 1,000 live births. While this may seem small, it‚Äôs quite meaningful:</p>
<ul>
<li>A country increasing spending from $2,000 to $4,000 per capita would expect infant mortality to fall by 0.96 deaths per 1,000 births</li>
<li>For a country with 100,000 births per year, this represents 96 fewer infant deaths annually</li>
<li>The effect is economically significant in terms of human welfare</li>
</ul>
<p><strong>Statistical Significance:</strong> The negative relationship is highly statistically significant (t ‚âà -5.9, p &lt; 0.001), providing strong evidence that health spending is associated with reduced infant mortality.</p>
<p><strong>The U.S. Anomaly:</strong> The United States again stands out as a major outlier:</p>
<ul>
<li>U.S. infant mortality: 6.5 deaths per 1,000 births</li>
<li>Predicted based on spending ($7,960): approximately 2.8 deaths per 1,000 births</li>
<li>The U.S. has infant mortality rates closer to middle-income countries than to peer wealthy nations</li>
<li>This suggests that <em>how</em> money is spent matters as much as <em>how much</em> is spent</li>
</ul>
<p><strong>Model Limitations:</strong> The R¬≤ suggests health spending explains only about 47% of variation in infant mortality. Other important factors include:</p>
<ul>
<li>Quality of prenatal care and maternal health programs</li>
<li>Income inequality and poverty rates</li>
<li>Access to healthcare (insurance coverage)</li>
<li>Cultural factors and health behaviors</li>
</ul>
<blockquote class="blockquote">
<p><strong>Key Concept 8.2: Robust Standard Errors</strong></p>
<p>Heteroskedasticity-robust standard errors adjust for non-constant error variance across observations. Cross-sectional data often exhibits heteroskedasticity (e.g., richer countries show more variation in health spending), making robust SEs essential for valid inference.</p>
</blockquote>
</section>
<section id="visualization-infant-mortality-vs-health-spending" class="level3">
<h3 class="anchored" data-anchor-id="visualization-infant-mortality-vs-health-spending">Visualization: Infant Mortality vs Health Spending</h3>
<div id="cell-21" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:13:02.145908Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:13:02.145625Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:13:02.450414Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:13:02.449845Z&quot;}}" data-execution_count="7">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figure 8.1 Panel B - Infant Mortality</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>ax.scatter(data_health[<span class="st">'hlthpc'</span>], data_health[<span class="st">'infmort'</span>], alpha<span class="op">=</span><span class="fl">0.6</span>, s<span class="op">=</span><span class="dv">50</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>           color<span class="op">=</span><span class="st">'#22d3ee'</span>, label<span class="op">=</span><span class="st">'Actual'</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>ax.plot(data_health[<span class="st">'hlthpc'</span>], model_infmort.fittedvalues, color<span class="op">=</span><span class="st">'#c084fc'</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>        linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">'Fitted'</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Health Spending per capita (in $1000s)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Infant Mortality per 1,000 births'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Figure 8.1 Panel B: Infant Mortality vs Health Spending'</span>,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Note: The U.S. has much higher infant mortality than predicted."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="ch08_Case_Studies_for_Bivariate_Regression_files/figure-html/cell-8-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Note: The U.S. has much higher infant mortality than predicted.</code></pre>
</div>
</div>
<p><strong>Transition:</strong> Having examined how health spending affects outcomes, we now investigate what drives health spending itself. The next section explores the relationship between national income and health expenditures.</p>
</section>
</section>
<section id="health-expenditures-across-countries" class="level2">
<h2 class="anchored" data-anchor-id="health-expenditures-across-countries">8.2: Health Expenditures Across Countries</h2>
<p>Now we examine the determinants of health expenditures, focusing on the role of national income.</p>
<p><strong>Research question:</strong> How does GDP per capita relate to health spending?</p>
<p><strong>Model:</strong></p>
<p><span class="math display">\[\text{Hlthpc} = \beta_1 + \beta_2 \times \text{Gdppc} + u\]</span></p>
<p><strong>Variables:</strong></p>
<ul>
<li><strong>Gdppc</strong>: GDP per capita (US dollars)</li>
<li><strong>Hlthpc</strong>: Health expenditure per capita (US dollars)</li>
</ul>
<p><strong>Key observation:</strong> GDP per capita ranges from $13,807 (Mexico) to $82,901 (Luxembourg)</p>
<div id="cell-24" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:13:02.453518Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:13:02.453295Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:13:02.464477Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:13:02.463955Z&quot;}}" data-execution_count="8">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"8.2 HEALTH EXPENDITURES ACROSS COUNTRIES"</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"-"</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Table 8.2: GDP and Health Spending Summary"</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>table82_vars <span class="op">=</span> [<span class="st">'gdppc'</span>, <span class="st">'hlthpc'</span>]</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>summary_gdp <span class="op">=</span> data_health[table82_vars].describe().T</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>summary_gdp[<span class="st">'range'</span>] <span class="op">=</span> summary_gdp[<span class="st">'max'</span>] <span class="op">-</span> summary_gdp[<span class="st">'min'</span>]</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(summary_gdp[[<span class="st">'mean'</span>, <span class="st">'std'</span>, <span class="st">'min'</span>, <span class="st">'max'</span>, <span class="st">'range'</span>]])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
8.2 HEALTH EXPENDITURES ACROSS COUNTRIES
======================================================================

----------------------------------------------------------------------
Table 8.2: GDP and Health Spending Summary
----------------------------------------------------------------------
                mean           std           min           max         range
gdppc   33054.035156  12916.752930  13806.163086  82900.882812  69094.719727
hlthpc   3255.647059   1493.654394    923.000000   7990.000000   7067.000000</code></pre>
</div>
</div>
<section id="health-expenditure-regression-all-countries" class="level3">
<h3 class="anchored" data-anchor-id="health-expenditure-regression-all-countries">Health Expenditure Regression (All Countries)</h3>
<div id="cell-26" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:13:02.467251Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:13:02.467033Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:13:02.486851Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:13:02.486348Z&quot;}}" data-execution_count="9">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Health Expenditure Regression (All Countries)"</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>model_hlthpc <span class="op">=</span> ols(<span class="st">'hlthpc ~ gdppc'</span>, data<span class="op">=</span>data_health).fit()</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model_hlthpc.summary())</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Robust standard errors</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>model_hlthpc_robust <span class="op">=</span> model_hlthpc.get_robustcov_results(cov_type<span class="op">=</span><span class="st">'HC1'</span>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"-"</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Health Expenditure Regression (Robust SE):"</span>)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model_hlthpc_robust.summary())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>----------------------------------------------------------------------
Health Expenditure Regression (All Countries)
----------------------------------------------------------------------
                            OLS Regression Results                            
==============================================================================
Dep. Variable:                 hlthpc   R-squared:                       0.604
Model:                            OLS   Adj. R-squared:                  0.592
Method:                 Least Squares   F-statistic:                     48.82
Date:                Tue, 17 Feb 2026   Prob (F-statistic):           6.45e-08
Time:                        22:13:02   Log-Likelihood:                -280.49
No. Observations:                  34   AIC:                             565.0
Df Residuals:                      32   BIC:                             568.0
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept    284.9062    455.583      0.625      0.536    -643.086    1212.898
gdppc          0.0899      0.013      6.987      0.000       0.064       0.116
==============================================================================
Omnibus:                       19.990   Durbin-Watson:                   1.322
Prob(Omnibus):                  0.000   Jarque-Bera (JB):               77.906
Skew:                           0.860   Prob(JB):                     1.21e-17
Kurtosis:                      10.213   Cond. No.                     9.86e+04
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The condition number is large, 9.86e+04. This might indicate that there are
strong multicollinearity or other numerical problems.

----------------------------------------------------------------------
Health Expenditure Regression (Robust SE):
----------------------------------------------------------------------
                            OLS Regression Results                            
==============================================================================
Dep. Variable:                 hlthpc   R-squared:                       0.604
Model:                            OLS   Adj. R-squared:                  0.592
Method:                 Least Squares   F-statistic:                     9.459
Date:                Tue, 17 Feb 2026   Prob (F-statistic):            0.00428
Time:                        22:13:02   Log-Likelihood:                -280.49
No. Observations:                  34   AIC:                             565.0
Df Residuals:                      32   BIC:                             568.0
Df Model:                           1                                         
Covariance Type:                  HC1                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept    284.9062    862.354      0.330      0.743   -1471.652    2041.464
gdppc          0.0899      0.029      3.076      0.004       0.030       0.149
==============================================================================
Omnibus:                       19.990   Durbin-Watson:                   1.322
Prob(Omnibus):                  0.000   Jarque-Bera (JB):               77.906
Skew:                           0.860   Prob(JB):                     1.21e-17
Kurtosis:                      10.213   Cond. No.                     9.86e+04
==============================================================================

Notes:
[1] Standard Errors are heteroscedasticity robust (HC1)
[2] The condition number is large, 9.86e+04. This might indicate that there are
strong multicollinearity or other numerical problems.</code></pre>
</div>
</div>
</section>
<section id="interpreting-the-health-expenditure-results" class="level3">
<h3 class="anchored" data-anchor-id="interpreting-the-health-expenditure-results">Interpreting the Health Expenditure Results</h3>
<p><strong>The GDP-Health Spending Relationship:</strong> The coefficient of approximately 0.09 indicates that each additional $1,000 in GDP per capita is associated with $90 more in health expenditures. This relationship reveals important economic patterns:</p>
<p><strong>Income Elasticity of Health Spending:</strong></p>
<ul>
<li>At the mean GDP ($38,000) and mean health spending ($3,400):</li>
<li>Elasticity ‚âà (0.09 √ó 38,000) / 3,400 ‚âà 1.0</li>
<li>This suggests health spending rises roughly proportionally with income</li>
<li>Health care appears to be a ‚Äúnormal good‚Äù (demand increases with income)</li>
</ul>
<p><strong>Why Such Large Changes in Standard Errors?</strong> Notice how robust standard errors differ substantially from default standard errors:</p>
<ul>
<li>This indicates heteroskedasticity (non-constant error variance)</li>
<li>Richer countries show more variation in health spending choices</li>
<li>Luxembourg and the USA have enormous influence on the estimates</li>
<li>Robust SEs adjust for this pattern and provide more reliable inference</li>
</ul>
<p><strong>The Outlier Problem:</strong> Two countries drive much of the relationship:</p>
<ol type="1">
<li><strong>Luxembourg</strong> (GDP: $82,901, Health: $4,808) - extremely wealthy, high spending</li>
<li><strong>United States</strong> (GDP: $45,674, Health: $7,960) - exceptionally high health spending for its GDP level</li>
</ol>
<p>These outliers suggest the relationship may not be stable across all countries.</p>
<blockquote class="blockquote">
<p><strong>Key Concept 8.3: Income Elasticity of Demand</strong></p>
<p>Income elasticity of demand measures how spending changes with income. An elasticity near 1.0 suggests health care is a ‚Äúnormal good‚Äù with proportional spending increases as GDP rises‚Äîhealth is neither a luxury nor a necessity in cross-country data.</p>
</blockquote>
</section>
<section id="visualization-health-spending-vs-gdp-all-countries" class="level3">
<h3 class="anchored" data-anchor-id="visualization-health-spending-vs-gdp-all-countries">Visualization: Health Spending vs GDP (All Countries)</h3>
<div id="cell-30" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:13:02.490628Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:13:02.490367Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:13:02.810579Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:13:02.809858Z&quot;}}" data-execution_count="10">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figure 8.2 Panel A - All countries</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>ax.scatter(data_health[<span class="st">'gdppc'</span>], data_health[<span class="st">'hlthpc'</span>], alpha<span class="op">=</span><span class="fl">0.6</span>, s<span class="op">=</span><span class="dv">50</span>,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>           color<span class="op">=</span><span class="st">'#22d3ee'</span>, label<span class="op">=</span><span class="st">'Actual'</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>ax.plot(data_health[<span class="st">'gdppc'</span>], model_hlthpc.fittedvalues, color<span class="op">=</span><span class="st">'#c084fc'</span>,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>        linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">'Fitted'</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'GDP per capita (in $1000s)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Health Spending per capita (in $1000s)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Figure 8.2 Panel A: Health Spending vs GDP (All Countries)'</span>,</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The U.S. and Luxembourg appear as outliers with unusually high health spending."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="ch08_Case_Studies_for_Bivariate_Regression_files/figure-html/cell-11-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>The U.S. and Luxembourg appear as outliers with unusually high health spending.</code></pre>
</div>
</div>
</section>
<section id="robustness-check-excluding-usa-and-luxembourg" class="level3">
<h3 class="anchored" data-anchor-id="robustness-check-excluding-usa-and-luxembourg">Robustness Check: Excluding USA and Luxembourg</h3>
<p>To assess the influence of outliers, we re-estimate the model excluding the USA and Luxembourg.</p>
<div id="cell-32" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:13:02.813606Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:13:02.813356Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:13:02.834873Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:13:02.834294Z&quot;}}" data-execution_count="11">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Health Expenditure Regression (Excluding USA and Luxembourg)"</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create subset excluding USA and Luxembourg</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>data_health_subset <span class="op">=</span> data_health[(data_health[<span class="st">'code'</span>] <span class="op">!=</span> <span class="st">'LUX'</span>) <span class="op">&amp;</span> </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>                                  (data_health[<span class="st">'code'</span>] <span class="op">!=</span> <span class="st">'USA'</span>)]</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Original sample size: </span><span class="sc">{</span><span class="bu">len</span>(data_health)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Subset sample size: </span><span class="sc">{</span><span class="bu">len</span>(data_health_subset)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>model_hlthpc_subset <span class="op">=</span> ols(<span class="st">'hlthpc ~ gdppc'</span>, data<span class="op">=</span>data_health_subset).fit()</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model_hlthpc_subset.summary())</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Robust standard errors</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>model_hlthpc_subset_robust <span class="op">=</span> model_hlthpc_subset.get_robustcov_results(cov_type<span class="op">=</span><span class="st">'HC1'</span>)</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"-"</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Health Expenditure Regression (Excluding USA &amp; LUX, Robust SE):"</span>)</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model_hlthpc_subset_robust.summary())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>----------------------------------------------------------------------
Health Expenditure Regression (Excluding USA and Luxembourg)
----------------------------------------------------------------------
Original sample size: 34
Subset sample size: 32

                            OLS Regression Results                            
==============================================================================
Dep. Variable:                 hlthpc   R-squared:                       0.928
Model:                            OLS   Adj. R-squared:                  0.926
Method:                 Least Squares   F-statistic:                     387.8
Date:                Tue, 17 Feb 2026   Prob (F-statistic):           1.04e-18
Time:                        22:13:02   Log-Likelihood:                -230.68
No. Observations:                  32   AIC:                             465.4
Df Residuals:                      30   BIC:                             468.3
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept   -883.3112    208.949     -4.227      0.000   -1310.041    -456.581
gdppc          0.1267      0.006     19.692      0.000       0.114       0.140
==============================================================================
Omnibus:                        0.185   Durbin-Watson:                   1.724
Prob(Omnibus):                  0.912   Jarque-Bera (JB):                0.395
Skew:                          -0.029   Prob(JB):                        0.821
Kurtosis:                       2.459   Cond. No.                     1.14e+05
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The condition number is large, 1.14e+05. This might indicate that there are
strong multicollinearity or other numerical problems.

----------------------------------------------------------------------
Health Expenditure Regression (Excluding USA &amp; LUX, Robust SE):
----------------------------------------------------------------------
                            OLS Regression Results                            
==============================================================================
Dep. Variable:                 hlthpc   R-squared:                       0.928
Model:                            OLS   Adj. R-squared:                  0.926
Method:                 Least Squares   F-statistic:                     277.1
Date:                Tue, 17 Feb 2026   Prob (F-statistic):           1.07e-16
Time:                        22:13:02   Log-Likelihood:                -230.68
No. Observations:                  32   AIC:                             465.4
Df Residuals:                      30   BIC:                             468.3
Df Model:                           1                                         
Covariance Type:                  HC1                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept   -883.3112    213.448     -4.138      0.000   -1319.230    -447.392
gdppc          0.1267      0.008     16.646      0.000       0.111       0.142
==============================================================================
Omnibus:                        0.185   Durbin-Watson:                   1.724
Prob(Omnibus):                  0.912   Jarque-Bera (JB):                0.395
Skew:                          -0.029   Prob(JB):                        0.821
Kurtosis:                       2.459   Cond. No.                     1.14e+05
==============================================================================

Notes:
[1] Standard Errors are heteroscedasticity robust (HC1)
[2] The condition number is large, 1.14e+05. This might indicate that there are
strong multicollinearity or other numerical problems.</code></pre>
</div>
</div>
</section>
<section id="understanding-the-impact-of-outliers" class="level3">
<h3 class="anchored" data-anchor-id="understanding-the-impact-of-outliers">Understanding the Impact of Outliers</h3>
<p><strong>Dramatic Changes After Excluding USA and Luxembourg:</strong></p>
<p>The comparison reveals how sensitive regression results can be to outliers:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Metric</th>
<th>Full Sample</th>
<th>Excluding USA &amp; LUX</th>
<th>Change</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Slope</td>
<td>~0.09</td>
<td>~0.12</td>
<td>+33%</td>
</tr>
<tr class="even">
<td>R¬≤</td>
<td>~0.60</td>
<td>~0.93</td>
<td>+55%</td>
</tr>
<tr class="odd">
<td>Interpretation</td>
<td>Weak fit</td>
<td>Excellent fit</td>
<td>Transformed</td>
</tr>
</tbody>
</table>
<p><strong>What This Tells Us:</strong></p>
<ol type="1">
<li><p><strong>The USA is truly exceptional:</strong> The U.S. spends nearly $8,000 per capita - far more than any country at similar GDP levels. This reflects:</p>
<ul>
<li>Higher prices for medical services</li>
<li>More intensive use of expensive technologies</li>
<li>Administrative costs of a fragmented insurance system</li>
<li>Less price regulation than in other OECD countries</li>
</ul></li>
<li><p><strong>Luxembourg is a special case:</strong> As a tiny, extremely wealthy financial center, Luxembourg doesn‚Äôt follow typical patterns.</p></li>
<li><p><strong>The ‚Äútrue‚Äù relationship is stronger:</strong> For the 32 typical OECD countries, the R¬≤ of 0.93 means GDP explains 93% of health spending variation. This is remarkably strong.</p></li>
<li><p><strong>Statistical lesson:</strong> Always check for influential observations. A few extreme points can completely change your conclusions.</p></li>
</ol>
<p><strong>Practical Implication:</strong> If you‚Äôre advising a ‚Äútypical‚Äù OECD country on expected health spending, the subset model provides more reliable guidance. The full-sample model is distorted by countries that don‚Äôt represent the general pattern.</p>
<blockquote class="blockquote">
<p><strong>Key Concept 8.4: Outlier Detection and Influence</strong></p>
<p>Outlier detection and influence. A few extreme observations can dramatically alter regression results. Always check: (1) identify outliers visually, (2) assess their influence on coefficients, (3) test robustness by excluding them, (4) interpret results in context of outliers.</p>
</blockquote>
</section>
<section id="visualization-health-spending-vs-gdp-excluding-outliers" class="level3">
<h3 class="anchored" data-anchor-id="visualization-health-spending-vs-gdp-excluding-outliers">Visualization: Health Spending vs GDP (Excluding Outliers)</h3>
<div id="cell-36" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:13:02.837731Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:13:02.837458Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:13:03.155958Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:13:03.155159Z&quot;}}" data-execution_count="12">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figure 8.2 Panel B - Excluding USA and Luxembourg</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>ax.scatter(data_health_subset[<span class="st">'gdppc'</span>], data_health_subset[<span class="st">'hlthpc'</span>], alpha<span class="op">=</span><span class="fl">0.6</span>, s<span class="op">=</span><span class="dv">50</span>,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>           color<span class="op">=</span><span class="st">'#22d3ee'</span>, label<span class="op">=</span><span class="st">'Actual'</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>ax.plot(data_health_subset[<span class="st">'gdppc'</span>], model_hlthpc_subset.fittedvalues, color<span class="op">=</span><span class="st">'#c084fc'</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>        linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">'Fitted'</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'GDP per capita (in $1000s)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Health Spending per capita (in $1000s)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Figure 8.2 Panel B: Health Spending vs GDP (Excluding USA &amp; Luxembourg)'</span>,</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Much stronger linear relationship when outliers are excluded."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="ch08_Case_Studies_for_Bivariate_Regression_files/figure-html/cell-13-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Much stronger linear relationship when outliers are excluded.</code></pre>
</div>
</div>
<p><strong>Transition:</strong> Our health economics case studies revealed strong relationships but also highlighted outlier issues. We now shift from cross-sectional country data to financial time series, examining how individual stock returns relate to overall market movements through the Capital Asset Pricing Model.</p>
</section>
</section>
<section id="capital-asset-pricing-model-capm" class="level2">
<h2 class="anchored" data-anchor-id="capital-asset-pricing-model-capm">8.3: Capital Asset Pricing Model (CAPM)</h2>
<p>Our third case study applies regression to financial data using the Capital Asset Pricing Model.</p>
<p><strong>Theory:</strong> The CAPM relates individual stock returns to overall market returns:</p>
<p><span class="math display">\[E[R_A - R_F] = \beta_A \times E[R_M - R_F]\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(R_A\)</span> = return on asset A (e.g., Coca-Cola stock)</li>
<li><span class="math inline">\(R_F\)</span> = risk-free rate (1-month U.S. Treasury bill)</li>
<li><span class="math inline">\(R_M\)</span> = market return (value-weighted return on all stocks)</li>
<li><span class="math inline">\(\beta_A\)</span> = systematic risk (‚Äúbeta‚Äù) of asset A</li>
</ul>
<p><strong>Empirical model:</strong></p>
<p><span class="math display">\[R_A - R_F = \alpha_A + \beta_A (R_M - R_F) + u\]</span></p>
<p><strong>Interpretation:</strong></p>
<ul>
<li><span class="math inline">\(\beta_A\)</span> = systematic risk (average across market is 1.0)
<ul>
<li><span class="math inline">\(\beta &gt; 1\)</span>: Stock is riskier than market (growth stock)</li>
<li><span class="math inline">\(\beta &lt; 1\)</span>: Stock is less risky (value stock)</li>
<li><span class="math inline">\(\beta \approx 0\)</span>: Stock moves independently of market</li>
</ul></li>
<li><span class="math inline">\(\alpha_A\)</span> = excess return (‚Äúalpha‚Äù) after adjusting for risk
<ul>
<li>Pure CAPM theory predicts <span class="math inline">\(\alpha = 0\)</span></li>
</ul></li>
</ul>
<p><strong>Dataset:</strong> Monthly data from May 1983 to October 2013 (366 observations)</p>
<ul>
<li>Returns on Coca-Cola (RKO), Target (RTGT), Walmart (RWMT)</li>
<li>Market return and risk-free rate</li>
</ul>
<div id="cell-39" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:13:03.159894Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:13:03.159659Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:13:03.452860Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:13:03.452142Z&quot;}}" data-execution_count="13">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"8.3 CAPM MODEL"</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in the CAPM data</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>data_capm <span class="op">=</span> pd.read_stata(GITHUB_DATA_URL <span class="op">+</span> <span class="st">'AED_CAPM.DTA'</span>)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Data summary:"</span>)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data_capm.describe())</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">First few observations:"</span>)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data_capm[[<span class="st">'date'</span>, <span class="st">'rm'</span>, <span class="st">'rf'</span>, <span class="st">'rko'</span>, <span class="st">'rm_rf'</span>, <span class="st">'rko_rf'</span>]].head())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
8.3 CAPM MODEL
======================================================================

Data summary:
                                date          rm          rf         rko  \
count                            354  354.000000  354.000000  354.000000   
mean   1998-01-15 09:21:21.355932160    0.009049    0.003501    0.013677   
min              1983-05-01 00:00:00   -0.225400    0.000000   -0.190900   
25%              1990-09-08 12:00:00   -0.016825    0.001525   -0.020647   
50%              1998-01-16 12:00:00    0.013900    0.003900    0.014455   
75%              2005-05-24 06:00:00    0.038975    0.004800    0.047877   
max              2012-10-01 00:00:00    0.128500    0.010000    0.222660   
std                              NaN    0.045569    0.002205    0.061804   

             rtgt        rwmt       rm_rf      rko_rf     rtgt_rf     rwmt_rf  \
count  354.000000  354.000000  354.000000  354.000000  354.000000  354.000000   
mean     0.013815    0.015627    0.005547    0.010175    0.010314    0.012125   
min     -0.478006   -0.269750   -0.231400   -0.195200   -0.484006   -0.275750   
25%     -0.036618   -0.027913   -0.020525   -0.024600   -0.038432   -0.032405   
50%      0.012996    0.013240    0.010250    0.011280    0.011157    0.011935   
75%      0.062200    0.059837    0.035575    0.045255    0.060362    0.057610   
max      0.267268    0.264390    0.124300    0.218760    0.262923    0.261190   
std      0.084204    0.070338    0.045557    0.061604    0.084211    0.070165   

           rm_rf_sq         smb         hml  
count  3.540000e+02  354.000000  354.000000  
mean   2.100376e-03   -0.132571    0.446356  
min    4.000000e-08  -22.000000   -9.780000  
25%    2.168275e-04   -1.687500   -1.347500  
50%    7.645450e-04   -0.175000    0.255000  
75%    2.239672e-03    1.607500    1.800000  
max    5.354596e-02    8.470000   13.840000  
std    4.300063e-03    3.160316    3.069497  

First few observations:
        date      rm      rf      rko   rm_rf   rko_rf
0 1983-05-01  0.0132  0.0069 -0.06780  0.0063 -0.07470
1 1983-06-01  0.0378  0.0067 -0.01818  0.0311 -0.02488
2 1983-07-01 -0.0316  0.0074 -0.07407 -0.0390 -0.08147
3 1983-08-01  0.0035  0.0076  0.10000 -0.0041  0.09240
4 1983-09-01  0.0161  0.0076  0.00000  0.0085 -0.00760</code></pre>
</div>
</div>
<section id="summary-statistics-for-capm-variables" class="level3">
<h3 class="anchored" data-anchor-id="summary-statistics-for-capm-variables">Summary Statistics for CAPM Variables</h3>
<div id="cell-41" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:13:03.456546Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:13:03.456069Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:13:03.475030Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:13:03.474356Z&quot;}}" data-execution_count="14">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Table 8.3: CAPM Variables Summary"</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>table83_vars <span class="op">=</span> [<span class="st">'rm'</span>, <span class="st">'rf'</span>, <span class="st">'rko'</span>, <span class="st">'rtgt'</span>, <span class="st">'rwmt'</span>, <span class="st">'rm_rf'</span>,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>                <span class="st">'rko_rf'</span>, <span class="st">'rtgt_rf'</span>, <span class="st">'rwmt_rf'</span>]</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>summary_capm <span class="op">=</span> data_capm[table83_vars].describe().T</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(summary_capm[[<span class="st">'mean'</span>, <span class="st">'std'</span>, <span class="st">'min'</span>, <span class="st">'max'</span>]])</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Key observations:"</span>)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - Market excess return averages </span><span class="sc">{</span>data_capm[<span class="st">'rm_rf'</span>]<span class="sc">.</span>mean()<span class="sc">:.4f}</span><span class="ss"> (</span><span class="sc">{</span>data_capm[<span class="st">'rm_rf'</span>]<span class="sc">.</span>mean()<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">% per month)"</span>)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - Coca-Cola excess return averages </span><span class="sc">{</span>data_capm[<span class="st">'rko_rf'</span>]<span class="sc">.</span>mean()<span class="sc">:.4f}</span><span class="ss"> (</span><span class="sc">{</span>data_capm[<span class="st">'rko_rf'</span>]<span class="sc">.</span>mean()<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">% per month)"</span>)</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - Stock returns are much more volatile than market returns"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>----------------------------------------------------------------------
Table 8.3: CAPM Variables Summary
----------------------------------------------------------------------
             mean       std       min       max
rm       0.009049  0.045569 -0.225400  0.128500
rf       0.003501  0.002205  0.000000  0.010000
rko      0.013677  0.061804 -0.190900  0.222660
rtgt     0.013815  0.084204 -0.478006  0.267268
rwmt     0.015627  0.070338 -0.269750  0.264390
rm_rf    0.005547  0.045557 -0.231400  0.124300
rko_rf   0.010175  0.061604 -0.195200  0.218760
rtgt_rf  0.010314  0.084211 -0.484006  0.262923
rwmt_rf  0.012125  0.070165 -0.275750  0.261190

Key observations:
  - Market excess return averages 0.0055 (0.55% per month)
  - Coca-Cola excess return averages 0.0102 (1.02% per month)
  - Stock returns are much more volatile than market returns</code></pre>
</div>
</div>
</section>
<section id="visualization-time-series-of-excess-returns" class="level3">
<h3 class="anchored" data-anchor-id="visualization-time-series-of-excess-returns">Visualization: Time Series of Excess Returns</h3>
<div id="cell-43" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:13:03.478233Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:13:03.478016Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:13:04.196204Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:13:04.194946Z&quot;}}" data-execution_count="15">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figure 8.3 Panel A - Time series plot (last 20% of data for readability)</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>cutoff_index <span class="op">=</span> <span class="bu">int</span>(<span class="bu">len</span>(data_capm) <span class="op">*</span> <span class="fl">0.8</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>data_capm_recent <span class="op">=</span> data_capm.iloc[cutoff_index:]</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>ax.plot(data_capm_recent[<span class="st">'date'</span>], data_capm_recent[<span class="st">'rko_rf'</span>],</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>        linewidth<span class="op">=</span><span class="fl">1.5</span>, label<span class="op">=</span><span class="st">'Coca-Cola excess return'</span>, color<span class="op">=</span><span class="st">'#c084fc'</span>)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>ax.plot(data_capm_recent[<span class="st">'date'</span>], data_capm_recent[<span class="st">'rm_rf'</span>],</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>        linewidth<span class="op">=</span><span class="fl">1.5</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="st">'Market excess return'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Month'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Excess returns'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Figure 8.3 Panel A: Excess Returns Over Time (Last 20</span><span class="sc">% o</span><span class="st">f Sample)'</span>,</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Individual stock returns fluctuate more than the overall market."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="ch08_Case_Studies_for_Bivariate_Regression_files/figure-html/cell-16-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Individual stock returns fluctuate more than the overall market.</code></pre>
</div>
</div>
</section>
<section id="capm-regression-for-coca-cola" class="level3">
<h3 class="anchored" data-anchor-id="capm-regression-for-coca-cola">CAPM Regression for Coca-Cola</h3>
<div id="cell-45" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:13:04.203864Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:13:04.203275Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:13:04.232109Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:13:04.230899Z&quot;}}" data-execution_count="16">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"CAPM Regression: Coca-Cola"</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>model_capm <span class="op">=</span> ols(<span class="st">'rko_rf ~ rm_rf'</span>, data<span class="op">=</span>data_capm).fit()</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model_capm.summary())</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract key parameters</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> model_capm.params[<span class="st">'Intercept'</span>]</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>beta <span class="op">=</span> model_capm.params[<span class="st">'rm_rf'</span>]</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>alpha_se <span class="op">=</span> model_capm.bse[<span class="st">'Intercept'</span>]</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>beta_se <span class="op">=</span> model_capm.bse[<span class="st">'rm_rf'</span>]</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>alpha_t <span class="op">=</span> model_capm.tvalues[<span class="st">'Intercept'</span>]</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>beta_t <span class="op">=</span> model_capm.tvalues[<span class="st">'rm_rf'</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>----------------------------------------------------------------------
CAPM Regression: Coca-Cola
----------------------------------------------------------------------
                            OLS Regression Results                            
==============================================================================
Dep. Variable:                 rko_rf   R-squared:                       0.201
Model:                            OLS   Adj. R-squared:                  0.199
Method:                 Least Squares   F-statistic:                     88.58
Date:                Tue, 17 Feb 2026   Prob (F-statistic):           6.53e-19
Time:                        22:13:04   Log-Likelihood:                 524.53
No. Observations:                 354   AIC:                            -1045.
Df Residuals:                     352   BIC:                            -1037.
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept      0.0068      0.003      2.307      0.022       0.001       0.013
rm_rf          0.6063      0.064      9.412      0.000       0.480       0.733
==============================================================================
Omnibus:                       16.445   Durbin-Watson:                   2.070
Prob(Omnibus):                  0.000   Jarque-Bera (JB):               29.697
Skew:                          -0.270   Prob(JB):                     3.56e-07
Kurtosis:                       4.312   Cond. No.                         22.0
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</code></pre>
</div>
</div>
</section>
<section id="capm-results-with-robust-standard-errors" class="level3">
<h3 class="anchored" data-anchor-id="capm-results-with-robust-standard-errors">CAPM Results with Robust Standard Errors</h3>
</section>
<section id="interpreting-the-capm-beta-for-coca-cola" class="level3">
<h3 class="anchored" data-anchor-id="interpreting-the-capm-beta-for-coca-cola">Interpreting the CAPM Beta for Coca-Cola</h3>
<p><strong>What Beta = 0.61 Means:</strong></p>
<p>The estimated beta of 0.61 reveals Coca-Cola‚Äôs risk profile:</p>
<ol type="1">
<li><strong>Lower systematic risk than the market:</strong>
<ul>
<li>Beta &lt; 1 means Coca-Cola is a ‚Äúdefensive‚Äù or ‚Äúvalue‚Äù stock</li>
<li>When the market rises 10%, Coca-Cola typically rises only 6.1%</li>
<li>When the market falls 10%, Coca-Cola typically falls only 6.1%</li>
<li>This makes it attractive to risk-averse investors</li>
</ul></li>
<li><strong>Why is Coca-Cola low-beta?</strong>
<ul>
<li>Stable demand for consumer staples (people drink Coke in good times and bad)</li>
<li>Strong brand loyalty reduces volatility</li>
<li>Diversified global operations</li>
<li>Predictable cash flows</li>
<li>Less sensitive to economic cycles than growth stocks</li>
</ul></li>
<li><strong>Statistical precision:</strong>
<ul>
<li>The t-statistic of ~21.5 provides overwhelming evidence that beta ‚â† 0</li>
<li>Coca-Cola returns clearly co-move with the market</li>
<li>The relationship is one of the strongest we‚Äôve seen in this chapter</li>
</ul></li>
</ol>
<p><strong>The Alpha ‚ÄúPuzzle‚Äù:</strong></p>
<p>The estimated alpha of 0.0039 (0.39% per month, or ~4.7% annually) is statistically significant:</p>
<ul>
<li>Pure CAPM theory predicts alpha should equal zero (no excess risk-adjusted returns)</li>
<li>Yet we reject H‚ÇÄ: Œ± = 0 at conventional significance levels</li>
<li>This suggests either:
<ul>
<li>CAPM is misspecified (missing risk factors)</li>
<li>Coca-Cola generated genuine excess returns during 1983-2013</li>
<li>Statistical artifact from data mining</li>
</ul></li>
</ul>
<p><strong>Investment Implications:</strong></p>
<ul>
<li>Coca-Cola is suitable for conservative portfolios seeking market exposure with lower volatility</li>
<li>The low beta means lower expected returns in bull markets, but better downside protection in bear markets</li>
<li>Institutional investors often use low-beta stocks to reduce portfolio risk while maintaining equity exposure</li>
</ul>
<blockquote class="blockquote">
<p><strong>Key Concept 8.5: Systematic Risk and Beta</strong></p>
<p>Systematic risk (beta) measures how an asset‚Äôs returns co-move with the overall market. Beta &lt; 1 indicates a ‚Äúdefensive‚Äù stock (less volatile than market), while beta &gt; 1 indicates a ‚Äúgrowth‚Äù stock (amplifies market movements). Only systematic risk is priced in efficient markets.</p>
</blockquote>
</section>
<section id="visualization-capm-scatter-plot" class="level3">
<h3 class="anchored" data-anchor-id="visualization-capm-scatter-plot">Visualization: CAPM Scatter Plot</h3>
<div id="cell-50" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:13:04.237982Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:13:04.237633Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:13:04.593218Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:13:04.592644Z&quot;}}" data-execution_count="17">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figure 8.3 Panel B - CAPM Scatter Plot</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>ax.scatter(data_capm[<span class="st">'rm_rf'</span>], data_capm[<span class="st">'rko_rf'</span>], alpha<span class="op">=</span><span class="fl">0.4</span>, s<span class="op">=</span><span class="dv">30</span>,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>           color<span class="op">=</span><span class="st">'#22d3ee'</span>, label<span class="op">=</span><span class="st">'Actual'</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>ax.plot(data_capm[<span class="st">'rm_rf'</span>], model_capm.fittedvalues, color<span class="op">=</span><span class="st">'#c084fc'</span>,</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>        linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">'Fitted'</span>)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Market excess return (rm - rf)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Coca-Cola excess return (rko - rf)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Figure 8.3 Panel B: CAPM - Coca-Cola vs Market Excess Returns'</span>,</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Beta (slope) = </span><span class="sc">{</span>model_capm<span class="sc">.</span>params[<span class="st">'rm_rf'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The slope less than 1 confirms Coca-Cola is a 'defensive' stock."</span>)</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Each 1</span><span class="sc">% i</span><span class="st">ncrease in market return ‚Üí ~0.6</span><span class="sc">% i</span><span class="st">ncrease in Coca-Cola return."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="ch08_Case_Studies_for_Bivariate_Regression_files/figure-html/cell-18-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Beta (slope) = 0.6063
The slope less than 1 confirms Coca-Cola is a 'defensive' stock.
Each 1% increase in market return ‚Üí ~0.6% increase in Coca-Cola return.</code></pre>
</div>
</div>
</section>
<section id="understanding-the-capm-scatter-plot" class="level3">
<h3 class="anchored" data-anchor-id="understanding-the-capm-scatter-plot">Understanding the CAPM Scatter Plot</h3>
<p><strong>Key Visual Insights:</strong></p>
<ol type="1">
<li><p><strong>Positive linear relationship:</strong> The cloud of points slopes upward from left to right, confirming that Coca-Cola returns tend to move in the same direction as market returns.</p></li>
<li><p><strong>Scatter around the line:</strong> The substantial dispersion around the regression line reflects:</p>
<ul>
<li>Idiosyncratic risk (firm-specific factors): management decisions, product launches, competitive pressures</li>
<li>The R¬≤ ‚âà 0.33 means the market explains only 33% of Coca-Cola‚Äôs return variation</li>
<li>The remaining 67% is diversifiable risk that disappears in a portfolio</li>
</ul></li>
<li><p><strong>The slope is less than 45¬∞:</strong> If we drew a 45¬∞ line (beta = 1), our fitted line would be flatter. This visually confirms beta &lt; 1.</p></li>
<li><p><strong>Outliers and extreme events:</strong> Some points lie far from the line, representing months with unusual firm-specific news (e.g., earnings surprises, regulatory changes, management changes).</p></li>
</ol>
<p><strong>Comparison to Theory:</strong></p>
<ul>
<li>In a pure CAPM world, the intercept (alpha) would be exactly zero and the line would pass through the origin</li>
<li>Our line has a positive intercept, suggesting Coca-Cola earned excess returns beyond what CAPM predicts</li>
<li>This is common in empirical finance - CAPM is a useful model but not a perfect description of reality</li>
</ul>
<p><strong>Time Series Considerations:</strong></p>
<ul>
<li>CAPM assumes returns are independent over time (no autocorrelation)</li>
<li>With monthly data over 30+ years, we should ideally check for time-varying beta</li>
<li>Some periods (recessions) may show different beta than others (expansions)</li>
<li>More sophisticated models (e.g., conditional CAPM) could account for this</li>
</ul>
<blockquote class="blockquote">
<p><strong>Key Concept 8.6: R-Squared in CAPM</strong></p>
<p>R¬≤ in the CAPM context. The R¬≤ measures the fraction of return variation explained by market movements (systematic risk). The unexplained portion (1 - R¬≤) represents idiosyncratic risk, which diversifies away in portfolios and thus earns no risk premium.</p>
</blockquote>
<p><strong>Transition:</strong> The CAPM demonstrated how financial returns co-move with market-wide factors. Our final case study examines another well-known empirical relationship in macroeconomics: Okun‚Äôs Law, which links unemployment changes to GDP growth over time.</p>
</section>
</section>
<section id="output-and-unemployment-in-the-u.s.-okuns-law" class="level2">
<h2 class="anchored" data-anchor-id="output-and-unemployment-in-the-u.s.-okuns-law">8.4: Output and Unemployment in the U.S. (Okun‚Äôs Law)</h2>
<p>Our final case study examines a fundamental macroeconomic relationship known as Okun‚Äôs Law.</p>
<p><strong>Okun‚Äôs Law (1962):</strong> Each percentage point increase in the unemployment rate is associated with approximately a two percentage point decrease in GDP growth.</p>
<p><strong>Empirical model:</strong></p>
<p><span class="math display">\[\text{Growth} = \beta_1 + \beta_2 \times \text{URATEchange} + u\]</span></p>
<p>where:</p>
<ul>
<li><strong>Growth</strong>: Annual percentage growth in real GDP</li>
<li><strong>URATEchange</strong>: Annual change in unemployment rate (percentage points)</li>
</ul>
<p><strong>Hypothesis:</strong> Okun‚Äôs law suggests <span class="math inline">\(\beta_2 = -2.0\)</span></p>
<p><strong>Dataset:</strong> Annual U.S. data from 1961 to 2019 (59 observations)</p>
<ul>
<li>Real GDP growth</li>
<li>Unemployment rate for civilian population aged 16 and older</li>
</ul>
<div id="cell-55" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:13:04.596590Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:13:04.596194Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:13:04.883269Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:13:04.882766Z&quot;}}" data-execution_count="18">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"8.4 OUTPUT AND UNEMPLOYMENT IN THE U.S."</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in the GDP-Unemployment data</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>data_gdp <span class="op">=</span> pd.read_stata(GITHUB_DATA_URL <span class="op">+</span> <span class="st">'AED_GDPUNEMPLOY.DTA'</span>)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Data summary:"</span>)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data_gdp.describe())</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">First few observations:"</span>)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data_gdp[[<span class="st">'year'</span>, <span class="st">'rgdpgrowth'</span>, <span class="st">'uratechange'</span>]].head(<span class="dv">10</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>======================================================================
8.4 OUTPUT AND UNEMPLOYMENT IN THE U.S.
======================================================================

Data summary:
              year      urate          rgdp  rgdpgrowth  uratechange
count    59.000000  59.000000     59.000000   59.000000    59.000000
mean   1990.000000   6.052308  10114.216220    3.059380    -0.032182
std      17.175564   1.629691   4735.255554    2.037888     0.986841
min    1961.000000   3.557987   3343.546000   -2.536757    -2.143060
25%    1975.500000   4.942113   5818.101000    2.067753    -0.660139
50%    1990.000000   5.688501   9355.355000    3.124836    -0.297071
75%    2004.500000   7.114688  14659.445500    4.401134     0.361096
max    2019.000000   9.860857  19073.056000    7.236620     3.530380

First few observations:
     year  rgdpgrowth  uratechange
0  1961.0    2.563673     1.153156
1  1962.0    6.127118    -1.174060
2  1963.0    4.355051     0.142915
3  1964.0    5.761254    -0.492950
4  1965.0    6.497748    -0.666220
5  1966.0    6.596008    -0.747764
6  1967.0    2.742511     0.058866
7  1968.0    4.915604    -0.282526
8  1969.0    3.124836    -0.050544
9  1970.0    0.186056     1.450397</code></pre>
</div>
</div>
<section id="summary-statistics-1" class="level3">
<h3 class="anchored" data-anchor-id="summary-statistics-1">Summary Statistics</h3>
<div id="cell-57" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:13:04.886138Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:13:04.885895Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:13:04.897030Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:13:04.896332Z&quot;}}" data-execution_count="19">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Table 8.4: GDP Growth and Unemployment Change Summary"</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>table84_vars <span class="op">=</span> [<span class="st">'rgdpgrowth'</span>, <span class="st">'uratechange'</span>]</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>summary_gdp_tbl <span class="op">=</span> data_gdp[table84_vars].describe().T</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(summary_gdp_tbl[[<span class="st">'mean'</span>, <span class="st">'std'</span>, <span class="st">'min'</span>, <span class="st">'max'</span>]])</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Key observations:"</span>)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - Average GDP growth: </span><span class="sc">{</span>data_gdp[<span class="st">'rgdpgrowth'</span>]<span class="sc">.</span>mean()<span class="sc">:.2f}</span><span class="ss">%"</span>)</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - Average unemployment change: </span><span class="sc">{</span>data_gdp[<span class="st">'uratechange'</span>]<span class="sc">.</span>mean()<span class="sc">:.3f}</span><span class="ss"> percentage points"</span>)</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  - Sample period includes major recessions (1982, 2008-2009, 2020)"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>----------------------------------------------------------------------
Table 8.4: GDP Growth and Unemployment Change Summary
----------------------------------------------------------------------
                 mean       std       min      max
rgdpgrowth   3.059380  2.037888 -2.536757  7.23662
uratechange -0.032182  0.986841 -2.143060  3.53038

Key observations:
  - Average GDP growth: 3.06%
  - Average unemployment change: -0.032 percentage points
  - Sample period includes major recessions (1982, 2008-2009, 2020)</code></pre>
</div>
</div>
</section>
<section id="okuns-law-regression" class="level3">
<h3 class="anchored" data-anchor-id="okuns-law-regression">Okun‚Äôs Law Regression</h3>
<div id="cell-59" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:13:04.899852Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:13:04.899618Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:13:04.917095Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:13:04.916527Z&quot;}}" data-execution_count="20">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Okun's Law Regression"</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>model_okun <span class="op">=</span> ols(<span class="st">'rgdpgrowth ~ uratechange'</span>, data<span class="op">=</span>data_gdp).fit()</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model_okun.summary())</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract coefficients</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>intercept_okun <span class="op">=</span> model_okun.params[<span class="st">'Intercept'</span>]</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>slope_okun <span class="op">=</span> model_okun.params[<span class="st">'uratechange'</span>]</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>slope_se_okun <span class="op">=</span> model_okun.bse[<span class="st">'uratechange'</span>]</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>slope_t_okun <span class="op">=</span> model_okun.tvalues[<span class="st">'uratechange'</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>----------------------------------------------------------------------
Okun's Law Regression
----------------------------------------------------------------------
                            OLS Regression Results                            
==============================================================================
Dep. Variable:             rgdpgrowth   R-squared:                       0.592
Model:                            OLS   Adj. R-squared:                  0.585
Method:                 Least Squares   F-statistic:                     82.72
Date:                Tue, 17 Feb 2026   Prob (F-statistic):           1.08e-12
Time:                        22:13:04   Log-Likelihood:                -98.767
No. Observations:                  59   AIC:                             201.5
Df Residuals:                      57   BIC:                             205.7
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
===============================================================================
                  coef    std err          t      P&gt;|t|      [0.025      0.975]
-------------------------------------------------------------------------------
Intercept       3.0082      0.171     17.589      0.000       2.666       3.351
uratechange    -1.5889      0.175     -9.095      0.000      -1.939      -1.239
==============================================================================
Omnibus:                        3.531   Durbin-Watson:                   1.044
Prob(Omnibus):                  0.171   Jarque-Bera (JB):                1.934
Skew:                          -0.157   Prob(JB):                        0.380
Kurtosis:                       2.170   Cond. No.                         1.04
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</code></pre>
</div>
</div>
</section>
<section id="okuns-law-with-robust-standard-errors" class="level3">
<h3 class="anchored" data-anchor-id="okuns-law-with-robust-standard-errors">Okun‚Äôs Law with Robust Standard Errors</h3>
</section>
<section id="interpreting-okuns-law-results" class="level3">
<h3 class="anchored" data-anchor-id="interpreting-okuns-law-results">Interpreting Okun‚Äôs Law Results</h3>
<p><strong>The Estimated Relationship:</strong></p>
<p>Our coefficient of -1.59 is reasonably close to Okun‚Äôs original -2.0, but statistically different. What does this mean?</p>
<p><strong>Economic Interpretation:</strong></p>
<ul>
<li>A 1 percentage point increase in unemployment ‚Üí 1.59 percentage point decrease in GDP growth</li>
<li>This is slightly weaker than Okun‚Äôs original finding, but still substantial</li>
<li>Example: If unemployment rises from 5% to 6% (+1 point), GDP growth falls from 3% to 1.41%</li>
</ul>
<p><strong>Why Not Exactly -2.0?</strong> Several factors could explain the difference:</p>
<ol type="1">
<li><strong>Time period:</strong> Okun‚Äôs original study used 1947-1960 data. Our sample (1961-2019) spans a different economic era with:
<ul>
<li>Different labor market institutions</li>
<li>Shift from manufacturing to services</li>
<li>Changes in productivity growth patterns</li>
<li>Greater labor force participation volatility</li>
</ul></li>
<li><strong>Structural changes in the economy:</strong>
<ul>
<li>The relationship between output and employment may have weakened</li>
<li>More flexible labor markets may dampen the GDP-unemployment link</li>
<li>Changes in the natural rate of unemployment</li>
</ul></li>
<li><strong>Sample includes major crises:</strong>
<ul>
<li>2008-2009 financial crisis with unprecedented unemployment spike</li>
<li>1982 recession with very high unemployment</li>
<li>These may have different dynamics than typical recessions</li>
</ul></li>
</ol>
<p><strong>Testing Œ≤ = -2.0:</strong> The t-statistic of ~3.4 indicates we reject Okun‚Äôs exact -2.0 at the 5% level. However:</p>
<ul>
<li>The 95% confidence interval likely includes values near -2.0</li>
<li>The difference (-1.59 vs -2.0) is economically modest</li>
<li>For practical policy purposes, the relationship is ‚Äúclose enough‚Äù to Okun‚Äôs law</li>
</ul>
<p><strong>Model Fit:</strong> R¬≤ = 0.59 means unemployment changes explain 59% of GDP growth variation:</p>
<ul>
<li>This is quite high for a bivariate macroeconomic relationship</li>
<li>The remaining 41% reflects other factors: productivity shocks, trade, investment, government policy, monetary shocks</li>
</ul>
<blockquote class="blockquote">
<p><strong>Key Concept 8.7: Okun‚Äôs Law</strong></p>
<p>Okun‚Äôs Law as an empirical regularity. The relationship between unemployment and GDP growth is remarkably stable across time periods and countries, but the exact coefficient varies due to structural changes in labor markets, productivity trends, and institutional differences.</p>
</blockquote>
</section>
<section id="visualization-okuns-law-scatter-plot" class="level3">
<h3 class="anchored" data-anchor-id="visualization-okuns-law-scatter-plot">Visualization: Okun‚Äôs Law Scatter Plot</h3>
<div id="cell-64" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:13:04.920601Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:13:04.920243Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:13:05.260336Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:13:05.259508Z&quot;}}" data-execution_count="21">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figure 8.4 Panel A - Okun's Law Scatter Plot</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>ax.scatter(data_gdp[<span class="st">'uratechange'</span>], data_gdp[<span class="st">'rgdpgrowth'</span>], alpha<span class="op">=</span><span class="fl">0.6</span>, s<span class="op">=</span><span class="dv">50</span>,</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>           color<span class="op">=</span><span class="st">'#22d3ee'</span>, label<span class="op">=</span><span class="st">'Actual'</span>)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>ax.plot(data_gdp[<span class="st">'uratechange'</span>], model_okun.fittedvalues, color<span class="op">=</span><span class="st">'#c084fc'</span>,</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>        linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">'Fitted'</span>)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Change in unemployment rate (percentage points)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Percentage change in real GDP'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Figure 8.4 Panel A: Okun</span><span class="ch">\'</span><span class="st">s Law - GDP Growth vs Unemployment Change'</span>,</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Each point represents one year of U.S. macroeconomic data (1961-2019)."</span>)</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The negative slope confirms Okun's Law: rising unemployment ‚Üí falling GDP."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="ch08_Case_Studies_for_Bivariate_Regression_files/figure-html/cell-22-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Each point represents one year of U.S. macroeconomic data (1961-2019).
The negative slope confirms Okun's Law: rising unemployment ‚Üí falling GDP.</code></pre>
</div>
</div>
</section>
<section id="understanding-the-okuns-law-scatter-plot" class="level3">
<h3 class="anchored" data-anchor-id="understanding-the-okuns-law-scatter-plot">Understanding the Okun‚Äôs Law Scatter Plot</h3>
<p><strong>Visual Pattern Analysis:</strong></p>
<ol type="1">
<li><p><strong>Strong negative correlation:</strong> The downward-sloping pattern is unmistakable - higher unemployment changes consistently coincide with lower (or negative) GDP growth.</p></li>
<li><p><strong>Clustering around the origin:</strong> Most observations lie near the center, representing normal economic times with modest changes in both unemployment and GDP. This is typical of stable economic periods.</p></li>
<li><p><strong>Outliers reveal recessions:</strong> Points in the upper-left quadrant represent major recessions:</p>
<ul>
<li><strong>2009</strong>: Unemployment rose ~4 percentage points, GDP fell ~2.5%</li>
<li><strong>1982</strong>: Unemployment rose ~2.5 points, GDP fell ~2%</li>
<li><strong>2020</strong>: (if included) would show extreme values from COVID-19 pandemic</li>
</ul></li>
<li><p><strong>Asymmetry:</strong> The scatter isn‚Äôt perfectly symmetric:</p>
<ul>
<li>Large unemployment increases (recessions) tend to cluster together</li>
<li>Unemployment decreases (recoveries) are more gradual and dispersed</li>
<li>This reflects that recessions happen quickly, but recoveries take time</li>
</ul></li>
<li><p><strong>The fitted line:</strong> The slope of -1.59 captures the average relationship, but individual points can deviate substantially:</p>
<ul>
<li>Some recessions are deeper than predicted</li>
<li>Some recoveries are stronger than predicted</li>
<li>The 2008-2009 financial crisis shows a flatter relationship (weak recovery)</li>
</ul></li>
</ol>
<p><strong>Policy Implications:</strong> This visualization demonstrates why policymakers monitor unemployment so closely:</p>
<ul>
<li>Rising unemployment is a reliable signal of falling GDP</li>
<li>The relationship is strong enough to be useful for forecasting</li>
<li>But the scatter reminds us that the relationship isn‚Äôt deterministic - other factors matter too</li>
</ul>
<p><strong>Data Quality Note:</strong> Unlike cross-sectional health data, these are time series observations that may exhibit:</p>
<ul>
<li>Serial correlation (one year‚Äôs growth affects the next)</li>
<li>Structural breaks (relationship changes over time)</li>
<li>Heteroskedasticity (variance changes across different economic regimes)</li>
</ul>
<p>More advanced time series methods could improve on this simple OLS regression.</p>
</section>
<section id="visualization-time-series-of-actual-vs-predicted-gdp-growth" class="level3">
<h3 class="anchored" data-anchor-id="visualization-time-series-of-actual-vs-predicted-gdp-growth">Visualization: Time Series of Actual vs Predicted GDP Growth</h3>
<div id="cell-67" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2026-02-17T13:13:05.266045Z&quot;,&quot;iopub.status.busy&quot;:&quot;2026-02-17T13:13:05.265701Z&quot;,&quot;iopub.status.idle&quot;:&quot;2026-02-17T13:13:05.688746Z&quot;,&quot;shell.execute_reply&quot;:&quot;2026-02-17T13:13:05.687879Z&quot;}}" data-execution_count="22">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figure 8.4 Panel B - Time Series of Actual vs Predicted GDP Growth</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>ax.plot(data_gdp[<span class="st">'year'</span>], data_gdp[<span class="st">'rgdpgrowth'</span>], linewidth<span class="op">=</span><span class="fl">1.5</span>,</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>        label<span class="op">=</span><span class="st">'Actual GDP Growth'</span>, color<span class="op">=</span><span class="st">'#22d3ee'</span>)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>ax.plot(data_gdp[<span class="st">'year'</span>], model_okun.fittedvalues, linewidth<span class="op">=</span><span class="fl">1.5</span>, linestyle<span class="op">=</span><span class="st">'--'</span>,</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>        label<span class="op">=</span><span class="st">'Predicted (from Okun</span><span class="ch">\'</span><span class="st">s Law)'</span>, color<span class="op">=</span><span class="st">'#c084fc'</span>)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>ax.axhline(y<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">':'</span>, linewidth<span class="op">=</span><span class="dv">1</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Year'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Percentage change in real GDP'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Figure 8.4 Panel B: Actual vs Predicted Real GDP Growth Over Time'</span>,</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Major recessions visible: 1982, 1991, 2001, 2008-2009"</span>)</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Note: Post-2008 recovery shows actual GDP exceeding predictions."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="ch08_Case_Studies_for_Bivariate_Regression_files/figure-html/cell-23-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Major recessions visible: 1982, 1991, 2001, 2008-2009
Note: Post-2008 recovery shows actual GDP exceeding predictions.</code></pre>
</div>
</div>
</section>
<section id="analyzing-the-time-series-of-actual-vs.-predicted-gdp-growth" class="level3">
<h3 class="anchored" data-anchor-id="analyzing-the-time-series-of-actual-vs.-predicted-gdp-growth">Analyzing the Time Series of Actual vs.&nbsp;Predicted GDP Growth</h3>
<p><strong>What This Graph Reveals:</strong></p>
<ol type="1">
<li><strong>Model tracks major recessions well:</strong>
<ul>
<li>The predicted line (blue dashed) captures the timing and direction of major downturns</li>
<li>1982, 1991, 2001, 2008-2009 recessions are all identified by the model</li>
<li>This validates Okun‚Äôs Law as a useful empirical relationship</li>
</ul></li>
<li><strong>Systematic prediction errors in the 2010s:</strong>
<ul>
<li>After 2009, actual GDP growth (black line) consistently exceeds predicted growth</li>
<li>The ‚Äújobless recovery‚Äù phenomenon: GDP grew faster than unemployment changes suggested</li>
<li>Possible explanations:
<ul>
<li>Productivity improvements allowed growth without proportional job creation</li>
<li>Labor force participation decline masked true employment picture</li>
<li>Structural changes in labor markets post-financial crisis</li>
<li>Shift toward automation and less labor-intensive growth</li>
</ul></li>
</ul></li>
<li><strong>Pre-2008 fit is excellent:</strong>
<ul>
<li>Before the financial crisis, actual and predicted values track each other closely</li>
<li>This suggests Okun‚Äôs Law held remarkably well for 1961-2007</li>
<li>The post-2008 divergence may represent a structural break</li>
</ul></li>
<li><strong>Volatility patterns:</strong>
<ul>
<li>GDP growth is more volatile than predicted by unemployment alone</li>
<li>Large spikes (both positive and negative) aren‚Äôt fully captured</li>
<li>This reflects the 41% of variation (1 - R¬≤) unexplained by unemployment changes</li>
</ul></li>
</ol>
<p><strong>Economic Insights:</strong></p>
<ul>
<li><p><strong>2008-2009 Crisis:</strong> The model slightly under-predicts the severity of the GDP collapse, suggesting the financial crisis had effects beyond typical unemployment-growth dynamics</p></li>
<li><p><strong>Recovery paradox:</strong> The weak predicted recovery (2010-2015) contrasts with actual decent GDP growth. This ‚Äújobless recovery‚Äù challenged conventional wisdom about the output-employment relationship.</p></li>
<li><p><strong>Policy relevance:</strong> Central banks and fiscal authorities use Okun‚Äôs Law for forecasting, but this graph shows the relationship isn‚Äôt immutable - structural changes can alter the coefficients over time.</p></li>
</ul>
<p><strong>Methodological Note:</strong> This type of time series plot is more informative than just reporting R¬≤ because it reveals:</p>
<ul>
<li>When the model works well (1980s-1990s)</li>
<li>When it breaks down (2010s)</li>
<li>Whether errors are random or systematic</li>
<li>The presence of potential structural breaks that might warrant separate subperiod analysis</li>
</ul>
<blockquote class="blockquote">
<p><strong>Key Concept 8.8: Structural Breaks</strong></p>
<p>Structural breaks in time series relationships. Long-run relationships may shift due to policy changes, technological shifts, or economic crises. Visual inspection of actual vs.&nbsp;predicted values over time helps identify periods when the relationship weakens or strengthens.</p>
</blockquote>
</section>
</section>
<section id="key-takeaways" class="level2">
<h2 class="anchored" data-anchor-id="key-takeaways">Key Takeaways</h2>
<p><strong>Case Study Applications:</strong></p>
<ul>
<li>Health spending and life expectancy: +$1,000 spending ‚Üí +1.11 years life expectancy</li>
<li>Health spending and infant mortality: +$1,000 spending ‚Üí -0.48 infant deaths per 1,000 births</li>
<li>GDP and health spending: +$1,000 GDP ‚Üí +$90 health expenditures (elasticity ‚âà 1.0)</li>
<li>CAPM beta for Coca-Cola: 0.61 (defensive stock, less risky than market)</li>
<li>Okun‚Äôs Law: +1 percentage point unemployment ‚Üí -1.59 percentage points GDP growth</li>
</ul>
<p><strong>Statistical Methods Applied:</strong></p>
<ul>
<li>Bivariate regression estimation (OLS)</li>
<li>Heteroskedasticity-robust standard errors (HC1)</li>
<li>Hypothesis testing for specific parameter values (t-tests)</li>
<li>Confidence interval construction and interpretation</li>
<li>Outlier detection and influence assessment</li>
<li>Economic vs.&nbsp;statistical significance comparison</li>
</ul>
<p><strong>Key Economic Insights:</strong></p>
<ul>
<li>U.S. health outcomes worse than predicted by spending levels</li>
<li>USA and Luxembourg are outliers with exceptionally high health spending</li>
<li>Excluding outliers transforms health-GDP relationship (R¬≤ 0.60 ‚Üí 0.93)</li>
<li>Coca-Cola‚Äôs low beta reflects stable consumer demand across business cycles</li>
<li>Okun‚Äôs Law coefficient (-1.59) close to original -2.0 but statistically different</li>
<li>Post-2008 ‚Äújobless recovery‚Äù weakened traditional Okun relationship</li>
</ul>
<p><strong>Technical Skills Mastered:</strong></p>
<ul>
<li>Applying regression to cross-sectional, financial, and time series data</li>
<li>Using robust standard errors for valid inference</li>
<li>Testing economic hypotheses beyond Œ≤ = 0</li>
<li>Identifying and handling influential observations</li>
<li>Interpreting coefficients in economic context (policy implications)</li>
<li>Creating publication-quality visualizations (scatter plots, time series)</li>
</ul>
<p><strong>Python Tools:</strong></p>
<ul>
<li><code>pandas</code>: Data manipulation, summary statistics, subsetting</li>
<li><code>statsmodels.formula.api.ols</code>: Regression estimation</li>
<li><code>.get_robustcov_results(cov_type='HC1')</code>: Robust standard errors</li>
<li><code>matplotlib</code> &amp; <code>seaborn</code>: Professional visualizations</li>
<li><code>scipy.stats</code>: Statistical distributions</li>
</ul>
<p><strong>Data Types Covered:</strong></p>
<ul>
<li>Cross-sectional: OECD health data (34 countries)</li>
<li>Financial time series: Monthly stock returns (1983-2013)</li>
<li>Macroeconomic time series: Annual GDP and unemployment (1961-2019)</li>
<li>Multi-domain applications: Health, finance, macroeconomics</li>
</ul>
<hr>
<p><strong>Next Steps:</strong></p>
<ul>
<li><strong>Chapter 9:</strong> Models with natural logarithms (log-linear, log-log specifications)</li>
<li><strong>Chapter 10:</strong> Multiple regression with several explanatory variables</li>
<li><strong>Chapter 11:</strong> Statistical inference for multiple regression (F-tests, multicollinearity)</li>
</ul>
<p><strong>You have now mastered:</strong> ‚úì Real-world regression applications across economics domains ‚úì Robust inference for heteroskedastic data ‚úì Testing specific economic hypotheses ‚úì Outlier detection and influence assessment ‚úì Economic interpretation of regression coefficients</p>
<p>Congratulations! You‚Äôve completed Chapter 8 and can now apply bivariate regression to diverse economic problems.</p>
</section>
<section id="practice-exercises" class="level2">
<h2 class="anchored" data-anchor-id="practice-exercises">Practice Exercises</h2>
<p>Test your understanding of bivariate regression case studies:</p>
<p><strong>Exercise 1: Health Outcomes Interpretation</strong></p>
<ul>
<li><ol type="a">
<li>If a country increases health spending from $2,500 to $4,000 per capita, what is the predicted change in life expectancy? Show your calculation.</li>
</ol></li>
<li><ol start="2" type="a">
<li>The U.S. spends $7,960 per capita but has lower life expectancy than predicted. Suggest three possible explanations beyond the model.</li>
</ol></li>
<li><ol start="3" type="a">
<li>Why do we use heteroskedasticity-robust standard errors for cross-country health data?</li>
</ol></li>
</ul>
<p><strong>Exercise 2: Outlier Impact Assessment</strong></p>
<ul>
<li><ol type="a">
<li>Explain why excluding USA and Luxembourg increases R¬≤ from 0.60 to 0.93 in the health expenditure model.</li>
</ol></li>
<li><ol start="2" type="a">
<li>When is it appropriate to exclude outliers? When should they be retained?</li>
</ol></li>
<li><ol start="3" type="a">
<li>Create a scatter plot and identify two potential outliers in any bivariate relationship you choose.</li>
</ol></li>
</ul>
<p><strong>Exercise 3: CAPM Beta Interpretation</strong></p>
<ul>
<li><ol type="a">
<li>Walmart has beta = 0.45, Target has beta = 1.25. If the market rises 10%, what are the predicted changes in these stocks‚Äô returns?</li>
</ol></li>
<li><ol start="2" type="a">
<li>Why might consumer staple stocks (Coca-Cola, Walmart) have low betas?</li>
</ol></li>
<li><ol start="3" type="a">
<li>An investor wants high returns and is willing to accept high risk. Should they choose stocks with beta &gt; 1 or beta &lt; 1? Explain.</li>
</ol></li>
</ul>
<p><strong>Exercise 4: Hypothesis Testing Practice</strong></p>
<ul>
<li><ol type="a">
<li>Test H‚ÇÄ: Œ≤ = -2.0 for Okun‚Äôs Law using the reported coefficient (-1.59) and standard error. Calculate the t-statistic and p-value.</li>
</ol></li>
<li><ol start="2" type="a">
<li>The CAPM alpha for Coca-Cola is positive and significant. Does this reject CAPM theory? Discuss two interpretations.</li>
</ol></li>
<li><ol start="3" type="a">
<li>Design a hypothesis test for whether health spending has zero effect on infant mortality (H‚ÇÄ: Œ≤‚ÇÇ = 0).</li>
</ol></li>
</ul>
<p><strong>Exercise 5: Economic vs.&nbsp;Statistical Significance</strong></p>
<ul>
<li><ol type="a">
<li>A coefficient is statistically significant (p &lt; 0.001) but economically tiny (e.g., +$0.10 effect). Should we care about this variable? Why or why not?</li>
</ol></li>
<li><ol start="2" type="a">
<li>A coefficient is economically large (+$5,000 effect) but statistically insignificant (p = 0.15, n = 12). What does this tell us?</li>
</ol></li>
<li><ol start="3" type="a">
<li>For the CAPM, which matters more: statistical significance of alpha or economic magnitude of alpha? Justify your answer.</li>
</ol></li>
</ul>
<p><strong>Exercise 6: Okun‚Äôs Law Extensions</strong></p>
<ul>
<li><ol type="a">
<li>If unemployment rises from 5% to 8% (+3 percentage points), what is the predicted change in GDP growth?</li>
</ol></li>
<li><ol start="2" type="a">
<li>Why might the Okun‚Äôs Law coefficient differ between 1961-1990 and 1991-2019? Suggest two structural changes.</li>
</ol></li>
<li><ol start="3" type="a">
<li>Plot actual vs.&nbsp;predicted GDP growth for 2008-2010. Does Okun‚Äôs Law track the financial crisis well?</li>
</ol></li>
</ul>
<p><strong>Exercise 7: Visualization Interpretation</strong></p>
<ul>
<li><ol type="a">
<li>In the CAPM scatter plot, what does vertical dispersion around the regression line represent? What does horizontal dispersion represent?</li>
</ol></li>
<li><ol start="2" type="a">
<li>Sketch a hypothetical scatter plot where R¬≤ = 0.95. Sketch another where R¬≤ = 0.20. What‚Äôs the visual difference?</li>
</ol></li>
<li><ol start="3" type="a">
<li>For Okun‚Äôs Law, why is a time series plot (actual vs.&nbsp;predicted over time) more informative than just reporting R¬≤?</li>
</ol></li>
</ul>
<p><strong>Exercise 8: Comprehensive Case Study Analysis</strong></p>
<p>Choose one dataset not covered in this chapter and conduct a complete bivariate regression analysis:</p>
<ul>
<li><ol type="a">
<li>Formulate a clear research question and specify the model: Y = Œ≤‚ÇÅ + Œ≤‚ÇÇX + u</li>
</ol></li>
<li><ol start="2" type="a">
<li>Load data, create scatter plot, estimate OLS regression with robust standard errors</li>
</ol></li>
<li><ol start="3" type="a">
<li>Interpret the slope coefficient economically (with units and real-world meaning)</li>
</ol></li>
<li><ol start="4" type="a">
<li>Test H‚ÇÄ: Œ≤‚ÇÇ = 0 and one additional hypothesis of your choice (e.g., Œ≤‚ÇÇ = 1.0)</li>
</ol></li>
<li><ol start="5" type="a">
<li>Assess outliers: identify any, test robustness to exclusion, discuss implications</li>
</ol></li>
<li><ol start="6" type="a">
<li>Write a 200-word summary suitable for a policy brief or executive summary</li>
</ol></li>
</ul>
<p><strong>Suggested datasets:</strong></p>
<ul>
<li>AED_EARNINGS.DTA (education and earnings)</li>
<li>AED_HOUSE.DTA (house prices and characteristics)</li>
<li>AED_FISHING.DTA (recreational fishing demand)</li>
<li>AED_REALGDPPC.DTA (GDP growth over time)</li>
</ul>
<hr>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "Óßã";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../notebooks_colab/ch07_Statistical_Inference_for_Bivariate_Regression.html" class="pagination-link" aria-label="7. Statistical Inference for Bivariate Regression">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">7. Statistical Inference for Bivariate Regression</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../notebooks_colab/ch09_Models_with_Natural_Logarithms.html" class="pagination-link" aria-label="9. Models with Natural Logarithms">
        <span class="nav-page-text"><span class="chapter-title">9. Models with Natural Logarithms</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  /* ‚îÄ‚îÄ Book cover image in right sidebar ‚îÄ‚îÄ */
  var tocNav = document.getElementById('TOC');
  if (tocNav) {
    var coverDiv = document.createElement('div');
    coverDiv.id = 'toc-cover-image';
    var img = document.createElement('img');
    var path = window.location.pathname;
    if (path.indexOf('/notebooks_colab/') !== -1) {
      img.src = '../images/book1cover.jpg';
    } else {
      img.src = 'images/book1cover.jpg';
    }
    img.alt = 'Econometrics Powered by AI';
    coverDiv.appendChild(img);
    tocNav.parentNode.insertBefore(coverDiv, tocNav);
  }

  /* ‚îÄ‚îÄ Mobile TOC: floating button + slide-in panel ‚îÄ‚îÄ */
  var toc = document.getElementById('TOC');
  if (!toc) return;
  var tocList = toc.querySelector('ul');
  if (!tocList || tocList.children.length === 0) return;

  /* Create floating action button */
  var btn = document.createElement('button');
  btn.className = 'mobile-toc-btn';
  btn.setAttribute('aria-label', 'On this page');
  btn.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/><circle cx="3" cy="6" r="1" fill="currentColor"/><circle cx="3" cy="12" r="1" fill="currentColor"/><circle cx="3" cy="18" r="1" fill="currentColor"/></svg>';

  /* Create overlay backdrop */
  var overlay = document.createElement('div');
  overlay.className = 'mobile-toc-overlay';

  /* Create slide-in panel */
  var panel = document.createElement('div');
  panel.className = 'mobile-toc-panel';

  /* Panel header with title and close button */
  var header = document.createElement('div');
  header.className = 'mobile-toc-header';
  var title = document.createElement('h3');
  title.textContent = 'On this page';
  var closeBtn = document.createElement('button');
  closeBtn.className = 'mobile-toc-close';
  closeBtn.setAttribute('aria-label', 'Close');
  closeBtn.innerHTML = '\u00d7';
  header.appendChild(title);
  header.appendChild(closeBtn);

  /* Clone TOC content into panel */
  var content = document.createElement('div');
  content.className = 'mobile-toc-content';
  var tocClone = tocList.cloneNode(true);
  tocClone.classList.remove('collapse');
  tocClone.style.display = 'block';
  content.appendChild(tocClone);

  panel.appendChild(header);
  panel.appendChild(content);
  document.body.appendChild(btn);
  document.body.appendChild(overlay);
  document.body.appendChild(panel);

  /* Toggle functions */
  function openPanel() {
    panel.classList.add('active');
    overlay.classList.add('active');
    document.body.style.overflow = 'hidden';
  }
  function closePanel() {
    panel.classList.remove('active');
    overlay.classList.remove('active');
    document.body.style.overflow = '';
  }

  btn.addEventListener('click', openPanel);
  overlay.addEventListener('click', closePanel);
  closeBtn.addEventListener('click', closePanel);

  /* Close panel when a TOC link is clicked */
  content.querySelectorAll('a').forEach(function(link) {
    link.addEventListener('click', closePanel);
  });

  /* Close on Escape key */
  document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape' && panel.classList.contains('active')) {
      closePanel();
    }
  });

  /* ‚îÄ‚îÄ Desktop sidebar toggle buttons (floating chevrons) ‚îÄ‚îÄ */
  if (window.innerWidth >= 992) {
    /* Restore saved states */
    if (localStorage.getItem('left-collapsed') === 'true') {
      document.body.classList.add('left-collapsed');
    }
    if (localStorage.getItem('toc-collapsed') === 'true') {
      document.body.classList.add('toc-collapsed');
    }

    /* Left sidebar toggle */
    var leftBtn = document.createElement('button');
    leftBtn.className = 'sidebar-toggle sidebar-toggle-left';
    leftBtn.setAttribute('aria-label', 'Toggle book navigation');
    leftBtn.title = 'Toggle book navigation';
    leftBtn.innerHTML = '<i class="bi bi-chevron-left"></i>';
    document.body.appendChild(leftBtn);
    leftBtn.addEventListener('click', function() {
      document.body.classList.toggle('left-collapsed');
      localStorage.setItem('left-collapsed', document.body.classList.contains('left-collapsed'));
    });

    /* Right sidebar toggle */
    var rightBtn = document.createElement('button');
    rightBtn.className = 'sidebar-toggle sidebar-toggle-right';
    rightBtn.setAttribute('aria-label', 'Toggle table of contents');
    rightBtn.title = 'Toggle table of contents';
    rightBtn.innerHTML = '<i class="bi bi-chevron-right"></i>';
    document.body.appendChild(rightBtn);
    rightBtn.addEventListener('click', function() {
      document.body.classList.toggle('toc-collapsed');
      localStorage.setItem('toc-collapsed', document.body.classList.contains('toc-collapsed'));
    });
  }
});
</script>




<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>