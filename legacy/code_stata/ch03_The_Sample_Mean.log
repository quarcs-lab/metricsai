
. * ch03_The_Sample_Mean.do - January 2026 For Stata
. * Updated for online execution portability
. 
. ********** OVERVIEW OF ch03_The_Sample_Mean.do **********
. 
. * STATA Program
. * copyright C 2021 by A. Colin Cameron
. * Used for "Analyis of Economics Data: An Introduction to Econometrics"
. * by A. Colin Cameron (2021)
. 
. * To run you need file
. *   AED_COINTOSSMEANS.DTA
. *   AED_CENSUSAGEMEANS.DTA
. 
. * in your directory
. 
. ********** SETUP **********
. 
. * Set random seed for reproducibility
. set seed 42

. 
. * Clear all macros
. macro drop _all

. 
. * GitHub data URL
. global github_data_url "https://raw.githubusercontent.com/quarcs-lab/data-ope
> n/master/AED/"

. 
. * Create output directories (optional - for saving figures and tables locally
> )
. cap mkdir "images"

. cap mkdir "tables"

. 
. set more off

. clear all

. 
. ************
. 
. * This STATA does analysis for Chapter 3
. *   3.1 RANDOM VARIABLES
. *   3.2 SAMPLE GENERATED BY AN EXPERIMENT: COIN TOSSES
. *   3.3 PROPERTIES OF THE SAMPLE MEAM
. *   3.4 SAMPLING FROM A FINITE POPULATION: 1880 U.S. CENSUS
. *   3.5 ESTIMATION OF THE POPULATION MEAN
. *   3.6 SAMPLES OTHER THAN RANDOM SAMPLES
. *   3.7 COMPUTER GENERATION OF A RANDOM SAMPLE
. 
. ********** DATA DESCRIPTION
. 
. * (1) Coin toss means data is in AED_COINTOSSMEANS.DTA
. *     The code to generate this is given at the end of this program
. * (2) 1880 Census data in AED_CENSUSAGEMEANS.DTA was drived as follows
. *     First the entire Census was obtained from IPUMS
. *     Second Stata code was written to randomly select subsamples without rep
> lacement
. *     See makedata_CENSUSAGEMEANS.do
. 
. ****   3.2 SAMPLE GENERATED BY AN EXPERIMENT: COIN TOSSES
. 
. * Draw one sample of size 30 from Bernoulli mu = p = 0.5 
. clear

. set obs 30
Number of observations (_N) was 0, now 30.

. set seed 10101

. generate u = runiform()

. generate x = u > 0.5

. summarize x

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
           x |         30    .3333333    .4794633          0          1

. label variable x "Heads = 1 and Tails = 0"

. 
. * Figure 3.1: First panel
. histogram x
(bin=5, start=0, width=.2)

. graph export "images/ch03_fig1a.png", replace
(file images/ch03_fig1a.png not found)
file images/ch03_fig1a.png written in PNG format

. 
. * Means from 400 samples of 30 coin tosses for a fair coin
. * See the code at the end of this file that creates this dataset
. 
. * Download and load data from GitHub for 400 coin tosses
. clear

. copy "${github_data_url}AED_COINTOSSMEANS.DTA" "temp_data.dta", replace
(file temp_data.dta not found)

. use "temp_data.dta", clear
(Data for A. Colin Cameron (2020): Analysis of Economics Data)

. erase "temp_data.dta"

. list in 1/5

     +------------------------------+
     |     xbar      stdev   numobs |
     |------------------------------|
  1. | .3333333   .4794633       30 |
  2. |       .5   .5085476       30 |
  3. | .5333334   .5074162       30 |
  4. | .5666667   .5040069       30 |
  5. |       .5   .5085476       30 |
     +------------------------------+

. describe

Contains data from temp_data.dta
 Observations:           400                  Data for A. Colin Cameron
                                                (2020): Analysis of Economics
                                                Data
    Variables:             3                  14 Jul 2020 18:06
-------------------------------------------------------------------------------
Variable      Storage   Display    Value
    name         type    format    label      Variable label
-------------------------------------------------------------------------------
xbar            float   %9.0g                 Sample mean for each of 400
                                                samples
stdev           float   %9.0g                 Sample standard deviation for
                                                each of 400 samples
numobs          float   %9.0g                 Number of observations in each
                                                sample
-------------------------------------------------------------------------------
Sorted by: 

. summarize

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
        xbar |        400    .4994167    .0863066   .2666667   .7333333
       stdev |        400    .5008261    .0103604   .4497764   .5085476
      numobs |        400          30           0         30         30

. summarize xbar

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
        xbar |        400    .4994167    .0863066   .2666667   .7333333

. 
. * Default histogram has empty bins as xbar can only take values
. *   0, 1/30, 2/30, ...., 29/30, 1
. histogram xbar, normal
(bin=20, start=.26666668, width=.02333333)

. 
. * Figure 3.1: Second panel
. * only 12 bins
. histogram xbar, normal bin(12)
(bin=12, start=.26666668, width=.03888889)

. graph export "images/ch03_fig1b.png", replace
(file images/ch03_fig1b.png not found)
file images/ch03_fig1b.png written in PNG format

. 
. ****  3.4 SAMPLING FROM A FINITE POPULATION: 1880 U.S. CENSUS
. 
. * These data based on a very large dataset not given here.
. 
. * Figure 3.2  Histogram of the very large dataset
. * Not given here
. 
. * Figure 3.3 first panel - again from the very large dataset
. * Not given here
. 
. * Figure 3.3 second panel - uses the following data
. 
. * Download and load data from GitHub - means from 100 samples of size 25
. clear

. copy "${github_data_url}AED_CENSUSAGEMEANS.DTA" "temp_data.dta", replace
(file temp_data.dta not found)

. use "temp_data.dta", clear
(Data for A. Colin Cameron (2020): Analysis of Economics Data)

. erase "temp_data.dta"

. describe

Contains data from temp_data.dta
 Observations:           100                  Data for A. Colin Cameron
                                                (2020): Analysis of Economics
                                                Data
    Variables:             3                  14 Jul 2020 18:06
-------------------------------------------------------------------------------
Variable      Storage   Display    Value
    name         type    format    label      Variable label
-------------------------------------------------------------------------------
mean            float   %9.0g                 Sample mean for each of 100
                                                samples
stdev           float   %9.0g                 Sample standard deviation for
                                                each of 100 samples
numobs          float   %9.0g                 Number of observations in each
                                                sample
-------------------------------------------------------------------------------
Sorted by: 

. summarize

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
        mean |        100      23.782    3.760694       14.6      33.44
       stdev |        100    18.24502    2.890753   12.36285   25.30659
      numobs |        100          25           0         25         25

. list in 1/5

     +---------------------------+
     |  mean      stdev   numobs |
     |---------------------------|
  1. | 27.84   20.70765       25 |
  2. |  19.4         16       25 |
  3. | 23.28   19.02087       25 |
  4. | 26.84   20.50951       25 |
  5. | 26.56   20.19299       25 |
     +---------------------------+

. 
. * Figure 3.3 second panel  Histogram for 100 means
. histogram mean, normal width(2)
(bin=10, start=14.6, width=2)

. graph export "images/ch03_fig3.png", replace
(file images/ch03_fig3.png not found)
file images/ch03_fig3.png written in PNG format

. 
. ****   3.7 COMPUTER GENERATION OF A RANDOM SAMPLE
. 
. * Single sample
. set obs 100
Number of observations (_N) was 100, now 100.

. set seed 10101

. generate x=runiform(3,9)

. generate y=rnormal(5,2)

. summarize x y

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
           x |        100    5.681975    1.690174   3.071115   8.774179
           y |        100    5.144543    1.857429   .0059828   8.747525

. 
. * Multiple samples for a simulation
. * First define one sample of 30 coin tosses
. program onesample, rclass
  1. drop _all
  2. set obs 30
  3. generate u = runiform()
  4. generate x = u > 0.5
  5. summarize x
  6. return scalar xbar = r(mean)
  7. return scalar stdev = r(sd)
  8. return scalar numobs = r(N)
  9. end

. * Then do 400 simulations
. simulate xbar=r(xbar) stdev=r(stdev) numobs=r(numobs), seed(10101) reps(400):
>  onesample

      Command: onesample
         xbar: r(xbar)
        stdev: r(stdev)
       numobs: r(numobs)

Simulations (400): .........10.........20.........30.........40.........50.....
> ....60.........70.........80.........90.........100.........110.........120..
> .......130.........140.........150.........160.........170.........180.......
> ..190.........200.........210.........220.........230.........240.........250
> .........260.........270.........280.........290.........300.........310.....
> ....320.........330.........340.........350.........360.........370.........3
> 80.........390.........400 done

. label variable xbar "Sample mean for each of 400 samples"

. label variable stdev "Sample standard deviation for each of 400 samples"

. label variable numobs "Number of observations in each sample"

. describe 

Contains data
 Observations:           400                  simulate: onesample
    Variables:             3                  20 Jan 2026 19:57
-------------------------------------------------------------------------------
Variable      Storage   Display    Value
    name         type    format    label      Variable label
-------------------------------------------------------------------------------
xbar            float   %9.0g                 Sample mean for each of 400
                                                samples
stdev           float   %9.0g                 Sample standard deviation for
                                                each of 400 samples
numobs          float   %9.0g                 Number of observations in each
                                                sample
-------------------------------------------------------------------------------
Sorted by: 
     Note: Dataset has changed since last saved.

. summarize

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
        xbar |        400    .4994167    .0863066   .2666667   .7333333
       stdev |        400    .5008261    .0103604   .4497764   .5085476
      numobs |        400          30           0         30         30

. 
. ********** CLOSE OUTPUT
. 
. display ""


. display "Chapter 03 analysis complete."
Chapter 03 analysis complete.

. display "Figures saved to: images/"
Figures saved to: images/

. display "Tables saved to: tables/"
Tables saved to: tables/

. 
end of do-file
