
. * ch05_Bivariate_Data_Summary.do - January 2026 For Stata
. * Updated for online execution portability
. 
. ********** OVERVIEW OF ch05_Bivariate_Data_Summary.do **********
. 
. * STATA Program
. * copyright C 2021 by A. Colin Cameron
. * Used for "Analyis of Economics Data: An Introduction to Econometrics"
. * by A. Colin Cameron (2021)
. 
. * To run you need file
. *   AED_HOUSE.DTA
. * in your directory
. 
. ********** SETUP **********
. 
. * Set random seed for reproducibility
. set seed 42

. 
. * Clear all macros
. macro drop _all

. 
. * GitHub data URL
. global github_data_url "https://raw.githubusercontent.com/quarcs-lab/data-ope
> n/master/AED/"

. 
. * Create output directories (optional - for saving figures and tables locally
> )
. cap mkdir "images"

. cap mkdir "tables"

. 
. set more off

. clear all

. 
. ************
. 
. * This STATA program does analysis for Chapter 5
. *  5.1 EXAMPLE: HOUSE PRICE AND SIZE
. *  5.2 TWO-WAY TABULATION
. *  5.3 TWOWAY SCATTER PLOT
. *  5.4 CORRELATION
. *  5.5 REGRESSION LINE
. *  5.6 MEASURES OF MODEL FIT
. *  5.7 COMPUTER OUTPUT FOLLOWING REGRESSION
. *  5.8 PREDICTION AND OUTLYING OBSERVATIONS
. *  5.9 REGRESSION AND CORRELATION
. *  5.10 CAUSATION
. *  5.11 COMPUTATIONS FOR CORRELATION AND REGRESSION 
. *  5.12 NONPARAMETRIC REGRESSION
. 
. ********** DATA DESCRIPTION
. 
. * House sale price for 29 houses in Central Davis in 1999
. *     29 observations on 9 variables 
. 
. ****  5.1 EXAMPLE: HOUSE PRICE AND SIZE
. 
. * Download and load data from GitHub
. clear

. copy "${github_data_url}AED_HOUSE.DTA" "temp_data.dta", replace
(file temp_data.dta not found)

. use "temp_data.dta", clear
(Data for A. Colin Cameron (2020): Analysis of Economics Data)

. erase "temp_data.dta"

. describe

Contains data from temp_data.dta
 Observations:            29                  Data for A. Colin Cameron
                                                (2020): Analysis of Economics
                                                Data
    Variables:             8                  14 Jul 2020 18:06
-------------------------------------------------------------------------------
Variable      Storage   Display    Value
    name         type    format    label      Variable label
-------------------------------------------------------------------------------
price           long    %12.0g                House sale price in dollars
size            int     %8.0g                 House size in square feet
bedrooms        byte    %8.0g                 Number of bedrooms
bathrooms       float   %9.0g                 Number of Bathrooms
lotsize         byte    %8.0g                 Size of lot: 1 > 2 > 3
age             float   %9.0g                 House Age in Years
monthsold       byte    %8.0g                 Month of year house was sold
list            long    %12.0g                House list price in dollars
-------------------------------------------------------------------------------
Sorted by: price

. summarize

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
       price |         29    253910.3    37390.71     204000     375000
        size |         29    1882.759    398.2721       1400       3300
    bedrooms |         29    3.793103    .6750296          3          6
   bathrooms |         29    2.206897    .3411441          2          3
     lotsize |         29    2.137931    .6930336          1          3
-------------+---------------------------------------------------------
         age |         29    36.41379    7.118975         23         51
   monthsold |         29    5.965517    1.679344          3          8
        list |         29    257824.1    40860.26     199900     386000

. * Table 5.1
. sort price

. list, clean 

        price   size   bedrooms   bathro~s   lotsize   age   months~d     list 
>  
  1.   204000   1400          3          2         1    31          7   199900 
>  
  2.   212000   1600          3          3         2    33          5   212000 
>  
  3.   213000   1800          3          2         2    51          4   219900 
>  
  4.   220000   1600          3          2         1    49          4   229000 
>  
  5.   224500   2100          4        2.5         2    47          6   224500 
>  
  6.   229000   1700          4        2.5         2    35          3   229500 
>  
  7.   230000   2100          4          2         2    34          8   239000 
>  
  8.   233000   1700          3          2         1    40          6   244500 
>  
  9.   235000   1700          4          2         2    29          7   245000 
>  
 10.   235000   1600          3          2         3    35          5   242000 
>  
 11.   236500   1600          3          2         3    23          8   239500 
>  
 12.   238000   1900          4          2         2    29          7   249000 
>  
 13.   239500   1600          3          2         3    34          6   239500 
>  
 14.   241000   1600          4          2         2    34          8   242500 
>  
 15.   244000   2000          4          2         1    29          7   249000 
>  
 16.   245000   1400          4          2         2    30          8   252000 
>  
 17.   249000   1900          4          3         3    37          6   235000 
>  
 18.   253000   2100          4          2         3    47          6   269000 
>  
 19.   255000   1500          4          2         3    47          7   240000 
>  
 20.   258500   1600          3          2         1    39          8   259900 
>  
 21.   270000   1800          4          2         3    31          3   263900 
>  
 22.   270000   2000          4        2.5         3    39          5   269000 
>  
 23.   272000   1800          4        2.5         2    46          3   279500 
>  
 24.   273000   1900          5          2         2    37          7   273000 
>  
 25.   278500   2600          6          2         3    38          8   280000 
>  
 26.   279900   2000          4          2         2    31          7   279900 
>  
 27.   310000   2300          4        2.5         2    28          5   315000 
>  
 28.   340000   2400          4          3         2    34          6   369900 
>  
 29.   375000   3300          4        2.5         2    39          3   386000 
>  

. * Table 5.2
. summarize price, detail

                 House sale price in dollars
-------------------------------------------------------------
      Percentiles      Smallest
 1%       204000         204000
 5%       212000         212000
10%       213000         213000       Obs                  29
25%       233000         220000       Sum of wgt.          29

50%       244000                      Mean           253910.3
                        Largest       Std. dev.      37390.71
75%       270000         279900
90%       310000         310000       Variance       1.40e+09
95%       340000         340000       Skewness       1.560837
99%       375000         375000       Kurtosis       5.612707

. mean price

Mean estimation                             Number of obs = 29

--------------------------------------------------------------
             |       Mean   Std. err.     [95% conf. interval]
-------------+------------------------------------------------
       price |   253910.3   6943.281      239687.7      268133
--------------------------------------------------------------

. summarize size, detail

                  House size in square feet
-------------------------------------------------------------
      Percentiles      Smallest
 1%         1400           1400
 5%         1400           1400
10%         1500           1500       Obs                  29
25%         1600           1600       Sum of wgt.          29

50%         1800                      Mean           1882.759
                        Largest       Std. dev.      398.2721
75%         2000           2300
90%         2400           2400       Variance       158620.7
95%         2600           2600       Skewness       1.727665
99%         3300           3300       Kurtosis       6.742809

. mean size

Mean estimation                             Number of obs = 29

--------------------------------------------------------------
             |       Mean   Std. err.     [95% conf. interval]
-------------+------------------------------------------------
        size |   1882.759   73.95728      1731.264    2034.253
--------------------------------------------------------------

. 
. ****  5.2 TWO-WAY TABULATION
. 
. * Create categorical variables
. generate pricerange = price

. recode pricerange(1/249999=1) (250000/400000=2)
(29 changes made to pricerange)

. generate sizerange = size

. recode sizerange (1/1799=1) (1800/2399=2) (2400/4000=3)
(29 changes made to sizerange)

. * Table 5.3
. tabulate pricerange sizerange, row

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |            sizerange
pricerange |         1          2          3 |     Total
-----------+---------------------------------+----------
         1 |        11          6          0 |        17 
           |     64.71      35.29       0.00 |    100.00 
-----------+---------------------------------+----------
         2 |         2          7          3 |        12 
           |     16.67      58.33      25.00 |    100.00 
-----------+---------------------------------+----------
     Total |        13         13          3 |        29 
           |     44.83      44.83      10.34 |    100.00 

. * Table 5.4 - with expected frequencies
. tabulate pricerange sizerange, expected

+--------------------+
| Key                |
|--------------------|
|     frequency      |
| expected frequency |
+--------------------+

           |            sizerange
pricerange |         1          2          3 |     Total
-----------+---------------------------------+----------
         1 |        11          6          0 |        17 
           |       7.6        7.6        1.8 |      17.0 
-----------+---------------------------------+----------
         2 |         2          7          3 |        12 
           |       5.4        5.4        1.2 |      12.0 
-----------+---------------------------------+----------
     Total |        13         13          3 |        29 
           |      13.0       13.0        3.0 |      29.0 

. 
. ****  5.3 TWOWAY SCATTER PLOT
. 
. * Figure 5.1 First panel
. scatter price size

. graph export "images/ch05_fig1.png", replace
(file images/ch05_fig1.png not found)
file images/ch05_fig1.png written in PNG format

. 
. ****  5.4 CORRELATION
. 
. * Figure 5.1 Second panel
. scatter price size, xline(1883) yline(253910) xlabel(0(1000)4000) ylabel(0(10
> 0000)500000)

. * Covariance and correlation coefficient
. correlate price size, covariance
(obs=29)

             |    price     size
-------------+------------------
       price |  1.4e+09
        size |  1.2e+07   158621


. display %20.1f r(cov_12)
          11701613.3

. * Figure 5.2: Plot of four cases of correlation - skip
. 
. ****  5.5 REGRESSION
. 
. * Download and load data from GitHub
. clear

. copy "${github_data_url}AED_HOUSE.DTA" "temp_data.dta", replace
(file temp_data.dta not found)

. use "temp_data.dta", clear
(Data for A. Colin Cameron (2020): Analysis of Economics Data)

. erase "temp_data.dta"

. * Linear regression
. regress price size

      Source |       SS           df       MS      Number of obs   =        29
-------------+----------------------------------   F(1, 27)        =     43.58
       Model |  2.4171e+10         1  2.4171e+10   Prob > F        =    0.0000
    Residual |  1.4975e+10        27   554633395   R-squared       =    0.6175
-------------+----------------------------------   Adj R-squared   =    0.6033
       Total |  3.9146e+10        28  1.3981e+09   Root MSE        =     23551

------------------------------------------------------------------------------
       price | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        size |   73.77104   11.17491     6.60   0.000     50.84202    96.70006
       _cons |   115017.3   21489.36     5.35   0.000     70924.76    159109.8
------------------------------------------------------------------------------

. * Figure 5.3 - drawn in Word
. * Figure 5.4
. scatter price size || lfit price size

. * Intercept-only regression compared to the sample mean
. regress price

      Source |       SS           df       MS      Number of obs   =        29
-------------+----------------------------------   F(0, 28)        =      0.00
       Model |           0         0           .   Prob > F        =         .
    Residual |  3.9146e+10        28  1.3981e+09   R-squared       =    0.0000
-------------+----------------------------------   Adj R-squared   =    0.0000
       Total |  3.9146e+10        28  1.3981e+09   Root MSE        =     37391

------------------------------------------------------------------------------
       price | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
       _cons |   253910.3   6943.281    36.57   0.000     239687.7      268133
------------------------------------------------------------------------------

. mean price 

Mean estimation                             Number of obs = 29

--------------------------------------------------------------
             |       Mean   Std. err.     [95% conf. interval]
-------------+------------------------------------------------
       price |   253910.3   6943.281      239687.7      268133
--------------------------------------------------------------

. 
. ****  5.6 MEASURES OF GOODNESS OF FIT
. 
. * Figure 5.5 - skip
. 
. **** 5.7 COMPUTER OUTPUT FOLLOWING REGRESSION
. 
. * Table 5.5
. regress price size

      Source |       SS           df       MS      Number of obs   =        29
-------------+----------------------------------   F(1, 27)        =     43.58
       Model |  2.4171e+10         1  2.4171e+10   Prob > F        =    0.0000
    Residual |  1.4975e+10        27   554633395   R-squared       =    0.6175
-------------+----------------------------------   Adj R-squared   =    0.6033
       Total |  3.9146e+10        28  1.3981e+09   Root MSE        =     23551

------------------------------------------------------------------------------
       price | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        size |   73.77104   11.17491     6.60   0.000     50.84202    96.70006
       _cons |   115017.3   21489.36     5.35   0.000     70924.76    159109.8
------------------------------------------------------------------------------

. 
. **** 5.8 PREDICTION AND OUTLYING OBSERVATIONS
. 
. * predict at size = 2000
. display _b[_cons] + _b[size]*2000
262559.36

. * predict all observations in sample
. predict double yhat
(option xb assumed; fitted values)

. generate double resid = y - yhat

. summarize price yhat resid

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
       price |         29    253910.3    37390.71     204000     375000
        yhat |         29    253910.3    29380.95   218296.7   358461.7
       resid |         29           0           0          0          0

. 
. ****  5.9 REGRESSION AND CORRELATION
. 
. * Nothing
. 
. ****  5.10 CAUSATION
. 
. * Reverse regression
. regress size price

      Source |       SS           df       MS      Number of obs   =        29
-------------+----------------------------------   F(1, 27)        =     43.58
       Model |  2742344.91         1  2742344.91   Prob > F        =    0.0000
    Residual |   1699034.4        27  62927.2001   R-squared       =    0.6175
-------------+----------------------------------   Adj R-squared   =    0.6033
       Total |  4441379.31        28   158620.69   Root MSE        =    250.85

------------------------------------------------------------------------------
        size | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
       price |   .0083699   .0012679     6.60   0.000     .0057684    .0109713
       _cons |  -242.4359   325.2793    -0.75   0.463     -909.854    424.9821
------------------------------------------------------------------------------

. 
. ****  5.11 REGRESSION COMPUTATION
. 
. * Example with artifical data
. clear

. input x y 

             x          y
  1.  1 1
  2.  2 2
  3.  3 2
  4.  4 2
  5.  5 3
  6. end

. list 

     +-------+
     | x   y |
     |-------|
  1. | 1   1 |
  2. | 2   2 |
  3. | 3   2 |
  4. | 4   2 |
  5. | 5   3 |
     +-------+

. summarize

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
           x |          5           3    1.581139          1          5
           y |          5           2    .7071068          1          3

. * Figure 5.6
. graph twoway (scatter y x) (function y = 0.8 + 0.4*x, range(0 6)), legend(off
> )

. * Check hand calculations
. regress y x

      Source |       SS           df       MS      Number of obs   =         5
-------------+----------------------------------   F(1, 3)         =     12.00
       Model |         1.6         1         1.6   Prob > F        =    0.0405
    Residual |          .4         3  .133333333   R-squared       =    0.8000
-------------+----------------------------------   Adj R-squared   =    0.7333
       Total |           2         4          .5   Root MSE        =    .36515

------------------------------------------------------------------------------
           y | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
           x |         .4   .1154701     3.46   0.041     .0325228    .7674772
       _cons |         .8   .3829708     2.09   0.128    -.4187841    2.018784
------------------------------------------------------------------------------

. correlate y x
(obs=5)

             |        y        x
-------------+------------------
           y |   1.0000
           x |   0.8944   1.0000


. display r(rho)^2
.8

. 
. ****  5.12 NONPARAMETRIC REGRESSION
. 
. * Download and load data from GitHub
. clear

. copy "${github_data_url}AED_HOUSE.DTA" "temp_data.dta", replace
(file temp_data.dta not found)

. use "temp_data.dta", clear
(Data for A. Colin Cameron (2020): Analysis of Economics Data)

. erase "temp_data.dta"

. sort size

. list price size

     +---------------+
     |  price   size |
     |---------------|
  1. | 204000   1400 |
  2. | 245000   1400 |
  3. | 255000   1500 |
  4. | 235000   1600 |
  5. | 220000   1600 |
     |---------------|
  6. | 236500   1600 |
  7. | 258500   1600 |
  8. | 239500   1600 |
  9. | 212000   1600 |
 10. | 241000   1600 |
     |---------------|
 11. | 233000   1700 |
 12. | 229000   1700 |
 13. | 235000   1700 |
 14. | 270000   1800 |
 15. | 272000   1800 |
     |---------------|
 16. | 213000   1800 |
 17. | 273000   1900 |
 18. | 238000   1900 |
 19. | 249000   1900 |
 20. | 270000   2000 |
     |---------------|
 21. | 244000   2000 |
 22. | 279900   2000 |
 23. | 230000   2100 |
 24. | 224500   2100 |
 25. | 253000   2100 |
     |---------------|
 26. | 310000   2300 |
 27. | 340000   2400 |
 28. | 278500   2600 |
 29. | 375000   3300 |
     +---------------+

. correlate price size
(obs=29)

             |    price     size
-------------+------------------
       price |   1.0000
        size |   0.7858   1.0000


. regress price size

      Source |       SS           df       MS      Number of obs   =        29
-------------+----------------------------------   F(1, 27)        =     43.58
       Model |  2.4171e+10         1  2.4171e+10   Prob > F        =    0.0000
    Residual |  1.4975e+10        27   554633395   R-squared       =    0.6175
-------------+----------------------------------   Adj R-squared   =    0.6033
       Total |  3.9146e+10        28  1.3981e+09   Root MSE        =     23551

------------------------------------------------------------------------------
       price | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        size |   73.77104   11.17491     6.60   0.000     50.84202    96.70006
       _cons |   115017.3   21489.36     5.35   0.000     70924.76    159109.8
------------------------------------------------------------------------------

. * local linear regression
. lpoly price size, degree(1) bw(300) generate(xlpoly ylpoly)
(n() set to 29)

. * lowess with default bandwidth
. lowess price size, generate(ylowess)

. * Figure 5.7
. graph twoway (scatter price size) (line ylpoly xlpoly) (line ylowess size)

.   
. ********** CLOSE OUTPUT
. 
. display ""


. display "Chapter 05 analysis complete."
Chapter 05 analysis complete.

. display "Figures saved to: images/"
Figures saved to: images/

. display "Tables saved to: tables/"
Tables saved to: tables/

. 
end of do-file
